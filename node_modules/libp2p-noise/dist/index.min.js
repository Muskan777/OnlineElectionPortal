
  (function (root, factory) {
    if (typeof module === 'object' && module.exports) {
        module.exports = factory();
    } else {
        root.Libp2pNoise = factory();
  }
}(typeof self !== 'undefined' ? self : this, function () {

var Libp2pNoise=(()=>{var py=Object.create,Sf=Object.defineProperty,yy=Object.getPrototypeOf,my=Object.prototype.hasOwnProperty,xy=Object.getOwnPropertyNames,vy=Object.getOwnPropertyDescriptor;var gy=r=>Sf(r,"__esModule",{value:!0});var C=(r,e)=>()=>(e||(e={exports:{}},r(e.exports,e)),e.exports),wy=(r,e)=>{for(var t in e)Sf(r,t,{get:e[t],enumerable:!0})},Sy=(r,e,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of xy(e))!my.call(r,i)&&i!=="default"&&Sf(r,i,{get:()=>e[i],enumerable:!(t=vy(e,i))||t.enumerable});return r},We=r=>r&&r.__esModule?r:Sy(gy(Sf(r!=null?py(yy(r)):{},"default",{value:r,enumerable:!0})),r);var ah=C(Ef=>{"use strict";Ef.byteLength=Ey;Ef.toByteArray=My;Ef.fromByteArray=_y;var si=[],Rr=[],Iy=typeof Uint8Array!="undefined"?Uint8Array:Array,lo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var y0=0,Ay=lo.length;y0<Ay;++y0)si[y0]=lo[y0],Rr[lo.charCodeAt(y0)]=y0;Rr["-".charCodeAt(0)]=62;Rr["_".charCodeAt(0)]=63;function fh(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var i=t===e?0:4-t%4;return[t,i]}function Ey(r){var e=fh(r),t=e[0],i=e[1];return(t+i)*3/4-i}function By(r,e,t){return(e+t)*3/4-t}function My(r){var e,t=fh(r),i=t[0],n=t[1],s=new Iy(By(r,i,n)),f=0,a=n>0?i-4:i,o;for(o=0;o<a;o+=4)e=Rr[r.charCodeAt(o)]<<18|Rr[r.charCodeAt(o+1)]<<12|Rr[r.charCodeAt(o+2)]<<6|Rr[r.charCodeAt(o+3)],s[f++]=e>>16&255,s[f++]=e>>8&255,s[f++]=e&255;return n===2&&(e=Rr[r.charCodeAt(o)]<<2|Rr[r.charCodeAt(o+1)]>>4,s[f++]=e&255),n===1&&(e=Rr[r.charCodeAt(o)]<<10|Rr[r.charCodeAt(o+1)]<<4|Rr[r.charCodeAt(o+2)]>>2,s[f++]=e>>8&255,s[f++]=e&255),s}function ky(r){return si[r>>18&63]+si[r>>12&63]+si[r>>6&63]+si[r&63]}function qy(r,e,t){for(var i,n=[],s=e;s<t;s+=3)i=(r[s]<<16&16711680)+(r[s+1]<<8&65280)+(r[s+2]&255),n.push(ky(i));return n.join("")}function _y(r){for(var e,t=r.length,i=t%3,n=[],s=16383,f=0,a=t-i;f<a;f+=s)n.push(qy(r,f,f+s>a?a:f+s));return i===1?(e=r[t-1],n.push(si[e>>2]+si[e<<4&63]+"==")):i===2&&(e=(r[t-2]<<8)+r[t-1],n.push(si[e>>10]+si[e>>4&63]+si[e<<2&63]+"=")),n.join("")}});var oh=C(bo=>{bo.read=function(r,e,t,i,n){var s,f,a=n*8-i-1,o=(1<<a)-1,c=o>>1,d=-7,u=t?n-1:0,p=t?-1:1,x=r[e+u];for(u+=p,s=x&(1<<-d)-1,x>>=-d,d+=a;d>0;s=s*256+r[e+u],u+=p,d-=8);for(f=s&(1<<-d)-1,s>>=-d,d+=i;d>0;f=f*256+r[e+u],u+=p,d-=8);if(s===0)s=1-c;else{if(s===o)return f?NaN:(x?-1:1)*Infinity;f=f+Math.pow(2,i),s=s-c}return(x?-1:1)*f*Math.pow(2,s-i)};bo.write=function(r,e,t,i,n,s){var f,a,o,c=s*8-n-1,d=(1<<c)-1,u=d>>1,p=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,x=i?0:s-1,y=i?1:-1,g=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===Infinity?(a=isNaN(e)?1:0,f=d):(f=Math.floor(Math.log(e)/Math.LN2),e*(o=Math.pow(2,-f))<1&&(f--,o*=2),f+u>=1?e+=p/o:e+=p*Math.pow(2,1-u),e*o>=2&&(f++,o/=2),f+u>=d?(a=0,f=d):f+u>=1?(a=(e*o-1)*Math.pow(2,n),f=f+u):(a=e*Math.pow(2,u-1)*Math.pow(2,n),f=0));n>=8;r[t+x]=a&255,x+=y,a/=256,n-=8);for(f=f<<n|a,c+=n;c>0;r[t+x]=f&255,x+=y,f/=256,c-=8);r[t+x-y]|=g*128}});var Ht=C(m0=>{"use strict";var po=ah(),x0=oh(),ch=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;m0.Buffer=J;m0.SlowBuffer=Cy;m0.INSPECT_MAX_BYTES=50;var Mf=2147483647;m0.kMaxLength=Mf;J.TYPED_ARRAY_SUPPORT=Ty();!J.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function Ty(){try{var r=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(r,e),r.foo()===42}catch(t){return!1}}Object.defineProperty(J.prototype,"parent",{enumerable:!0,get:function(){if(!!J.isBuffer(this))return this.buffer}});Object.defineProperty(J.prototype,"offset",{enumerable:!0,get:function(){if(!!J.isBuffer(this))return this.byteOffset}});function Ri(r){if(r>Mf)throw new RangeError('The value "'+r+'" is invalid for option "size"');var e=new Uint8Array(r);return Object.setPrototypeOf(e,J.prototype),e}function J(r,e,t){if(typeof r=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return yo(r)}return dh(r,e,t)}J.poolSize=8192;function dh(r,e,t){if(typeof r=="string")return Ny(r,e);if(ArrayBuffer.isView(r))return Py(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(fi(r,ArrayBuffer)||r&&fi(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(fi(r,SharedArrayBuffer)||r&&fi(r.buffer,SharedArrayBuffer)))return mo(r,e,t);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var i=r.valueOf&&r.valueOf();if(i!=null&&i!==r)return J.from(i,e,t);var n=Ry(r);if(n)return n;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return J.from(r[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}J.from=function(r,e,t){return dh(r,e,t)};Object.setPrototypeOf(J.prototype,Uint8Array.prototype);Object.setPrototypeOf(J,Uint8Array);function hh(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function Ky(r,e,t){return hh(r),r<=0?Ri(r):e!==void 0?typeof t=="string"?Ri(r).fill(e,t):Ri(r).fill(e):Ri(r)}J.alloc=function(r,e,t){return Ky(r,e,t)};function yo(r){return hh(r),Ri(r<0?0:xo(r)|0)}J.allocUnsafe=function(r){return yo(r)};J.allocUnsafeSlow=function(r){return yo(r)};function Ny(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!J.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var t=uh(r,e)|0,i=Ri(t),n=i.write(r,e);return n!==t&&(i=i.slice(0,n)),i}function vo(r){for(var e=r.length<0?0:xo(r.length)|0,t=Ri(e),i=0;i<e;i+=1)t[i]=r[i]&255;return t}function Py(r){if(fi(r,Uint8Array)){var e=new Uint8Array(r);return mo(e.buffer,e.byteOffset,e.byteLength)}return vo(r)}function mo(r,e,t){if(e<0||r.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');var i;return e===void 0&&t===void 0?i=new Uint8Array(r):t===void 0?i=new Uint8Array(r,e):i=new Uint8Array(r,e,t),Object.setPrototypeOf(i,J.prototype),i}function Ry(r){if(J.isBuffer(r)){var e=xo(r.length)|0,t=Ri(e);return t.length===0||r.copy(t,0,0,e),t}if(r.length!==void 0)return typeof r.length!="number"||go(r.length)?Ri(0):vo(r);if(r.type==="Buffer"&&Array.isArray(r.data))return vo(r.data)}function xo(r){if(r>=Mf)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Mf.toString(16)+" bytes");return r|0}function Cy(r){return+r!=r&&(r=0),J.alloc(+r)}J.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==J.prototype};J.compare=function(e,t){if(fi(e,Uint8Array)&&(e=J.from(e,e.offset,e.byteLength)),fi(t,Uint8Array)&&(t=J.from(t,t.offset,t.byteLength)),!J.isBuffer(e)||!J.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var i=e.length,n=t.length,s=0,f=Math.min(i,n);s<f;++s)if(e[s]!==t[s]){i=e[s],n=t[s];break}return i<n?-1:n<i?1:0};J.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};J.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return J.alloc(0);var i;if(t===void 0)for(t=0,i=0;i<e.length;++i)t+=e[i].length;var n=J.allocUnsafe(t),s=0;for(i=0;i<e.length;++i){var f=e[i];if(fi(f,Uint8Array))s+f.length>n.length?J.from(f).copy(n,s):Uint8Array.prototype.set.call(n,f,s);else if(J.isBuffer(f))f.copy(n,s);else throw new TypeError('"list" argument must be an Array of Buffers');s+=f.length}return n};function uh(r,e){if(J.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||fi(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);var t=r.length,i=arguments.length>2&&arguments[2]===!0;if(!i&&t===0)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return wo(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return lh(r).length;default:if(n)return i?-1:wo(r).length;e=(""+e).toLowerCase(),n=!0}}J.byteLength=uh;function Uy(r,e,t){var i=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return zy(this,e,t);case"utf8":case"utf-8":return bh(this,e,t);case"ascii":return Fy(this,e,t);case"latin1":case"binary":return Dy(this,e,t);case"base64":return Ly(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Oy(this,e,t);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),i=!0}}J.prototype._isBuffer=!0;function qn(r,e,t){var i=r[e];r[e]=r[t],r[t]=i}J.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)qn(this,t,t+1);return this};J.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)qn(this,t,t+3),qn(this,t+1,t+2);return this};J.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)qn(this,t,t+7),qn(this,t+1,t+6),qn(this,t+2,t+5),qn(this,t+3,t+4);return this};J.prototype.toString=function(){var e=this.length;return e===0?"":arguments.length===0?bh(this,0,e):Uy.apply(this,arguments)};J.prototype.toLocaleString=J.prototype.toString;J.prototype.equals=function(e){if(!J.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:J.compare(this,e)===0};J.prototype.inspect=function(){var e="",t=m0.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"};ch&&(J.prototype[ch]=J.prototype.inspect);J.prototype.compare=function(e,t,i,n,s){if(fi(e,Uint8Array)&&(e=J.from(e,e.offset,e.byteLength)),!J.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),i===void 0&&(i=e?e.length:0),n===void 0&&(n=0),s===void 0&&(s=this.length),t<0||i>e.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&t>=i)return 0;if(n>=s)return-1;if(t>=i)return 1;if(t>>>=0,i>>>=0,n>>>=0,s>>>=0,this===e)return 0;for(var f=s-n,a=i-t,o=Math.min(f,a),c=this.slice(n,s),d=e.slice(t,i),u=0;u<o;++u)if(c[u]!==d[u]){f=c[u],a=d[u];break}return f<a?-1:a<f?1:0};function yh(r,e,t,i,n){if(r.length===0)return-1;if(typeof t=="string"?(i=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,go(t)&&(t=n?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(n)return-1;t=r.length-1}else if(t<0)if(n)t=0;else return-1;if(typeof e=="string"&&(e=J.from(e,i)),J.isBuffer(e))return e.length===0?-1:ph(r,e,t,i,n);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):ph(r,[e],t,i,n);throw new TypeError("val must be string, number or Buffer")}function ph(r,e,t,i,n){var s=1,f=r.length,a=e.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(r.length<2||e.length<2)return-1;s=2,f/=2,a/=2,t/=2}function o(x,y){return s===1?x[y]:x.readUInt16BE(y*s)}var c;if(n){var d=-1;for(c=t;c<f;c++)if(o(r,c)===o(e,d===-1?0:c-d)){if(d===-1&&(d=c),c-d+1===a)return d*s}else d!==-1&&(c-=c-d),d=-1}else for(t+a>f&&(t=f-a),c=t;c>=0;c--){for(var u=!0,p=0;p<a;p++)if(o(r,c+p)!==o(e,p)){u=!1;break}if(u)return c}return-1}J.prototype.includes=function(e,t,i){return this.indexOf(e,t,i)!==-1};J.prototype.indexOf=function(e,t,i){return yh(this,e,t,i,!0)};J.prototype.lastIndexOf=function(e,t,i){return yh(this,e,t,i,!1)};function Hy(r,e,t,i){t=Number(t)||0;var n=r.length-t;i?(i=Number(i),i>n&&(i=n)):i=n;var s=e.length;i>s/2&&(i=s/2);for(var f=0;f<i;++f){var a=parseInt(e.substr(f*2,2),16);if(go(a))return f;r[t+f]=a}return f}function Vy(r,e,t,i){return _f(wo(e,r.length-t),r,t,i)}function Gy(r,e,t,i){return _f(Jy(e),r,t,i)}function Xy(r,e,t,i){return _f(lh(e),r,t,i)}function Zy(r,e,t,i){return _f(Yy(e,r.length-t),r,t,i)}J.prototype.write=function(e,t,i,n){if(t===void 0)n="utf8",i=this.length,t=0;else if(i===void 0&&typeof t=="string")n=t,i=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(i)?(i=i>>>0,n===void 0&&(n="utf8")):(n=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var s=this.length-t;if((i===void 0||i>s)&&(i=s),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var f=!1;;)switch(n){case"hex":return Hy(this,e,t,i);case"utf8":case"utf-8":return Vy(this,e,t,i);case"ascii":case"latin1":case"binary":return Gy(this,e,t,i);case"base64":return Xy(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Zy(this,e,t,i);default:if(f)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),f=!0}};J.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Ly(r,e,t){return e===0&&t===r.length?po.fromByteArray(r):po.fromByteArray(r.slice(e,t))}function bh(r,e,t){t=Math.min(r.length,t);for(var i=[],n=e;n<t;){var s=r[n],f=null,a=s>239?4:s>223?3:s>191?2:1;if(n+a<=t){var o,c,d,u;switch(a){case 1:s<128&&(f=s);break;case 2:o=r[n+1],(o&192)==128&&(u=(s&31)<<6|o&63,u>127&&(f=u));break;case 3:o=r[n+1],c=r[n+2],(o&192)==128&&(c&192)==128&&(u=(s&15)<<12|(o&63)<<6|c&63,u>2047&&(u<55296||u>57343)&&(f=u));break;case 4:o=r[n+1],c=r[n+2],d=r[n+3],(o&192)==128&&(c&192)==128&&(d&192)==128&&(u=(s&15)<<18|(o&63)<<12|(c&63)<<6|d&63,u>65535&&u<1114112&&(f=u))}}f===null?(f=65533,a=1):f>65535&&(f-=65536,i.push(f>>>10&1023|55296),f=56320|f&1023),i.push(f),n+=a}return Wy(i)}var mh=4096;function Wy(r){var e=r.length;if(e<=mh)return String.fromCharCode.apply(String,r);for(var t="",i=0;i<e;)t+=String.fromCharCode.apply(String,r.slice(i,i+=mh));return t}function Fy(r,e,t){var i="";t=Math.min(r.length,t);for(var n=e;n<t;++n)i+=String.fromCharCode(r[n]&127);return i}function Dy(r,e,t){var i="";t=Math.min(r.length,t);for(var n=e;n<t;++n)i+=String.fromCharCode(r[n]);return i}function zy(r,e,t){var i=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>i)&&(t=i);for(var n="",s=e;s<t;++s)n+=jy[r[s]];return n}function Oy(r,e,t){for(var i=r.slice(e,t),n="",s=0;s<i.length-1;s+=2)n+=String.fromCharCode(i[s]+i[s+1]*256);return n}J.prototype.slice=function(e,t){var i=this.length;e=~~e,t=t===void 0?i:~~t,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,J.prototype),n};function Yt(r,e,t){if(r%1!=0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}J.prototype.readUintLE=J.prototype.readUIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||Yt(e,t,this.length);for(var n=this[e],s=1,f=0;++f<t&&(s*=256);)n+=this[e+f]*s;return n};J.prototype.readUintBE=J.prototype.readUIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||Yt(e,t,this.length);for(var n=this[e+--t],s=1;t>0&&(s*=256);)n+=this[e+--t]*s;return n};J.prototype.readUint8=J.prototype.readUInt8=function(e,t){return e=e>>>0,t||Yt(e,1,this.length),this[e]};J.prototype.readUint16LE=J.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||Yt(e,2,this.length),this[e]|this[e+1]<<8};J.prototype.readUint16BE=J.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||Yt(e,2,this.length),this[e]<<8|this[e+1]};J.prototype.readUint32LE=J.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||Yt(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};J.prototype.readUint32BE=J.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||Yt(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};J.prototype.readIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||Yt(e,t,this.length);for(var n=this[e],s=1,f=0;++f<t&&(s*=256);)n+=this[e+f]*s;return s*=128,n>=s&&(n-=Math.pow(2,8*t)),n};J.prototype.readIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||Yt(e,t,this.length);for(var n=t,s=1,f=this[e+--n];n>0&&(s*=256);)f+=this[e+--n]*s;return s*=128,f>=s&&(f-=Math.pow(2,8*t)),f};J.prototype.readInt8=function(e,t){return e=e>>>0,t||Yt(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};J.prototype.readInt16LE=function(e,t){e=e>>>0,t||Yt(e,2,this.length);var i=this[e]|this[e+1]<<8;return i&32768?i|4294901760:i};J.prototype.readInt16BE=function(e,t){e=e>>>0,t||Yt(e,2,this.length);var i=this[e+1]|this[e]<<8;return i&32768?i|4294901760:i};J.prototype.readInt32LE=function(e,t){return e=e>>>0,t||Yt(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};J.prototype.readInt32BE=function(e,t){return e=e>>>0,t||Yt(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};J.prototype.readFloatLE=function(e,t){return e=e>>>0,t||Yt(e,4,this.length),x0.read(this,e,!0,23,4)};J.prototype.readFloatBE=function(e,t){return e=e>>>0,t||Yt(e,4,this.length),x0.read(this,e,!1,23,4)};J.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||Yt(e,8,this.length),x0.read(this,e,!0,52,8)};J.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||Yt(e,8,this.length),x0.read(this,e,!1,52,8)};function gr(r,e,t,i,n,s){if(!J.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<s)throw new RangeError('"value" argument is out of bounds');if(t+i>r.length)throw new RangeError("Index out of range")}J.prototype.writeUintLE=J.prototype.writeUIntLE=function(e,t,i,n){if(e=+e,t=t>>>0,i=i>>>0,!n){var s=Math.pow(2,8*i)-1;gr(this,e,t,i,s,0)}var f=1,a=0;for(this[t]=e&255;++a<i&&(f*=256);)this[t+a]=e/f&255;return t+i};J.prototype.writeUintBE=J.prototype.writeUIntBE=function(e,t,i,n){if(e=+e,t=t>>>0,i=i>>>0,!n){var s=Math.pow(2,8*i)-1;gr(this,e,t,i,s,0)}var f=i-1,a=1;for(this[t+f]=e&255;--f>=0&&(a*=256);)this[t+f]=e/a&255;return t+i};J.prototype.writeUint8=J.prototype.writeUInt8=function(e,t,i){return e=+e,t=t>>>0,i||gr(this,e,t,1,255,0),this[t]=e&255,t+1};J.prototype.writeUint16LE=J.prototype.writeUInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||gr(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2};J.prototype.writeUint16BE=J.prototype.writeUInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||gr(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2};J.prototype.writeUint32LE=J.prototype.writeUInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||gr(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4};J.prototype.writeUint32BE=J.prototype.writeUInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||gr(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};J.prototype.writeIntLE=function(e,t,i,n){if(e=+e,t=t>>>0,!n){var s=Math.pow(2,8*i-1);gr(this,e,t,i,s-1,-s)}var f=0,a=1,o=0;for(this[t]=e&255;++f<i&&(a*=256);)e<0&&o===0&&this[t+f-1]!==0&&(o=1),this[t+f]=(e/a>>0)-o&255;return t+i};J.prototype.writeIntBE=function(e,t,i,n){if(e=+e,t=t>>>0,!n){var s=Math.pow(2,8*i-1);gr(this,e,t,i,s-1,-s)}var f=i-1,a=1,o=0;for(this[t+f]=e&255;--f>=0&&(a*=256);)e<0&&o===0&&this[t+f+1]!==0&&(o=1),this[t+f]=(e/a>>0)-o&255;return t+i};J.prototype.writeInt8=function(e,t,i){return e=+e,t=t>>>0,i||gr(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1};J.prototype.writeInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||gr(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2};J.prototype.writeInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||gr(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2};J.prototype.writeInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||gr(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4};J.prototype.writeInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||gr(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function xh(r,e,t,i,n,s){if(t+i>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function vh(r,e,t,i,n){return e=+e,t=t>>>0,n||xh(r,e,t,4,34028234663852886e22,-34028234663852886e22),x0.write(r,e,t,i,23,4),t+4}J.prototype.writeFloatLE=function(e,t,i){return vh(this,e,t,!0,i)};J.prototype.writeFloatBE=function(e,t,i){return vh(this,e,t,!1,i)};function gh(r,e,t,i,n){return e=+e,t=t>>>0,n||xh(r,e,t,8,17976931348623157e292,-17976931348623157e292),x0.write(r,e,t,i,52,8),t+8}J.prototype.writeDoubleLE=function(e,t,i){return gh(this,e,t,!0,i)};J.prototype.writeDoubleBE=function(e,t,i){return gh(this,e,t,!1,i)};J.prototype.copy=function(e,t,i,n){if(!J.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),!n&&n!==0&&(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<i&&(n=i),n===i||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-i&&(n=e.length-t+i);var s=n-i;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,i,n):Uint8Array.prototype.set.call(e,this.subarray(i,n),t),s};J.prototype.fill=function(e,t,i,n){if(typeof e=="string"){if(typeof t=="string"?(n=t,t=0,i=this.length):typeof i=="string"&&(n=i,i=this.length),n!==void 0&&typeof n!="string")throw new TypeError("encoding must be a string");if(typeof n=="string"&&!J.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(e.length===1){var s=e.charCodeAt(0);(n==="utf8"&&s<128||n==="latin1")&&(e=s)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;t=t>>>0,i=i===void 0?this.length:i>>>0,e||(e=0);var f;if(typeof e=="number")for(f=t;f<i;++f)this[f]=e;else{var a=J.isBuffer(e)?e:J.from(e,n),o=a.length;if(o===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(f=0;f<i-t;++f)this[f+t]=a[f%o]}return this};var $y=/[^+/0-9A-Za-z-_]/g;function Qy(r){if(r=r.split("=")[0],r=r.trim().replace($y,""),r.length<2)return"";for(;r.length%4!=0;)r=r+"=";return r}function wo(r,e){e=e||Infinity;for(var t,i=r.length,n=null,s=[],f=0;f<i;++f){if(t=r.charCodeAt(f),t>55295&&t<57344){if(!n){if(t>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(f+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=t;continue}if(t<56320){(e-=3)>-1&&s.push(239,191,189),n=t;continue}t=(n-55296<<10|t-56320)+65536}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,t<128){if((e-=1)<0)break;s.push(t)}else if(t<2048){if((e-=2)<0)break;s.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;s.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;s.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return s}function Jy(r){for(var e=[],t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}function Yy(r,e){for(var t,i,n,s=[],f=0;f<r.length&&!((e-=2)<0);++f)t=r.charCodeAt(f),i=t>>8,n=t%256,s.push(n),s.push(i);return s}function lh(r){return po.toByteArray(Qy(r))}function _f(r,e,t,i){for(var n=0;n<i&&!(n+t>=e.length||n>=r.length);++n)e[n+t]=r[n];return n}function fi(r,e){return r instanceof e||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===e.name}function go(r){return r!==r}var jy=function(){for(var r="0123456789abcdef",e=new Array(256),t=0;t<16;++t)for(var i=t*16,n=0;n<16;++n)e[i+n]=r[t]+r[n];return e}()});var Ki=C((cI,wh)=>{"use strict";function Sh(r,e){if(!r){let t=new Error(e||"Assertion failed");throw Error.captureStackTrace&&Error.captureStackTrace(t,Sh),t}}wh.exports=Sh});var So=C(Eh=>{"use strict";Eh.custom="inspect"});var Gh=C((hI,Mh)=>{"use strict";var{custom:_h}=So(),Ih=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],em=[0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],tm=[0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176],Eo={p192:null,p224:null,p521:null,k256:null,p251:null,p25519:null,p448:null},Pt={NONE:0,QUO:1,REM:2,BOTH:3,EUCLID:4,ALL:7},ms=4,v0=1<<ms-1,Cn=typeof BigInt=="function",D=class{constructor(e,t,i){this.words=[0],this.length=1,this.negative=0,this.red=null,this.from(e,t,i)}_iadd(e,t){let i=0,n=0;for(e.length<t.length&&([e,t]=[t,e]),e!==this&&this._alloc(e.length);n<t.length;n++){let s=(e.words[n]|0)+(t.words[n]|0)+i;this.words[n]=s&67108863,i=s>>>26}for(;i!==0&&n<e.length;n++){let s=(e.words[n]|0)+i;this.words[n]=s&67108863,i=s>>>26}if(this.length=e.length,i!==0)this._alloc(this.length+1),this.words[this.length++]=i;else if(e!==this)for(;n<e.length;n++)this.words[n]=e.words[n];return this}_iaddn(e){if(this.words[0]+=e,this.words[0]<67108864)return this;let t=0;for(this._alloc(this.length+1),this.words[this.length]=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,this.words[t+1]+=1;return this.length=Math.max(this.length,t+1),this}iadd(e){if(U(D.isBN(e),"num","bignum"),this.negative===e.negative)this._iadd(this,e);else{let t=this.ucmp(e);if(t===0)return this.words[0]=0,this.length=1,this.negative=0,this;t<0?(this._isub(e,this),this.negative^=1):this._isub(this,e)}return this}iaddn(e){U(Ze(e),"num","smi");let t=e<0|0;return t&&(e=-e),this.negative===t?this._iaddn(e):this.length===1&&this.words[0]<e?(this.words[0]=e-this.words[0],this.negative^=1):this._isubn(e),this}add(e){return U(D.isBN(e),"num","bignum"),e.length>this.length?e.clone().iadd(this):this.clone().iadd(e)}addn(e){return this.clone().iaddn(e)}_isub(e,t){let i=0,n=0;for(Rt(e.length>=t.length),e!==this&&this._alloc(e.length);n<t.length;n++){let s=(e.words[n]|0)-(t.words[n]|0)+i;i=s>>26,this.words[n]=s&67108863}for(;i!==0&&n<e.length;n++){let s=(e.words[n]|0)+i;i=s>>26,this.words[n]=s&67108863}if(Rt(i===0),e!==this)for(;n<e.length;n++)this.words[n]=e.words[n];return this.length=Math.max(this.length,n),this._strip()}_isubn(e){if(this.words[0]-=e,this.words[0]>=0)return this._normalize();Rt(this.length!==1),this._alloc(this.length+1);for(let t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.words[this.length]=0,this._strip()}isub(e){if(U(D.isBN(e),"num","bignum"),this.negative!==e.negative)this._iadd(this,e);else{let t=this.ucmp(e);if(t===0)return this.words[0]=0,this.length=1,this.negative=0,this;t<0?(this._isub(e,this),this.negative^=1):this._isub(this,e)}return this}isubn(e){U(Ze(e),"num","smi");let t=e<0|0;return t&&(e=-e),this.negative!==t?this._iaddn(e):this.length===1&&this.words[0]<e?(this.words[0]=e-this.words[0],this.negative^=1):this._isubn(e),this}sub(e){return this.clone().isub(e)}subn(e){return this.clone().isubn(e)}_mul(e,t){if(U(D.isBN(e),"num","bignum"),U(D.isBN(t),"out","bignum"),this.length===10&&e.length===10)return Hh(this,e,t);let i=this.length+e.length;return i<63?Oh(this,e,t):i<1024?Uh(this,e,t):im(this,e,t)}imul(e){return this.mul(e)._move(this)}imuln(e){U(Ze(e),"num","smi");let t=e<0|0;t&&(e=-e);let i=0;for(let n=0;n<this.length;n++){let s=this.words[n]*e,f=(s&67108863)+(i&67108863);i>>=26,i+=s/67108864|0,i+=f>>>26,this.words[n]=f&67108863}return this.negative^=t,i!==0?(this._alloc(this.length+1),this.words[this.length++]=i):this._strip(),this}mul(e){U(D.isBN(e),"num","bignum");let t=this.length+e.length,i=new D;i.words=new Array(t);for(let n=0;n<t;n++)i.words[n]=0;return this._mul(e,i)}muln(e){return this.clone().imuln(e)}mulShift(e,t){U(D.isBN(e),"num","bignum"),U(t>>>0===t,"bits","uint32");let i=this.mul(e),n=i.utestn(t-1);return i.iushrn(t),this.negative^e.negative?i.isubn(n):i.iaddn(n)}_div(e,t){U(D.isBN(e),"num","bignum"),Rt((t&Pt.ALL)===t),Rt(t!==Pt.NONE);let i=this,n=e;if(If(!n.isZero()),i.isZero())return[new D(0),new D(0)];let s=i.negative,f=n.negative;i.negative=0,n.negative=0;let a=null,o=null;return i.ucmp(n)<0?(t&Pt.QUO&&(a=new D(0)),t&Pt.REM&&(o=i.clone())):n.length===1?(t&Pt.QUO&&(a=i.quon(n.words[0])),t&Pt.REM&&(o=i.remn(n.words[0]))):[a,o]=i._wordDiv(n,t),i.negative=s,n.negative=f,t&Pt.QUO&&(a.negative=i.negative^n.negative,a._normalize()),t&Pt.REM&&(o.negative=i.negative,o._normalize()),t&Pt.EUCLID&&(t&Pt.QUO&&(Rt((t&Pt.REM)!=0),o.negative!==0&&(n.negative!==0?a.iaddn(1):a.isubn(1))),t&Pt.REM&&o.negative!==0&&(n.negative!==0?o.isub(n):o.iadd(n))),[a,o]}_wordDiv(e,t){let i=this.clone(),n=e,s=null,f,a=n.words[n.length-1]|0,o=26-g0(a);o!==0?(n=n.clone(),i.iushln(o),n.iushln(o),f=n.words[n.length-1]|0):f=a;let c=i.length-n.length;if(Rt(c>=0),t&Pt.QUO){s=new D(0),s.length=c+1,s.words=new Array(s.length);for(let u=0;u<s.length;u++)s.words[u]=0}let d=i.clone();d._ishlnsubmul(n,1,c),d.negative===0&&(s&&(s.words[c]=1),i=d);for(let u=c-1;u>=0;u--){let p=i.words[n.length+u],x=i.words[n.length+u-1],y=(p*67108864+x)/f|0,g=Math.min(y,67108863);for(i._ishlnsubmul(n,g,u);i.negative!==0;)g-=1,i.negative=0,i._ishlnsubmul(n,1,u),i.ineg();s&&(s.words[u]=g)}return s&&s._strip(),t&Pt.REM&&o!==0&&i.iushrn(o),[s,i]}_ishlnsubmul(e,t,i){let n=0,s=0;for(this._expand(e.length+i);s<e.length;s++){let f=(this.words[s+i]|0)+n,a=e.words[s]*t,o=f-(a&67108863);n=(o>>26)-(a/67108864|0),this.words[s+i]=o&67108863}for(;s<this.length-i;s++){let f=(this.words[s+i]|0)+n;n=f>>26,this.words[s+i]=f&67108863}if(n===0)return this._strip();Rt(n===-1),n=0;for(let f=0;f<this.length;f++){let a=-(this.words[f]|0)+n;n=a>>26,this.words[f]=a&67108863}return this.negative=1,this._strip()}quorem(e){return this._div(e,Pt.BOTH)}iquo(e){return this.quo(e)._move(this)}iquon(e){U(Ze(e),"num","smi"),If(e!==0);let t=e<0|0;t&&(e=-e);let i=0;for(let n=this.length-1;n>=0;n--){let s=(this.words[n]|0)+i*67108864;this.words[n]=s/e|0,i=s%e}return this.negative^=t,this._strip()}quo(e){return this._div(e,Pt.QUO)[0]}quon(e){return this.clone().iquon(e)}irem(e){return this.rem(e)._move(this)}iremn(e){let t=this.remrn(e);return t<0&&(t=-t),this.words[0]=t,this.length=1,this._normalize()}rem(e){return this._div(e,Pt.REM)[1]}remn(e){return this.clone().iremn(e)}remrn(e){U(Ze(e),"num","smi"),If(e!==0),e<0&&(e=-e);let t=(1<<26)%e,i=0;for(let n=this.length-1;n>=0;n--)i=(t*i+(this.words[n]|0))%e;return this.negative!==0?-i|0:i}divmod(e){return this._div(e,Pt.BOTH|Pt.EUCLID)}idiv(e){return this.div(e)._move(this)}idivn(e){if(this.negative===0)return this.iquon(e);let t=this.remrn(e);return this.iquon(e),t<0&&(e<0?this.iaddn(1):this.isubn(1)),this}div(e){return this._div(e,Pt.BOTH|Pt.EUCLID)[0]}divn(e){return this.clone().idivn(e)}imod(e){return this.ucmp(e)<0?(this.negative!==0&&(this._isub(e,this),this.negative=0),this):this.mod(e)._move(this)}imodn(e){return this.words[0]=this.modrn(e),this.length=1,this.negative=0,this}mod(e){return this._div(e,Pt.REM|Pt.EUCLID)[1]}modn(e){return this.clone().imodn(e)}modrn(e){U(Ze(e),"num","smi");let t=this.remrn(e);return t<0&&(e<0?t-=e:t+=e),t}divRound(e){let[t,i]=this.quorem(e);if(i.isZero())return t;let n=e.words[0]&1;e.iushrn(1);let s=i.ucmp(e);return e.iushln(1),e.words[0]|=n,s<0||e.isOdd()&&s===0?t:this.negative^e.negative?t.isubn(1):t.iaddn(1)}ipow(e){return this.pow(e)._move(this)}ipown(e){return this.pown(e)._move(this)}pow(e){U(D.isBN(e),"num","bignum");let t=g0(e.words[e.length-1]),i=new D(1);for(let n=e.length-1;n>=0;n--){let s=e.words[n];for(let f=t-1;f>=0;f--)i=i.sqr(),s>>f&1&&(i=i.mul(this));t=26}return i}pown(e){if(U(Ze(e),"num","smi"),e<0&&(e=-e),e===0)return new D(1);if(e===1)return this.clone();let t=g0(e),i=this;for(let n=t-2;n>=0;n--)i=i.sqr(),e>>n&1&&(i=i.mul(this));return i}isqr(){return this.imul(this)}sqr(){return this.mul(this)}_rootrem(e,t){if(U(e>>>0===e,"num","uint32"),e===0)throw new RangeError("Zeroth root.");if(~e&this.negative)throw new RangeError("Negative with even root.");if(this.ucmpn(1)<=0)return[this.clone(),new D(0)];let i=new D(0),n=D.shift(1,this.bitLength()/e+1|0),s,f;if(this.negative!==0&&n.ineg(),e===2)do i=n,n=this.quo(i),n.iadd(i),n.iushrn(1);while(n.ucmp(i)<0);else do i=n,n=i.pown(e-1),n=this.quo(n),s=i.muln(e-1),n.iadd(s),n=n.quon(e);while(n.ucmp(i)<0);return t&&(n=i.pown(e),f=this.sub(n)),[i,f]}rootrem(e){return this._rootrem(e,1)}iroot(e){return this.root(e)._move(this)}root(e){return this._rootrem(e,0)[0]}isPower(e){if(U(e>>>0===e,"num","uint32"),e===0||~e&this.negative)return!1;let[,t]=this.rootrem(e);return t.sign()===0}sqrtrem(){return this.rootrem(2)}isqrt(){return this.sqrt()._move(this)}sqrt(){return this.root(2)}isSquare(){return this.isPower(2)}iand(e){U(D.isBN(e),"num","bignum");let t=this,i=e;if(t===i)return t;if((t.negative|i.negative)==0)return t.iuand(i);if((t.negative&i.negative)==1)return t.iaddn(1),i.iaddn(1),t.iuor(i),t.isubn(1),i.isubn(1),t;t.negative!==0&&([t,i]=[i.clone(),t]);let n=t.bitLength();return i.iaddn(1),i.inotn(n),t.iuand(i),i.inotn(n),i.isubn(1),t._move(this)}iandn(e){return U(Ze(e),"num","smi"),(this.negative|e<0)!=0?this.iand(new D(e)):(this.words[0]&=e,this.length=1,this)}and(e){return this.clone().iand(e)}andn(e){return this.clone().iandn(e)}andrn(e){if(U(Ze(e),"num","smi"),(this.negative|e<0)!=0){let t=this.iand(new D(e));if(t.length>1)throw new RangeError("Number exceeds 26 bits.");return t.negative!==0?-t.words[0]:t.words[0]}return this.words[0]&e}iuand(e){U(D.isBN(e),"num","bignum"),this.length=Math.min(this.length,e.length);for(let t=0;t<this.length;t++)this.words[t]&=e.words[t];return this._strip()}iuandn(e){return U(Ze(e),"num","smi"),this.words[0]&=Math.abs(e),this.length=1,this._normalize()}uand(e){return this.clone().iuand(e)}uandn(e){return this.clone().iuandn(e)}uandrn(e){U(Ze(e),"num","smi");let t=this.words[0]&Math.abs(e);return this.negative!==0?-t|0:t}ior(e){U(D.isBN(e),"num","bignum");let t=this,i=e;return t===i?t:(t.negative|i.negative)==0?t.iuor(i):(t.negative&i.negative)==1?(t.iaddn(1),i.iaddn(1),t.iuand(i),t.isubn(1),i.isubn(1),t):(i=i.clone(),t.negative!==0&&([t,i]=[i,t]),i.iaddn(1),t.inotn(i.bitLength()),i.iuand(t),i.isubn(1),i._move(this))}iorn(e){return U(Ze(e),"num","smi"),(this.negative|e<0)!=0?this.ior(new D(e)):(this.words[0]|=e,this)}or(e){return this.clone().ior(e)}orn(e){return this.clone().iorn(e)}iuor(e){U(D.isBN(e),"num","bignum"),this._expand(e.length);for(let t=0;t<e.length;t++)this.words[t]|=e.words[t];return this}iuorn(e){return U(Ze(e),"num","smi"),this.words[0]|=Math.abs(e),this}uor(e){return this.clone().iuor(e)}uorn(e){return this.clone().iuorn(e)}ixor(e){U(D.isBN(e),"num","bignum");let t=this,i=e;return t===i?(t.words[0]=0,t.length=1,t.negative=0,t):(t.negative|i.negative)==0?t.iuxor(i):(t.negative&i.negative)==1?(t.iaddn(1),i.iaddn(1),t.iuxor(i),t.ineg(),i.isubn(1),t):(t.negative!==0&&([t,i]=[i.clone(),t]),i.iaddn(1),t.iuxor(i),t.iaddn(1),t.ineg(),i.isubn(1),t._move(this))}ixorn(e){return U(Ze(e),"num","smi"),(this.negative|e<0)!=0?this.ixor(new D(e)):(this.words[0]^=e,this)}xor(e){return this.clone().ixor(e)}xorn(e){return this.clone().ixorn(e)}iuxor(e){U(D.isBN(e),"num","bignum");let t=this,i=e;t.length<i.length&&([t,i]=[i,t]);let n=0;for(;n<i.length;n++)this.words[n]=t.words[n]^i.words[n];if(t!==this)for(this._alloc(t.length);n<t.length;n++)this.words[n]=t.words[n];return this.length=t.length,this._strip()}iuxorn(e){return U(Ze(e),"num","smi"),this.words[0]^=Math.abs(e),this._normalize()}uxor(e){return this.clone().iuxor(e)}uxorn(e){return this.clone().iuxorn(e)}inot(){return this.negative!==0?this.ineg().isubn(1):this.iaddn(1).ineg(),this}not(){return this.clone().inot()}inotn(e){U(e>>>0===e,"width","uint32");let t=e%26,i=Math.ceil(e/26),n=0;for(this._expand(i),t>0&&(i-=1);n<i;n++)this.words[n]^=67108863;return t>0&&(this.words[n]^=(1<<t)-1),this._strip()}notn(e){return this.clone().inotn(e)}ishl(e){return U(D.isBN(e),"bits","bignum"),U(e.bitLength()<=32,"bits","uint32"),this.ishln(e.toNumber())}ishln(e){return this.iushln(e)}shl(e){return this.clone().ishl(e)}shln(e){return this.clone().ishln(e)}iushl(e){return U(D.isBN(e),"bits","bignum"),U(e.bitLength()<=32,"bits","uint32"),this.iushln(e.toNumber())}iushln(e){U(e>>>0===e,"bits","uint32");let t=e%26,i=(e-t)/26,n=(1<<t)-1<<26-t;if(t!==0){let s=0;for(let f=0;f<this.length;f++){let a=this.words[f]&n,o=(this.words[f]|0)-a<<t;this.words[f]=o|s,s=a>>>26-t}s!==0&&(this._alloc(this.length+1),this.words[this.length++]=s)}if(i!==0){this._alloc(this.length+i);for(let s=this.length-1;s>=0;s--)this.words[s+i]=this.words[s];for(let s=0;s<i;s++)this.words[s]=0;this.length+=i}return this._strip()}ushl(e){return this.clone().iushl(e)}ushln(e){return this.clone().iushln(e)}_split(e,t){let i=e%26,n=Math.min((e-i)/26,this.length),s=(1<<i)-1;if(t){t._alloc(n);for(let a=0;a<n;a++)t.words[a]=this.words[a];t.length=n}if(n!==0)if(this.length>n){this.length-=n;for(let a=0;a<this.length;a++)this.words[a]=this.words[a+n]}else this.words[0]=0,this.length=1;let f=0;if(i!==0)for(let a=this.length-1;a>=0;a--){let o=this.words[a]|0;this.words[a]=f<<26-i|o>>>i,f=o&s}return t&&(f!==0?(t._alloc(t.length+1),t.words[t.length++]=f):(t.length===0&&(t.words[t.length++]=0),t._strip())),this._strip()}ishr(e){return U(D.isBN(e),"bits","bignum"),U(e.bitLength()<=32,"bits","uint32"),this.ishrn(e.toNumber())}ishrn(e){return U(e>>>0===e,"bits","uint32"),this.negative!==0?(this.iaddn(1),this.iushrn(e),this.isubn(1),this):this.iushrn(e)}shr(e){return this.clone().ishr(e)}shrn(e){return this.clone().ishrn(e)}iushr(e){return U(D.isBN(e),"bits","bignum"),U(e.bitLength()<=32,"bits","uint32"),this.iushrn(e.toNumber())}iushrn(e){return U(e>>>0===e,"bits","uint32"),this._split(e,null)}ushr(e){return this.clone().iushr(e)}ushrn(e){return this.clone().iushrn(e)}setn(e,t){return U(e>>>0===e,"bit","uint32"),this.negative!==0?(this.iaddn(1),this.usetn(e,!t),this.isubn(1),this):this.usetn(e,t)}usetn(e,t){U(e>>>0===e,"bit","uint32");let i=e%26,n=(e-i)/26;return this._expand(n+1),t?this.words[n]|=1<<i:this.words[n]&=~(1<<i),this._strip()}testn(e){U(e>>>0===e,"bit","uint32");let t=e%26,i=(e-t)/26;if(this.length<=i)return this.negative;let n=this.words[i],s=n>>t&1;if(this.negative!==0){if(t>0&&n&(1<<t)-1)return s^1;let f=i;for(;f--;)if(this.words[f]>0)return s^1}return s}utestn(e){U(e>>>0===e,"bit","uint32");let t=e%26,i=(e-t)/26;return this.length<=i?0:this.words[i]>>t&1}imaskn(e){return U(e>>>0===e,"bits","uint32"),this.negative!==0&&(this.iaddn(1),this.inotn(e+1),this.ineg()),this.iumaskn(e)}maskn(e){return this.clone().imaskn(e)}iumaskn(e){U(e>>>0===e,"bits","uint32");let t=e%26,i=(e-t)/26;return this.length<=i?this:(t!==0&&(i+=1),this.length=Math.min(i,this.length),t!==0&&(this.words[this.length-1]&=(1<<t)-1),this.length===0&&(this.words[this.length++]=0),this._strip())}umaskn(e){return this.clone().iumaskn(e)}andln(e){return this.words[0]&e}bit(e){return this.utestn(e)}bits(e,t){U(e>>>0===e,"pos","uint32"),U(t>>>0===t,"width","uint32"),U(t<=26,"width","width");let i=e%26,n=(e-i)/26;if(n>=this.length)return 0;let s=this.words[n]>>i&(1<<t)-1;if(i+t>26&&n+1<this.length){let f=i+t-26;s|=(this.words[n+1]&(1<<f)-1)<<26-i}return s}ineg(){return this.isZero()||(this.negative^=1),this}neg(){return this.clone().ineg()}iabs(){return this.negative=0,this}abs(){return this.clone().iabs()}cmp(e){if(U(D.isBN(e),"num","bignum"),this.negative!==e.negative)return e.negative-this.negative;let t=this.ucmp(e);return this.negative!==0?-t|0:t}cmpn(e){U(Ze(e),"num","smi");let t=e<0|0;if(this.negative!==t)return t-this.negative;let i=this.ucmpn(e);return this.negative!==0?-i|0:i}eq(e){return this.cmp(e)===0}eqn(e){return this.cmpn(e)===0}gt(e){return this.cmp(e)>0}gtn(e){return this.cmpn(e)>0}gte(e){return this.cmp(e)>=0}gten(e){return this.cmpn(e)>=0}lt(e){return this.cmp(e)<0}ltn(e){return this.cmpn(e)<0}lte(e){return this.cmp(e)<=0}lten(e){return this.cmpn(e)<=0}sign(){return this.negative!==0?-1:this.length===1&&this.words[0]===0?0:1}isZero(){return this.length===1&&this.words[0]===0}isNeg(){return this.negative!==0}isPos(){return this.negative===0}isOdd(){return(this.words[0]&1)==1}isEven(){return(this.words[0]&1)==0}ucmp(e){if(U(D.isBN(e),"num","bignum"),this.length<e.length)return-1;if(this.length>e.length)return 1;for(let t=this.length-1;t>=0;t--){let i=this.words[t]|0,n=e.words[t]|0;if(i!==n)return(i>n)-(i<n)}return 0}ucmpn(e){if(U(Ze(e),"num","smi"),this.length>1)return 1;let t=this.words[0]|0;return e<0&&(e=-e),(t>e)-(t<e)}legendre(e){let t=Cn?D.red(e):D.mont(e);return this.toRed(t).redLegendre()}jacobi(e){if(U(D.isBN(e),"num","bignum"),e.isZero()||e.isEven())throw new Error("jacobi: `num` must be odd.");let t=this._cloneNormal(),i=e.clone(),n=1;for(i.isNeg()&&(t.isNeg()&&(n=-1),i.ineg()),(t.isNeg()||t.ucmp(i)>=0)&&t.imod(i);!t.isZero();){if(t._makeOdd()&1){let a=i.andln(7);(a===3||a===5)&&(n=-n)}t.ucmp(i)<0&&([t,i]=[i,t],t.andln(3)===3&&i.andln(3)===3&&(n=-n)),t._isub(t,i).iushrn(1);let f=i.andln(7);(f===3||f===5)&&(n=-n)}return i.cmpn(1)!==0?0:n}kronecker(e){U(D.isBN(e),"num","bignum");let t=[0,1,0,-1,0,-1,0,1],i=this._cloneNormal(),n=e.clone(),s=1;if(n.isZero())return i.ucmpn(1)===0?s:0;if(!i.isOdd()&&!n.isOdd())return 0;for(n._makeOdd()&1&&(s=t[i.andln(7)]),n.isNeg()&&(i.isNeg()&&(s=-s),n.ineg());!i.isZero();)i._makeOdd()&1&&(s*=t[n.andln(7)]),(i.words[0]^i.negative*67108863)&n.words[0]&2&&(s=-s),n.imod(i),[i,n]=[n,i],n.negative=0;return n.cmpn(1)!==0?0:s}igcd(e){return this.gcd(e)._move(this)}gcd(e){if(U(D.isBN(e),"num","bignum"),this.isZero())return e.abs();if(e.isZero())return this.abs();let t=this.clone(),i=e.clone();t.negative=0,i.negative=0;let n=t._factor2(i);for(n!==0&&(t.iushrn(n),i.iushrn(n));;){t._makeOdd(),i._makeOdd();let s=t.ucmp(i);if(s<0)[t,i]=[i,t];else if(s===0||i.ucmpn(1)===0)break;t._isub(t,i)}return i.iushln(n)}ilcm(e){return this.lcm(e)._move(this)}lcm(e){return U(D.isBN(e),"num","bignum"),this.isZero()||e.isZero()?new D(0):this.quo(this.gcd(e)).mul(e).iabs()}egcd(e){if(U(D.isBN(e),"num","bignum"),this.isZero())return[new D(0),new D(e.sign()),e.abs()];if(e.isZero())return[new D(this.sign()),new D(0),this.abs()];let t=this.clone(),i=e.clone();t.negative=0,i.negative=0;let n=new D(1),s=new D(0),f=new D(0),a=new D(1),o=t._factor2(i);o>0&&(t.iushrn(o),i.iushrn(o));let c=t.clone(),d=i.clone();for(;!t.isZero();){let u=t._makeOdd(),p=i._makeOdd();for(;u--;)(n.isOdd()||s.isOdd())&&(n.iadd(d),s.isub(c)),n.iushrn(1),s.iushrn(1);for(;p--;)(f.isOdd()||a.isOdd())&&(f.iadd(d),a.isub(c)),f.iushrn(1),a.iushrn(1);t.cmp(i)>=0?(t.isub(i),n.isub(f),s.isub(a)):(i.isub(t),f.isub(n),a.isub(s))}return this.negative!==0&&f.ineg(),e.negative!==0&&a.ineg(),[f,a,i.iushln(o)]}iinvert(e){return this.invert(e)._move(this)}invert(e){if(U(D.isBN(e),"num","bignum"),ai(e.sign()>0,"invert"),e.isOdd())return this._invertp(e);if(e.cmpn(1)===0)throw new RangeError("Not invertible.");let[t,,i]=this.egcd(e);if(i.cmpn(1)!==0)throw new RangeError("Not invertible.");return t.imod(e)}ifermat(e){return this.fermat(e)._move(this)}fermat(e){let t=Cn?D.red(e):D.mont(e);return this.toRed(t).redFermat().fromRed()}ipowm(e,t,i){return this.powm(e,t,i)._move(this)}powm(e,t,i){let n=!Cn&&i?D.mont(t):D.red(t);return this.toRed(n).redPow(e).fromRed()}ipowmn(e,t,i){return this.powmn(e,t,i)._move(this)}powmn(e,t,i){let n=i?D.mont(t):D.red(t);return this.toRed(n).redPown(e).fromRed()}isqrtm(e){return this.sqrtm(e)._move(this)}sqrtm(e){U(D.isBN(e),"p","bignum");let t;return e.andln(3)===3||e.andln(7)===5?t=D.red(e):t=D.mont(e),this.toRed(t).redSqrt().fromRed()}isqrtpq(e,t){return this.sqrtpq(e,t)._move(this)}sqrtpq(e,t){let i=this.sqrtm(e),n=this.sqrtm(t),[s,f]=e.egcd(t),a=n.mul(s).mul(e),o=i.mul(f).mul(t),c=e.mul(t);return a.iadd(o).imod(c)}isPrime(e,t,i){return U(t>>>0===t,"reps","uint32"),!(!this.isPrimeMR(e,t+1,!0)||!this.isPrimeLucas(i))}isPrimeMR(e,t,i=!1){U(t>>>0===t,"reps","uint32"),U(t>0,"reps","integer"),U(typeof i=="boolean","force2","boolean");let n=this;if(n.cmpn(7)<0)return n.cmpn(2)===0||n.cmpn(3)===0||n.cmpn(5)===0;if(n.isEven())return!1;let s=n.subn(1),f=s.subn(2),a=s.zeroBits(),o=s.ushrn(a),c=D.red(n),d=s.toRed(c),u=new D(1).toRed(c);e:for(let p=0;p<t;p++){let x;p===t-1&&i?x=new D(2):(x=D.random(e,0,f),x.iaddn(2));let y=x.toRed(c).redPow(o);if(!(y.cmp(u)===0||y.cmp(d)===0)){for(let g=1;g<a;g++){if(y=y.redSqr(),y.cmp(d)===0)continue e;if(y.cmp(u)===0)return!1}return!1}}return!0}isPrimeLucas(e=0){U(e>>>0===e,"limit","uint32");let t=this;if(t.cmpn(1)<=0)return!1;if(t.isEven())return t.cmpn(2)===0;let i=3;for(;;){if(i>1e4)throw new Error(`Cannot find (D/n) = -1 for ${t.toString(10)}.`);if(e!==0&&i>e)return!1;let c=new D(i*i-4).jacobi(t);if(c===-1)break;if(c===0)return t.cmpn(i+2)===0;if(i===40&&t.isSquare())return!1;i+=1}let n=t.addn(1),s=n._makeOdd(),f=new D(2),a=new D(i);for(let o=n.bitLength();o>=0;o--)n.utestn(o)?(f=f.mul(a).isubn(i).imod(t),a=a.sqr().isubn(2).imod(t)):(a=a.mul(f).isubn(i).imod(t),f=f.sqr().isubn(2).imod(t));if(f.cmpn(2)===0||f.cmp(t.subn(2))===0){let o=f.muln(i).imod(t),c=a.ushln(1).imod(t);if(o.cmp(c)===0)return!0}for(let o=0;o<s-1;o++){if(f.isZero())return!0;if(f.cmpn(2)===0)return!1;f=f.sqr().isubn(2).imod(t)}return!1}toTwos(e){return this.negative!==0?this.abs().inotn(e).iaddn(1):this.clone()}fromTwos(e){return U(e>>>0===e,"width","uint32"),ai(e>0,"width"),this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()}toRed(e){if(U(e instanceof Tn,"ctx","reduction context"),this.red)throw new Error("Already in reduction context.");return e.convertTo(this)}fromRed(){return he(this.red,"fromRed"),this.red.convertFrom(this)}forceRed(e){if(U(e instanceof Tn,"ctx","reduction context"),this.red){if(!e.m.eq(this.red.m)||e.mont!==this.red.mont)throw new Error("Already in reduction context.")}else ai(this.negative===0,"red"),ai(this.ucmp(e.m)<0,"red");return this.clone()._forceRed(e)}redIAdd(e){return U(D.isBN(e),"num","bignum"),he(this.red,"redIAdd"),this.red.iadd(this,e)}redAdd(e){return U(D.isBN(e),"num","bignum"),he(this.red,"redAdd"),this.red.add(this,e)}redIAddn(e){return U(Ze(e),"num","smi"),he(this.red,"redIAddn"),this.red.iaddn(this,e)}redAddn(e){return U(Ze(e),"num","smi"),he(this.red,"redAddn"),this.red.addn(this,e)}redISub(e){return U(D.isBN(e),"num","bignum"),he(this.red,"redISub"),this.red.isub(this,e)}redSub(e){return U(D.isBN(e),"num","bignum"),he(this.red,"redSub"),this.red.sub(this,e)}redISubn(e){return U(Ze(e),"num","smi"),he(this.red,"redISubn"),this.red.isubn(this,e)}redSubn(e){return U(Ze(e),"num","smi"),he(this.red,"redSubn"),this.red.subn(this,e)}redIMul(e){return U(D.isBN(e),"num","bignum"),he(this.red,"redIMul"),this.red.imul(this,e)}redMul(e){return U(D.isBN(e),"num","bignum"),he(this.red,"redMul"),this.red.mul(this,e)}redIMuln(e){return U(Ze(e),"num","smi"),he(this.red,"redIMuln"),this.red.imuln(this,e)}redMuln(e){return U(Ze(e),"num","smi"),he(this.red,"redMuln"),this.red.muln(this,e)}redIDiv(e){return U(D.isBN(e),"num","bignum"),he(this.red,"redIDiv"),this.red.idiv(this,e)}redDiv(e){return U(D.isBN(e),"num","bignum"),he(this.red,"redDiv"),this.red.div(this,e)}redIDivn(e){return U(Ze(e),"num","smi"),he(this.red,"redIDivn"),this.red.idivn(this,e)}redDivn(e){return U(Ze(e),"num","smi"),he(this.red,"redDivn"),this.red.divn(this,e)}redIPow(e){return U(D.isBN(e),"num","bignum"),he(this.red,"redIPow"),Nn(!e.red,"redIPow"),this.red.ipow(this,e)}redPow(e){return U(D.isBN(e),"num","bignum"),he(this.red,"redPow"),Nn(!e.red,"redPow"),this.red.pow(this,e)}redIPown(e){return U(Ze(e),"num","smi"),he(this.red,"redIPown"),this.red.ipown(this,e)}redPown(e){return U(Ze(e),"num","smi"),he(this.red,"redPown"),this.red.pown(this,e)}redISqr(){return he(this.red,"redISqr"),this.red.isqr(this)}redSqr(){return he(this.red,"redSqr"),this.red.sqr(this)}redISqrt(){return he(this.red,"redISqrt"),this.red.isqrt(this)}redSqrt(){return he(this.red,"redSqrt"),this.red.sqrt(this)}redIDivSqrt(e){return he(this.red,"redIDivSqrt"),this.red.idivsqrt(this,e)}redDivSqrt(e){return he(this.red,"redDivSqrt"),this.red.divsqrt(this,e)}redIsSquare(){return he(this.red,"redIsSquare"),this.red.isSquare(this)}redIShl(e){return U(D.isBN(e),"num","bignum"),he(this.red,"redIShl"),Nn(!e.red,"redIShl"),this.red.ishl(this,e)}redShl(e){return U(D.isBN(e),"num","bignum"),he(this.red,"redShl"),Nn(!e.red,"redShl"),this.red.shl(this,e)}redIShln(e){return U(e>>>0===e,"num","uint32"),he(this.red,"redIShln"),this.red.ishln(this,e)}redShln(e){return U(e>>>0===e,"num","uint32"),he(this.red,"redShln"),this.red.shln(this,e)}redINeg(){return he(this.red,"redINeg"),this.red.ineg(this)}redNeg(){return he(this.red,"redNeg"),this.red.neg(this)}redEq(e){return U(D.isBN(e),"num","bignum"),he(this.red,"redEq"),this.red.eq(this,e)}redEqn(e){return U(Ze(e),"num","smi"),he(this.red,"redEqn"),this.red.eqn(this,e)}redIsHigh(){return he(this.red,"redIsHigh"),this.red.isHigh(this)}redIsLow(){return he(this.red,"redIsLow"),this.red.isLow(this)}redIsOdd(){return he(this.red,"redIsOdd"),this.red.isOdd(this)}redIsEven(){return he(this.red,"redIsEven"),this.red.isEven(this)}redLegendre(){return he(this.red,"redLegendre"),this.red.legendre(this)}redJacobi(){return he(this.red,"redJacobi"),this.red.jacobi(this)}redKronecker(){return he(this.red,"redKronecker"),this.red.kronecker(this)}redIInvert(){return he(this.red,"redIInvert"),this.red.iinvert(this)}redInvert(){return he(this.red,"redInvert"),this.red.invert(this)}redIFermat(){return he(this.red,"redIFermat"),this.red.ifermat(this)}redFermat(){return he(this.red,"redFermat"),this.red.fermat(this)}_move(e){return e.words=this.words,e.length=this.length,e.negative=this.negative,e.red=this.red,e}_alloc(e){for(;this.words.length<e;)this.words.push(0);return this}_expand(e){for(this._alloc(e);this.length<e;)this.words[this.length++]=0;return this}_strip(){for(;this.length>1&&this.words[this.length-1]===0;)this.length-=1;return this._normalize()}_normalize(){return Rt(this.length>0),this.length===1&&this.words[0]===0&&(this.negative=0),this}_check(){return Rt(this.length>0),Rt(this.length<=this.words.length),this.length===1?(this.words[0]===0&&Rt(this.negative===0),this):(Rt(this.words[this.length-1]!==0),this)}_invertp(e){if(U(D.isBN(e),"p","bignum"),ai(e.sign()>0,"invert"),Rt(e.isOdd()),e.cmpn(1)===0)throw new RangeError("Not invertible.");let t=this.clone(),i=e.clone(),n=new D(1),s=new D(0);for((t.isNeg()||t.ucmp(i)>=0)&&t.imod(i);!t.isZero();){let f=t._makeOdd(),a=i._makeOdd();for(;f--;)n.isOdd()&&n._iadd(n,e),n.iushrn(1);for(;a--;)s.isOdd()&&s._iadd(s,e),s.iushrn(1);t.ucmp(i)>=0?(t._isub(t,i),n.ucmp(s)<0?(n._isub(s,n),n._isub(e,n)):n._isub(n,s)):(i._isub(i,t),s.ucmp(n)<0?(s._isub(n,s),s._isub(e,s)):s._isub(s,n))}if(i.cmpn(1)!==0)throw new RangeError("Not invertible.");return Rt(s.negative===0),Rt(s.ucmp(e)<0),s}_makeOdd(){let e=this.zeroBits();return e>0&&this.iushrn(e),e}_factor2(e){if((this.words[0]|e.words[0])&1)return 0;let t=Math.min(this.length,e.length),i=0;for(let n=0;n<t;n++){let s=Fh(this.words[n]|e.words[n]);if(i+=s,s!==26)break}return i}_cloneNormal(){return this.red?this.fromRed():this.clone()}_forceRed(e){return this.red=e,this}clone(){let e=new D;e.words=new Array(this.length);for(let t=0;t<this.length;t++)e.words[t]=this.words[t];return e.length=this.length,e.negative=this.negative,e.red=this.red,e}inject(e){U(D.isBN(e),"num","bignum"),this._alloc(e.length);for(let t=0;t<e.length;t++)this.words[t]=e.words[t];return this.length=e.length,this.negative=e.negative,this.red=e.red,this}set(e,t){return this.fromNumber(e,t)}swap(e){U(D.isBN(e),"num","bignum");let t=this,i=e;return[t.words,i.words]=[i.words,t.words],[t.length,i.length]=[i.length,t.length],[t.negative,i.negative]=[i.negative,t.negative],[t.red,i.red]=[i.red,t.red],t}reverse(){let e=this.negative;return this.fromBuffer(this.toBuffer("be"),"le"),this.negative=e,this}byteLength(){return Math.ceil(this.bitLength()/8)}bitLength(){let e=this.words[this.length-1],t=g0(e);return(this.length-1)*26+t}zeroBits(){if(this.isZero()||this.isOdd())return 0;let e=0;for(let t=0;t<this.length;t++){let i=Fh(this.words[t]);if(e+=i,i!==26)break}return e}isSafe(){return this.length<=2||this.length===3&&this.words[2]===1}word(e){return U(e>>>0===e,"pos","uint32"),e>=this.length?0:this.words[e]}[_h](){let e="BN";return this.red&&(e="BN-R"),`<${e}: ${this.toString(10)}>`}toNumber(){let e=this.words[0];if(this.length===2)e+=this.words[1]*67108864;else if(this.length===3&&this.words[2]===1)e+=4503599627370496+this.words[1]*67108864;else if(this.length>2)throw new RangeError("Number can only safely store up to 53 bits.");return this.negative!==0?-e:e}toDouble(){let e=0;for(let t=this.length-1;t>=0;t--)e=e*67108864+this.words[t];return this.negative!==0?-e:e}valueOf(){return this.toDouble()}toBigInt(){if(!Cn)throw new Error("BigInt is not supported!");let e=BigInt(52),t=BigInt(26),i=this.length-1,n=BigInt(0);for(;i>=1;i-=2){let s=this.words[i]*67108864,f=this.words[i-1];n=n<<e|BigInt(s+f)}return i>=0&&(n=n<<t|BigInt(this.words[0])),this.negative!==0?-n:n}toBool(){return!this.isZero()}toString(e,t){if(e=Lh(e),t==null&&(t=0),t===0&&(t=1),U(e>>>0===e,"base","uint32"),U(t>>>0===t,"padding","uint32"),e<2||e>36)throw new RangeError("Base ranges between 2 and 36.");if(this._check(),e===16){let a="",o=0,c=0;for(let d=0;d<this.length;d++){let u=this.words[d],p=((u<<o|c)&16777215).toString(16);c=u>>>24-o&16777215,c!==0||d!==this.length-1?a=Ih[6-p.length]+p+a:a=p+a,o+=2,o>=26&&(o-=26,d-=1)}for(c!==0&&(a=c.toString(16)+a);a.length%t!=0;)a="0"+a;return this.negative!==0&&(a="-"+a),a}let i=em[e-1],n=tm[e-1],s=this.clone(),f="";for(s.negative=0;!s.isZero();){let a=s.remrn(n).toString(e);s.iquon(n),s.isZero()?f=a+f:f=Ih[i-a.length]+a+f}for(this.isZero()&&(f="0");f.length%t!=0;)f="0"+f;return this.negative!==0&&(f="-"+f),f}toJSON(){return this.toString(16,2)}toArray(e,t){return this.toArrayLike(Array,e,t)}toBuffer(e,t){return this.toArrayLike(Buffer,e,t)}toArrayLike(e,t,i){t==null&&(t="be"),i==null&&(i=0),U(typeof e=="function","ArrayType","function"),U(t==="be"||t==="le","endian","endianness"),U(i>>>0===i,"length","uint32"),this._check();let n=this.byteLength(),s=i||Math.max(1,n);if(n>s)throw new RangeError("Byte array longer than desired length.");let f=rm(e,s);if(t==="be"){let a=f.length-1,o=0;for(let c=0;c<this.length;c++){let d=(c&3)<<1,u=this.words[c]<<d|o;f[a--]=u&255,a>=0&&(f[a--]=u>>>8&255),a>=0&&(f[a--]=u>>>16&255),d===6?(a>=0&&(f[a--]=u>>>24&255),o=0):o=u>>>24}if(a>=0){for(f[a--]=o;a>=0;)f[a--]=0;o=0}Rt(o===0)}else{let a=0,o=0;for(let c=0;c<this.length;c++){let d=(c&3)<<1,u=this.words[c]<<d|o;f[a++]=u&255,a<f.length&&(f[a++]=u>>>8&255),a<f.length&&(f[a++]=u>>>16&255),d===6?(a<f.length&&(f[a++]=u>>>24&255),o=0):o=u>>>24}if(a<f.length){for(f[a++]=o;a<f.length;)f[a++]=0;o=0}Rt(o===0)}return f}encode(e,t){return this.toBuffer(e,t)}of(e,t){return this.fromNumber(e,t)}fromNumber(e,t){t==null&&(t="be"),U(Kh(e),"num","integer"),U(t==="be"||t==="le","endian","endianness");let i=e<0|0;return i&&(e=-e),e<67108864?(this.words[0]=e&67108863,this.length=1):e<4503599627370496?(this.words=[e&67108863,e/67108864&67108863],this.length=2):(this.words=[e&67108863,e/67108864&67108863,1],this.length=3),this.negative=i,t==="le"&&this.reverse(),this}fromDouble(e,t){t==null&&(t="be"),U(typeof e=="number","num","double"),U(t==="be"||t==="le","endian","endianness"),isFinite(e)||(e=0);let i=e<=-1|0;for(e<0&&(e=-e),e=Math.floor(e),this.words=[];e>0;){let n=e%67108864,s=(e-n)/67108864;this.words.push(n),e=s}return this.words.length===0&&this.words.push(0),this.length=this.words.length,this.negative=i,t==="le"&&this.reverse(),this}fromBigInt(e,t){if(t==null&&(t="be"),U(typeof e=="bigint","num","bigint"),U(t==="be"||t==="le","endian","endianness"),!Cn)throw new Error("BigInt is not supported!");let i=e<BigInt(0)|0;return this._fromHex(e.toString(16),i),this.negative=i,t==="le"&&this.reverse(),this}fromBool(e){return U(typeof e=="boolean","value","boolean"),this.words[0]=e|0,this.length=1,this.negative=0,this}fromString(e,t,i){if((t==="le"||t==="be")&&([t,i]=[i,t]),t=Lh(t),i==null&&(i="be"),U(typeof e=="string","string","string"),U(t>>>0===t,"base","uint32"),U(i==="be"||i==="le","endian","endianness"),t<2||t>36)throw new Error("Base ranges between 2 and 36.");e=e.replace(/\s+/g,"");let n=0;return e.length>0&&e.charCodeAt(0)===45&&(n=1),t===16?this._fromHex(e,n):this._fromBase(e,t,n),this.negative=n,this._normalize(),i==="le"&&this.reverse(),this}_fromHex(e,t){this.length=Math.max(2,Math.ceil((e.length-t)/6)),this.words=new Array(this.length);for(let f=0;f<this.length;f++)this.words[f]=0;let i=0,n=e.length-6,s=0;for(;n>=t;n-=6){let f=Dh(e,n,n+6);this.words[s]|=f<<i&67108863,this.words[s+1]|=f>>>26-i&4194303,i+=24,i>=26&&(i-=26,s+=1)}if(n+6!==t){let f=Dh(e,t,n+6);this.words[s]|=f<<i&67108863,this.words[s+1]|=f>>>26-i&4194303}return this._strip()}_fromBase(e,t,i){this.words[0]=0,this.length=1,this.negative=0;let n=0,s=1;for(;s<=67108863;s*=t)n+=1;n-=1,s=s/t|0;let f=e.length-i,a=f%n,o=Math.min(f,f-a)+i,c=i;for(;c<o;c+=n){let d=zh(e,c,c+n,t);this.imuln(s),this._iaddn(d)}if(a!==0){let d=Math.pow(t,a),u=zh(e,c,e.length,t);this.imuln(d),this._iaddn(u)}return this}fromJSON(e){if(D.isBN(e))return e.red?e.fromRed():e.clone();if(Array.isArray(e)){for(let t of e)U(typeof t=="string","chunk","string");e=e.join("")}return this.fromString(e,16)}fromBN(e){return this.inject(e)}fromArray(e,t){return U(Array.isArray(e),"data","array"),this.fromArrayLike(e,t)}fromBuffer(e,t){return U(Buffer.isBuffer(e),"data","buffer"),this.fromArrayLike(e,t)}fromArrayLike(e,t){if(t==null&&(t="be"),U(e&&e.length>>>0===e.length,"data","array-like"),U(t==="be"||t==="le","endian","endianness"),e.length===0)return this.words[0]=0,this.length=1,this.negative=0,this;this.length=Math.max(2,Math.ceil(e.length/3)),this.words=new Array(this.length),this.negative=0;for(let a=0;a<this.length;a++)this.words[a]=0;let i=e.length%3,n=0,s=0,f=0;if(t==="be"){for(let a=e.length-1;a>=2;a-=3){let o=e[a]|e[a-1]<<8|e[a-2]<<16;this.words[s]|=o<<n&67108863,this.words[s+1]=o>>>26-n&67108863,n+=24,n>=26&&(n-=26,s+=1)}switch(i){case 2:f=e[1]|e[0]<<8;break;case 1:f=e[0];break}}else{let a=e.length-i;for(let o=0;o<a;o+=3){let c=e[o]|e[o+1]<<8|e[o+2]<<16;this.words[s]|=c<<n&67108863,this.words[s+1]=c>>>26-n&67108863,n+=24,n>=26&&(n-=26,s+=1)}switch(i){case 2:f=e[a]|e[a+1]<<8;break;case 1:f=e[a];break}}return i>0&&(this.words[s]|=f<<n&67108863,this.words[s+1]=f>>>26-n&67108863),this._strip()}decode(e,t){return this.fromBuffer(e,t)}from(e,t,i){if(e==null)return this;if((t==="le"||t==="be")&&([t,i]=[i,t]),typeof e=="number")return this.fromNumber(e,i);if(typeof e=="bigint")return this.fromBigInt(e,i);if(typeof e=="string")return this.fromString(e,t,i);if(typeof e=="object"){if(D.isBN(e))return this.fromBN(e,i);if(e.length>>>0===e.length)return this.fromArrayLike(e,i)}if(typeof e=="boolean")return this.fromBool(e);throw new TypeError("Non-numeric object passed to BN.")}static min(...e){let t=null;for(let i of e)U(D.isBN(i),"num","bignum"),(!t||i.cmp(t)<0)&&(t=i);return t||new D(0)}static max(...e){let t=null;for(let i of e)U(D.isBN(i),"num","bignum"),(!t||i.cmp(t)>0)&&(t=i);return t||new D(0)}static cmp(e,t){return U(D.isBN(e),"a","bignum"),e.cmp(t)}static ucmp(e,t){return U(D.isBN(e),"a","bignum"),e.ucmp(t)}static red(e){return new Tn(e)}static barrett(e){return new Ph(e)}static mont(e){return new Rh(e)}static _prime(e){if(Eo[e])return Eo[e];let t;if(e==="p192")t=new Ah;else if(e==="p224")t=new Bh;else if(e==="p521")t=new kh;else if(e==="k256")t=new qh;else if(e==="p251")t=new Ch;else if(e==="p25519")t=new Th;else if(e==="p448")t=new Nh;else throw new Error(`Unknown prime: "${e}".`);return Eo[e]=t,t}static prime(e){return D._prime(e).p.clone()}static pow(e,t){return e===2?D.shift(1,t):new D().fromNumber(e).pown(t)}static shift(e,t){return e===1?new D(0).usetn(t,1):new D().fromNumber(e).ishln(t)}static mask(e){return D.shift(1,e).isubn(1)}static randomBits(e,t){if(U(e!=null,"rng","rng"),U(t>>>0===t,"bits","uint32"),typeof e=="object"){U(typeof e.randomBytes=="function","rng","rng");let n=t+7>>>3,s=n*8,f=e.randomBytes(n);if(U(Buffer.isBuffer(f),"bytes","buffer"),f.length!==n)throw new RangeError("Invalid number of bytes returned from RNG.");let a=D.fromBuffer(f);return s>t&&a.iushrn(s-t),a}U(typeof e=="function","rng","rng");let i=e(t);if(U(D.isBN(i),"num","bignum"),ai(i.negative===0,"RNG"),Nn(!i.red,"RNG"),i.bitLength()>t)throw new RangeError("Invalid number of bits returned from RNG.");return i}static random(e,t,i){if(t=D.cast(t,16),i=D.cast(i,16),t.cmp(i)>0)throw new RangeError("Minimum cannot be greater than maximum.");let n=i.sub(t).iabs(),s=n.bitLength();if(s===0)return t.clone();for(;;){let f=D.randomBits(e,s);if(!(f.cmp(n)>=0))return f.iadd(t),f}}static of(e,t){return new D().of(e,t)}static fromNumber(e,t){return new D().fromNumber(e,t)}static fromDouble(e,t){return new D().fromDouble(e,t)}static fromBigInt(e,t){return new D().fromBigInt(e,t)}static fromBool(e){return new D().fromBool(e)}static fromString(e,t,i){return new D().fromString(e,t,i)}static fromJSON(e){return new D().fromJSON(e)}static fromBN(e){return new D().fromBN(e)}static fromArray(e,t){return new D().fromArray(e,t)}static fromBuffer(e,t){return new D().fromBuffer(e,t)}static fromArrayLike(e,t){return new D().fromArrayLike(e,t)}static decode(e,t){return new D().decode(e,t)}static from(e,t,i){return new D().from(e,t,i)}static cast(e,t,i){return D.isBN(e)?e:new D(e,t,i)}static isBN(e){return e instanceof D}};D.BN=D;D.wordSize=26;D.native=0;var Af=class{constructor(e,t){this.name=e,this.p=new D(t,16),this.n=this.p.bitLength(),this.k=D.shift(1,this.n).isub(this.p),this.lo=this.p.clone(),this.one=this.p.clone()}ireduce(e){let t=e.negative!==0,i=e.bitLength();for(Rt(i<=this.n*2),e.negative=0;i>this.n;)this.split(e,this.lo),this.imulK(e),e._iadd(e,this.lo),i=e.bitLength();let n=i<this.n?-1:e.ucmp(this.p);return n===0?(e.words[0]=0,e.length=1):n>0&&e._isub(e,this.p),t&&!e.isZero()&&e._isub(this.p,e),e}split(e,t){e._split(this.n,t)}imulK(e){return e.imul(this.k)}pm2(e){throw new Error("Not implemented.")}fermat(e){return this.pm2(e)}},w0=class extends Af{constructor(e,t){super(e,t)}pm3d4(e){throw new Error("Not implemented.")}pp1d4(e){throw new Error("Not implemented.")}sqrt(e){let{red:t}=e,i=this.pp1d4(e);if(!t.sqr(i).eq(e))throw new Gt(i);return i}divsqrt(e,t){let{red:i}=e,n=i.sqr(e),s=i.mul(n,e),f=i.mul(s,n),a=i.mul(i.sqr(t),t),o=this.pm3d4(i.mul(f,a)),c=i.mul(i.mul(s,t),o);if(i.mul(t,i.sqr(c)).eq(e))return c;throw new Gt(c)}},Vh=class extends Af{constructor(e,t,i){super(e,t);this.sm1=new D(i,16)}pm5d8(e){throw new Error("Not implemented.")}pp3d8(e){throw new Error("Not implemented.")}sqrt(e){let{red:t}=e,i=this.sm1._forceRed(t),n=this.pp3d8(e);if(t.sqr(n).eq(e))return n;let s=t.mul(n,i);if(t.sqr(s).eq(e))return s;throw new Gt(n)}divsqrt(e,t){let{red:i}=e,n=this.sm1._forceRed(i),s=i.mul(i.sqr(t),t),f=i.mul(i.sqr(s),t),a=this.pm5d8(i.mul(e,f)),o=i.mul(i.mul(e,s),a),c=i.mul(t,i.sqr(o));if(c.eq(e))return o;let d=i.ineg(c);if(d.eq(e))return i.mul(o,n);throw d.eq(i.mul(e,n))?new Gt(i.mul(o,n)):new Gt(o)}},Jh=class extends Af{constructor(e,t,i){super(e,t);this.g=new D(i,16),this.z=this.p.subn(1).zeroBits()}powS(e){throw new Error("Not implemented.")}powE(e){throw new Error("Not implemented.")}sqrt(e){let{red:t}=e;switch(t.jacobi(e)){case-1:throw new Gt(e);case 0:return e.clone();case 1:break}let i=this.g._forceRed(t),n=this.powE(e),s=this.powS(e),f=this.z;for(;;){let a=s,o=0;for(;a.cmpn(1)!==0&&o<f;)a=t.sqr(a),o+=1;if(o===0)break;Rt(o<f),a=t.sqrn(i,f-o-1),i=t.sqr(a),n=t.mul(n,a),s=t.mul(s,i),f=o}return n}divsqrt(e,t){let{red:i}=e;if(t.isZero())throw new Gt(t);return this.sqrt(i.div(e,t))}},Ah=class extends w0{constructor(){super("p192","ffffffff ffffffff ffffffff fffffffeffffffff ffffffff")}imulK(e){let t=this.one.inject(e);return e.iushln(64)._iadd(e,t)}core(e){let{red:t}=e,i=t.sqrnmul(e,1,e),n=t.sqrnmul(i,1,e),s=t.sqrnmul(n,3,n),f=t.sqrnmul(s,6,s),a=t.sqrnmul(f,12,f),o=t.sqrnmul(a,6,s),c=t.sqrnmul(o,1,e),d=t.sqrnmul(c,31,c),u=t.sqrnmul(d,62,d),p=t.sqrnmul(u,3,n),x=t.sqrn(p,1);return t.sqrnmul(x,62,d)}pm3d4(e){return this.core(e)}pm2(e){let{red:t}=e,i=this.core(e),n=t.sqrn(i,1);return t.sqrnmul(n,1,e)}pp1d4(e){let{red:t}=e,i=t.sqrnmul(e,1,e),n=t.sqrnmul(i,2,i),s=t.sqrnmul(n,4,n),f=t.sqrnmul(s,8,s),a=t.sqrnmul(f,16,f),o=t.sqrnmul(a,32,a),c=t.sqrnmul(o,64,o);return t.sqrn(c,62)}},Bh=class extends Jh{constructor(){super("p224","ffffffff ffffffff ffffffff ffffffff00000000 00000000 00000001","6a0fec67 8598a792 0c55b2d4 0b2d6ffbbea3d8ce f3fb3632 dc691b74")}imulK(e){let t=this.one.inject(e);return e.iushln(96)._isub(e,t)}powS(e){let{red:t}=e,i=t.sqrnmul(e,1,e),n=t.sqrnmul(i,2,i),s=t.sqrnmul(n,4,n),f=t.sqrnmul(s,8,s),a=t.sqrnmul(f,16,f),o=t.sqrnmul(a,32,a);return t.sqrnmul(o,64,o)}powE(e){let{red:t}=e;return t.sqrn(e,127)}pm2(e){let{red:t}=e,i=t.sqrnmul(e,1,e),n=t.sqrnmul(i,1,e),s=t.sqrnmul(n,3,n),f=t.sqrnmul(s,6,s),a=t.sqrnmul(f,12,f),o=t.sqrnmul(a,24,a),c=t.sqrnmul(o,48,o),d=t.sqrnmul(c,24,a),u=t.sqrnmul(d,6,s),p=t.sqrnmul(u,1,e),x=t.sqrn(p,1);return t.sqrnmul(x,96,c)}},kh=class extends w0{constructor(){super("p521","000001ff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff ffffffffffffffff")}imulK(e){return e}core(e){let{red:t}=e,i=t.sqrnmul(e,1,e),n=t.sqrnmul(i,1,e),s=t.sqrnmul(n,3,n),f=t.sqrnmul(s,1,e),a=t.sqrnmul(f,1,e),o=t.sqrnmul(a,8,a),c=t.sqrnmul(o,16,o),d=t.sqrnmul(c,32,c),u=t.sqrnmul(d,64,d),p=t.sqrnmul(u,128,u),x=t.sqrnmul(p,256,p);return t.sqrnmul(x,7,f)}pm3d4(e){return this.core(e)}pm2(e){let{red:t}=e,i=this.core(e),n=t.sqrn(i,1);return t.sqrnmul(n,1,e)}pp1d4(e){let{red:t}=e;return t.sqrn(e,519)}},qh=class extends w0{constructor(){super("k256","ffffffff ffffffff ffffffff ffffffffffffffff ffffffff fffffffe fffffc2f")}split(e,t){let i=4194303,n=Math.min(e.length,9);t._alloc(n+1);for(let a=0;a<n;a++)t.words[a]=e.words[a];if(t.length=n,e.length<=9){t._strip(),e.words[0]=0,e.length=1;return}let s=e.words[9],f=10;for(t.words[t.length++]=s&i,t._strip();f<e.length;f++){let a=e.words[f]|0;e.words[f-10]=(a&i)<<4|s>>>22,s=a}s>>>=22,e.words[f-10]=s,s===0&&e.length>10?e.length-=10:e.length-=9,e._strip()}imulK(e){e._expand(e.length+2);let t=0;for(let i=0;i<e.length;i++){let n=e.words[i];t+=n*977,e.words[i]=t&67108863,t=n*64+Math.floor(t/67108864)}return e.words[e.length-1]===0&&(e.length-=1,e.words[e.length-1]===0&&(e.length-=1)),e}core(e,t){let{red:i}=e,n=i.sqrnmul(t,1,e),s=i.sqrnmul(n,3,n),f=i.sqrnmul(s,3,n),a=i.sqrnmul(f,2,t),o=i.sqrnmul(a,11,a),c=i.sqrnmul(o,22,o),d=i.sqrnmul(c,44,c),u=i.sqrnmul(d,88,d),p=i.sqrnmul(u,44,c),x=i.sqrnmul(p,3,n),y=i.sqrn(x,1),g=i.sqrnmul(y,22,o);return i.sqrn(g,4)}pm3d4(e){let{red:t}=e,i=t.sqrnmul(e,1,e),n=this.core(e,i),s=t.sqrnmul(n,1,e),f=t.sqrn(s,1);return t.sqrnmul(f,2,i)}pm2(e){let{red:t}=e,i=t.sqrnmul(e,1,e),n=this.core(e,i),s=t.sqrnmul(n,1,e),f=t.sqrn(s,1),a=t.sqrnmul(f,2,i),o=t.sqrn(a,1);return t.sqrnmul(o,1,e)}pp1d4(e){let{red:t}=e,i=t.sqrnmul(e,1,e),n=this.core(e,i),s=t.sqrnmul(n,2,i);return t.sqrn(s,2)}},Ch=class extends w0{constructor(){super("p251","07ffffff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff fffffff7")}imulK(e){if(e.isZero())return e;let t=0;for(let i=0;i<e.length;i++){let n=e.words[i]*9+t;t=n>>>26,e.words[i]=n&67108863}return t!==0&&(e._alloc(e.length+1),e.words[e.length++]=t),e}core(e){let{red:t}=e,i=t.sqrnmul(e,1,e),n=t.sqrnmul(i,1,e),s=t.sqrnmul(n,3,n),f=t.sqrnmul(s,6,s),a=t.sqrnmul(f,12,f),o=t.sqrnmul(a,24,a),c=t.sqrnmul(o,48,o),d=t.sqrnmul(c,96,c),u=t.sqrnmul(d,48,o),p=t.sqrnmul(u,6,s);return t.sqrnmul(p,1,e)}pm3d4(e){let{red:t}=e,i=this.core(e),n=t.sqrn(i,1);return t.sqrnmul(n,1,e)}pm2(e){let{red:t}=e,i=this.core(e),n=t.sqrn(i,1),s=t.sqrnmul(n,1,e),f=t.sqrn(s,1);return t.sqrnmul(f,1,e)}pp1d4(e){let{red:t}=e,i=this.core(e),n=t.sqrnmul(i,1,e);return t.sqrn(n,1)}},Th=class extends Vh{constructor(){super("p25519","7fffffff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff ffffffed","2b832480 4fc1df0b 2b4d0099 3dfbd7a72f431806 ad2fe478 c4ee1b27 4a0ea0b0")}imulK(e){let t=0;for(let i=0;i<e.length;i++){let n=e.words[i]*19+t;t=n>>>26,e.words[i]=n&67108863}return t!==0&&(e._alloc(e.length+1),e.words[e.length++]=t),e}core(e,t){let{red:i}=e,n=i.sqrnmul(t,2,t),s=i.sqrnmul(n,1,e),f=i.sqrnmul(s,5,s),a=i.sqrnmul(f,10,f),o=i.sqrnmul(a,20,a),c=i.sqrnmul(o,10,f),d=i.sqrnmul(c,50,c),u=i.sqrnmul(d,100,d);return i.sqrnmul(u,50,c)}pm5d8(e){let{red:t}=e,i=t.sqrnmul(e,1,e),n=this.core(e,i),s=t.sqrn(n,1);return t.sqrnmul(s,1,e)}pm2(e){let{red:t}=e,i=t.sqrnmul(e,1,e),n=this.core(e,i),s=t.sqrn(n,1),f=t.sqrnmul(s,1,e),a=t.sqrn(f,1);return t.sqrnmul(a,2,i)}pp3d8(e){let{red:t}=e,i=t.sqrnmul(e,1,e),n=this.core(e,i),s=t.sqrnmul(n,1,e);return t.sqrn(s,1)}},Nh=class extends w0{constructor(){super("p448","ffffffff ffffffff ffffffff ffffffffffffffff ffffffff fffffffe ffffffffffffffff ffffffff ffffffff ffffffffffffffff ffffffff")}imulK(e){let t=this.one.inject(e);return e.iushln(224)._iadd(e,t)}core(e,t){let{red:i}=e,n=i.sqrnmul(t,1,e),s=i.sqrnmul(n,3,n),f=i.sqrnmul(s,3,n),a=i.sqrnmul(f,2,t),o=i.sqrnmul(a,11,a),c=i.sqrnmul(o,22,o),d=i.sqrnmul(c,44,c),u=i.sqrnmul(d,88,d),p=i.sqrnmul(u,44,c);return i.sqrnmul(p,2,t)}pm3d4(e){let{red:t}=e,i=t.sqrnmul(e,1,e),n=this.core(e,i),s=t.sqrnmul(n,1,e),f=t.sqrn(s,1);return t.sqrnmul(f,222,n)}pm2(e){let{red:t}=e,i=this.pm3d4(e),n=t.sqrn(i,1);return t.sqrnmul(n,1,e)}pp1d4(e){let{red:t}=e,i=t.sqrnmul(e,1,e),n=this.core(e,i),s=t.sqrnmul(n,2,i);return t.sqrn(s,222)}},Tn=class{constructor(e){let t=null;typeof e=="string"&&(t=D._prime(e),e=t.p),U(D.isBN(e),"m","bignum"),Nn(!e.red,"reduction"),ai(e.sign()>0,"reduction"),this.m=e,this.prime=t,this.mb=null,this.sm1=null}_verify1(e){ai(e.negative===0,"red"),he(e.red!=null,"red")}_verify2(e,t){ai((e.negative|t.negative)==0,"red"),he(e.red!=null&&e.red===t.red,"red")}get mont(){return!1}precompute(){if(this.sm1===null&&this.m.andln(7)===5)if(this.prime)this.sm1=this.prime.sm1.clone()._forceRed(this);else{let e=new D(2).toRed(this),t=this.m.subn(1).iushrn(2);this.sm1=this.pow(e,t)}return this}convertTo(e){let t=e.mod(this.m);return t.red=this,t}convertFrom(e){let t=e.clone();return t.red=null,t}intTo(e){return e}intFrom(e){return e}imod(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.imod(this.m)._forceRed(this)}iadd(e,t){return this._verify2(e,t),e._iadd(e,t),e.ucmp(this.m)>=0&&e._isub(e,this.m),e}add(e,t){return e.length<t.length?this.iadd(t.clone(),e):this.iadd(e.clone(),t)}iaddn(e,t){return this._verify1(e),t<0?this.isubn(e,-t):(this.m.length===1&&(t%=this.m.words[0]),e._iaddn(t),e.ucmp(this.m)>=0&&e._isub(e,this.m),e)}addn(e,t){return this.iaddn(e.clone(),t)}isub(e,t){this._verify2(e,t);let i=e.ucmp(t);return i===0?(e.words[0]=0,e.length=1,e):(i<0?(e._isub(t,e),e._isub(this.m,e)):e._isub(e,t),e)}sub(e,t){return this.isub(e.clone(),t)}isubn(e,t){return this._verify1(e),t<0?this.iaddn(e,-t):(this.m.length===1&&(t%=this.m.words[0]),e.length===1&&e.words[0]<t?(e.words[0]=t-e.words[0],e._isub(this.m,e)):e._isubn(t),e)}subn(e,t){return this.isubn(e.clone(),t)}imul(e,t){return this._verify2(e,t),this.imod(e.imul(t))}mul(e,t){return this._verify2(e,t),this.imod(e.mul(t))}imuln(e,t){if(this._verify1(e),e.isZero())return e;if(t===0)return e.words[0]=0,e.length=1,e;let i=t<0;if(i&&(t=-t),this.m.length===1&&(t%=this.m.words[0]),e.imuln(t),t<=16)for(;e.ucmp(this.m)>=0;)e._isub(e,this.m);else this.imod(e);return i&&this.ineg(e),e}muln(e,t){return this.imuln(e.clone(),t)}idiv(e,t){return this.div(e,t)._move(e)}div(e,t){return this.mul(e,this.invert(t))}idivn(e,t){return this.divn(e,t)._move(e)}divn(e,t){return this.div(e,this.convertTo(new D(t)))}ipow(e,t){return this.pow(e,t)._move(e)}pow(e,t){return this._verify1(e),t.isNeg()&&(e=this.invert(e)),t.length===1?this.pown(e,t.words[0]):Cn&&!this.prime?this.powInt(e,t):this.powNum(e,t)}powNum(e,t){let i=new D(1).toRed(this),n=new Array(v0),s=this.sqr(e);n[0]=e;for(let o=1;o<v0;o++)n[o]=this.mul(n[o-1],s);let f=t.bitLength(),a=i;for(;f>=ms;){let o=ms,c=t.bits(f-o,o);if(c<v0){a=this.sqr(a),f-=1;continue}for(;(c&1)==0;)o-=1,c>>=1;a===i?a=n[c>>1].clone():(a=this.sqrn(a,o),a=this.mul(a,n[c>>1])),f-=o}if(f>0){let o=t.bits(0,f);for(;f--;)a=this.sqr(a),o>>f&1&&(a=this.mul(a,e))}return a}powInt(e,t){this.mb===null&&(this.mb=this.m.toBigInt());let i=this.intFrom(e.toBigInt()),n=nm(i,t,this.mb),s=this.intTo(n);return D.fromBigInt(s)._forceRed(this)}sqrn(e,t){for(;t--;)e=this.sqr(e);return e}sqrnmul(e,t,i){return this.mul(this.sqrn(e,t),i)}ipown(e,t){return this.pown(e,t)._move(e)}pown(e,t){if(this._verify1(e),t<0&&(e=this.invert(e),t=-t),t===0)return new D(1).toRed(this);if(t===1)return e.clone();let i=g0(t),n=e;for(let s=i-2;s>=0;s--)n=this.sqr(n),t>>s&1&&(n=this.mul(n,e));return n}isqr(e){return this.imul(e,e)}sqr(e){return this.mul(e,e)}isqrt(e){return this.sqrt(e)._move(e)}sqrt(e){return this._verify1(e),this.prime?this.prime.sqrt(e):this.m.andln(3)===3?this.sqrt3mod4(e):this.m.andln(7)===5?this.sm1!=null?this.sqrt5mod8sm1(e):this.sqrt5mod8(e):this.sqrt0(e)}sqrt3mod4(e){let t=this.m.addn(1).iushrn(2),i=this.pow(e,t);if(!this.sqr(i).eq(e))throw new Gt(i);return i}sqrt5mod8(e){let t=new D(1).toRed(this),i=this.m.ushrn(3),n=this.add(e,e),s=this.pow(n,i),f=this.mul(n,this.sqr(s)),a=this.mul(this.mul(s,e),this.isub(f,t));if(!this.sqr(a).eq(e))throw new Gt(a);return a}sqrt5mod8sm1(e){let t=this.m.addn(3).iushrn(3),i=this.pow(e,t);if(this.sqr(i).eq(e))return i;let n=this.mul(i,this.sm1);if(this.sqr(n).eq(e))return n;throw new Gt(i)}sqrt0(e){if(this.m.cmpn(1)===0||!this.m.isOdd())throw new Error("Invalid prime.");switch(this.jacobi(e)){case-1:throw new Gt(e);case 0:return e.clone();case 1:break}let t=new D(1).toRed(this),i=this.m.subn(1),n=i._makeOdd(),s=new D(2).toRed(this);for(;this.jacobi(s)!==-1;)this.iadd(s,t);let f=this.pow(s,i),a=this.pow(e,i),o=this.pow(e,i.iaddn(1).iushrn(1)),c=n;for(;;){let d=a,u=0;for(;!d.eq(t)&&u<c;)d=this.sqr(d),u+=1;if(u===0)break;Rt(u<c),d=this.sqrn(f,c-u-1),f=this.sqr(d),o=this.mul(o,d),a=this.mul(a,f),c=u}return o}idivsqrt(e,t){return this.divsqrt(e,t)._move(e)}divsqrt(e,t){if(this._verify2(e,t),e.isZero()&&t.isZero())throw new Gt(t);if(this.prime)return this.prime.divsqrt(e,t);if(this.m.andln(3)===3)return this.divsqrt3mod4(e,t);if(this.sm1!=null&&this.m.andln(7)===5)return this.divsqrt5mod8(e,t);if(t.isZero())throw new Gt(t);return this.sqrt(this.div(e,t))}divsqrt3mod4(e,t){let i=this.m.subn(3).iushrn(2),n=this.sqr(e),s=this.mul(n,e),f=this.mul(s,n),a=this.mul(this.sqr(t),t),o=this.pow(this.mul(f,a),i),c=this.mul(this.mul(s,t),o);if(this.mul(t,this.sqr(c)).eq(e))return c;throw new Gt(c)}divsqrt5mod8(e,t){let i=this.m.subn(5).iushrn(3),n=this.mul(this.sqr(t),t),s=this.mul(this.sqr(n),t),f=this.pow(this.mul(e,s),i),a=this.mul(this.mul(e,n),f),o=this.mul(t,this.sqr(a));if(o.eq(e))return a;let c=this.ineg(o);if(c.eq(e))return this.mul(a,this.sm1);throw c.eq(this.mul(e,this.sm1))?new Gt(this.mul(a,this.sm1)):new Gt(a)}isSquare(e){return this.m.isOdd()?this.jacobi(e)>=0:this.kronecker(e)>=0}ishl(e,t){return this._verify1(e),this.imod(e.iushl(t))}shl(e,t){return this.ishl(e.clone(),t)}ishln(e,t){if(this._verify1(e),e.iushln(t),t<=4)for(;e.ucmp(this.m)>=0;)e._isub(e,this.m);else this.imod(e);return e}shln(e,t){return this.ishln(e.clone(),t)}ineg(e){return this._verify1(e),e.isZero()||e._isub(this.m,e),e}neg(e){return this.ineg(e.clone())}eq(e,t){return this._verify2(e,t),e.ucmp(t)===0}eqn(e,t){if(this._verify1(e),this.m.length===1)return t%=this.m.words[0],t<0&&(t+=this.m.words[0]),e.ucmpn(t)===0;if(t<0){this.m._isubn(-t);let i=e.ucmp(this.m);return this.m._iaddn(-t),i===0}return e.ucmpn(t)===0}isHigh(e){return!this.isLow(e)}isLow(e){return this._verify1(e),e.ucmp(this.m.ushrn(1))<=0}isOdd(e){return this._verify1(e),e.isOdd()}isEven(e){return this._verify1(e),e.isEven()}legendre(e){if(this._verify1(e),this.m.isEven())throw new Error("legendre: `num` must be odd.");let t=this.m.subn(1).iushrn(1),i=this.pow(e,t);if(i.isZero())return 0;let n=new D(1).toRed(this);if(i.eq(n))return 1;if(i.eq(this.ineg(n)))return-1;throw new Error("Invalid prime.")}jacobi(e){return this._verify1(e),e.jacobi(this.m)}kronecker(e){return this._verify1(e),e.kronecker(this.m)}iinvert(e){return this.invert(e)._move(e)}invert(e){return this._verify1(e),e.invert(this.m)._forceRed(this)}ifermat(e){return this.fermat(e)._move(e)}fermat(e){if(this._verify1(e),e.isZero()||this.m.cmpn(1)===0)throw new RangeError("Not invertible.");return this.prime?this.prime.fermat(e):this.pow(e,this.m.subn(2))}invertAll(e){U(Array.isArray(e),"elems","array");for(let s of e)U(D.isBN(s),"elem","bignum"),this._verify1(s);if(this.m.cmpn(1)===0||this.m.isEven())throw new RangeError("Not invertible.");let t=e.length,i=new Array(t);if(t===0)return i;let n=new D(1).toRed(this);for(let s=0;s<t;s++){if(e[s].isZero()){i[s]=e[s].clone();continue}i[s]=n,n=this.mul(n,e[s])}n=this.invert(n);for(let s=t-1;s>=0;s--)e[s].isZero()||(i[s]=this.mul(n,i[s]),n=this.mul(n,e[s]));return i}[_h](){return this.prime?`<Red: ${this.prime.name}>`:`<Red: ${this.m.toString(10)}>`}},Ph=class extends Tn{constructor(e){super(e);this.prime=null,this.n=this.m.bitLength(),this.n%26!=0&&(this.n+=26-this.n%26),this.k=this.n*2,this.w=this.k/26,this.b=D.shift(1,this.k).div(this.m)}convertTo(e){return e.length>this.w?super.convertTo(e):this.imod(e.clone())}_shift(e){let t=0,i=this.w;for(;i<e.length;)e.words[t++]=e.words[i++];t===0&&(e.words[t++]=0),e.length=t}imod(e){let t=e.negative;Rt(e.length<=this.w),e.negative=0;let i=e.mul(this.b);return this._shift(i),e._isub(e,i.mul(this.m)),e.ucmp(this.m)>=0&&e._isub(e,this.m),t&&!e.isZero()&&e._isub(this.m,e),e.red=this,e}},Rh=class extends Tn{constructor(e){super(e);this.prime=null,this.n=this.m.length*26,this.r=D.shift(1,this.n),this.r2=D.shift(1,this.n*2).imod(this.m),this.ri=this.r.invert(this.m),this.mi=this.r.mul(this.ri).isubn(1).div(this.m),this.rib=null}get mont(){return!0}convertTo(e){return e.isNeg()||e.ucmp(this.m)>=0?this.imod(e.ushln(this.n)):this.mul(e,this.r2)}convertFrom(e){let t=this.mul(e,new D(1));return t.red=null,t}intTo(e){return(e<<BigInt(this.n))%this.mb}intFrom(e){return this.rib===null&&(this.rib=this.ri.toBigInt()),e*this.rib%this.mb}iaddn(e,t){return this.iadd(e,this.convertTo(new D(t)))}isubn(e,t){return this.isub(e,this.convertTo(new D(t)))}imul(e,t){return this.mul(e,t)._move(e)}mul(e,t){if(e.isZero()||t.isZero())return new D(0)._forceRed(this);let i=e.mul(t),n=i.umaskn(this.n).mul(this.mi).iumaskn(this.n),s=i.iadd(n.mul(this.m)).iushrn(this.n);return s.ucmp(this.m)>=0&&s._isub(s,this.m),s._forceRed(this)}imuln(e,t){if(this._verify1(e),e.isZero())return e;if(t===0)return e.words[0]=0,e.length=1,e;let i=t<0;i&&(t=-t),this.m.length===1&&(t%=this.m.words[0]);let n=g0(t);if(n>5)this.imul(e,this.convertTo(new D(t)));else if((t&t-1)==0)for(let s=0;s<n-1;s++)this.iadd(e,e);else{let s=e.clone();for(let f=n-2;f>=0;f--)this.iadd(e,e),t>>f&1&&this.iadd(e,s)}return i&&this.ineg(e),e}eqn(e,t){return this._verify1(e),t===0?e.isZero():e.ucmp(this.convertTo(new D(t)))===0}isLow(e){return this._verify1(e),this.convertFrom(e).ucmp(this.m.ushrn(1))<=0}isOdd(e){return this._verify1(e),this.convertFrom(e).isOdd()}isEven(e){return this._verify1(e),this.convertFrom(e).isEven()}invert(e){return this._verify1(e),this.imod(e.invert(this.m).mul(this.r2))}};function S0(r,e,t){let i=new r(e);return r.captureStackTrace&&r.captureStackTrace(i,t),i}function Rt(r,e){if(!r)throw S0(Error,e||"Assertion failed.",Rt)}function U(r,e,t){if(!r){let i=`"${e}" must be a(n) ${t}.`;throw S0(TypeError,i,U)}}function ai(r,e){if(!r){let t=`"${e}" only works with positive numbers.`;throw S0(RangeError,t,ai)}}function he(r,e){if(!r){let t=`"${e}" only works with red numbers.`;throw S0(TypeError,t,he)}}function Nn(r,e){if(!r){let t=`"${e}" only works with normal numbers.`;throw S0(TypeError,t,Nn)}}function If(r){if(!r)throw S0(RangeError,"Cannot divide by zero.",If)}var Gt=class extends Error{constructor(e){super();this.name="SquareRootError",this.message="X is not a square mod P.",this.result=e.fromRed(),Error.captureStackTrace&&Error.captureStackTrace(this,Gt)}};function Kh(r){return Number.isSafeInteger(r)}function Ze(r){return Kh(r)&&r>=-67108863&&r<=67108863}function rm(r,e){return r.allocUnsafeSlow?r.allocUnsafeSlow(e):new r(e)}function Lh(r){if(r==null)return 10;if(typeof r=="number")return r;switch(r){case"bin":return 2;case"oct":return 8;case"dec":return 10;case"hex":return 16}return 0}function g0(r){if(Math.clz32)return 32-Math.clz32(r);let e=r,t=0;return e>=4096&&(t+=13,e>>>=13),e>=64&&(t+=7,e>>>=7),e>=8&&(t+=4,e>>>=4),e>=2&&(t+=2,e>>>=2),t+e}function Fh(r){if(r===0)return 26;let e=r,t=0;return(e&8191)==0&&(t+=13,e>>>=13),(e&127)==0&&(t+=7,e>>>=7),(e&15)==0&&(t+=4,e>>>=4),(e&3)==0&&(t+=2,e>>>=2),(e&1)==0&&(t+=1),t}function Dh(r,e,t){let i=Math.min(r.length,t),n=0,s=0;for(let f=e;f<i;f++){let a=r.charCodeAt(f)-48;n<<=4;let o;a>=49&&a<=54?o=a-49+10:a>=17&&a<=22?o=a-17+10:o=a,n|=o,s|=o}if(s&~15)throw new Error("Invalid string.");return n}function zh(r,e,t,i){let n=Math.min(r.length,t),s=0;for(let f=e;f<n;f++){let a=r.charCodeAt(f)-48;s*=i;let o;if(a>=49?o=a-49+10:a>=17?o=a-17+10:o=a,a<0||a>207||o>=i)throw new Error("Invalid string.");s+=o}return s}function nm(r,e,t){let i=BigInt(1),n=new Array(v0),s=r*r%t;n[0]=r;for(let o=1;o<v0;o++)n[o]=n[o-1]*s%t;let f=e.bitLength(),a=i;for(;f>=ms;){let o=ms,c=e.bits(f-o,o);if(c<v0){a=a*a%t,f-=1;continue}for(;(c&1)==0;)o-=1,c>>=1;a===i?a=n[c>>1]:(a=sm(a,o,t),a=a*n[c>>1]%t),f-=o}if(f>0){let o=e.bits(0,f);for(;f--;)a=a*a%t,o>>f&1&&(a=a*r%t)}return a}function sm(r,e,t){for(let i=0;i<e;i++)r=r*r%t;return r}function Oh(r,e,t){let i=r.length+e.length;t.negative=r.negative^e.negative,t._alloc(i),t.length=i;let n=r.words[0],s=e.words[0],f=n*s,a=f&67108863,o=f/67108864|0,c=1;for(t.words[0]=a;c<t.length-1;c++){let d=o>>>26,u=o&67108863,p=Math.max(0,c-r.length+1),x=Math.min(c,e.length-1);for(let y=p;y<=x;y++){let g=c-y,M=r.words[g],k=e.words[y],R=M*k+u;d+=R/67108864|0,u=R&67108863}t.words[c]=u|0,o=d|0}return o!==0?t.words[c]=o|0:t.length-=1,t._strip()}function Uh(r,e,t){let i=r.length+e.length;t.negative=r.negative^e.negative,t._alloc(i),t.length=i;let n=0,s=0,f=0;for(;f<t.length-1;f++){let a=s;s=0;let o=n&67108863,c=Math.max(0,f-r.length+1),d=Math.min(f,e.length-1);for(let u=c;u<=d;u++){let p=f-u,x=r.words[p],y=e.words[u],g=x*y,M=g&67108863;a=a+(g/67108864|0)|0,M=M+o|0,o=M&67108863,a=a+(M>>>26)|0,s+=a>>>26,a&=67108863}t.words[f]=o,n=a,a=s}return n!==0?t.words[f]=n:t.length-=1,t._strip()}function im(r,e,t){if(!Cn||r.length+e.length>82595519)return Uh(r,e,t);let i=BigInt(0),n=BigInt(67108863),s=BigInt(26),f=r.toBigInt()*e.toBigInt(),a=f<i|0;a&&(f=-f);let o=0;for(;f>i;)t.words[o++]=Number(f&n),f>>=s;return o===0&&(t.words[o++]=0),t.length=o,t.negative=a,t}function Hh(r,e,t){let i=r.words,n=e.words,s=t.words,f=i[0]|0,a=f&8191,o=f>>>13,c=i[1]|0,d=c&8191,u=c>>>13,p=i[2]|0,x=p&8191,y=p>>>13,g=i[3]|0,M=g&8191,k=g>>>13,R=i[4]|0,K=R&8191,L=R>>>13,O=i[5]|0,F=O&8191,G=O>>>13,B=i[6]|0,b=B&8191,m=B>>>13,w=i[7]|0,S=w&8191,I=w>>>13,q=i[8]|0,h=q&8191,_=q>>>13,l=i[9]|0,A=l&8191,W=l>>>13,$=n[0]|0,Y=$&8191,j=$>>>13,de=n[1]|0,te=de&8191,pe=de>>>13,ye=n[2]|0,re=ye&8191,Be=ye>>>13,ke=n[3]|0,se=ke&8191,qe=ke>>>13,Ce=n[4]|0,fe=Ce&8191,Te=Ce>>>13,Ne=n[5]|0,Se=Ne&8191,_t=Ne>>>13,It=n[6]|0,Ee=It&8191,At=It>>>13,Bt=n[7]|0,Me=Bt&8191,kt=Bt>>>13,qt=n[8]|0,_e=qt&8191,Ct=qt>>>13,Tt=n[9]|0,Ie=Tt&8191,Nt=Tt>>>13,ie=0,T,v,N;t.negative=r.negative^e.negative,t._alloc(20),t.length=19,T=Math.imul(a,Y),v=Math.imul(a,j),v=v+Math.imul(o,Y)|0,N=Math.imul(o,j);let ot=(ie+T|0)+((v&8191)<<13)|0;ie=(N+(v>>>13)|0)+(ot>>>26)|0,ot&=67108863,T=Math.imul(d,Y),v=Math.imul(d,j),v=v+Math.imul(u,Y)|0,N=Math.imul(u,j),T=T+Math.imul(a,te)|0,v=v+Math.imul(a,pe)|0,v=v+Math.imul(o,te)|0,N=N+Math.imul(o,pe)|0;let d0=(ie+T|0)+((v&8191)<<13)|0;ie=(N+(v>>>13)|0)+(d0>>>26)|0,d0&=67108863,T=Math.imul(x,Y),v=Math.imul(x,j),v=v+Math.imul(y,Y)|0,N=Math.imul(y,j),T=T+Math.imul(d,te)|0,v=v+Math.imul(d,pe)|0,v=v+Math.imul(u,te)|0,N=N+Math.imul(u,pe)|0,T=T+Math.imul(a,re)|0,v=v+Math.imul(a,Be)|0,v=v+Math.imul(o,re)|0,N=N+Math.imul(o,Be)|0;let ct=(ie+T|0)+((v&8191)<<13)|0;ie=(N+(v>>>13)|0)+(ct>>>26)|0,ct&=67108863,T=Math.imul(M,Y),v=Math.imul(M,j),v=v+Math.imul(k,Y)|0,N=Math.imul(k,j),T=T+Math.imul(x,te)|0,v=v+Math.imul(x,pe)|0,v=v+Math.imul(y,te)|0,N=N+Math.imul(y,pe)|0,T=T+Math.imul(d,re)|0,v=v+Math.imul(d,Be)|0,v=v+Math.imul(u,re)|0,N=N+Math.imul(u,Be)|0,T=T+Math.imul(a,se)|0,v=v+Math.imul(a,qe)|0,v=v+Math.imul(o,se)|0,N=N+Math.imul(o,qe)|0;let dt=(ie+T|0)+((v&8191)<<13)|0;ie=(N+(v>>>13)|0)+(dt>>>26)|0,dt&=67108863,T=Math.imul(K,Y),v=Math.imul(K,j),v=v+Math.imul(L,Y)|0,N=Math.imul(L,j),T=T+Math.imul(M,te)|0,v=v+Math.imul(M,pe)|0,v=v+Math.imul(k,te)|0,N=N+Math.imul(k,pe)|0,T=T+Math.imul(x,re)|0,v=v+Math.imul(x,Be)|0,v=v+Math.imul(y,re)|0,N=N+Math.imul(y,Be)|0,T=T+Math.imul(d,se)|0,v=v+Math.imul(d,qe)|0,v=v+Math.imul(u,se)|0,N=N+Math.imul(u,qe)|0,T=T+Math.imul(a,fe)|0,v=v+Math.imul(a,Te)|0,v=v+Math.imul(o,fe)|0,N=N+Math.imul(o,Te)|0;let h0=(ie+T|0)+((v&8191)<<13)|0;ie=(N+(v>>>13)|0)+(h0>>>26)|0,h0&=67108863,T=Math.imul(F,Y),v=Math.imul(F,j),v=v+Math.imul(G,Y)|0,N=Math.imul(G,j),T=T+Math.imul(K,te)|0,v=v+Math.imul(K,pe)|0,v=v+Math.imul(L,te)|0,N=N+Math.imul(L,pe)|0,T=T+Math.imul(M,re)|0,v=v+Math.imul(M,Be)|0,v=v+Math.imul(k,re)|0,N=N+Math.imul(k,Be)|0,T=T+Math.imul(x,se)|0,v=v+Math.imul(x,qe)|0,v=v+Math.imul(y,se)|0,N=N+Math.imul(y,qe)|0,T=T+Math.imul(d,fe)|0,v=v+Math.imul(d,Te)|0,v=v+Math.imul(u,fe)|0,N=N+Math.imul(u,Te)|0,T=T+Math.imul(a,Se)|0,v=v+Math.imul(a,_t)|0,v=v+Math.imul(o,Se)|0,N=N+Math.imul(o,_t)|0;let ht=(ie+T|0)+((v&8191)<<13)|0;ie=(N+(v>>>13)|0)+(ht>>>26)|0,ht&=67108863,T=Math.imul(b,Y),v=Math.imul(b,j),v=v+Math.imul(m,Y)|0,N=Math.imul(m,j),T=T+Math.imul(F,te)|0,v=v+Math.imul(F,pe)|0,v=v+Math.imul(G,te)|0,N=N+Math.imul(G,pe)|0,T=T+Math.imul(K,re)|0,v=v+Math.imul(K,Be)|0,v=v+Math.imul(L,re)|0,N=N+Math.imul(L,Be)|0,T=T+Math.imul(M,se)|0,v=v+Math.imul(M,qe)|0,v=v+Math.imul(k,se)|0,N=N+Math.imul(k,qe)|0,T=T+Math.imul(x,fe)|0,v=v+Math.imul(x,Te)|0,v=v+Math.imul(y,fe)|0,N=N+Math.imul(y,Te)|0,T=T+Math.imul(d,Se)|0,v=v+Math.imul(d,_t)|0,v=v+Math.imul(u,Se)|0,N=N+Math.imul(u,_t)|0,T=T+Math.imul(a,Ee)|0,v=v+Math.imul(a,At)|0,v=v+Math.imul(o,Ee)|0,N=N+Math.imul(o,At)|0;let ut=(ie+T|0)+((v&8191)<<13)|0;ie=(N+(v>>>13)|0)+(ut>>>26)|0,ut&=67108863,T=Math.imul(S,Y),v=Math.imul(S,j),v=v+Math.imul(I,Y)|0,N=Math.imul(I,j),T=T+Math.imul(b,te)|0,v=v+Math.imul(b,pe)|0,v=v+Math.imul(m,te)|0,N=N+Math.imul(m,pe)|0,T=T+Math.imul(F,re)|0,v=v+Math.imul(F,Be)|0,v=v+Math.imul(G,re)|0,N=N+Math.imul(G,Be)|0,T=T+Math.imul(K,se)|0,v=v+Math.imul(K,qe)|0,v=v+Math.imul(L,se)|0,N=N+Math.imul(L,qe)|0,T=T+Math.imul(M,fe)|0,v=v+Math.imul(M,Te)|0,v=v+Math.imul(k,fe)|0,N=N+Math.imul(k,Te)|0,T=T+Math.imul(x,Se)|0,v=v+Math.imul(x,_t)|0,v=v+Math.imul(y,Se)|0,N=N+Math.imul(y,_t)|0,T=T+Math.imul(d,Ee)|0,v=v+Math.imul(d,At)|0,v=v+Math.imul(u,Ee)|0,N=N+Math.imul(u,At)|0,T=T+Math.imul(a,Me)|0,v=v+Math.imul(a,kt)|0,v=v+Math.imul(o,Me)|0,N=N+Math.imul(o,kt)|0;let u0=(ie+T|0)+((v&8191)<<13)|0;ie=(N+(v>>>13)|0)+(u0>>>26)|0,u0&=67108863,T=Math.imul(h,Y),v=Math.imul(h,j),v=v+Math.imul(_,Y)|0,N=Math.imul(_,j),T=T+Math.imul(S,te)|0,v=v+Math.imul(S,pe)|0,v=v+Math.imul(I,te)|0,N=N+Math.imul(I,pe)|0,T=T+Math.imul(b,re)|0,v=v+Math.imul(b,Be)|0,v=v+Math.imul(m,re)|0,N=N+Math.imul(m,Be)|0,T=T+Math.imul(F,se)|0,v=v+Math.imul(F,qe)|0,v=v+Math.imul(G,se)|0,N=N+Math.imul(G,qe)|0,T=T+Math.imul(K,fe)|0,v=v+Math.imul(K,Te)|0,v=v+Math.imul(L,fe)|0,N=N+Math.imul(L,Te)|0,T=T+Math.imul(M,Se)|0,v=v+Math.imul(M,_t)|0,v=v+Math.imul(k,Se)|0,N=N+Math.imul(k,_t)|0,T=T+Math.imul(x,Ee)|0,v=v+Math.imul(x,At)|0,v=v+Math.imul(y,Ee)|0,N=N+Math.imul(y,At)|0,T=T+Math.imul(d,Me)|0,v=v+Math.imul(d,kt)|0,v=v+Math.imul(u,Me)|0,N=N+Math.imul(u,kt)|0,T=T+Math.imul(a,_e)|0,v=v+Math.imul(a,Ct)|0,v=v+Math.imul(o,_e)|0,N=N+Math.imul(o,Ct)|0;let lt=(ie+T|0)+((v&8191)<<13)|0;ie=(N+(v>>>13)|0)+(lt>>>26)|0,lt&=67108863,T=Math.imul(A,Y),v=Math.imul(A,j),v=v+Math.imul(W,Y)|0,N=Math.imul(W,j),T=T+Math.imul(h,te)|0,v=v+Math.imul(h,pe)|0,v=v+Math.imul(_,te)|0,N=N+Math.imul(_,pe)|0,T=T+Math.imul(S,re)|0,v=v+Math.imul(S,Be)|0,v=v+Math.imul(I,re)|0,N=N+Math.imul(I,Be)|0,T=T+Math.imul(b,se)|0,v=v+Math.imul(b,qe)|0,v=v+Math.imul(m,se)|0,N=N+Math.imul(m,qe)|0,T=T+Math.imul(F,fe)|0,v=v+Math.imul(F,Te)|0,v=v+Math.imul(G,fe)|0,N=N+Math.imul(G,Te)|0,T=T+Math.imul(K,Se)|0,v=v+Math.imul(K,_t)|0,v=v+Math.imul(L,Se)|0,N=N+Math.imul(L,_t)|0,T=T+Math.imul(M,Ee)|0,v=v+Math.imul(M,At)|0,v=v+Math.imul(k,Ee)|0,N=N+Math.imul(k,At)|0,T=T+Math.imul(x,Me)|0,v=v+Math.imul(x,kt)|0,v=v+Math.imul(y,Me)|0,N=N+Math.imul(y,kt)|0,T=T+Math.imul(d,_e)|0,v=v+Math.imul(d,Ct)|0,v=v+Math.imul(u,_e)|0,N=N+Math.imul(u,Ct)|0,T=T+Math.imul(a,Ie)|0,v=v+Math.imul(a,Nt)|0,v=v+Math.imul(o,Ie)|0,N=N+Math.imul(o,Nt)|0;let bt=(ie+T|0)+((v&8191)<<13)|0;ie=(N+(v>>>13)|0)+(bt>>>26)|0,bt&=67108863,T=Math.imul(A,te),v=Math.imul(A,pe),v=v+Math.imul(W,te)|0,N=Math.imul(W,pe),T=T+Math.imul(h,re)|0,v=v+Math.imul(h,Be)|0,v=v+Math.imul(_,re)|0,N=N+Math.imul(_,Be)|0,T=T+Math.imul(S,se)|0,v=v+Math.imul(S,qe)|0,v=v+Math.imul(I,se)|0,N=N+Math.imul(I,qe)|0,T=T+Math.imul(b,fe)|0,v=v+Math.imul(b,Te)|0,v=v+Math.imul(m,fe)|0,N=N+Math.imul(m,Te)|0,T=T+Math.imul(F,Se)|0,v=v+Math.imul(F,_t)|0,v=v+Math.imul(G,Se)|0,N=N+Math.imul(G,_t)|0,T=T+Math.imul(K,Ee)|0,v=v+Math.imul(K,At)|0,v=v+Math.imul(L,Ee)|0,N=N+Math.imul(L,At)|0,T=T+Math.imul(M,Me)|0,v=v+Math.imul(M,kt)|0,v=v+Math.imul(k,Me)|0,N=N+Math.imul(k,kt)|0,T=T+Math.imul(x,_e)|0,v=v+Math.imul(x,Ct)|0,v=v+Math.imul(y,_e)|0,N=N+Math.imul(y,Ct)|0,T=T+Math.imul(d,Ie)|0,v=v+Math.imul(d,Nt)|0,v=v+Math.imul(u,Ie)|0,N=N+Math.imul(u,Nt)|0;let l0=(ie+T|0)+((v&8191)<<13)|0;ie=(N+(v>>>13)|0)+(l0>>>26)|0,l0&=67108863,T=Math.imul(A,re),v=Math.imul(A,Be),v=v+Math.imul(W,re)|0,N=Math.imul(W,Be),T=T+Math.imul(h,se)|0,v=v+Math.imul(h,qe)|0,v=v+Math.imul(_,se)|0,N=N+Math.imul(_,qe)|0,T=T+Math.imul(S,fe)|0,v=v+Math.imul(S,Te)|0,v=v+Math.imul(I,fe)|0,N=N+Math.imul(I,Te)|0,T=T+Math.imul(b,Se)|0,v=v+Math.imul(b,_t)|0,v=v+Math.imul(m,Se)|0,N=N+Math.imul(m,_t)|0,T=T+Math.imul(F,Ee)|0,v=v+Math.imul(F,At)|0,v=v+Math.imul(G,Ee)|0,N=N+Math.imul(G,At)|0,T=T+Math.imul(K,Me)|0,v=v+Math.imul(K,kt)|0,v=v+Math.imul(L,Me)|0,N=N+Math.imul(L,kt)|0,T=T+Math.imul(M,_e)|0,v=v+Math.imul(M,Ct)|0,v=v+Math.imul(k,_e)|0,N=N+Math.imul(k,Ct)|0,T=T+Math.imul(x,Ie)|0,v=v+Math.imul(x,Nt)|0,v=v+Math.imul(y,Ie)|0,N=N+Math.imul(y,Nt)|0;let pt=(ie+T|0)+((v&8191)<<13)|0;ie=(N+(v>>>13)|0)+(pt>>>26)|0,pt&=67108863,T=Math.imul(A,se),v=Math.imul(A,qe),v=v+Math.imul(W,se)|0,N=Math.imul(W,qe),T=T+Math.imul(h,fe)|0,v=v+Math.imul(h,Te)|0,v=v+Math.imul(_,fe)|0,N=N+Math.imul(_,Te)|0,T=T+Math.imul(S,Se)|0,v=v+Math.imul(S,_t)|0,v=v+Math.imul(I,Se)|0,N=N+Math.imul(I,_t)|0,T=T+Math.imul(b,Ee)|0,v=v+Math.imul(b,At)|0,v=v+Math.imul(m,Ee)|0,N=N+Math.imul(m,At)|0,T=T+Math.imul(F,Me)|0,v=v+Math.imul(F,kt)|0,v=v+Math.imul(G,Me)|0,N=N+Math.imul(G,kt)|0,T=T+Math.imul(K,_e)|0,v=v+Math.imul(K,Ct)|0,v=v+Math.imul(L,_e)|0,N=N+Math.imul(L,Ct)|0,T=T+Math.imul(M,Ie)|0,v=v+Math.imul(M,Nt)|0,v=v+Math.imul(k,Ie)|0,N=N+Math.imul(k,Nt)|0;let yt=(ie+T|0)+((v&8191)<<13)|0;ie=(N+(v>>>13)|0)+(yt>>>26)|0,yt&=67108863,T=Math.imul(A,fe),v=Math.imul(A,Te),v=v+Math.imul(W,fe)|0,N=Math.imul(W,Te),T=T+Math.imul(h,Se)|0,v=v+Math.imul(h,_t)|0,v=v+Math.imul(_,Se)|0,N=N+Math.imul(_,_t)|0,T=T+Math.imul(S,Ee)|0,v=v+Math.imul(S,At)|0,v=v+Math.imul(I,Ee)|0,N=N+Math.imul(I,At)|0,T=T+Math.imul(b,Me)|0,v=v+Math.imul(b,kt)|0,v=v+Math.imul(m,Me)|0,N=N+Math.imul(m,kt)|0,T=T+Math.imul(F,_e)|0,v=v+Math.imul(F,Ct)|0,v=v+Math.imul(G,_e)|0,N=N+Math.imul(G,Ct)|0,T=T+Math.imul(K,Ie)|0,v=v+Math.imul(K,Nt)|0,v=v+Math.imul(L,Ie)|0,N=N+Math.imul(L,Nt)|0;let b0=(ie+T|0)+((v&8191)<<13)|0;ie=(N+(v>>>13)|0)+(b0>>>26)|0,b0&=67108863,T=Math.imul(A,Se),v=Math.imul(A,_t),v=v+Math.imul(W,Se)|0,N=Math.imul(W,_t),T=T+Math.imul(h,Ee)|0,v=v+Math.imul(h,At)|0,v=v+Math.imul(_,Ee)|0,N=N+Math.imul(_,At)|0,T=T+Math.imul(S,Me)|0,v=v+Math.imul(S,kt)|0,v=v+Math.imul(I,Me)|0,N=N+Math.imul(I,kt)|0,T=T+Math.imul(b,_e)|0,v=v+Math.imul(b,Ct)|0,v=v+Math.imul(m,_e)|0,N=N+Math.imul(m,Ct)|0,T=T+Math.imul(F,Ie)|0,v=v+Math.imul(F,Nt)|0,v=v+Math.imul(G,Ie)|0,N=N+Math.imul(G,Nt)|0;let mt=(ie+T|0)+((v&8191)<<13)|0;ie=(N+(v>>>13)|0)+(mt>>>26)|0,mt&=67108863,T=Math.imul(A,Ee),v=Math.imul(A,At),v=v+Math.imul(W,Ee)|0,N=Math.imul(W,At),T=T+Math.imul(h,Me)|0,v=v+Math.imul(h,kt)|0,v=v+Math.imul(_,Me)|0,N=N+Math.imul(_,kt)|0,T=T+Math.imul(S,_e)|0,v=v+Math.imul(S,Ct)|0,v=v+Math.imul(I,_e)|0,N=N+Math.imul(I,Ct)|0,T=T+Math.imul(b,Ie)|0,v=v+Math.imul(b,Nt)|0,v=v+Math.imul(m,Ie)|0,N=N+Math.imul(m,Nt)|0;let xt=(ie+T|0)+((v&8191)<<13)|0;ie=(N+(v>>>13)|0)+(xt>>>26)|0,xt&=67108863,T=Math.imul(A,Me),v=Math.imul(A,kt),v=v+Math.imul(W,Me)|0,N=Math.imul(W,kt),T=T+Math.imul(h,_e)|0,v=v+Math.imul(h,Ct)|0,v=v+Math.imul(_,_e)|0,N=N+Math.imul(_,Ct)|0,T=T+Math.imul(S,Ie)|0,v=v+Math.imul(S,Nt)|0,v=v+Math.imul(I,Ie)|0,N=N+Math.imul(I,Nt)|0;let p0=(ie+T|0)+((v&8191)<<13)|0;ie=(N+(v>>>13)|0)+(p0>>>26)|0,p0&=67108863,T=Math.imul(A,_e),v=Math.imul(A,Ct),v=v+Math.imul(W,_e)|0,N=Math.imul(W,Ct),T=T+Math.imul(h,Ie)|0,v=v+Math.imul(h,Nt)|0,v=v+Math.imul(_,Ie)|0,N=N+Math.imul(_,Nt)|0;let vt=(ie+T|0)+((v&8191)<<13)|0;ie=(N+(v>>>13)|0)+(vt>>>26)|0,vt&=67108863,T=Math.imul(A,Ie),v=Math.imul(A,Nt),v=v+Math.imul(W,Ie)|0,N=Math.imul(W,Nt);let gt=(ie+T|0)+((v&8191)<<13)|0;return ie=(N+(v>>>13)|0)+(gt>>>26)|0,gt&=67108863,s[0]=ot,s[1]=d0,s[2]=ct,s[3]=dt,s[4]=h0,s[5]=ht,s[6]=ut,s[7]=u0,s[8]=lt,s[9]=bt,s[10]=l0,s[11]=pt,s[12]=yt,s[13]=b0,s[14]=mt,s[15]=xt,s[16]=p0,s[17]=vt,s[18]=gt,ie!==0&&(s[19]=ie,t.length+=1),t}Math.imul||(Hh=Oh);D.Red=Tn;Mh.exports=D});var Mo=C((uI,Xh)=>{"use strict";Xh.exports=Gh()});var bu=C(wr=>{"use strict";var{custom:E0}=So(),H=Mo(),oi={AFFINE:0,JACOBIAN:1,PROJECTIVE:2,EXTENDED:3},fm=[-3,-1,-5,-7,0,7,5,1,3],Yh=!1,am=0,yr=class{constructor(e,t,i){this.Point=null,this.id=null,this.uid=am++,this.ossl=null,this.type="base",this.endian="be",this.hash=null,this.prefix=null,this.context=!1,this.prime=null,this.p=null,this.red=null,this.fieldSize=0,this.fieldBits=0,this.adjustedSize=0,this.signBit=0,this.mask=0,this.n=null,this.h=null,this.q=null,this.z=null,this.g=null,this.nh=null,this.scalarSize=0,this.scalarBits=0,this.zero=null,this.one=null,this.two=null,this.three=null,this.four=null,this.i2=null,this.i3=null,this.i4=null,this.i6=null,this.torsion=null,this.endo=null,this.hi=null,this._init(e,t,i)}_init(e,t,i){E(typeof e=="function"),E(typeof t=="string"),E(i&&typeof i=="object"),E(i.red==null||i.red instanceof H.Red),E(i.p!=null,"Must pass a prime."),E(i.id==null||typeof i.id=="string"),E(i.ossl==null||typeof i.ossl=="string"),E(i.endian==null||typeof i.endian=="string"),E(i.hash==null||typeof i.hash=="string"),E(i.prefix==null||typeof i.prefix=="string"),E(i.context==null||typeof i.context=="boolean"),E(i.prime==null||typeof i.prime=="string"),E(i.torsion==null||Array.isArray(i.torsion)),this.Point=e,this.id=i.id||null,this.ossl=i.ossl||null,this.type=t,this.endian=i.endian||(t==="short"?"be":"le"),this.hash=i.hash||null,this.prefix=i.prefix?Buffer.from(i.prefix,"binary"):null,this.context=i.context||!1,this.prime=i.prime||null,this.p=H.fromJSON(i.p),i.red?this.red=i.red:(this.red=i.prime?H.red(i.prime):H.mont(this.p),this.red.precompute()),this.fieldSize=this.p.byteLength(),this.fieldBits=this.p.bitLength(),this.adjustedSize=this.fieldSize+((this.fieldBits&7)==0),this.signBit=this.adjustedSize*8-1,this.mask=255,(this.fieldBits&7)!=0&&(this.mask=(1<<(this.fieldBits&7))-1),this.n=H.fromJSON(i.n||"0"),this.h=H.fromJSON(i.h||"1"),this.q=this.n.mul(this.h),this.z=H.fromJSON(i.z||"0").toRed(this.red),this.g=null,this.nh=this.n.ushrn(1),this.scalarSize=this.n.byteLength(),this.scalarBits=this.n.bitLength(),this.zero=new H(0).toRed(this.red),this.one=new H(1).toRed(this.red),this.two=new H(2).toRed(this.red),this.three=new H(3).toRed(this.red),this.four=new H(4).toRed(this.red),this.i2=this.two.redInvert(),this.i3=this.three.redInvert(),this.i4=this.i2.redSqr(),this.i6=this.i2.redMul(this.i3),this.torsion=new Array(this.h.word(0));for(let n=0;n<this.torsion.length;n++)this.torsion[n]=this.point();return this.endo=null,this.hi=null,this._scale=_o(this._scale,this),this.isIsomorphic=_o(this.isIsomorphic,this),this.isIsogenous=_o(this.isIsogenous,this),E(this.p.sign()>0&&this.p.isOdd()),E(this.n.sign()>=0),E(this.h.sign()>0&&this.h.cmpn(255)<=0),E(this.endian==="be"||this.endian==="le"),this}_finalize(e){if(E(e&&typeof e=="object"),this.g=e.g?this.pointFromJSON(e.g):this.point(),e.torsion){E(e.torsion.length===this.torsion.length);for(let t=0;t<this.torsion.length;t++)this.torsion[t]=this.pointFromJSON(e.torsion[t])}return this}_findTorsion(){E(!this.n.isZero());let e=this.h.word(0),t=this.one.redNeg(),i=[this.point()],n=new Set,s=e;for(;i.length<s;){let f;t.redIAdd(this.one);try{f=this.pointFromX(t.clone())}catch(a){continue}try{f=f.mul(this.n)}catch(a){s=2;continue}if(!f.isInfinity()){f.normalize();for(let a of[f,f.neg()]){let o=a.key();n.has(o)||(i.push(a),n.add(o))}}}for(i.sort((f,a)=>f.cmp(a));i.length<e;)i.push(this.point());return i}_fixedMul(e,t){E(e instanceof ft),E(t instanceof H),E(e.pre&&e.pre.windows);let{width:i,points:n}=e._getWindows(0,0),s=1<<i,a=(t.bitLength()+i-1)/i>>>0,o=this.jpoint();for(let c=0;c<a;c++){let d=t.bits(c*i,i);o=o.add(n[c*s+d])}return t.isNeg()&&(o=o.neg()),o}_fixedNafMul(e,t){E(e instanceof ft),E(t instanceof H),E(e.pre&&e.pre.doubles);let{step:i,points:n}=e._getDoubles(0,0),s=om(t,2,t.bitLength()+1,i),f=((1<<i+1)-(i%2==0?2:1))/3,a=this.jpoint(),o=this.jpoint();for(let c=f;c>0;c--){for(let d=0;d<s.length;d++){let u=s[d];u===c?o=o.add(n[d]):u===-c&&(o=o.sub(n[d]))}a=a.add(o)}return a}_wnafMul(e,t,i){E(t instanceof ft),E(i instanceof H);let{width:n,points:s}=t._safeNAF(e),f=Bf(i,n,i.bitLength()+1),a=this.jpoint();for(let o=f.length-1;o>=0;o--){let c=f[o];o!==f.length-1&&(a=a.dbl()),c>0?a=a.add(s[c-1>>1]):c<0&&(a=a.sub(s[-c-1>>1]))}return a}_wnafMulAdd(e,t,i){E(e>>>0===e),E(Array.isArray(t)),E(Array.isArray(i)),E(t.length===i.length);let n=t.length,s=new Array(n),f=new Array(n),a=0;for(let p=0;p<n;p++){let x=t[p],y=i[p];if(E(x instanceof ft),E(y instanceof H),p>0&&x.type!==t[p-1].type)throw new Error("Cannot mix points.");s[p]=null,f[p]=null,a=Math.max(a,y.bitLength()+1)}let o=null,c=null,d=0;for(let p=0;p<n;p++){let x=t[p],y=i[p],g=x._getNAF(0);if(g){s[d]=g.points,f[d]=Bf(y,g.width,a),d+=1;continue}if(!o){o=x,c=y;continue}s[d]=o._getJNAF(x),f[d]=cm(c,y,a),o=null,c=null,d+=1}if(o){let p=o._safeNAF(e);s[d]=p.points,f[d]=Bf(c,p.width,a),d+=1}let u=this.jpoint();for(let p=a-1;p>=0;p--){p!==a-1&&(u=u.dbl());for(let x=0;x<d;x++){let y=f[x][p];y>0?u=u.add(s[x][y-1>>1]):y<0&&(u=u.sub(s[x][-y-1>>1]))}}return u}_endoWnafMulAdd(e,t){throw new Error("Not implemented.")}_scale(e,t){switch(E(e instanceof yr),E(e.p.eq(this.p)),e.type){case"short":return this._scaleShort(e,t);case"mont":return this._scaleMont(e,t);case"edwards":return this._scaleEdwards(e,t);default:throw new Error("Not implemented.")}}_scaleShort(e,t){throw new Error("Not implemented.")}_scaleMont(e,t){throw new Error("Not implemented.")}_scaleEdwards(e,t){throw new Error("Not implemented.")}isElliptic(){throw new Error("Not implemented.")}jinv(){throw new Error("Not implemented.")}isComplete(){return!1}precompute(e){return E(!this.g.isInfinity(),"Must have base point."),E(!this.n.isZero(),"Must have order."),this.g.precompute(this.n.bitLength(),e),this}scalar(e,t,i){let n=new H(e,t,i);return E(!n.red),this.n.isZero()?n:n.imod(this.n)}field(e,t,i){let n=H.cast(e,t,i);return n.red?n.forceRed(this.red):n.toRed(this.red)}point(e,t){throw new Error("Not implemented.")}jpoint(e,t,i){throw new Error("Not implemented.")}xpoint(e,t){throw new Error("Not implemented.")}cpoint(e,t,i,n){if(E(e instanceof H),E(t instanceof H),E(i instanceof H),E(n instanceof H),t.isZero()||n.isZero())return this.point();let s=t.redMul(n).redInvert(),f=e.redMul(n).redMul(s),a=i.redMul(t).redMul(s);return this.point(f,a)}solveX2(e){throw new Error("Not implemented.")}solveX(e){return this.solveX2(e).redSqrt()}solveY2(e){throw new Error("Not implemented.")}solveY(e){return this.solveY2(e).redSqrt()}validate(e){throw new Error("Not implemented.")}pointFromX(e,t){throw new Error("Not implemented.")}pointFromY(e,t){throw new Error("Not implemented.")}isIsomorphic(e){throw new Error("Not implemented.")}isIsogenous(e){throw new Error("Not implemented.")}pointFromShort(e){throw new Error("Not implemented.")}pointFromMont(e,t){throw new Error("Not implemented.")}pointFromEdwards(e){throw new Error("Not implemented.")}pointFromUniform(e){throw new Error("Not implemented.")}pointToUniform(e){throw new Error("Not implemented.")}pointFromHash(e,t=!1){if(E(Buffer.isBuffer(e)),E(typeof t=="boolean"),e.length!==this.fieldSize*2)throw new Error("Invalid hash size.");let i=e.slice(0,this.fieldSize),n=e.slice(this.fieldSize),s=this.decodeUniform(i),f=this.decodeUniform(n),a=this.pointFromUniform(s),o=this.pointFromUniform(f),c=a.add(o);return t?c.mulH():c}pointToHash(e,t,i){E(e instanceof this.Point),E(t>>>0===t);let n=t%this.torsion.length,s=e.add(this.torsion[n]);for(;;){let f=this.randomField(i),a=this.pointFromUniform(f);if(a.neg().eq(a))continue;let o=s.sub(a),c=Zh(i),d;try{d=this.pointToUniform(o,c&15)}catch(x){if(x.message==="Invalid point.")continue;throw x}let u=this.encodeUniform(f,c>>>8),p=this.encodeUniform(d,c>>>16);return Buffer.concat([u,p])}}randomScalar(e){let t=this.n.isZero()?this.p:this.n;return H.random(e,1,t)}randomField(e){return H.random(e,1,this.p).toRed(this.red)}randomPoint(e){let t;for(;;){let i=this.randomField(e),n=(Zh(e)&1)!=0;try{t=this.pointFromX(i,n)}catch(s){continue}return E(t.validate()),t.mulH()}}mulAll(e,t){return this.jmulAll(e,t)}jmulAll(e,t){return E(Array.isArray(e)),E(e.length===0||e[0]instanceof ft),this.endo&&e.length>0&&e[0].type===oi.AFFINE?this._endoWnafMulAdd(e,t):this._wnafMulAdd(5,e,t)}mulH(e){return E(e instanceof H),this.imulH(e.clone())}imulH(e){E(e instanceof H),E(!e.red);let t=this.h.word(0);if((t&t-1)==0){let i=this.h.bitLength();return e.iushln(i-1).imod(this.n)}return e.imuln(t).imod(this.n)}normalizeAll(e){E(Array.isArray(e));let t=e.length,i=new Array(t);for(let f=0;f<t;f++){let a=e[f];if(E(a instanceof ft),E(a.curve===this),a.type===oi.AFFINE){i[f]=this.one;continue}i[f]=a.z}let n=this.red.invertAll(i),s=new Array(t);for(let f=0;f<t;f++)s[f]=e[f].scale(n[f]);return s}affinizeAll(e){return this.normalizeAll(e)}clamp(e){E(Buffer.isBuffer(e)),E(e.length===this.scalarSize),E(this.scalarSize<=this.fieldSize);let t=this.fieldBits&7||8,i=0,n=this.scalarSize-1;return this.endian==="be"&&([i,n]=[n,i]),this.scalarSize<this.fieldSize&&(t=8),e[i]&=-this.h.word(0)&255,e[n]&=(1<<t)-1,e[n]|=1<<t-1,e}splitHash(e){E(Buffer.isBuffer(e)),E(e.length===this.adjustedSize*2),E(this.scalarSize<=this.adjustedSize);let t=0;this.endian==="be"&&(t=this.adjustedSize-this.scalarSize);let i=e.slice(t,t+this.scalarSize),n=e.slice(this.adjustedSize);return this.clamp(i),[i,n]}encodeField(e){return E(e instanceof H),E(!e.red),e.encode(this.endian,this.fieldSize)}decodeField(e){if(E(Buffer.isBuffer(e)),e.length!==this.fieldSize)throw new Error("Invalid field element size.");return H.decode(e,this.endian)}encodeAdjusted(e){return E(e instanceof H),E(!e.red),e.encode(this.endian,this.adjustedSize)}decodeAdjusted(e){if(E(Buffer.isBuffer(e)),e.length!==this.adjustedSize)throw new Error("Invalid field element size.");return H.decode(e,this.endian)}encodeScalar(e){return E(e instanceof H),E(!e.red),e.encode(this.endian,this.scalarSize)}decodeScalar(e){if(E(Buffer.isBuffer(e)),e.length!==this.scalarSize)throw new Error("Invalid scalar size.");return H.decode(e,this.endian)}encodeClamped(e){return this.clamp(this.encodeScalar(e))}decodeClamped(e){if(E(Buffer.isBuffer(e)),e.length!==this.scalarSize)throw new Error("Invalid scalar size.");let t=this.clamp(Buffer.from(e));return H.decode(t,this.endian)}encodeUniform(e,t){E(e instanceof H),E(t>>>0===t);let i=this.endian==="le"?this.fieldSize-1:0,n=e.fromRed().encode(this.endian,this.fieldSize);return n[i]|=t&~this.mask&255,n}decodeUniform(e){if(E(Buffer.isBuffer(e)),e.length!==this.fieldSize)throw new Error("Invalid field size.");let t=H.decode(e,this.endian);return t.iumaskn(this.fieldBits),t.toRed(this.red)}encodePoint(e,t){return E(e instanceof ft),e.encode(t)}decodePoint(e){throw new Error("Not implemented.")}encodeX(e){throw new Error("Not implemented.")}decodeX(e){throw new Error("Not implemented.")}decodeEven(e){throw new Error("Not implemented.")}decodeSquare(e){throw new Error("Not implemented.")}toShort(){throw new Error("Not implemented.")}toMont(e){throw new Error("Not implemented.")}toEdwards(e){throw new Error("Not implemented.")}pointToJSON(e,t){return E(e instanceof ft),e.toJSON(t)}pointFromJSON(e){throw new Error("Not implemented.")}toJSON(e){let t,i,n,s,f;return this.type==="edwards"&&(t=this.prefix?this.prefix.toString():null,i=this.context),this.n.isZero()||(n=this.n.toJSON()),this.z.isZero()||(s=this.z.fromRed(),this.z.redIsHigh()&&s.isub(this.p),s=s.toString(16)),this.endo&&(f=this.endo.toJSON()),{id:this.id,ossl:this.ossl,type:this.type,endian:this.endian,hash:this.hash,prefix:t,context:i,prime:this.prime,p:this.p.toJSON(),a:void 0,b:void 0,d:void 0,n,h:this.h.toString(16),s:void 0,z:s,c:void 0,g:this.g.toJSON(e),endo:f}}static fromJSON(e){return new this(e)}},ft=class{constructor(e,t){E(e instanceof yr),E(t>>>0===t),this.curve=e,this.type=t,this.pre=null}_init(){throw new Error("Not implemented.")}_safeNAF(e){if(E(e>>>0===e),this.pre&&this.pre.naf)return this.pre.naf;if(e===0)return null;let t=1<<e-2,i=new Array(t),n=this.toJ(),s=t===1?null:n.dbl();i[0]=n;for(let f=1;f<t;f++)i[f]=i[f-1].add(s);return new qf(e,i)}_getNAF(e){if(E(e>>>0===e),this.pre&&this.pre.naf)return this.pre.naf;if(e===0)return null;let t=this._safeNAF(e).points,i=this.curve.affinizeAll(t);return new qf(e,i)}_getWindows(e,t){if(E(e>>>0===e),E(t>>>0===t),this.pre&&this.pre.windows)return this.pre.windows;if(e===0)return null;let i=1<<e,n=(t+e-1)/e>>>0,s=new Array(n*i),f=this.toJ();for(let o=0;o<n;o++){s[o*i]=this.curve.jpoint();for(let c=1;c<i;c++)s[o*i+c]=s[o*i+c-1].add(f);f=f.dblp(e)}let a=this.curve.affinizeAll(s);return new Io(e,t,a)}_getDoubles(e,t){if(E(e>>>0===e),E(t>>>0===t),this.pre&&this.pre.doubles)return this.pre.doubles;if(e===0)return null;let i=Math.ceil(t/e)+1,n=new Array(i),s=this.toJ(),f=0;n[f++]=s;for(let o=0;o<t;o+=e){for(let c=0;c<e;c++)s=s.dbl();n[f++]=s}E(f===i);let a=this.curve.affinizeAll(n);return new Ao(e,a)}_getBeta(){return null}_getBlinding(e){if(this.pre&&this.pre.blinding)return this.pre.blinding;if(!e||this.curve.n.isZero())return null;let t=this.curve.randomScalar(e),i=this.mul(t);return new Bo(t,i)}_hasWindows(e){if(E(e instanceof H),!this.pre||!this.pre.windows)return!1;let{width:t,bits:i}=this.pre.windows,n=(i+t-1)/t>>>0;return e.bitLength()<=n*t}_hasDoubles(e){if(E(e instanceof H),!this.pre||!this.pre.doubles)return!1;let{step:t,points:i}=this.pre.doubles,n=e.bitLength()+1;return i.length>=Math.ceil(n/t)+1}_getJNAF(e){return E(e instanceof ft),E(e.type===this.type),[this,this.add(e),this.sub(e),e]}_blind(e,t){if(E(e instanceof H),E(!e.red),this.pre&&this.pre.blinding){let{blind:n,unblind:s}=this.pre.blinding,f=e.sub(n);return[this,f,s]}if(!t)return[this,e,null];if(this.pre){if(this.curve.n.isZero())return[this,e,null];let f=this.curve.randomScalar(t).mul(this.curve.n).iadd(e);return[this,f,null]}return[this.randomize(t),e,null]}clone(){throw new Error("Not implemented.")}precompute(e,t){return E(e>>>0===e),this.pre||(this.pre=new kf),this.pre.naf||(this.pre.naf=this._getNAF(9)),Yh&&!this.pre.windows&&(this.pre.windows=this._getWindows(4,e)),this.pre.doubles||(this.pre.doubles=this._getDoubles(4,e+1)),this.pre.beta||(this.pre.beta=this._getBeta()),this.pre.blinding||(this.pre.blinding=this._getBlinding(t)),this}validate(){return this.curve.validate(this)}normalize(){return this}scale(e){throw new Error("Not implemented.")}randomize(e){let t=this.curve.randomField(e);return this.scale(t)}neg(){throw new Error("Not implemented.")}add(e){throw new Error("Not implemented.")}sub(e){return E(e instanceof ft),this.add(e.neg())}dbl(){throw new Error("Not implemented.")}dblp(e){E(e>>>0===e);let t=this;for(let i=0;i<e;i++)t=t.dbl();return t}diffAddDbl(e,t){throw new Error("Not implemented.")}getX(){throw new Error("Not implemented.")}getY(){throw new Error("Not implemented.")}eq(e){throw new Error("Not implemented.")}cmp(e){throw new Error("Not implemented.")}isInfinity(){throw new Error("Not implemented.")}isOrder2(){throw new Error("Not implemented.")}isOdd(){throw new Error("Not implemented.")}isEven(){throw new Error("Not implemented.")}isSquare(){throw new Error("Not implemented.")}eqX(e){throw new Error("Not implemented.")}eqR(e){throw new Error("Not implemented.")}isSmall(){return this.isInfinity()?!1:this.jmulH().isInfinity()}hasTorsion(){return this.isInfinity()?!1:!this.jmul(this.curve.n).isInfinity()}order(){let{h:e,n:t}=this.curve,i=this.toJ(),n=new H(1);for(;!i.isInfinity();){if(n.iaddn(1),n.cmp(e)>0){n=t.clone();break}i=i.add(this)}return n}mul(e){return this.jmul(e)}muln(e){return this.jmuln(e)}mulBlind(e,t){return this.jmulBlind(e,t)}mulAdd(e,t,i){return this.jmulAdd(e,t,i)}mulH(){return this.jmulH()}div(e){return this.jdiv(e)}divn(e){return this.jdivn(e)}divH(){return this.jdivH()}jmul(e){return Yh&&this._hasWindows(e)?this.curve._fixedMul(this,e):this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo&&this.type===oi.AFFINE?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(5,this,e)}jmuln(e){return E((e|0)===e),this.jmul(new H(e))}jmulBlind(e,t=null){let[i,n,s]=this._blind(e,t),f=i.jmul(n);return s?f.add(s):f}jmulAdd(e,t,i){return this.curve.endo&&this.type===oi.AFFINE?this.curve._endoWnafMulAdd([this,t],[e,i]):this.curve._wnafMulAdd(5,[this,t],[e,i])}jmulH(){let e=this.curve.h.word(0);if((e&e-1)==0){let t=this.curve.h.bitLength();return this.toJ().dblp(t-1)}return this.jmul(this.curve.h)}jdiv(e){return E(e instanceof H),E(!e.red),this.jmul(e.invert(this.curve.n))}jdivn(e){return E(!this.curve.n.isZero()),this.curve.h.cmpn(e)===0?this.jdivH():this.jdiv(new H(e))}jdivH(){return this.curve.n.isZero()?this.toJ():this.curve.h.cmpn(1)===0?this.toJ():(this.curve.hi===null&&(this.curve.hi=this.curve.h.invert(this.curve.n)),this.jmul(this.curve.hi))}toP(){return this.normalize()}toJ(){return this}toX(){return this}key(){if(this.isInfinity())return`${this.curve.uid}:oo`;this.normalize();let e=this.getX().toString(16),t=this.getY().toString(16);return`${this.curve.uid}:${e},${t}`}encode(e){throw new Error("Not implemented.")}static decode(e,t){throw new Error("Not implemented.")}encodeX(){throw new Error("Not implemented.")}static decodeX(e,t){throw new Error("Not implemented.")}static decodeEven(e,t){throw new Error("Not implemented.")}static decodeSquare(e,t){throw new Error("Not implemented.")}toJSON(e){throw new Error("Not implemented.")}static fromJSON(e,t){throw new Error("Not implemented.")}[E0](){return"<Point>"}},je=class extends yr{constructor(e){super(wt,"short",e);this.a=H.fromJSON(e.a).toRed(this.red),this.b=H.fromJSON(e.b).toRed(this.red),this.c=H.fromJSON(e.c||"0").toRed(this.red),this.ai=this.a.isZero()?this.zero:this.a.redInvert(),this.zi=this.z.isZero()?this.zero:this.z.redInvert(),this.zeroA=this.a.isZero(),this.threeA=this.a.eq(this.three.redNeg()),this.redN=this.n.toRed(this.red),this.pmodn=this.p.clone(),this.highOrder=this.n.cmp(this.p)>=0,this.smallGap=!1,this._finalize(e)}_finalize(e){return super._finalize(e),e.endo!=null?this.endo=ko.fromJSON(this,e.endo):this.endo=this._getEndomorphism(),this.n.isZero()||(this.pmodn=this.p.mod(this.n),this.smallGap=this.p.div(this.n).cmpn(1)<=0),this}static _isomorphism(e,t,i,n){if(E(e instanceof H),E(t instanceof H),E(i instanceof H),E(n==null||typeof n=="boolean"),E(!e.isZero()||!t.isZero()),i.isZero())throw new Error("Invalid coefficient.");if(e.isZero()){let u=i,p=u.redDiv(t),x=$h(p);return E(x.redJacobi()===1),[e.clone(),u.clone()]}if(t.isZero()){let u=i,x=u.redDiv(e).redSqrt();if(x.redJacobi()!==1&&x.redINeg(),x.redJacobi()!==1)throw new Error("Invalid `a` coefficient.");return[u.clone(),t.clone()]}let s=i,f=s.redDiv(e),a=f.redSqrt();if(n!=null?a.redIsOdd()!==n&&a.redINeg():a.redJacobi()!==1&&a.redINeg(),a.redJacobi()!==1)throw new Error("Invalid `a` coefficient.");let o=f.redMul(a),c=e.redMul(f),d=t.redMul(o);return E(c.eq(s)),[c,d]}_short(e,t){return je._isomorphism(this.a,this.b,e,t)}_mont(e,t){let[i,n]=this._findRS(t),s=n.redInvert(),f=i.redMuln(3).redMul(s);return e!=null?St._isomorphism(f,s,e):[f,s]}_edwards(e,t){let[i,n]=this._findRS(t),s=i.redMuln(3),f=n.redMuln(2),a=s.redAdd(f),o=s.redSub(f);return e!=null?Zt._isomorphism(a,o,e):[a,o]}_findRS(e){E(e==null||typeof e=="boolean"),E(this.h.word(0)>=4),E(!this.n.isZero());let t=this.one.redNeg(),i;for(;;){t.redIAdd(this.one);try{i=this.pointFromX(t.clone())}catch(a){continue}if(i=i.mul(this.n),!i.isInfinity()&&!!i.y.isZero())break}let n=i.x,f=n.redSqr().redMuln(3).redIAdd(this.a).redSqrt();return e!=null&&f.redIsOdd()!==e&&f.redINeg(),[n,f]}_scale0(e,t){if(E(this.a.isZero()===e.isZero()),E(this.b.isZero()===t.isZero()),this.a.isZero()){let o=this.b.redDiv(this.field(t)),c=$h(o),d=c.redSqrt(),u=c.redMul(d);return E(u.redSqr().eq(o)),E(!d.isZero()),[c,u]}if(this.b.isZero()){let o=this.a.redDiv(this.field(e)),c=o.redSqrt();c.redJacobi()!==1&&c.redINeg();let d=c.redSqrt(),u=c.redMul(d);return E(u.redMul(d).eq(o)),E(!d.isZero()),[c,u]}let i=this.a.redDiv(this.field(e)),n=this.b.redDiv(this.field(t)),s=i.redSqrt();i.redMul(s).eq(n)||s.redINeg(),E(i.redMul(s).eq(n));let f=s.redSqrt(),a=s.redMul(f);return E(!f.isZero()),[s,a]}_scale1(e,t){let i=this.g.x.redDiv(this.field(e)),n=this.g.y.redDiv(this.field(t)),s=i.redSqrt();return i.redMul(s).eq(n)||s.redINeg(),E(i.redMul(s).eq(n)),E(!s.isZero()),[i,n]}_scaleShort(e){return E(e instanceof je),this.g.isInfinity()||e.g.isInfinity()?this._scale0(e.a,e.b):this._scale1(e.g.x,e.g.y)}_scaleMont(e){if(E(e instanceof St),this.g.isInfinity()||e.g.isInfinity()){let[f,a]=e._short();return this._scale0(f,a)}let{x:t,y:i}=e.g,n=t.redAdd(e.a3).redMul(e.bi),s=i.redMul(e.bi);return this._scale1(n,s)}_scaleEdwards(e){if(E(e instanceof Zt),this.g.isInfinity()||e.g.isInfinity()){let[K,L]=e._short();return this._scale0(K,L)}let{x:t,y:i,z:n}=e.g,s=e.a.redMuln(5),f=e.d.redMuln(5),a=e.d.redSub(e.a),o=f.redSub(e.a),c=e.d.redSub(s),d=i.redAdd(n),u=i.redSub(n),p=o.redMul(i).redIAdd(c.redMul(n)),x=u.redMuln(12),y=a.redMul(d).redMul(n),g=u.redMul(t).redIMuln(4),M=x.redMul(g).redInvert(),k=p.redMul(g).redMul(M),R=y.redMul(x).redMul(M);return this._scale1(k,R)}_getEndomorphism(e=0){if(this.n.isZero()||this.g.isInfinity()||!this.zeroA||this.p.modrn(3)!==1||this.n.modrn(3)!==1)return null;let[t,i]=this._getEndoRoots(this.p),n=[t,i][e&1].toRed(this.red),[s,f]=this._getEndoRoots(this.n),a=this.point(this.g.x.redMul(n),this.g.y),o;this.g.mul(s).eq(a)?o=s:(E(this.g.mul(f).eq(a)),o=f);let c=this._getEndoBasis(o),d=this._getEndoPrecomp(c);return new ko(n,o,c,d)}_getEndoRoots(e){let t=e===this.p?this.red:H.mont(e),i=new H(2).toRed(t),n=new H(3).toRed(t),s=i.redInvert(),f=n.redNeg().redSqrt().redMul(s),a=f.redNeg(),o=f.redSub(s).fromRed(),c=a.redSub(s).fromRed();return[o,c].sort(H.cmp)}_getEndoBasis(e){let[t,i,n,s,f,a]=this._egcdSqrt(e),o=n,c=s.neg(),d=t.sqr().iadd(i.sqr()),u=f.sqr().iadd(a.sqr()),p,x;return d.cmp(u)<=0?(p=t,x=i.neg()):(p=f,x=a.neg()),[new Rn(o,c),new Rn(p,x)]}_egcdSqrt(e){E(e instanceof H),E(!e.red),E(e.sign()>0),E(this.n.sign()>0);let t=this.n.ushrn(this.n.bitLength()>>>1),i=e,n=this.n.clone(),s=new H(1),f=new H(0),a=new H(0),o=new H(1),c,d,u,p,x=0,y=0,g;for(;!i.isZero()&&x<2;){let R=n.quo(i),K=n.sub(R.mul(i)),L=a.sub(R.mul(s)),O=o.sub(R.mul(f));y===0&&K.cmp(t)<0&&(c=g,d=s,u=K,p=L,y=1),g=K,n=i,i=K,a=s,s=L,o=f,f=O,x+=y}return E(y!==0,"Could not find r < sqrt(n)."),[c,d,u,p,a,s]}_getEndoPrecomp(e){E(Array.isArray(e)),E(e.length===2),E(e[0]instanceof Rn),E(e[1]instanceof Rn);let[t,i]=e,n=t.a.mul(i.b).isub(t.b.mul(i.a)),s=n.bitLength(),f=s>=160;E(n.eq(this.n));let a=s+Math.ceil(s/2)+1,o,c;for(f&&(a-=a&63);a>s&&(o=i.b.ushln(a).divRound(n),c=t.b.ushln(a).divRound(n),!(o.ucmp(n)<0&&c.ucmp(n)<0));)f?a-=64:a-=1;if(a<=s)throw new Error("Could not calculate g1 and g2.");return[a,o,c]}_endoSplit(e){E(e instanceof H),E(!e.red),E(!this.n.isZero());let[t,i]=this.endo.basis,n=i.b.mul(e).divRound(this.n),s=t.b.neg().mul(e).divRound(this.n),f=n.mul(t.a),a=s.mul(i.a),o=n.ineg().mul(t.b),c=s.mul(i.b),d=e.sub(f).isub(a),u=o.isub(c);return[d,u]}_endoBeta(e){return E(e instanceof wt),[e,e._getBeta()]}_endoWnafMulAdd(e,t){E(Array.isArray(e)),E(Array.isArray(t)),E(e.length===t.length),E(this.endo!=null);let i=e.length,n=new Array(i*2),s=new Array(i*2);for(let f=0;f<i;f++){let[a,o]=this._endoBeta(e[f]),[c,d]=this._endoSplit(t[f]);n[f*2+0]=a,s[f*2+0]=c,n[f*2+1]=o,s[f*2+1]=d}return this._wnafMulAdd(5,n,s)}_sswu(e){let{b:t,z:i,ai:n,zi:s,one:f}=this,a=i.redSqr(),o=t.redNeg().redMul(n),c=t.redMul(s).redMul(n),d=e.redSqr(),u=d.redSqr(),p=a.redMul(u).redIAdd(i.redMul(d)),x=p.isZero()?p:p.redInvert(),y=x.isZero()?c:o.redMul(f.redAdd(x)),g=i.redMul(d).redMul(y),M=this.solveY2(y),k=this.solveY2(g),R=M.redIsSquare()|0,K=[y,g][R^1],L=[M,k][R^1].redSqrt();return L.redIsOdd()!==e.redIsOdd()&&L.redINeg(),this.point(K,L)}_sswui(e,t){let{a:i,b:n,z:s}=this,{x:f,y:a}=e,o=t&3,c=i.redSqr().redMul(f.redSqr()),d=i.redMul(n).redMul(f).redIMuln(2),u=n.redSqr().redMuln(3),p=i.redMul(f).redIAdd(n),x=c.redISub(d).redISub(u).redSqrt(),y=p.redSub(x).redINeg(),g=p.redAdd(x).redINeg(),M=p.redMul(s).redIMuln(2),k=n.redMul(s).redIMuln(2),R=[y,g][o&1],K=[M,k][o>>>1],L=R.redDivSqrt(K);return L.redIsOdd()!==a.redIsOdd()&&L.redINeg(),L}_svdwf(e){let{c:t,z:i,zi:n,i2:s,i3:f}=this,a=this.solveY2(i),o=f.redMul(n.redSqr()),c=e.redSqr(),d=c.redSqr(),u=c.redAdd(a),p=c.redMul(u),x=p.isZero()?p:p.redInvert(),y=d.redMul(x).redMul(t),g=u.redSqr().redMul(u),M=t.redSub(i).redMul(s).redISub(y),k=y.redSub(t.redAdd(i).redMul(s)),R=i.redSub(g.redMul(x).redMul(o)),K=this.solveY2(M),L=this.solveY2(k),O=this.solveY2(R),F=K.redJacobi()|1,G=L.redJacobi()|1,B=dm((F-1)*G,3),b=[M,k,R][B],m=[K,L,O][B];return[b,m]}_svdw(e){let[t,i]=this._svdwf(e),n=i.redSqrt();return n.redIsOdd()!==e.redIsOdd()&&n.redINeg(),this.point(t,n)}_svdwi(e,t){let{b:i,c:n,z:s,zero:f,two:a}=this,{x:o,y:c}=e,d=t&3,u=s.redSqr(),p=u.redMul(s),x=u.redSqr(),y=p.redAdd(i),g=y.redMuln(2),M=o.redSqr(),k=o.redMuln(2).redIAdd(s),R=o.redMul(u),K=n.redSub(k),L=n.redAdd(k),O=M.redMul(u).redIAdd(x).redIMuln(9),F=o.redMul(p).redIMuln(18),G=y.redMul(o.redSub(s)).redIMuln(12),b=(d>=2?O.redISub(F).redIAdd(G).redSqrt():f).redMul(s),m=p.redISub(R).redIMuln(3).redISub(g),w=y.redMul(K),S=y.redMul(L),I=m.redAdd(b),q=m.redSub(b),h=a,_=[w,S,I,q][d],l=[L,K,h,h][d],A=_.redDivSqrt(l),[W]=this._svdwf(A);if(!W.eq(o))throw new Error("Invalid point.");return A.redIsOdd()!==c.redIsOdd()&&A.redINeg(),A}isElliptic(){let{a:e,b:t}=this,n=e.redSqr().redMul(e);return!t.redSqr().redMuln(27).redIAdd(n.redMuln(4)).isZero()}jinv(){let{a:e,b:t}=this,n=e.redSqr().redMul(e),s=t.redSqr(),f=n.redMuln(4),a=f.redMuln(1728),o=s.redMuln(27).redIAdd(f);if(o.isZero())throw new Error("Curve is not elliptic.");return a.redDiv(o).fromRed()}point(e,t){return new wt(this,e,t)}jpoint(e,t,i){return new Pn(this,e,t,i)}solveX(e){if(E(e instanceof H),!this.a.isZero())throw new Error("Not implemented.");let i=e.redSqr().redSub(this.b);return jh(i)}solveY2(e){E(e instanceof H);let i=e.redSqr().redMul(e).redIAdd(this.b);return this.zeroA||(this.threeA?i.redIAdd(e.redMuln(-3)):i.redIAdd(this.a.redMul(e))),i}validate(e){if(E(e instanceof wt),e.inf)return!0;let{x:t,y:i}=e,n=this.solveY2(t);return i.redSqr().eq(n)}pointFromX(e,t=null){E(e instanceof H),E(t==null||typeof t=="boolean"),e.red||(e=e.toRed(this.red));let i=this.solveY(e);if(t!=null){if(this.h.cmpn(1)>0&&i.isZero()&&t)throw new Error("Invalid point.");i.redIsOdd()!==t&&i.redINeg()}return this.point(e,i)}pointFromY(e,t=0){E(e instanceof H),E(t>>>0===t),e.red||(e=e.toRed(this.red));let i=this.solveX(e);if(t>=i.length)throw new Error("Invalid X coordinate index.");let n=i[t];return this.point(n,e)}isIsomorphic(e){if(E(e instanceof yr),!e.p.eq(this.p))return!1;let t,i;try{[t,i]=this._scale(e)}catch(n){return!1}if(e.type==="short"){let n=this.field(e.a).redMul(t.redSqr()),s=this.field(e.b).redMul(i.redSqr());return this.a.eq(n)&&this.b.eq(s)}if(e.type==="mont"){let{a3:n,bi:s}=e,f=this.field(n.redMul(s)).redMul(t);return this.solveY2(f).isZero()}if(e.type==="edwards"){let n=this.field(e.ad6).redMul(t);return this.solveY2(n).isZero()}return!1}isIsogenous(e){return E(e instanceof yr),!1}pointFromShort(e){if(E(e instanceof wt),this.isIsomorphic(e.curve)){if(e.isInfinity())return this.point();let[t,i]=this._scale(e.curve),n=this.field(e.x),s=this.field(e.y),f=n.redMul(t),a=s.redMul(i);return this.point(f,a)}throw new Error("Not implemented.")}pointFromMont(e){if(E(e instanceof dr),this.isIsomorphic(e.curve)){if(e.isInfinity())return this.point();let{a3:t,bi:i}=e.curve,[n,s]=this._scale(e.curve),f=e.x.redAdd(t).redMul(i),a=e.y.redMul(i);return this.point(this.field(f).redMul(n),this.field(a).redMul(s))}throw new Error("Not implemented.")}pointFromEdwards(e){if(E(e instanceof hr),this.isIsomorphic(e.curve)){let{a:t,d:i,ad6:n}=e.curve,[s,f]=this._scale(e.curve);if(e.isInfinity())return this.point();if(e.x.isZero()){let O=this.field(n).redMul(s);return this.point(O,this.zero)}let{x:a,y:o,z:c}=e,d=t.redMuln(5),u=i.redMuln(5),p=i.redSub(t),x=u.redSub(t),y=i.redSub(d),g=o.redAdd(c),M=o.redSub(c),k=x.redMul(o).redIAdd(y.redMul(c)),R=M.redMuln(12),K=p.redMul(g).redMul(c),L=M.redMul(a).redIMuln(4);return this.cpoint(this.field(k).redMul(s),this.field(R),this.field(K).redMul(f),this.field(L))}throw new Error("Not implemented.")}pointFromUniform(e){if(E(e instanceof H),this.z.isZero()||this.b.isZero())throw new Error("Not implemented.");if(!this.a.isZero())return this._sswu(e);if(!this.c.isZero())return this._svdw(e);throw new Error("Not implemented.")}pointToUniform(e,t){if(E(e instanceof wt),E(t>>>0===t),this.z.isZero()||this.b.isZero())throw new Error("Not implemented.");if(e.isInfinity())throw new Error("Invalid point.");let i=(t>>>4&15)%this.torsion.length,n=e.add(this.torsion[i]);return Wh(()=>{if(!this.a.isZero())return this._sswui(n,t);if(!this.c.isZero())return this._svdwi(n,t);throw new Error("Not implemented.")})}mulAll(e,t){return super.mulAll(e,t).toP()}affinizeAll(e){let t=this.normalizeAll(e);for(let i=0;i<t.length;i++)t[i]=t[i].toP();return t}decodePoint(e){return wt.decode(this,e)}encodeX(e){return E(e instanceof ft),e.encodeX()}decodeEven(e){return wt.decodeEven(this,e)}decodeSquare(e){return wt.decodeSquare(this,e)}toShort(e,t,i=null){let[n,s]=this._short(e,t),f=new je({red:this.red,prime:this.prime,p:this.p,a:n,b:s,n:this.n,h:this.h});if(i!=null){let[,a]=f._scale(this);a.redIsOdd()!==i&&a.redINeg()}this.g.isInfinity()||(f.g=f.pointFromShort(this.g));for(let a=0;a<this.h.word(0);a++)f.torsion[a]=f.pointFromShort(this.torsion[a]);return f}toMont(e,t,i=null){let[n,s]=this._mont(e,t),f=new St({red:this.red,prime:this.prime,p:this.p,a:n,b:s,n:this.n,h:this.h});if(i!=null){let[,a]=this._scale(f);a.redIsOdd()!==i&&a.redINeg()}this.g.isInfinity()||(f.g=f.pointFromShort(this.g));for(let a=0;a<this.h.word(0);a++)f.torsion[a]=f.pointFromShort(this.torsion[a]);return f}toEdwards(e,t,i=null){let[n,s]=this._edwards(e,t),f=new Zt({red:this.red,prime:this.prime,p:this.p,a:n,d:s,n:this.n,h:this.h});if(i!=null){let[,a]=this._scale(f);a.redIsOdd()!==i&&a.redINeg()}if(this.g.isInfinity()||(f.g=f.pointFromShort(this.g),f.g.normalize()),f.isComplete())for(let a=0;a<this.h.word(0);a++)f.torsion[a]=f.pointFromShort(this.torsion[a]),f.torsion[a].normalize();return f}pointFromJSON(e){return wt.fromJSON(this,e)}toJSON(e){let t=super.toJSON(e);return t.a=this.a.fromRed().toJSON(),t.b=this.b.fromRed().toJSON(),this.c.isZero()||(t.c=this.c.fromRed().toJSON()),t}},wt=class extends ft{constructor(e,t,i){E(e instanceof je),super(e,oi.AFFINE),this.x=this.curve.zero,this.y=this.curve.zero,this.inf=!0,t!=null&&this._init(t,i)}_init(e,t){E(e instanceof H),E(t instanceof H),this.x=e,this.y=t,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1}_getBeta(){if(!this.curve.endo)return null;if(this.pre&&this.pre.beta)return this.pre.beta;let e=this.x.redMul(this.curve.endo.beta),t=this.curve.point(e,this.y);return this.pre&&(t.pre=this.pre.map(i=>{let n=i.x.redMul(this.curve.endo.beta);return this.curve.point(n,i.y)}),this.pre.beta=t),t}_getJNAF(e){if(E(e instanceof wt),this.inf||e.inf)return super._getJNAF(e);let t=[this,null,null,e];return this.y.eq(e.y)?(t[1]=this.add(e),t[2]=this.toJ().sub(e)):this.y.eq(e.y.redNeg())?(t[1]=this.toJ().add(e),t[2]=this.sub(e)):(t[1]=this.toJ().add(e),t[2]=this.toJ().sub(e)),t}clone(){return this.inf?this.curve.point():this.curve.point(this.x,this.y)}scale(e){return this.toJ().scale(e)}neg(){return this.inf?this:this.curve.point(this.x,this.y.redNeg())}add(e){if(E(e instanceof wt),this.inf)return e;if(e.inf)return this;if(this.x.eq(e.x))return this.y.eq(e.y)?this.dbl():this.curve.point();if(this.y.eq(e.y)){let a=this.x.redNeg().redISub(e.x),o=this.y.redNeg();return this.curve.point(a,o)}let t=this.x.redSub(e.x),n=this.y.redSub(e.y).redDiv(t),s=n.redSqr().redISub(this.x).redISub(e.x),f=n.redMul(this.x.redSub(s)).redISub(this.y);return this.curve.point(s,f)}dbl(){if(this.inf)return this;if(this.y.isZero())return this.curve.point();let t=this.x.redSqr().redIMuln(3).redIAdd(this.curve.a),i=this.y.redMuln(2),n=t.redDiv(i),s=n.redSqr().redISub(this.x).redISub(this.x),f=n.redMul(this.x.redSub(s)).redISub(this.y);return this.curve.point(s,f)}dblp(e){return this.toJ().dblp(e).toP()}getX(){if(this.inf)throw new Error("Invalid point.");return this.x.fromRed()}getY(){if(this.inf)throw new Error("Invalid point.");return this.y.fromRed()}eq(e){return E(e instanceof wt),this===e?!0:this.inf?e.inf:e.inf?!1:this.x.eq(e.x)&&this.y.eq(e.y)}cmp(e){return E(e instanceof wt),this.inf&&!e.inf?-1:!this.inf&&e.inf?1:this.inf&&e.inf?0:this.order().cmp(e.order())||this.getX().cmp(e.getX())||this.getY().cmp(e.getY())}isInfinity(){return this.inf}isOrder2(){return this.inf?!1:this.y.isZero()}isOdd(){return this.inf?!1:this.y.redIsOdd()}isEven(){return this.inf?!1:this.y.redIsEven()}isSquare(){return this.inf?!1:this.y.redJacobi()!==-1}eqX(e){return E(e instanceof H),E(!e.red),this.inf?!1:this.getX().eq(e)}eqR(e){return E(e instanceof H),E(!e.red),E(!this.curve.n.isZero()),this.inf?!1:this.getX().imod(this.curve.n).eq(e)}mul(e){return super.mul(e).toP()}muln(e){return super.muln(e).toP()}mulBlind(e,t){return super.mulBlind(e,t).toP()}mulAdd(e,t,i){return super.mulAdd(e,t,i).toP()}mulH(){return super.mulH().toP()}div(e){return super.div(e).toP()}divn(e){return super.divn(e).toP()}divH(){return super.divH().toP()}toP(){return this}toJ(){return this.inf?this.curve.jpoint():this.curve.jpoint(this.x,this.y,this.curve.one)}encode(e){e==null&&(e=!0),E(typeof e=="boolean");let{fieldSize:t}=this.curve;if(this.inf)throw new Error("Invalid point.");if(e){let f=Buffer.alloc(1+t),a=this.curve.encodeField(this.getX());return f[0]=2|this.y.redIsOdd(),a.copy(f,1),f}let i=Buffer.alloc(1+t*2),n=this.curve.encodeField(this.getX()),s=this.curve.encodeField(this.getY());return i[0]=4,n.copy(i,1),s.copy(i,1+t),i}static decode(e,t){E(e instanceof je),E(Buffer.isBuffer(t));let i=e.fieldSize;if(t.length<1+i)throw new Error("Not a point.");let n=t[0];switch(n){case 2:case 3:{if(t.length!==1+i)throw new Error("Invalid point size for compressed.");let s=e.decodeField(t.slice(1,1+i));if(s.cmp(e.p)>=0)throw new Error("Invalid point.");let f=e.pointFromX(s,n===3);return E(!f.isInfinity()),f}case 4:case 6:case 7:{if(t.length!==1+i*2)throw new Error("Invalid point size for uncompressed.");let s=e.decodeField(t.slice(1,1+i)),f=e.decodeField(t.slice(1+i,1+2*i));if(s.cmp(e.p)>=0||f.cmp(e.p)>=0)throw new Error("Invalid point.");if(n!==4&&n!==(6|f.isOdd()))throw new Error("Invalid hybrid encoding.");let a=e.point(s,f);if(!a.validate())throw new Error("Invalid point.");return E(!a.isInfinity()),a}default:throw new Error("Unknown point format.")}}encodeX(){return this.curve.encodeField(this.getX())}static decodeEven(e,t){E(e instanceof je);let i=e.decodeField(t);if(i.cmp(e.p)>=0)throw new Error("Invalid point.");return e.pointFromX(i,!1)}static decodeSquare(e,t){E(e instanceof je);let i=e.decodeField(t);if(i.cmp(e.p)>=0)throw new Error("Invalid point.");return e.pointFromX(i)}toJSON(e){if(this.inf)return[];let t=this.getX().toJSON(),i=this.getY().toJSON();return e===!0&&this.pre?[t,i,this.pre.toJSON()]:[t,i]}toPretty(){if(this.inf)return[];let e=this.curve.fieldSize*2,t=M0(this.getX(),e),i=M0(this.getY(),e);return[t,i]}static fromJSON(e,t){if(E(e instanceof je),E(Array.isArray(t)),E(t.length===0||t.length===2||t.length===3),t.length===0)return e.point();let i=H.fromJSON(t[0]),n=H.fromJSON(t[1]),s=e.point(i,n);return t.length>2&&t[2]!=null&&(s.pre=kf.fromJSON(s,t[2])),s}[E0](){return this.inf?"<ShortPoint: Infinity>":"<ShortPoint: x="+this.x.fromRed().toString(16,2)+" y="+this.y.fromRed().toString(16,2)+">"}},Pn=class extends ft{constructor(e,t,i,n){E(e instanceof je),super(e,oi.JACOBIAN),this.x=this.curve.one,this.y=this.curve.one,this.z=this.curve.zero,this.zOne=!1,t!=null&&this._init(t,i,n)}_init(e,t,i){E(e instanceof H),E(t instanceof H),E(i==null||i instanceof H),this.x=e,this.y=t,this.z=i||this.curve.one,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z.eq(this.curve.one)}clone(){return this.curve.jpoint(this.x,this.y,this.z)}validate(){let{a:e,b:t}=this.curve;if(this.isInfinity())return!0;if(this.zOne)return this.curve.validate(this.toP());let i=this.y.redSqr(),n=this.x.redSqr().redMul(this.x),s=this.z.redSqr(),f=s.redSqr(),a=f.redMul(s),o=n.redIAdd(t.redMul(a));return this.curve.zeroA||(this.curve.threeA?o.redIAdd(f.redIMuln(-3).redMul(this.x)):o.redIAdd(e.redMul(f).redMul(this.x))),i.eq(o)}normalize(){if(this.zOne)return this;if(this.isInfinity())return this;let e=this.z.redInvert(),t=e.redSqr();return this.x=this.x.redMul(t),this.y=this.y.redMul(t).redMul(e),this.z=this.curve.one,this.zOne=!0,this}scale(e){if(E(e instanceof H),this.isInfinity())return this.curve.jpoint();let t=e.redSqr(),i=this.x.redMul(t),n=this.y.redMul(t).redMul(e),s=this.z.redMul(e);return this.curve.jpoint(i,n,s)}neg(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)}add(e){return E(e instanceof ft),e.type===oi.AFFINE?this._mixedAdd(e):this._add(e)}_add(e){return E(e instanceof Pn),this.isInfinity()?e:e.isInfinity()?this:this.zOne?e._addJA(this):e.zOne?this._addJA(e):this._addJJ(e)}_mixedAdd(e){return E(e instanceof wt),this.isInfinity()?e.toJ():e.isInfinity()?this:this._addJA(e)}_addJJ(e){let t=this.z.redSqr(),i=e.z.redSqr(),n=this.x.redMul(i),s=e.x.redMul(t),f=this.y.redMul(e.z).redMul(i),a=e.y.redMul(this.z).redMul(t),o=s.redISub(n),c=a.redISub(f);if(o.isZero())return c.isZero()?this.dbl():this.curve.jpoint();let d=o.redSqr(),u=o.redMul(d),p=n.redMul(d),x=c.redSqr().redISub(u).redISub(p).redISub(p),y=c.redMul(p.redISub(x)).redISub(f.redMul(u)),g=this.z.redMul(e.z).redMul(o);return this.curve.jpoint(x,y,g)}_addJA(e){let t=this.z.redSqr(),i=e.x.redMul(t),n=e.y.redMul(this.z).redMul(t),s=i.redISub(this.x),f=n.redISub(this.y).redIMuln(2);if(s.isZero())return f.isZero()?this.dbl():this.curve.jpoint();let a=s.redMuln(2).redSqr(),o=s.redMul(a),c=this.x.redMul(a),d=f.redSqr().redISub(o).redISub(c).redISub(c),u=f.redMul(c.redISub(d)).redISub(this.y.redMul(o).redIMuln(2)),p=this.z.redMul(s).redIMuln(2);return this.curve.jpoint(d,u,p)}dbl(){return this.isInfinity()?this:this.y.isZero()?this.curve.jpoint():this.curve.zeroA?this._dbl0():this.curve.threeA?this._dbl3():this._dblJ()}_dblJ(){let e=this.x.redSqr(),t=this.y.redSqr(),i=this.z.redSqr(),n=this.x.redMul(t).redIMuln(4),s=e.redIMuln(3).redIAdd(this.curve.a.redMul(i.redSqr())),f=s.redSqr().redISub(n).redISub(n),a=f,o=s.redMul(n.redISub(f)).redISub(t.redSqr().redIMuln(8)),c=this.y.redMul(this.z).redIMuln(2);return this.curve.jpoint(a,o,c)}_dbl0(){let e=this.x.redSqr(),t=this.y.redSqr(),i=t.redSqr(),s=t.redIAdd(this.x).redSqr().redISub(e).redISub(i).redIMuln(2),f=e.redIMuln(3),o=f.redSqr().redISub(s).redISub(s),c=f.redMul(s.redISub(o)).redISub(i.redIMuln(8)),d=this.y.redMul(this.z).redIMuln(2);return this.curve.jpoint(o,c,d)}_dbl3(){let e=this.z.redSqr(),t=this.y.redSqr(),i=this.x.redMul(t),n=this.x.redSub(e),s=this.x.redAdd(e),f=n.redMul(s).redIMuln(3),a=i.redIMuln(4),o=a.redMuln(2),c=t.redSqr().redIMuln(8),d=f.redSqr().redISub(o),u=this.y.redAdd(this.z).redSqr().redISub(t).redISub(e),p=f.redMul(a.redISub(d)).redISub(c);return this.curve.jpoint(d,p,u)}getX(){if(this.isInfinity())throw new Error("Invalid point.");return this.normalize(),this.x.fromRed()}getY(){if(this.isInfinity())throw new Error("Invalid point.");return this.normalize(),this.y.fromRed()}eq(e){if(E(e instanceof Pn),this===e)return!0;if(this.isInfinity())return e.isInfinity();if(e.isInfinity())return!1;if(this.z.eq(e.z))return this.x.eq(e.x)&&this.y.eq(e.y);let t=this.z.redSqr(),i=e.z.redSqr(),n=this.x.redMul(i),s=e.x.redMul(t);if(!n.eq(s))return!1;let f=t.redMul(this.z),a=i.redMul(e.z),o=this.y.redMul(a),c=e.y.redMul(f);return o.eq(c)}cmp(e){E(e instanceof Pn);let t=this.isInfinity(),i=e.isInfinity();return t&&!i?-1:!t&&i?1:t&&i?0:this.order().cmp(e.order())||this.getX().cmp(e.getX())||this.getY().cmp(e.getY())}isInfinity(){return this.z.isZero()}isOrder2(){return this.isInfinity()?!1:this.y.isZero()}isOdd(){return this.isInfinity()?!1:(this.normalize(),this.y.redIsOdd())}isEven(){return this.isInfinity()?!1:(this.normalize(),this.y.redIsEven())}isSquare(){return this.isInfinity()?!1:this.y.redMul(this.z).redJacobi()!==-1}eqX(e){if(E(e instanceof H),E(!e.red),this.isInfinity())return!1;let t=this.z.redSqr(),i=e.toRed(this.curve.red).redMul(t);return this.x.eq(i)}eqR(e){if(E(e instanceof H),E(!e.red),!this.curve.smallGap)return this.toP().eqR(e);if(this.isInfinity()||e.cmp(this.curve.p)>=0)return!1;let t=this.z.redSqr(),i=e.toRed(this.curve.red).redMul(t);if(this.x.eq(i))return!0;if(this.curve.highOrder||e.cmp(this.curve.pmodn)>=0)return!1;let n=this.curve.redN.redMul(t);return i.redIAdd(n),this.x.eq(i)}toP(){return this.isInfinity()?this.curve.point():(this.normalize(),this.curve.point(this.x,this.y))}toJ(){return this}encode(e){return this.toP().encode(e)}static decode(e,t){return wt.decode(e,t).toJ()}encodeX(){return this.toP().encodeX()}static decodeEven(e,t){return wt.decodeEven(e,t).toJ()}static decodeSquare(e,t){return wt.decodeSquare(e,t).toJ()}toJSON(e){return this.toP().toJSON(e)}toPretty(){return this.toP().toPretty()}static fromJSON(e,t){return wt.fromJSON(e,t).toJ()}[E0](){return this.isInfinity()?"<JPoint: Infinity>":"<JPoint: x="+this.x.fromRed().toString(16,2)+" y="+this.y.fromRed().toString(16,2)+" z="+this.z.fromRed().toString(16,2)+">"}},St=class extends yr{constructor(e){super(dr,"mont",e);this.a=H.fromJSON(e.a).toRed(this.red),this.b=H.fromJSON(e.b).toRed(this.red),this.bi=this.b.redInvert(),this.a2=this.a.redAdd(this.two),this.a24=this.a2.redMul(this.i4),this.a3=this.a.redMul(this.i3),this.a0=this.a.redMul(this.bi),this.b0=this.bi.redSqr(),this._finalize(e)}static _isomorphism(e,t,i){E(e instanceof H),E(t instanceof H),E(i instanceof H);let n=e.clone(),s=i.clone();if(t.redDiv(i).redJacobi()!==1)throw new Error("Invalid `b` coefficient.");return[n,s]}_short(e,t){let{a:i,b:n,three:s}=this,f=i.redSqr(),a=f.redMul(i),o=n.redSqr(),c=o.redMul(n),d=s.redSub(f),u=o.redMuln(3),p=a.redMuln(2).redISub(i.redMuln(9)),x=c.redMuln(27),y=d.redDiv(u),g=p.redDiv(x);return e!=null?je._isomorphism(y,g,e,t):[y,g]}_mont(e){return St._isomorphism(this.a,this.b,e)}_edwards(e,t=!1){E(typeof t=="boolean");let{two:i,bi:n}=this,s=this.a.redAdd(i).redMul(n),f=this.a.redSub(i).redMul(n);return t&&s.swap(f),e!=null?Zt._isomorphism(s,f,e):[s,f]}_scaleShort(e){E(e instanceof je);let[t,i]=e._scale(this);return[this.field(t.redInvert()),this.field(i.redInvert())]}_scaleMont(e){return E(e instanceof St),this.g.isInfinity()||e.g.isInfinity()?this.field(e.b).redDivSqrt(this.b):this.g.y.redDiv(this.field(e.g.y))}_scaleEdwards(e,t){E(e instanceof Zt);let i=e._scale(this,t);return this.field(i)}_solveY0(e){E(e instanceof H);let t=this.a0,i=this.b0,n=e.redSqr();return n.redMul(e).redIAdd(t.redMul(n)).redIAdd(i.redMul(e))}_elligator2(e){let t=this.a0.redNeg(),i=this.one.redAdd(this.z.redMul(e.redSqr()));i.isZero()&&i.inject(this.one);let n=t.redMul(i.redInvert()),s=n.redNeg().redISub(this.a0),f=this._solveY0(n),a=this._solveY0(s),o=f.redIsSquare()|0,c=[n,s][o^1],d=[f,a][o^1].redSqrt();d.redIsOdd()!==e.redIsOdd()&&d.redINeg();let u=this.b.redMul(c),p=this.b.redMul(d);return this.point(u,p)}_invert2(e,t){let{x:i,y:n}=e,s=t&1,f=i.redMul(this.bi),a=n.redMul(this.bi),o=f.redAdd(this.a0),c=f,d=[o,c][s].redINeg(),u=[c,o][s].redMul(this.z),p=d.redDivSqrt(u);return p.redIsOdd()!==a.redIsOdd()&&p.redINeg(),p}isElliptic(){let e=this.a.redSqr();return!this.b.redMul(e.redSub(this.four)).isZero()}jinv(){let{a:e,three:t,four:i}=this,n=e.redSqr(),f=n.redSub(t).redPown(3).redIMuln(256),a=n.redSub(i);if(a.isZero())throw new Error("Curve is not elliptic.");return f.redDiv(a).fromRed()}point(e,t){return new dr(this,e,t)}jpoint(e,t,i){return E(e==null&&t==null&&i==null),this.point()}xpoint(e,t){return new ci(this,e,t)}solveY2(e){E(e instanceof H);let t=e.redSqr();return t.redMul(e).redIAdd(this.a.redMul(t)).redIAdd(e).redMul(this.bi)}validate(e){if(E(e instanceof dr),e.isInfinity())return!0;let{x:t,y:i}=e,n=this.solveY2(t);return i.redSqr().eq(n)}pointFromX(e,t=null){E(e instanceof H),E(t==null||typeof t=="boolean"),e.red||(e=e.toRed(this.red));let i=this.solveY(e);if(t!=null){if(i.isZero()&&t)throw new Error("Invalid point.");i.redIsOdd()!==t&&i.redINeg()}return this.point(e,i)}isIsomorphic(e,t){if(E(e instanceof yr),!e.p.eq(this.p))return!1;if(e.type==="mont"){let i=this.field(e.a),n=this.field(e.b);return!this.a.eq(i)||this.b.isZero()?!1:n.redDiv(this.b).redJacobi()===1}return e.isIsomorphic(this,t)}isIsogenous(e){return E(e instanceof yr),e.type==="mont"?!1:e.isIsogenous(this)}pointFromShort(e){if(E(e instanceof wt),this.isIsomorphic(e.curve)){if(e.isInfinity())return this.point();let{a3:t,b:i}=this,[n,s]=this._scale(e.curve),f=this.field(e.x).redMul(n),a=this.field(e.y).redMul(s),o=i.redMul(f).redISub(t),c=i.redMul(a);return this.point(o,c)}throw new Error("Not implemented.")}pointFromMont(e){if(E(e instanceof dr),this.isIsomorphic(e.curve)){if(e.isInfinity())return this.point();let t=this._scale(e.curve),i=this.field(e.x),n=this.field(e.y),s=i,f=t.redMul(n);return this.point(s,f)}throw new Error("Not implemented.")}pointFromEdwards(e){E(e instanceof hr),E(e.curve.p.eq(this.p));let t=this.field(e.x),i=this.field(e.y),n=this.field(e.z);if(this.isIsogenous(e.curve)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point(this.zero,this.zero);let s=n.redSqr().redIMuln(2),f=i.redSqr(),a=t.redSqr(),o=s.redISub(a).redISub(f).redMul(i),c=a.redMul(t);return this.cpoint(f,a,o,c)}if(this.isIsomorphic(e.curve,!0)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point(this.zero,this.zero);let s=this._scale(e.curve,!0),f=i.redAdd(n),a=i.redSub(n),o=s.redMul(n).redMul(f),c=t.redMul(a);return this.cpoint(f,a,o,c)}if(this.isIsomorphic(e.curve,!1)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point(this.zero,this.zero);let s=this._scale(e.curve,!1),f=n.redAdd(i),a=n.redSub(i),o=s.redMul(n).redMul(f),c=t.redMul(a);return this.cpoint(f,a,o,c)}throw new Error("Not implemented.")}pointFromUniform(e){if(E(e instanceof H),this.z.isZero()||this.a.isZero())throw new Error("Not implemented.");return this._elligator2(e)}pointToUniform(e,t){if(E(e instanceof dr),E(t>>>0===t),this.z.isZero()||this.a.isZero())throw new Error("Not implemented.");if(e.isInfinity())throw new Error("Invalid point.");let i=(t>>>4&15)%this.torsion.length,n=e.add(this.torsion[i]);return Wh(()=>this._invert2(n,t))}decodePoint(e,t){return dr.decode(this,e,t)}encodeX(e){return E(e instanceof ci),e.encode()}decodeX(e){return ci.decode(this,e)}toShort(e,t,i=null){let[n,s]=this._short(e,t),f=new je({red:this.red,prime:this.prime,p:this.p,a:n,b:s,n:this.n,h:this.h});if(i!=null){let[,a]=f._scale(this);a.redIsOdd()!==i&&a.redINeg()}this.g.isInfinity()||(f.g=f.pointFromMont(this.g));for(let a=0;a<this.h.word(0);a++)f.torsion[a]=f.pointFromMont(this.torsion[a]);return f}toMont(e,t=null){let[i,n]=this._mont(e),s=new St({red:this.red,prime:this.prime,p:this.p,a:i,b:n,n:this.n,h:this.h,z:this.z});if(t!=null){let f=s._scale(this);f.redIsOdd()!==t&&f.redINeg()}this.g.isInfinity()||(s.g=s.pointFromMont(this.g));for(let f=0;f<this.h.word(0);f++)s.torsion[f]=s.pointFromMont(this.torsion[f]);return s}toEdwards(e,t,i=null){let[n,s]=this._edwards(e,t),f=new Zt({red:this.red,prime:this.prime,p:this.p,a:n,d:s,n:this.n,h:this.h,z:this.z});if(i!=null){let a=f._scale(this,t);a.redIsOdd()!==i&&a.redINeg()}if(this.g.isInfinity()||(f.g=f.pointFromMont(this.g),f.g.normalize()),f.isComplete())for(let a=0;a<this.h.word(0);a++)f.torsion[a]=f.pointFromMont(this.torsion[a]),f.torsion[a].normalize();return f}pointFromJSON(e){return dr.fromJSON(this,e)}toJSON(e){let t=super.toJSON(e);return t.a=this.a.fromRed().toJSON(),t.b=this.b.fromRed().toJSON(),t}},dr=class extends ft{constructor(e,t,i){E(e instanceof St),super(e,oi.AFFINE),this.x=this.curve.zero,this.y=this.curve.zero,this.inf=!0,t!=null&&this._init(t,i)}_init(e,t){E(e instanceof H),E(t instanceof H),this.x=e,this.y=t,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1}clone(){return this.inf?this.curve.point():this.curve.point(this.x,this.y)}scale(e){return this.clone()}randomize(e){return this.clone()}neg(){return this.inf?this:this.curve.point(this.x,this.y.redNeg())}add(e){if(E(e instanceof dr),this.inf)return e;if(e.inf)return this;if(this.x.eq(e.x))return this.y.eq(e.y)?this.dbl():this.curve.point();let t=e.x.redSub(this.x),n=e.y.redSub(this.y).redDiv(t),f=this.curve.b.redMul(n.redSqr()).redISub(this.curve.a).redISub(this.x).redISub(e.x),a=n.redMul(this.x.redSub(f)).redISub(this.y);return this.curve.point(f,a)}dbl(){if(this.inf)return this;if(this.y.isZero())return this.curve.point();let e=this.x.redSqr().redIMuln(3),t=this.curve.a.redMul(this.x).redIMuln(2),i=e.redIAdd(t).redIAdd(this.curve.one),n=this.curve.b.redMul(this.y).redIMuln(2),s=i.redDiv(n),a=this.curve.b.redMul(s.redSqr()).redISub(this.curve.a).redISub(this.x).redISub(this.x),o=s.redMul(this.x.redSub(a)).redISub(this.y);return this.curve.point(a,o)}getX(){if(this.inf)throw new Error("Invalid point.");return this.x.fromRed()}getY(){if(this.inf)throw new Error("Invalid point.");return this.y.fromRed()}eq(e){return E(e instanceof dr),this===e?!0:this.inf?e.inf:e.inf?!1:this.x.eq(e.x)&&this.y.eq(e.y)}cmp(e){return E(e instanceof dr),this.inf&&!e.inf?-1:!this.inf&&e.inf?1:this.inf&&e.inf?0:this.order().cmp(e.order())||this.getX().cmp(e.getX())||this.getY().cmp(e.getY())}isInfinity(){return this.inf}isOrder2(){return this.inf?!1:this.y.isZero()}isOdd(){return this.inf?!1:this.y.redIsOdd()}isEven(){return this.inf?!1:this.y.redIsEven()}toP(){return this}toJ(){return this}toX(){return this.inf?this.curve.xpoint():this.curve.xpoint(this.x,this.curve.one)}encode(){return this.toX().encode()}static decode(e,t,i){return E(e instanceof St),e.decodeX(t).toP(i)}toJSON(e){if(this.inf)return[];let t=this.getX().toJSON(),i=this.getY().toJSON();return[t,i]}toPretty(){if(this.inf)return[];let e=this.curve.fieldSize*2,t=M0(this.getX(),e),i=M0(this.getY(),e);return[t,i]}static fromJSON(e,t){if(E(e instanceof St),E(Array.isArray(t)),E(t.length===0||t.length===2||t.length===3),t.length===0)return e.point();let i=H.fromJSON(t[0]),n=H.fromJSON(t[1]);return e.point(i,n)}[E0](){return this.inf?"<MontPoint: Infinity>":"<MontPoint: x="+this.x.fromRed().toString(16,2)+" y="+this.y.fromRed().toString(16,2)+">"}},ci=class extends ft{constructor(e,t,i){E(e instanceof St),super(e,oi.PROJECTIVE),this.x=this.curve.one,this.z=this.curve.zero,t!=null&&this._init(t,i)}_init(e,t){E(e instanceof H),E(t==null||t instanceof H),this.x=e,this.z=t||this.curve.one,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red))}clone(){return this.curve.xpoint(this.x,this.z)}precompute(e,t){return this}validate(){if(this.isInfinity())return!0;let{x:e,z:t}=this,i=e.redSqr(),n=i.redMul(e),s=t.redSqr(),f=this.curve.a.redMul(i).redMul(t);return n.redIAdd(f).redIAdd(e.redMul(s)).redMul(this.curve.bi).redMul(t).redJacobi()!==-1}normalize(){return this.isInfinity()?this:this.z.eq(this.curve.one)?this:(this.x=this.x.redDiv(this.z),this.z=this.curve.one,this)}scale(e){if(E(e instanceof H),this.isInfinity())return this.curve.xpoint();let t=this.x.redMul(e),i=this.z.redMul(e);return this.curve.xpoint(t,i)}neg(){return this}dbl(){let t=this.x.redAdd(this.z).redSqr(),n=this.x.redSub(this.z).redSqr(),s=t.redSub(n),f=t.redMul(n),a=s.redMul(n.redIAdd(this.curve.a24.redMul(s)));return this.curve.xpoint(f,a)}diffAddDbl(e,t){E(e instanceof ci),E(t instanceof ci);let i=e.x.redAdd(e.z),n=i.redSqr(),s=e.x.redSub(e.z),f=s.redSqr(),a=n.redSub(f),o=t.x.redAdd(t.z),d=t.x.redSub(t.z).redMul(i),u=o.redMul(s),p=this.z.redMul(d.redAdd(u).redSqr()),x=this.x.redMul(d.redISub(u).redSqr()),y=n.redMul(f),g=a.redMul(f.redIAdd(this.curve.a24.redMul(a)));return[this.curve.xpoint(y,g),this.curve.xpoint(p,x)]}getX(){if(this.isInfinity())throw new Error("Invalid point.");return this.normalize(),this.x.fromRed()}getY(e){return this.toP(e).getY()}eq(e){if(E(e instanceof ci),this===e)return!0;if(this.isInfinity())return e.isInfinity();if(e.isInfinity())return!1;if(this.z.eq(e.z))return this.x.eq(e.x);let t=this.x.redMul(e.z),i=e.x.redMul(this.z);return t.eq(i)}cmp(e){E(e instanceof ci);let t=this.isInfinity(),i=e.isInfinity();return t&&!i?-1:!t&&i?1:t&&i?0:this.order().cmp(e.order())||this.getX().cmp(e.getX())}isInfinity(){return this.z.isZero()}isOrder2(){return this.isInfinity()?!1:this.x.isZero()}isOdd(){return!1}isEven(){return!1}hasTorsion(){return this.isInfinity()?!1:this.x.isZero()?!0:super.hasTorsion()}order(){try{return this.toP().order()}catch(e){return new H(1)}}jmul(e){E(e instanceof H),E(!e.red);let t=e.bitLength(),i=this.curve.xpoint(),n=this;for(let s=t-1;s>=0;s--)e.bit(s)===0?[i,n]=this.diffAddDbl(i,n):[n,i]=this.diffAddDbl(n,i);return i}jmulBlind(e,t){return t?this.randomize(t).jmul(e):this.jmul(e)}jmulAdd(e,t,i){throw new Error("Not implemented.")}toP(e=null){return E(e==null||typeof e=="boolean"),this.isInfinity()?this.curve.point():(this.normalize(),this.curve.pointFromX(this.x,e))}toJ(){return this}toX(){return this}key(){if(this.isInfinity())return`${this.curve.uid}:oo`;this.normalize();let e=this.getX().toString(16);return`${this.curve.uid}:${e}`}encode(){return this.curve.encodeField(this.getX())}static decode(e,t){E(e instanceof St);let i=e.decodeField(t);i.iumaskn(e.fieldBits);let n=e.xpoint(i,e.one);return E(!n.isInfinity()),n}toJSON(e){return this.toP().toJSON(e)}toPretty(){return this.toP().toPretty()}static fromJSON(e,t){return dr.fromJSON(e,t).toX()}[E0](){return this.isInfinity()?"<XPoint: Infinity>":"<XPoint: x="+this.x.fromRed().toString(16,2)+" z="+this.z.fromRed().toString(16,2)+">"}},Zt=class extends yr{constructor(e){super(hr,"edwards",e);this.a=H.fromJSON(e.a).toRed(this.red),this.d=H.fromJSON(e.d).toRed(this.red),this.s=H.fromJSON(e.s||"0").toRed(this.red),this.si=this.s.isZero()?this.zero:this.s.redInvert(),this.k=this.d.redMuln(2),this.smi=-this.d.redNeg().word(0),this.ad6=this.a.redAdd(this.d).redMul(this.i6),this.twisted=!this.a.eq(this.one),this.oneA=this.a.eq(this.one),this.mOneA=this.a.eq(this.one.redNeg()),this.smallD=this.prime!=null&&this.d.redNeg().length===1,this.alt=null,this._finalize(e)}static _isomorphism(e,t,i){E(e instanceof H),E(t instanceof H),E(i instanceof H);let n=i.clone(),s=i.redMul(t).redDiv(e);if(e.redDiv(i).redJacobi()!==1)throw new Error("Invalid `a` coefficient.");return[n,s]}_short(e,t){let{a:i,d:n}=this,s=i.redSqr(),f=s.redMul(i),a=n.redSqr(),o=a.redMul(n),c=i.redMul(n).redIMuln(14),d=s.redMul(n),u=i.redMul(a),p=d.redIAdd(u).redIMuln(33),x=s.redAdd(c).redIAdd(a).redDivn(-48),y=p.redISub(f).redISub(o).redDivn(864);return e!=null?je._isomorphism(x,y,e,t):[x,y]}_mont(e,t=!1){E(typeof t=="boolean");let i,n;t?(i=this.d.redAdd(this.a),n=this.d.redSub(this.a)):(i=this.a.redAdd(this.d),n=this.a.redSub(this.d));let s=n.redInvert(),f=i.redMuln(2).redMul(s),a=s.redMuln(4);return e!=null?St._isomorphism(f,a,e):[f,a]}_edwards(e){return Zt._isomorphism(this.a,this.d,e)}_scaleShort(e){E(e instanceof je);let[t,i]=e._scale(this);return[this.field(t.redInvert()),this.field(i.redInvert())]}_scaleMont(e,t=!1){if(E(e instanceof St),E(typeof t=="boolean"),this.g.isInfinity()||e.g.isInfinity()){let[n]=e._edwards(null,t);return this.field(n).redDivSqrt(this.a)}let i=e.g.x.redDiv(e.g.y);return this.g.x.redDiv(this.field(i))}_scaleEdwards(e){return E(e instanceof Zt),this.g.isInfinity()||e.g.isInfinity()?this.field(e.a).redDivSqrt(this.a):this.g.x.redDiv(this.field(e.g.x))}_mulA(e){return E(e instanceof H),this.oneA?e.clone():this.mOneA?e.redNeg():this.a.redMul(e)}_mulD(e){return E(e instanceof H),this.smallD?e.redMuln(this.smi):this.d.redMul(e)}_elligator1(e){let{s:t,si:i,i2:n,one:s,two:f}=this,a=i.redSqr().redIMuln(2),o=t.redSqr().redMul(n),c=o.redSqr(),d=a.redAdd(o),u=d.redSqr().redISub(f),p=a.redSub(s),x=s.redSub(e),y=s.redAdd(e),g=y.isZero()?y:x.redDiv(y),M=g.redSqr(),k=M.redMul(g),K=k.redMul(M).redAdd(u.redMul(k)).redIAdd(g),L=this.field(K.redJacobi()),O=this.field(M.redAdd(c).redJacobi()),F=L.redMul(O),G=L.redMul(g),B=L.redMul(K).redSqrt().redMul(F),b=s.redAdd(G),m=d.redMul(G),w=b.redSqr(),S=p.redMul(t).redMul(G).redMul(b),I=g.isZero()?this.one:B,q=m.redSub(w),h=m.redAdd(w);return this.cpoint(S,I,q,h)}_invert1(e,t){let{s:i,si:n,i2:s,one:f}=this,{x:a,y:o,z:c}=e,d=t&1,u=n.redSqr().redIMuln(2),p=i.redSqr().redMul(s),x=p.redSqr(),y=u.redAdd(p),g=u.redSub(f),M=o.redSub(c),k=o.redAdd(c).redIMuln(2),R=k.isZero()?k:M.redDiv(k),K=f.redAdd(R.redMul(y)),F=K.redSqr().redISub(f).redSqrt().redSub(K),G=f.redAdd(F),b=g.redMul(i).redMul(F).redMul(G).redMul(a.redMul(c)),m=F.redSqr().redIAdd(x),S=this.field(b.redMul(m).redJacobi()).redMul(F),I=f.redSub(S),q=f.redAdd(S),h=q.isZero()?q:I.redDiv(q);return h.redIsOdd()!==Boolean(d)&&h.redINeg(),h}_alt(){return this.alt||(this.alt=this.toMont()),this.alt}isElliptic(){let e=this.a.redMul(this.d),t=this.a.redSub(this.d);return!e.redMul(t).isZero()}jinv(){let{a:e,d:t}=this,i=e.redMul(t),n=e.redSub(t).redPown(4),s=e.redSqr(),f=t.redSqr(),o=s.redAdd(i.redMuln(14)).redIAdd(f).redPown(3).redIMuln(16),c=i.redMul(n);if(c.isZero())throw new Error("Curve is not elliptic.");return o.redDiv(c).fromRed()}isComplete(){return this.a.redJacobi()===1&&this.d.redJacobi()===-1}point(e,t,i,n){return new hr(this,e,t,i,n)}jpoint(e,t,i){return E(e==null&&t==null&&i==null),this.point()}cpoint(e,t,i,n){E(e instanceof H),E(t instanceof H),E(i instanceof H),E(n instanceof H);let s=e.redMul(n),f=i.redMul(t),a=t.redMul(n),o=e.redMul(i);return this.point(s,f,a,o)}solveX2(e){E(e instanceof H);let t=e.redSqr(),i=this._mulD(t).redISub(this.a);return t.redISub(this.one).redDiv(i)}solveX(e){let t=e.redSqr(),i=this._mulD(t).redISub(this.a);return t.redISub(this.one).redDivSqrt(i)}solveY2(e){E(e instanceof H);let t=e.redSqr(),i=this._mulA(t).redISub(this.one),n=this._mulD(t).redISub(this.one);return i.redDiv(n)}solveY(e){let t=e.redSqr(),i=this._mulA(t).redISub(this.one),n=this._mulD(t).redISub(this.one);return i.redDivSqrt(n)}validate(e){if(E(e instanceof hr),e.zOne){let u=e.x.redSqr(),p=e.y.redSqr(),x=this._mulD(u).redMul(p),y=this._mulA(u).redIAdd(p),g=this.one.redAdd(x),M=e.t,k=e.x.redMul(e.y);return y.eq(g)&&M.eq(k)}let t=e.x.redSqr(),i=e.y.redSqr(),n=e.z.redSqr(),s=n.redSqr(),f=this._mulD(t).redMul(i),a=this._mulA(t).redIAdd(i).redMul(n),o=s.redIAdd(f),c=e.t.redMul(e.z),d=e.x.redMul(e.y);return a.eq(o)&&c.eq(d)}pointFromX(e,t=null){E(e instanceof H),E(t==null||typeof t=="boolean"),e.red||(e=e.toRed(this.red));let i=this.solveY(e);if(t!=null){if(i.isZero()&&t)throw new Error("Invalid point.");i.redIsOdd()!==t&&i.redINeg()}return this.point(e,i)}pointFromY(e,t=null){E(e instanceof H),E(t==null||typeof t=="boolean"),e.red||(e=e.toRed(this.red));let i=this.solveX(e);if(t!=null){if(i.isZero()&&t)throw new Error("Invalid point.");i.redIsOdd()!==t&&i.redINeg()}return this.point(i,e)}isIsomorphic(e,t=!1){if(E(e instanceof yr),E(typeof t=="boolean"),!e.p.eq(this.p))return!1;if(e.type==="short")return e.isIsomorphic(this);if(e.type==="mont"){let i=this.field(e.a),n,s;return t?(n=this.d.redAdd(this.a),s=this.d.redSub(this.a)):(n=this.a.redAdd(this.d),s=this.a.redSub(this.d)),i.redMul(s).eq(n.redIMuln(2))}if(e.type==="edwards"){let i=this.field(e.a),n=this.field(e.d);return this.a.redMul(n).eq(i.redMul(this.d))}return!1}isIsogenous(e){if(E(e instanceof yr),!e.p.eq(this.p))return!1;if(e.type==="mont"){if(!this.a.eq(this.one))return!1;let t=this.field(e.a),i=this.field(e.b),n=this.two.redSub(this.d.redMuln(4));return t.eq(n)&&i.eq(this.one)}if(e.type==="edwards"){let t=this.field(e.a),i=this.field(e.d);return t.eq(this.a.redNeg())&&i.eq(this.d.redSub(this.a))}return!1}pointFromShort(e){if(E(e instanceof wt),this.isIsomorphic(e.curve)){if(e.isInfinity())return this.point();if(e.y.isZero())return this.point(this.zero,this.one.redNeg());let{a:t,d:i}=this,[n,s]=this._scale(e.curve),f=t.redMuln(5),a=i.redMuln(5),o=this.field(e.x).redMul(n),c=this.field(e.y).redMul(s),d=o.redMuln(6),u=o.redMuln(12),p=d.redSub(t).redISub(i),x=c.redMuln(6),y=u.redSub(f).redIAdd(i),g=u.redAdd(t).redISub(a);return this.cpoint(p,x,y,g)}throw new Error("Not implemented.")}pointFromMont(e){E(e instanceof dr),E(e.curve.p.eq(this.p));let t=this.field(e.x),i=this.field(e.y);if(this.isIsogenous(e.curve)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point();let n=t.redSqr(),s=n.redMul(t),f=s.redMul(t),a=f.redMul(t),o=i.redSqr(),c=i.redMuln(4),d=n.redSub(this.one),u=n.redMuln(2),p=o.redMuln(4),x=s.redIMuln(2),y=t.redMul(o).redIMuln(4),g=n.redMul(o).redIMuln(2),M=o.redIMuln(2),k=c.redMul(d),R=f.redISub(u).redIAdd(p).redIAdd(this.one),K=a.redSub(x).redISub(y).redIAdd(t).redINeg(),L=a.redISub(g).redISub(x).redISub(M).redIAdd(t);return this.cpoint(k,R,K,L).divn(4)}if(this.isIsomorphic(e.curve,!0)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point(this.zero,this.one.redNeg());let s=this._scale(e.curve,!0).redMul(t),f=i,a=t.redAdd(this.one),o=t.redSub(this.one);return this.cpoint(s,f,a,o)}if(this.isIsomorphic(e.curve,!1)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point(this.zero,this.one.redNeg());let s=this._scale(e.curve,!1).redMul(t),f=i,a=t.redSub(this.one),o=t.redAdd(this.one);return this.cpoint(s,f,a,o)}throw new Error("Not implemented.")}pointFromEdwards(e){E(e instanceof hr),E(e.curve.p.eq(this.p));let t=this.field(e.curve.a),i=this.field(e.x),n=this.field(e.y),s=this.field(e.z),f=this.field(e.t);if(this.isIsogenous(e.curve)){let a=i.redMul(n),o=i.redSqr(),c=n.redSqr(),d=s.redSqr(),u=t.redMul(o),p=a.redIMuln(2),x=c.redSub(u),y=c.redAdd(u),g=d.redIMuln(2).redISub(y),M=this.cpoint(p,x,y,g);return this.twisted?M:M.divn(4)}if(this.isIsomorphic(e.curve)){let a=this._scale(e.curve),o=a.redMul(i),c=n,d=s,u=a.redMul(f);return this.point(o,c,d,u)}throw new Error("Not implemented.")}pointFromUniform(e,t=null){E(e instanceof H),E(e.red===this.red),E(t==null||t instanceof St),t||(t=this._alt());let i=t.field(e),n=t.pointFromUniform(i);return this.pointFromMont(n)}pointToUniform(e,t,i=null){E(e instanceof hr),E(t>>>0===t),E(i==null||i instanceof St),i||(i=this._alt());let n=(t>>4&15)%this.torsion.length,s=e.add(this.torsion[n]),f=i.pointFromEdwards(s),a=i.pointToUniform(f,t&15);return this.field(a)}pointFromHash(e,t,i=null){E(i==null||i instanceof St),i||(i=this._alt());let n=i.pointFromHash(e,t);return this.pointFromMont(n)}pointToHash(e,t,i,n=null){E(e instanceof hr),E(t>>>0===t),E(n==null||n instanceof St),n||(n=this._alt());let s=t%this.torsion.length,f=e.add(this.torsion[s]),a=n.pointFromEdwards(f);return n.pointToHash(a,0,i)}decodePoint(e){return hr.decode(this,e)}toShort(e,t,i=null){let[n,s]=this._short(e,t),f=new je({red:this.red,prime:this.prime,p:this.p,a:n,b:s,n:this.n,h:this.h});if(i!=null){let[,a]=f._scale(this);a.redIsOdd()!==i&&a.redINeg()}this.g.isInfinity()||(f.g=f.pointFromEdwards(this.g));for(let a=0;a<this.h.word(0);a++)f.torsion[a]=f.pointFromEdwards(this.torsion[a]);return f}toMont(e,t,i=null){let[n,s]=this._mont(e,t),f=new St({red:this.red,prime:this.prime,p:this.p,a:n,b:s,n:this.n,h:this.h,z:this.z});if(i!=null){let a=this._scale(f,t);a.redIsOdd()!==i&&a.redINeg()}this.g.isInfinity()||(f.g=f.pointFromEdwards(this.g));for(let a=0;a<this.h.word(0);a++)f.torsion[a]=f.pointFromEdwards(this.torsion[a]);return f}toEdwards(e,t=null){let[i,n]=this._edwards(e),s=new Zt({red:this.red,prime:this.prime,p:this.p,a:i,d:n,n:this.n,h:this.h,z:this.z});if(t!=null){let f=s._scale(this);f.redIsOdd()!==t&&f.redINeg()}if(this.g.isInfinity()||(s.g=s.pointFromEdwards(this.g),s.g.normalize()),s.isComplete())for(let f=0;f<this.h.word(0);f++)s.torsion[f]=s.pointFromEdwards(this.torsion[f]),s.torsion[f].normalize();return s}pointFromJSON(e){return hr.fromJSON(this,e)}toJSON(e){let t=super.toJSON(e);return t.a=this.a.fromRed().toJSON(),t.d=this.d.fromRed().toJSON(),this.s.isZero()||(t.s=this.s.fromRed().toJSON()),t}},hr=class extends ft{constructor(e,t,i,n,s){E(e instanceof Zt),super(e,oi.EXTENDED),this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0,t!=null&&this._init(t,i,n,s)}_init(e,t,i,n){E(e instanceof H),E(t instanceof H),E(i==null||i instanceof H),E(n==null||n instanceof H),this.x=e,this.y=t,this.z=i||this.curve.one,this.t=n||null,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z.eq(this.curve.one),this._check(),this.t||(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redDiv(this.z)))}_check(){if(this.z.isZero())throw new Error("Invalid point.")}clone(){return this.curve.point(this.x,this.y,this.z,this.t)}normalize(){if(this.zOne)return this;let e=this.z.redInvert();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t=this.t.redMul(e),this.z=this.curve.one,this.zOne=!0,this}scale(e){E(e instanceof H);let t=this.x.redMul(e),i=this.y.redMul(e),n=this.z.redMul(e),s=this.t.redMul(e);return this.curve.point(t,i,n,s)}neg(){let e=this.x.redNeg(),t=this.y,i=this.z,n=this.t.redNeg();return this.curve.point(e,t,i,n)}add(e){return E(e instanceof hr),this.isInfinity()?e:e.isInfinity()?this:this.zOne?e._add(this):this._add(e)}_add(e){return this.curve.mOneA?this._addM1(e):this._addA(e)}_addM1(e){let t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),i=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),n=this.t.redMul(this.curve.k).redMul(e.t),s=e.zOne?this.z.redAdd(this.z):this.z.redMul(e.z).redIMuln(2),f=i.redSub(t),a=s.redSub(n),o=s.redIAdd(n),c=i.redIAdd(t),d=f.redMul(a),u=o.redMul(c),p=f.redMul(c),x=a.redMul(o);return this.curve.point(d,u,x,p)}_addA(e){let t=this.x.redMul(e.x),i=this.y.redMul(e.y),n=this.curve._mulD(this.t).redMul(e.t),s=e.zOne?this.z.clone():this.z.redMul(e.z),a=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(t).redISub(i),o=s.redSub(n),c=s.redIAdd(n),d=i.redISub(this.curve._mulA(t)),u=a.redMul(o),p=c.redMul(d),x=a.redMul(d),y=o.redMul(c);return this.curve.point(u,p,y,x)}dbl(){return this.isInfinity()?this:this._dbl()}_dbl(){let e=this.x.redSqr(),t=this.y.redSqr(),i=this.zOne?this.curve.two:this.z.redSqr().redIMuln(2),n=this.curve._mulA(e),s=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),f=n.redAdd(t),a=f.redSub(i),o=n.redISub(t),c=s.redMul(a),d=f.redMul(o),u=s.redMul(o),p=a.redMul(f);return this.curve.point(c,d,p,u)}getX(){return this.normalize(),this.x.fromRed()}getY(){return this.normalize(),this.y.fromRed()}eq(e){if(E(e instanceof hr),E(!this.z.isZero()),E(!e.z.isZero()),this===e)return!0;if(this.z.eq(e.z))return this.x.eq(e.x)&&this.y.eq(e.y);let t=this.x.redMul(e.z),i=e.x.redMul(this.z);if(!t.eq(i))return!1;let n=this.y.redMul(e.z),s=e.y.redMul(this.z);return n.eq(s)}cmp(e){return E(e instanceof hr),this.order().cmp(e.order())||this.getY().cmp(e.getY())||this.getX().cmp(e.getX())}isInfinity(){return E(!this.z.isZero()),this.x.isZero()?this.y.eq(this.z):!1}isOrder2(){return this.isInfinity()?!1:this.x.isZero()}isOdd(){return this.normalize(),this.x.redIsOdd()}isEven(){return this.normalize(),this.x.redIsEven()}toP(){return this.normalize()}toJ(){return this}encode(){let e=this.getY();return e.setn(this.curve.signBit,this.x.redIsOdd()),this.curve.encodeAdjusted(e)}static decode(e,t){E(e instanceof Zt);let i=e.decodeAdjusted(t),n=i.testn(e.signBit)!==0;if(i.setn(e.signBit,0),i.cmp(e.p)>=0)throw new Error("Invalid point.");return e.pointFromY(i,n)}toJSON(e){if(this.isInfinity())return[];let t=this.getX().toJSON(),i=this.getY().toJSON();return e===!0&&this.pre?[t,i,this.pre.toJSON()]:[t,i]}toPretty(){let e=this.curve.fieldSize*2,t=M0(this.getX(),e),i=M0(this.getY(),e);return[t,i]}static fromJSON(e,t){if(E(e instanceof Zt),E(Array.isArray(t)),E(t.length===0||t.length===2||t.length===3),t.length===0)return e.point();let i=H.fromJSON(t[0]),n=H.fromJSON(t[1]),s=e.point(i,n);return t.length>2&&t[2]!=null&&(s.pre=kf.fromJSON(s,t[2])),s}[E0](){return this.isInfinity()?"<EdwardsPoint: Infinity>":"<EdwardsPoint: x="+this.x.fromRed().toString(16,2)+" y="+this.y.fromRed().toString(16,2)+" z="+this.z.fromRed().toString(16,2)+">"}},kf=class{constructor(){this.naf=null,this.windows=null,this.doubles=null,this.blinding=null,this.beta=null}map(e){E(typeof e=="function");let t=new this.constructor;return this.naf&&(t.naf=this.naf.map(e)),this.doubles&&(t.doubles=this.doubles.map(e)),t}toJSON(){return{naf:this.naf?this.naf.toJSON():null,windows:this.windows?this.windows.toJSON():null,doubles:this.doubles?this.doubles.toJSON():null,blinding:this.blinding?this.blinding.toJSON():void 0}}fromJSON(e,t){return E(e instanceof ft),E(t&&typeof t=="object"),t.naf!=null&&(this.naf=qf.fromJSON(e,t.naf)),t.windows!=null&&(this.windows=Io.fromJSON(e,t.windows)),t.doubles!=null&&(this.doubles=Ao.fromJSON(e,t.doubles)),t.blinding!=null&&(this.blinding=Bo.fromJSON(e,t.blinding)),this}static fromJSON(e,t){return new this().fromJSON(e,t)}},qf=class{constructor(e,t){this.width=e,this.points=t}map(e){E(typeof e=="function");let{width:t}=this,i=[];for(let n of this.points)i.push(e(n));return new this.constructor(t,i)}toJSON(){return{width:this.width,points:this.points.slice(1).map(e=>e.toJSON())}}static fromJSON(e,t){E(e instanceof ft),E(t&&typeof t=="object"),E(t.width>>>0===t.width),E(Array.isArray(t.points));let{curve:i}=e,{width:n}=t,s=[e];for(let f of t.points)s.push(i.pointFromJSON(f));return new this(n,s)}},Io=class{constructor(e,t,i){this.width=e,this.bits=t,this.points=i}toJSON(){return{width:this.width,bits:this.bits,points:this.points.slice(1).map(e=>e.toJSON())}}static fromJSON(e,t){E(e instanceof ft),E(t&&typeof t=="object"),E(t.width>>>0===t.width),E(t.bits>>>0===t.bits),E(Array.isArray(t.points));let{curve:i}=e,{width:n,bits:s}=t,f=[e];for(let a of t.points)f.push(i.pointFromJSON(a));return new this(n,s,f)}},Ao=class{constructor(e,t){this.step=e,this.points=t}map(e){E(typeof e=="function");let{step:t}=this,i=[];for(let n of this.points)i.push(e(n));return new this.constructor(t,i)}toJSON(){return{step:this.step,points:this.points.slice(1).map(e=>e.toJSON())}}static fromJSON(e,t){E(e instanceof ft),E(t&&typeof t=="object"),E(t.step>>>0===t.step),E(Array.isArray(t.points));let{curve:i}=e,{step:n}=t,s=[e];for(let f of t.points)s.push(i.pointFromJSON(f));return new this(n,s)}},Bo=class{constructor(e,t){this.blind=e,this.unblind=t}toJSON(){return{blind:this.blind.toJSON(),unblind:this.unblind.toJSON()}}static fromJSON(e,t){E(e instanceof ft),E(t&&typeof t=="object");let{curve:i}=e,n=H.fromJSON(t.blind),s=i.pointFromJSON(t.unblind);return new this(n,s)}},ko=class{constructor(e,t,i,n){this.beta=e,this.lambda=t,this.basis=i,this.pre=n}toJSON(){return{beta:this.beta.fromRed().toJSON(),lambda:this.lambda.toJSON(),basis:[this.basis[0].toJSON(),this.basis[1].toJSON()],pre:[this.pre[0],this.pre[1].toJSON(),this.pre[2].toJSON()]}}static fromJSON(e,t){E(e instanceof yr),E(t&&typeof t=="object"),E(Array.isArray(t.basis)),E(Array.isArray(t.pre)),E(t.basis.length===2),E(t.pre.length===3),E(t.pre[0]>>>0===t.pre[0]);let i=H.fromJSON(t.beta).toRed(e.red),n=H.fromJSON(t.lambda),s=[Rn.fromJSON(t.basis[0]),Rn.fromJSON(t.basis[1])],f=[t.pre[0],H.fromJSON(t.pre[1]),H.fromJSON(t.pre[2])];return new this(i,n,s,f)}},Rn=class{constructor(e,t){this.a=e,this.b=t}toJSON(){return{a:this.a.toJSON(),b:this.b.toJSON()}}static fromJSON(e){E(e&&typeof e=="object");let t=H.fromJSON(e.a),i=H.fromJSON(e.b);return new this(t,i)}},Qh=class extends je{constructor(e){super({id:"P192",ossl:"prime192v1",type:"short",endian:"be",hash:"SHA256",prime:"p192",p:["ffffffff ffffffff ffffffff fffffffe","ffffffff ffffffff"],a:["ffffffff ffffffff ffffffff fffffffe","ffffffff fffffffc"],b:["64210519 e59c80e7 0fa7e9ab 72243049","feb8deec c146b9b1"],n:["ffffffff ffffffff ffffffff 99def836","146bc9b1 b4d22831"],h:"1",z:"-5",g:[["188da80e b03090f6 7cbf20eb 43a18800","f4ff0afd 82ff1012"],["07192b95 ffc8da78 631011ed 6b24cdd5","73f977a1 1e794811"],e]})}},eu=class extends je{constructor(e){super({id:"P224",ossl:"secp224r1",type:"short",endian:"be",hash:"SHA256",prime:"p224",p:["ffffffff ffffffff ffffffff ffffffff","00000000 00000000 00000001"],a:["ffffffff ffffffff ffffffff fffffffe","ffffffff ffffffff fffffffe"],b:["b4050a85 0c04b3ab f5413256 5044b0b7","d7bfd8ba 270b3943 2355ffb4"],n:["ffffffff ffffffff ffffffff ffff16a2","e0b8f03e 13dd2945 5c5c2a3d"],h:"1",z:"1f",g:[["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3","56c21122 343280d6 115c1d21"],["bd376388 b5f723fb 4c22dfe6 cd4375a0","5a074764 44d58199 85007e34"],e]})}},tu=class extends je{constructor(e){super({id:"P256",ossl:"prime256v1",type:"short",endian:"be",hash:"SHA256",prime:null,p:["ffffffff 00000001 00000000 00000000","00000000 ffffffff ffffffff ffffffff"],a:["ffffffff 00000001 00000000 00000000","00000000 ffffffff ffffffff fffffffc"],b:["5ac635d8 aa3a93e7 b3ebbd55 769886bc","651d06b0 cc53b0f6 3bce3c3e 27d2604b"],n:["ffffffff 00000000 ffffffff ffffffff","bce6faad a7179e84 f3b9cac2 fc632551"],h:"1",z:"-a",g:[["6b17d1f2 e12c4247 f8bce6e5 63a440f2","77037d81 2deb33a0 f4a13945 d898c296"],["4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16","2bce3357 6b315ece cbb64068 37bf51f5"],e]})}},ru=class extends je{constructor(e){super({id:"P384",ossl:"secp384r1",type:"short",endian:"be",hash:"SHA384",prime:null,p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff fffffffe","ffffffff 00000000 00000000 ffffffff"],a:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff fffffffe","ffffffff 00000000 00000000 fffffffc"],b:["b3312fa7 e23ee7e4 988e056b e3f82d19","181d9c6e fe814112 0314088f 5013875a","c656398d 8a2ed19d 2a85c8ed d3ec2aef"],n:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff c7634d81 f4372ddf","581a0db2 48b0a77a ecec196a ccc52973"],h:"1",z:"-c",g:[["aa87ca22 be8b0537 8eb1c71e f320ad74","6e1d3b62 8ba79b98 59f741e0 82542a38","5502f25d bf55296c 3a545e38 72760ab7"],["3617de4a 96262c6f 5d9e98bf 9292dc29","f8f41dbd 289a147c e9da3113 b5f0b8c0","0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"],e]})}},iu=class extends je{constructor(e){super({id:"P521",ossl:"secp521r1",type:"short",endian:"be",hash:"SHA512",prime:"p521",p:["000001ff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff"],a:["000001ff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","fffffffc"],b:["00000051 953eb961 8e1c9a1f 929a21a0","b68540ee a2da725b 99b315f3 b8b48991","8ef109e1 56193951 ec7e937b 1652c0bd","3bb1bf07 3573df88 3d2c34f1 ef451fd4","6b503f00"],n:["000001ff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","fffffffa 51868783 bf2f966b 7fcc0148","f709a5d0 3bb5c9b8 899c47ae bb6fb71e","91386409"],h:"1",z:"-4",g:[["000000c6 858e06b7 0404e9cd 9e3ecb66","2395b442 9c648139 053fb521 f828af60","6b4d3dba a14b5e77 efe75928 fe1dc127","a2ffa8de 3348b3c1 856a429b f97e7e31","c2e5bd66"],["00000118 39296a78 9a3bc004 5c8a5fb4","2c7d1bd9 98f54449 579b4468 17afbd17","273e662c 97ee7299 5ef42640 c550b901","3fad0761 353c7086 a272c240 88be9476","9fd16650"],e]})}},nu=class extends je{constructor(e){super({id:"SECP256K1",ossl:"secp256k1",type:"short",endian:"be",hash:"SHA256",prime:"k256",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe fffffc2f"],a:"0",b:"7",n:["ffffffff ffffffff ffffffff fffffffe","baaedce6 af48a03b bfd25e8c d0364141"],h:"1",z:"1",c:["0a2d2ba9 3507f1df 233770c2 a797962c","c61f6d15 da14ecd4 7d8d27ae 1cd5f852"],g:[["79be667e f9dcbbac 55a06295 ce870b07","029bfcdb 2dce28d9 59f2815b 16f81798"],["483ada77 26a3c465 5da4fbfc 0e1108a8","fd17b448 a6855419 9c47d08f fb10d4b8"],e],endo:{beta:["7ae96a2b 657c0710 6e64479e ac3434e9","9cf04975 12f58995 c1396c28 719501ee"],lambda:["5363ad4c c05c30e0 a5261c02 8812645a","122e22ea 20816678 df02967c 1b23bd72"],basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],pre:[384,["3086d221 a7d46bcd e86c90e4 9284eb15","3daa8a14 71e8ca7f e893209a 45dbb031"],["-","e4437ed6 010e8828 6f547fa9 0abfe4c4","221208ac 9df506c6 1571b4ae 8ac47f71"]]}})}},su=class extends je{constructor(e){super({id:"BRAINPOOLP256",ossl:"brainpoolP256r1",type:"short",endian:"be",hash:"SHA256",prime:null,p:["a9fb57db a1eea9bc 3e660a90 9d838d72","6e3bf623 d5262028 2013481d 1f6e5377"],a:["7d5a0975 fc2c3057 eef67530 417affe7","fb8055c1 26dc5c6c e94a4b44 f330b5d9"],b:["26dc5c6c e94a4b44 f330b5d9 bbd77cbf","95841629 5cf7e1ce 6bccdc18 ff8c07b6"],n:["a9fb57db a1eea9bc 3e660a90 9d838d71","8c397aa3 b561a6f7 901e0e82 974856a7"],h:"1",z:"-2",g:[["8bd2aeb9 cb7e57cb 2c4b482f fc81b7af","b9de27e1 e3bd23c2 3a4453bd 9ace3262"],["547ef835 c3dac4fd 97f8461a 14611dc9","c2774513 2ded8e54 5c1d54c7 2f046997"],e]})}},fu=class extends je{constructor(e){super({id:"BRAINPOOLP384",ossl:"brainpoolP384r1",type:"short",endian:"be",hash:"SHA384",prime:null,p:["8cb91e82 a3386d28 0f5d6f7e 50e641df","152f7109 ed5456b4 12b1da19 7fb71123","acd3a729 901d1a71 87470013 3107ec53"],a:["7bc382c6 3d8c150c 3c72080a ce05afa0","c2bea28e 4fb22787 139165ef ba91f90f","8aa5814a 503ad4eb 04a8c7dd 22ce2826"],b:["04a8c7dd 22ce2826 8b39b554 16f0447c","2fb77de1 07dcd2a6 2e880ea5 3eeb62d5","7cb43902 95dbc994 3ab78696 fa504c11"],n:["8cb91e82 a3386d28 0f5d6f7e 50e641df","152f7109 ed5456b3 1f166e6c ac0425a7","cf3ab6af 6b7fc310 3b883202 e9046565"],h:"1",z:"-5",g:[["1d1c64f0 68cf45ff a2a63a81 b7c13f6b","8847a3e7 7ef14fe3 db7fcafe 0cbd10e8","e826e034 36d646aa ef87b2e2 47d4af1e"],["8abe1d75 20f9c2a4 5cb1eb8e 95cfd552","62b70b29 feec5864 e19c054f f9912928","0e464621 77918111 42820341 263c5315"],e]})}},au=class extends je{constructor(e){super({id:"BRAINPOOLP512",ossl:"brainpoolP512r1",type:"short",endian:"be",hash:"SHA512",prime:null,p:["aadd9db8 dbe9c48b 3fd4e6ae 33c9fc07","cb308db3 b3c9d20e d6639cca 70330871","7d4d9b00 9bc66842 aecda12a e6a380e6","2881ff2f 2d82c685 28aa6056 583a48f3"],a:["7830a331 8b603b89 e2327145 ac234cc5","94cbdd8d 3df91610 a83441ca ea9863bc","2ded5d5a a8253aa1 0a2ef1c9 8b9ac8b5","7f1117a7 2bf2c7b9 e7c1ac4d 77fc94ca"],b:["3df91610 a83441ca ea9863bc 2ded5d5a","a8253aa1 0a2ef1c9 8b9ac8b5 7f1117a7","2bf2c7b9 e7c1ac4d 77fc94ca dc083e67","984050b7 5ebae5dd 2809bd63 8016f723"],n:["aadd9db8 dbe9c48b 3fd4e6ae 33c9fc07","cb308db3 b3c9d20e d6639cca 70330870","553e5c41 4ca92619 41866119 7fac1047","1db1d381 085ddadd b5879682 9ca90069"],h:"1",z:"7",g:[["81aee4bd d82ed964 5a21322e 9c4c6a93","85ed9f70 b5d916c1 b43b62ee f4d0098e","ff3b1f78 e2d0d48d 50d1687b 93b97d5f","7c6d5047 406a5e68 8b352209 bcb9f822"],["7dde385d 566332ec c0eabfa9 cf7822fd","f209f700 24a57b1a a000c55b 881f8111","b2dcde49 4a5f485e 5bca4bd8 8a2763ae","d1ca2b2f a8f05406 78cd1e0f 3ad80892"],e]})}},ou=class extends St{constructor(){super({id:"X25519",ossl:"X25519",type:"mont",endian:"le",hash:"SHA512",prime:"p25519",p:["7fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffed"],a:"76d06",b:"1",n:["10000000 00000000 00000000 00000000","14def9de a2f79cd6 5812631a 5cf5d3ed"],h:"8",z:"2",g:[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000009"],["5f51e65e 475f794b 1fe122d3 88b72eb3","6dc2b281 92839e4d d6163a5d 81312c14"]],torsion:[[],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000001"],["6be4f497 f9a9c2af c21fa77a d7f4a6ef","635a11c7 284a9363 e9a248ef 9c884415"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000001"],["141b0b68 06563d50 3de05885 280b5910","9ca5ee38 d7b56c9c 165db710 6377bbd8"]],[["57119fd0 dd4e22d8 868e1c58 c45c4404","5bef839c 55b1d0b1 248c50a3 bc959c5f"],["68c59389 3d458e64 31c6ca00 45fb5015","20a44346 8eaa68dd 0f103842 048065b7"]],[["57119fd0 dd4e22d8 868e1c58 c45c4404","5bef839c 55b1d0b1 248c50a3 bc959c5f"],["173a6c76 c2ba719b ce3935ff ba04afea","df5bbcb9 71559722 f0efc7bd fb7f9a36"]],[["00b8495f 16056286 fdb1329c eb8d09da","6ac49ff1 fae35616 aeb8413b 7c7aebe0"],["3931c129 569e83a5 29482c14 e628b457","933bfc29 ed801b4d 68871483 92507b1a"]],[["00b8495f 16056286 fdb1329c eb8d09da","6ac49ff1 fae35616 aeb8413b 7c7aebe0"],["46ce3ed6 a9617c5a d6b7d3eb 19d74ba8","6cc403d6 127fe4b2 9778eb7c 6daf84d3"]]]})}},cu=class extends St{constructor(){super({id:"X448",ossl:"X448",type:"mont",endian:"le",hash:"SHAKE256",prime:"p448",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff"],a:"262a6",b:"1",n:["3fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 7cca23e9","c44edb49 aed63690 216cc272 8dc58f55","2378c292 ab5844f3"],h:"4",z:"-1",g:[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000005"],["7d235d12 95f5b1f6 6c98ab6e 58326fce","cbae5d34 f55545d0 60f75dc2 8df3f6ed","b8027e23 46430d21 1312c4b1 50677af7","6fd7223d 457b5b1a"]],torsion:[[],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["ba4d3a08 29b6112f 8812e51b a0bb2abe","bc1cb08e b48e5569 36ba50fd d2e7d68a","f8cb3216 0522425b 3f990812 abbe635a","d37a21e1 7551b193"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["45b2c5f7 d649eed0 77ed1ae4 5f44d541","43e34f71 4b71aa96 c945af01 2d182975","0734cde9 faddbda4 c066f7ed 54419ca5","2c85de1e 8aae4e6c"]]]})}},du=class extends St{constructor(){super({id:"MONT448",ossl:null,type:"mont",endian:"le",hash:"SHAKE256",prime:"p448",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff"],a:["b2cf97d2 d43459a9 31ed36b1 fc4e3cb5","5d93f8d2 22746997 60ccffc6 49961ed6","c5b05fca c24864ed 6fb59697 931b78da","84ddecd8 ca2b5cfb"],b:"1",n:["3fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 7cca23e9","c44edb49 aed63690 216cc272 8dc58f55","2378c292 ab5844f3"],h:"4",z:"-1",g:[["ac0d24cc c6c75cb0 eb71f81e 7a6edf51","48e88aee 009a2a24 e795687e c28e125a","3e6730a6 0d46367b aa7fe99d 152128dc","41321bc7 7817f059"],["5a4437f6 80c0d0db 9b061276 d5d0ffcc","e786ff33 b6a53d30 98746425 82e66f09","4433dae7 7244a6e2 6b11e905 7228f483","556c41a5 913f55fe"]],torsion:[[],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["bec92fd0 6da2acf2 b4e261e8 7cef0d34","22e75c18 3c589857 b71924e5 73c2f9ce","e18da5f2 466e2f39 3c2eedf0 f105a60a","b40c717d 4f1e1fd7"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["4136d02f 925d530d 4b1d9e17 8310f2cb","dd18a3e7 c3a767a8 48e6db19 8c3d0631","1e725a0d b991d0c6 c3d1120f 0efa59f5","4bf38e82 b0e1e028"]]]})}},hu=class extends Zt{constructor(e){super({id:"ED25519",ossl:"ED25519",type:"edwards",endian:"le",hash:"SHA512",prefix:"SigEd25519 no Ed25519 collisions",context:!1,prime:"p25519",p:["7fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffed"],a:"-1",d:["52036cee 2b6ffe73 8cc74079 7779e898","00700a4d 4141d8ab 75eb4dca 135978a3"],n:["10000000 00000000 00000000 00000000","14def9de a2f79cd6 5812631a 5cf5d3ed"],h:"8",z:"2",g:[["216936d3 cd6e53fe c0a4e231 fdd6dc5c","692cc760 9525a7b2 c9562d60 8f25d51a"],["66666666 66666666 66666666 66666666","66666666 66666666 66666666 66666658"],e],torsion:[[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000001"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"],["7fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffec"]],[["2b832480 4fc1df0b 2b4d0099 3dfbd7a7","2f431806 ad2fe478 c4ee1b27 4a0ea0b0"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"]],[["547cdb7f b03e20f4 d4b2ff66 c2042858","d0bce7f9 52d01b87 3b11e4d8 b5f15f3d"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"]],[["1fd5b9a0 06394a28 e9339932 38de4abb","5c193c70 13e5e238 dea14646 c545d14a"],["05fc536d 880238b1 3933c6d3 05acdfd5","f098eff2 89f4c345 b027b2c2 8f95e826"]],[["602a465f f9c6b5d7 16cc66cd c721b544","a3e6c38f ec1a1dc7 215eb9b9 3aba2ea3"],["05fc536d 880238b1 3933c6d3 05acdfd5","f098eff2 89f4c345 b027b2c2 8f95e826"]],[["1fd5b9a0 06394a28 e9339932 38de4abb","5c193c70 13e5e238 dea14646 c545d14a"],["7a03ac92 77fdc74e c6cc392c fa53202a","0f67100d 760b3cba 4fd84d3d 706a17c7"]],[["602a465f f9c6b5d7 16cc66cd c721b544","a3e6c38f ec1a1dc7 215eb9b9 3aba2ea3"],["7a03ac92 77fdc74e c6cc392c fa53202a","0f67100d 760b3cba 4fd84d3d 706a17c7"]]]})}},uu=class extends Zt{constructor(e){super({id:"ISO448",ossl:null,type:"edwards",endian:"le",hash:"SHAKE256",prefix:"SigEd448",context:!0,prime:"p448",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff"],a:"1",d:["d78b4bdc 7f0daf19 f24f38c2 9373a2cc","ad461572 42a50f37 809b1da3 412a12e7","9ccc9c81 264cfe9a d0809970 58fb61c4","243cc32d baa156b9"],n:["3fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 7cca23e9","c44edb49 aed63690 216cc272 8dc58f55","2378c292 ab5844f3"],h:"4",z:"-1",g:[["79a70b2b 70400553 ae7c9df4 16c792c6","1128751a c9296924 0c25a07d 728bdc93","e21f7787 ed697224 9de732f3 8496cd11","69871309 3e9c04fc"],["7fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 80000000","00000000 00000000 00000000 00000000","00000000 00000001"],e],torsion:[[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000001"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000001"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]]]})}},lu=class extends Zt{constructor(e){super({id:"ED448",ossl:"ED448",type:"edwards",endian:"le",hash:"SHAKE256",prefix:"SigEd448",context:!0,prime:"p448",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff"],a:"1",d:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffff6756"],n:["3fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 7cca23e9","c44edb49 aed63690 216cc272 8dc58f55","2378c292 ab5844f3"],h:"4",z:"-1",g:[["4f1970c6 6bed0ded 221d15a6 22bf36da","9e146570 470f1767 ea6de324 a3d3a464","12ae1af7 2ab66511 433b80e1 8b00938e","2626a82b c70cc05e"],["693f4671 6eb6bc24 88762037 56c9c762","4bea7373 6ca39840 87789c1e 05a0c2d7","3ad3ff1c e67c39c4 fdbd132c 4ed7c8ad","9808795b f230fa14"],e],torsion:[[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000001"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000001"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]]]})}},Cf={__proto__:null,P192:Qh,P224:eu,P256:tu,P384:ru,P521:iu,SECP256K1:nu,BRAINPOOLP256:su,BRAINPOOLP384:fu,BRAINPOOLP512:au,X25519:ou,X448:cu,MONT448:du,ED25519:hu,ISO448:uu,ED448:lu},qo={__proto__:null,P192:null,P224:null,P256:null,P384:null,P521:null,SECP256K1:null,BRAINPOOLP256:null,BRAINPOOLP384:null,BRAINPOOLP512:null,X25519:null,X448:null,MONT448:null,ED25519:null,ISO448:null,ED448:null};function hm(r,...e){E(typeof r=="string");let t=r.toUpperCase(),i=qo[t];if(!i){let n=Cf[t];if(!n)throw new Error(`Curve not found: "${r}".`);i=new n(...e),qo[t]=i}return i}function um(r,e){E(typeof r=="string"),E(typeof e=="function");let t=r.toUpperCase();if(Cf[t])throw new Error(`Curve already registered: "${r}".`);Cf[t]=e,qo[t]=null}function Bf(r,e,t){E(r instanceof H),E(!r.red),E(e>>>0===e),E(t>>>0===t);let i=new Array(t),n=r.bitLength()+1,s=r.sign()|1;E(n<=t);for(let c=0;c<t;c++)i[c]=0;let f=0,a=0,o;for(;f<n;){if(r.bit(f)===a){f+=1;continue}o=r.bits(f,e)+a,a=o>>e-1&1,o-=a<<e,i[f]=s*o,f+=e}return E(a===0),i}function om(r,e,t,i){E(i>>>0===i);let n=Bf(r,e,t),s=Math.ceil(n.length/i),f=new Array(s),a=0;for(let o=0;o<n.length;o+=i){let c=0;for(let d=o+i-1;d>=o;d--)c=(c<<1)+n[d];f[a++]=c}return E(a===s),f}function lm(r,e,t){E(r instanceof H),E(e instanceof H),E(!r.red),E(!e.red),E(t>>>0===t);let i=[new Array(t),new Array(t)],n=Math.max(r.bitLength(),e.bitLength())+1,s=r.sign()|1,f=e.sign()|1;E(n<=t);let a=0,o=0;for(let c=0;c<n;c++){let d=r.bits(c,3),u=e.bits(c,3),p=(d&3)+a&3,x=(u&3)+o&3,y=0,g=0;if(p===3&&(p=-1),x===3&&(x=-1),p&1){let M=(d&7)+a&7;(M===3||M===5)&&x===2?y=-p:y=p}if(x&1){let M=(u&7)+o&7;(M===3||M===5)&&p===2?g=-x:g=x}i[0][c]=y*s,i[1][c]=g*f,2*a===1+y&&(a=1-a),2*o===1+g&&(o=1-o)}for(let c=n;c<t;c++)i[0][c]=0,i[1][c]=0;return i}function cm(r,e,t){let i=lm(r,e,t),n=new Array(t);for(let s=0;s<t;s++){let f=i[0][s],a=i[1][s];n[s]=fm[(f+1)*3+(a+1)]}return n}function E(r,e){if(!r){let t=new Error(e||"Assertion failed");throw Error.captureStackTrace&&Error.captureStackTrace(t,E),t}}function Wh(r){E(typeof r=="function");try{return r()}catch(e){throw e.message==="X is not a square mod P."||e.message==="Not invertible."?new Error("Invalid point."):e}}function dm(r,e){let t=r%e;return t<0&&(e<0?t-=e:t+=e),t}function bm(r){E(r instanceof H),E(r.red);let e=r.red.m;if(e.cmpn(3)<=0)return r.clone();if(e.modrn(3)===2){let i=e.ushln(1).isubn(1).idivn(3);return r.redPow(i)}let t=e.modrn(9);if(t===4){let i=e.ushln(1).iaddn(1).idivn(9),n=r.redPow(i);if(!n.redSqr().redMul(n).eq(r))throw new Error("X is not a cube mod P.");return n}if(t===7){let i=e.addn(2).idivn(9),n=r.redPow(i);if(!n.redSqr().redMul(n).eq(r))throw new Error("X is not a cube mod P.");return n}throw new Error("Not implemented.")}function jh(r){let e=bm(r);if(r.red.m.modrn(3)===1){let t=new H(2).toRed(r.red),i=new H(3).toRed(r.red),n=t.redInvert(),s=i.redNeg().redSqrt().redMul(n),f=s.redNeg(),a=s.redSub(n),o=f.redSub(n),c=e.redMul(a),d=e.redMul(o);return[e,c,d]}return[e]}function $h(r){for(let e of jh(r))if(e.redJacobi()>=0)return e;throw new Error("X^(1/3) is not a square mod P.")}function Zh(r){return H.randomBits(r,32).toNumber()}function _o(r,e){let t=new WeakMap;return function(n,s){let f=s&1,a=t.get(n);if(a&&a[f]!==null)return a[f];let o=r.call(e,n,s);return t.has(n)||t.set(n,[null,null]),t.get(n)[f]=o,o}}function M0(r,e){E(r instanceof H),E(e>>>0===e),e&7&&(e+=8-(e&7));let t=r.toString(16,e),i=[],n=[];E((t.length&7)==0);for(let s=0;s<t.length;s+=8)i.push(t.slice(s,s+8));for(let s=0;s<i.length;s+=4)n.push(i.slice(s,s+4).join(" "));return n}wr.Curve=yr;wr.Point=ft;wr.ShortCurve=je;wr.ShortPoint=wt;wr.JPoint=Pn;wr.MontCurve=St;wr.MontPoint=dr;wr.XPoint=ci;wr.EdwardsCurve=Zt;wr.EdwardsPoint=hr;wr.curves=Cf;wr.curve=hm;wr.register=um});var vu=C(_0=>{"use strict";var mr=Ki(),Tf=globalThis.crypto||globalThis.msCrypto,pu=Tf&&typeof Tf.getRandomValues=="function",pm=pu?Tf.getRandomValues.bind(Tf):null,yu=new Uint32Array(16),Co=65536,To=0;function ym(r){mr(r>>>0===r);let e=Buffer.alloc(r);return mu(e,0,r),e}function mm(r,e,t){return mr(Buffer.isBuffer(r)),e==null&&(e=0),mr(e>>>0===e),t==null&&(t=r.length-e),mr(t>>>0===t),mr(e+t<=r.length),mu(r,e,t),r}function xu(){return(To&15)==0&&(No(yu),To=0),yu[To++]}function xm(r,e){mr(r>>>0===r),mr(e>>>0===e),mr(e>=r);let t=e-r;if(t===0)return r;let i=-t>>>0,n,s;do n=xu(),s=n%t;while(n-s>i);return s+r}function No(r){if(!pu)throw new Error("Entropy source not available.");return pm(r)}function mu(r,e,t){if(mr(Buffer.isBuffer(r)),mr(r.buffer instanceof ArrayBuffer),mr(r.byteOffset>>>0===r.byteOffset),mr(r.byteLength>>>0===r.byteLength),mr(e>>>0===e),mr(t>>>0===t),mr(e+t<=r.byteLength),t>2**31-1)throw new RangeError('The value "size" is out of range.');let i=r.byteOffset+e,n=new Uint8Array(r.buffer,i,t);if(n.length>Co)for(let s=0;s<n.length;s+=Co){let f=s+Co;f>n.length&&(f=n.length),No(n.subarray(s,f))}else n.length>0&&No(n)}_0.native=0;_0.randomBytes=ym;_0.randomFill=mm;_0.randomInt=xu;_0.randomRange=xm});var wu=C((pI,gu)=>{"use strict";gu.exports=vu()});var _u=C((yI,Su)=>{"use strict";var Li=Ki(),Po=Mo(),Eu=bu(),Kn=wu(),Mu=class{constructor(e,t,i){Li(typeof e=="string"),Li(!t||typeof t=="string"),this.id=e,this.type="ecdh",this.eid=t||null,this._pre=i||null,this._curve=null,this._edwards=null,this.native=0}get curve(){return this._curve||(this._curve=Eu.curve(this.id)),this._curve}get edwards(){return this.eid&&!this._edwards&&(this._edwards=Eu.curve(this.eid,this._pre),this._edwards.precompute(Kn),this._pre=null),this._edwards}get size(){return this.curve.fieldSize}get bits(){return this.curve.fieldBits}privateKeyGenerate(){let e=Kn.randomBytes(this.curve.scalarSize);return this.curve.clamp(e)}privateKeyVerify(e){return Li(Buffer.isBuffer(e)),e.length===this.curve.scalarSize}privateKeyExport(e,t){let i=this.publicKeyCreate(e),{x:n,y:s}=this.publicKeyExport(i,t);return{d:Buffer.from(e),x:n,y:s}}privateKeyImport(e){Li(e&&typeof e=="object");let t=Po.decode(e.d,this.curve.endian);if(t.byteLength()>this.curve.scalarSize)throw new Error("Invalid private key.");return this.curve.encodeScalar(t)}publicKeyCreate(e){let t=this.curve.decodeClamped(e);if(this.edwards&&this.edwards.g.pre){let s=this.edwards.g.mulBlind(t);return this.curve.pointFromEdwards(s).encode()}return this.curve.g.toX().mulBlind(t,Kn).encode()}publicKeyConvert(e,t){if(Li(t==null||typeof t=="boolean"),!this.edwards)throw new Error("No equivalent edwards curve.");let i=this.curve.decodePoint(e),n=this.edwards.pointFromMont(i);return t!=null&&n.isOdd()!==t?n.neg().encode():n.encode()}publicKeyFromUniform(e){let t=this.curve.decodeUniform(e);return this.curve.pointFromUniform(t).encode()}publicKeyToUniform(e,t=Kn.randomInt()){let i=this.curve.decodePoint(e),n=this.curve.pointToUniform(i,t);return this.curve.encodeUniform(n,t>>>8)}publicKeyFromHash(e,t=!1){return this.curve.pointFromHash(e,t).encode()}publicKeyToHash(e,t=Kn.randomInt()){let i=this.curve.decodePoint(e);return this.curve.pointToHash(i,t,Kn)}publicKeyVerify(e){Li(Buffer.isBuffer(e));let t;try{t=this.curve.decodeX(e)}catch(i){return!1}return t.validate()}publicKeyIsSmall(e){Li(Buffer.isBuffer(e));let t;try{t=this.curve.decodeX(e)}catch(i){return!1}return t.validate()?t.isSmall():!1}publicKeyHasTorsion(e){Li(Buffer.isBuffer(e));let t;try{t=this.curve.decodeX(e)}catch(i){return!1}return t.validate()?t.hasTorsion():!1}publicKeyExport(e,t){let{x:i,y:n}=this.curve.decodePoint(e,t);return{x:this.curve.encodeField(i.fromRed()),y:this.curve.encodeField(n.fromRed())}}publicKeyImport(e){Li(e&&typeof e=="object");let t=Po.decode(e.x,this.curve.endian);if(t.cmp(this.curve.p)>=0)throw new Error("Invalid point.");if(e.y!=null){let n=Po.decode(e.y,this.curve.endian);if(n.cmp(this.curve.p)>=0)throw new Error("Invalid point.");let s=this.curve.point(t,n);if(!s.validate())throw new Error("Invalid point.");return s.encode()}return this.curve.pointFromX(t).encode()}derive(e,t){let i=this.curve.decodeX(e),n=this.curve.decodeClamped(t);return i.mulBlind(n,Kn).encode()}};Su.exports=Mu});var Au=C((mI,Iu)=>{Iu.exports={naf:{width:9,points:[["67ae9c4a22928f491ff4ae743edac83a6343981981624886ac62485fd3f8e25c","1267b1d177ee69aba126a18e60269ef79f16ec176724030402c3684878f5b4d4"],["49fda73eade3587bfcef7cf7d12da5de5c2819f93e1be1a591409cc0322ef233","5f4825b298feae6fe02c6e148992466631282eca89430b5d10d21f83d676c8ed"],["14568685fcf4bd4ee9e3ee194b1d810783e809f3bbf1ce955855981af50e4107","31c563e32b47d52f87ce6468dd36ad41f0882b46f7abf23d12c4c4b59f4062b8"],["357cc970c80071651bf336e06f9422b886d80e5c2e4e0294d3e023065185715c","7f3d23c2c2dd0df4b2befce956f2d2fd1f789013236e4430c74e44845522f1c0"],["14e528b1154be417b6cf078dd6712438d381a5b2c593d552ff2fd2c1207cf3cb","2d9082313f21ab975a6f7ce340ff0fce1258591c3c9c58d4308f2dc36a033713"],["107427e0d5f366ccdb33adf0282d304f8843e3e88d22b7b83780e073b7c05fed","12dbb00ded538b7478466022d2da89b83740cfb2289a272387efe1aeea401f80"],["4f162deaec2ec435dc5ac6f95d20419ed9631374770189cb90617f3e66a18dc1","12cbfb2d04ff22f55162f70164d29331ace5af18a19a9aa1946d4cc4ad2e5cdf"],["7dc52d5a7db816e9b850741ea2fd72918d94985b85a20b4dc5597853a876df6a","6f6d2bca60003ef9f24ac245cc919fb717b188723b34f901cd6cfe9bec97be04"],["1d81f74a5ba45c7022e8c140d763b9c1b0e281a5304696e74f791a3a04a94472","3f185a93d95a4347227c5bb6ddd65cf42e1830823f435f3083fe6102691d55b9"],["6f0ac78e5eb90e87958588f9d47541edf252cb1dde3d073cc45e3e7ef9365716","6628d116b7975ae5f323e5ddf4f8cc35ae06d5c5c7d8a56effc66051336d289e"],["2188ac423c67db5625915e05222a391bcaf91f05d9b7cc2cab5798b2d2e14d95","23240c559c57b79a4df69a23fc46e50504277b1fa49369ab663d79782b33c0ee"],["794241471ed9ceb009384b370cb8790fca98552ecb822dc06b19362c36353455","71e918c03cdfca7207772e8d18ee8f9d92d79a0a83f378912362bc68d311dcd0"],["163bc180c22dfc5da23c5c052107bba93a88b4360aa1d4e729611d8f5a7f8079","631107a6ba83f7458194b9766a0a54f638ca20daf800384dbae1498677501939"],["39a32a30f3eb1da0eb7e3903b8ace3da3890b24b61a3a9e79db663b5db0f7a5d","4d4c54675dc1f1c9a1af9ca0010045dc803c16af345823136dd203715d67c491"],["38085391a0e2831f59c33fcce7591515784d359925f11ff958e0e4658efac0e9","42918001a829f49b5634e34ab7fac21b30e24660669ed91955cc31944a19e62a"],["5e3573b049d6135ffbbbbd9a480617434f2455b4a591f719e91153eeb75a32a1","54bc665420c789da1105d53983c1a0fc33bcc2690cd9b37d6566e21a85892871"],["7ed068b25b82c05fdc0e46bd80a357f3acd2f5c3b9330bc8d474e5b28270f6eb","01da83a187da8ccca704d46557a462551d70df7f943a681c3b97b1db6a21b7d3"],["05ca3370e7516f6686111b72650aab4c5484407f14b515ade03951c6a14a0aa3","6f407fc537b95277966e7f0f5e64b86904bf7baee091cee6011a3611834c6903"],["624cb312b698bbd6dbca79b8d2b53cb5d8b3ab33c19306e87c18211f095ab9c3","5b3336b2751e97c793731ac9b9a2243b6229f6d0bbea6b619395d0e5200bd8a3"],["1ddf6ece608fe2901b34b7e4f47cfcb75e947e293c704d8121b11a31a051b5f9","5e2dc58e9a48a749ce5296d229cfb34f96a147a8246d2e9844d52b52112ea94e"],["396b384f3d61cfc060308fbb1c941ebc9418e2d9abd81316e08d625f48c0e101","7223e5f7b66d1ca24962bac273a7aa6618cc60cb8a64a8837e0261107e7ad644"],["53cc3dca3410277fb38d75e4ac0dde8e77a99c817170dbc9696cffe7890fbd50","2592a3aafce64d7c69f4de468d5d5aa19845f5ca08f64a0a40e37d23ececbbe1"],["34705fe600f5aed77b29d3eacdffcd45d886904156d43dc550bb7fc889cc1368","299153c141a8950ffbcc8e9352993e642fa39a476200dd4acf42e158dbe3b01e"],["5969255bd089181b991fce96b1792ba330a14f8a0b061f8118c9c336b8504618","680a805fa0ae93c2a12b193517fb1147d355547e4ab18a9d6ca21575bbb4d7a4"],["27d1d57fa8808d3d452df14bda4248b37902752163b1fd499a92456c59918ecb","0a42f1c0f4c5d7de9e82904f0b4ff63988d31fedb8aad9d8ae009c7a1dff09c3"],["0811d14bfdfdcf2144edd9cf55bce584a9ba17aec3eac8aaa82987ad703d9b8a","42bea70d46f3ee0df0ec77d24c5495ea56ada2e0415920470c4746b68306376e"],["4de090761b863cb0f0650297f154a8e66d00c5119c38e5dd05303d905d527a4a","5eef0efd105361ce198a30e09e7e7edffbe3d70189e63ca68cf6057b9772baa8"],["1d45517858ce45556aaee056ebab7e0ef3dc9ae3740aed570f3e76bfb4fc4817","0b5a9d8fe8b7ccb04c0a5ef77798a3ec6e1bc1138604eb05e83844f0d4c5c699"],["4285edbe9117f30aae1ef5ee419eb1d472106c6b3d7f3ce3701e39324b0eeafc","503aa6104a682bcf2c0a60c84f4c22b50b0caa0fed8db87dedc7173eae04bdbd"],["3ef830cbeff9b79039b1b6bd9bb52bbcfa56d008d91b9703ea1c80351f8687d6","62349ff5d8dbd216a874769eec152ef9734bea9240eed623992c7553dc8ee4c8"],["649a996e6d4d3b60ccb526939ed8929134107e03e2fd4648eaa2fa9830822c1a","1648311b942fe95d492a1ace5e5235c1aea860d036d2475cc8964cd1acedee9c"],["3a95596d97770d050d1ecc075d58a74f5fe6b4b8222740534ba22c8be73f9d56","15a80cdcc03317a830fa4a7461de6bac136993e0a797f83b405c161a34c98fd7"],["2d265d3fe1c88903ca93685209418deec5af886bf0d9fdb3f499d831cbb76ce1","08376fb0663d3aa220948612b519af4a6a1f956622b15a305fb2e60a84210b3c"],["642cb15498d8c6b25803f3e56b98e2ea185ac808cbeab5eb0a610ed5babb9385","21b5ca5020a9e5a2334c0bee15193ea16c909963ffa6e1d93df4b239abeaeb3e"],["38e576301ff6cdd0822a19c6d610d445d3967e2bada903abb6220f68c6e79bef","458fe689e31a24952d2817dda4349109c1b26ef31699fa36c4f8389eeb60eac0"],["372bec78d75011a0ef2233cd08790a7f15c1ec1e3a78cac8d6652678641780db","32e9e47cf2f48612ed3e2c2006ea0c0c8476d3562aa88cefb67ec97abdb538e8"],["1aa3756aabcc3eb65afee34e0a15dd67bfb9fb199eb131f4cc6a3ca9ec4d1c77","42333e27831add6eb49af80e17347c63c26dd684758096ee3dbdbe03a49159ae"],["38db16447d79d3590c4a36e20286beadfbae91a4eed2e5e7dd4f975ac0537dc5","1c48ccaed60ec12ce862ea71165bba7df1739845df2a857f4ef0a0f714f96daa"],["176b78984cddfddef90bae619c6a98e951d9a7ac7d6af218ae7e76b273212fb7","7b5b93eda77443f366e2a127abe12212aad8536767ec1c5861143f777db85852"],["042d154bf7b4a7bd73897ae528c6bc552ea58d74f8109e8e4052d3e9d38bb0f6","42d1831323e279f9f7ee9e3470ba20ca7edc3245eca5d8ffa182de120a71fc90"],["1f8d28dd4f286a8d0687b626b01204434bf5874a9550d6e375116490c154e108","1ce82e2360367e06f41757fd45239f9bc2c61609139446b09b55a9c43da98bb8"],["613eb914c015076e9ae8356bf508c289e50b1c87d9e2546f6e406362e248e5e5","3edbaafcd8c41ef4aa18b254137d201a2ef0ca4ca28807156bc949e920b97353"],["27bf43826bf0310b4b3e3a405eff790a1d77a8d48b04891246cff8e193cb03a9","16a24d749cc1d234fbe8af9cfd782c3aaa5869d6db0afa7b4d4c67037514f2ea"],["769a6a59746d7bead417bdd9c3b5f5ae1dbd924083ffd9e88df7714f57a675c2","22dc1267cfb2b41c590abb7dc3df45619af688d0421f2bdfb50748335ec5da25"],["795734ee4fcc24194219d25d41a2889cdb942f765848e9df63bff0b158c7224d","756420ab5c71127d39d2e79907634a177af0e483e08484ea4d7b76f7100669b5"],["644d12fc5e7fcac5aeb5911d8240971a99fc59fdd2903f46958e6896aefbcf46","173450789fcd40172e8124fea56f7aedad2ee13fa8fc5209cc8cb572175216dc"],["5deca767ef17b9e8d4f351f5c8ad1fcc50e97a2ed687516bf5210679fd6c1110","4ddf2207da12f700708089989da016f3307ce5721c9e27c952599d67898aa396"],["296dcb24cb3185d037a94bef93c97cacd09fc7050ba8472da59d4a689d9d2848","0b17dc85a4acf73833fab728f15abccac97cd09e57975bd996d3e1dd8b060f7b"],["408a3f1af2e77dfe94f8e225b40dfc146abb1002db7bcf15fde61c1a6cf1b93f","4f01ec38854c15a879e7c7924f048e2ec951dcdf04a614088b68fbcc0954e1c8"],["07d2d9234970cdc9483e0a7c5ec52c49077c440e0a993a1e624f90b8fafbbf07","6ac2190030c210ae3e07b9239f6ee7affba263866ee7831a564c511f703f2295"],["2982d553002082320aa899b9b6887e40dedf11868fa931689795d93d58452873","215e16ca447978624cad0ea6bf45aada4eca914425ee275db2a26e980dc349b6"],["1d8649515cb49e136d2895b6276569e5c711fe1a343eeb5a3daaa8d0e7b42d1a","5b21e2f2978f343a3e9ec3316cdc111af3b55f34afa5fc3fcbf6c26c1bb7fb6c"],["5460df4d607147939cdbc04dbdcbdffd37c5eafdd501b50a67213a23ee724a97","69dfc7004263ccb52487d34ab134b80bb3030273999739cb9cdc16d71b9abcd8"],["24623476f0af9f42ca15a0697ad23abeaf5ed9dc4d2b44f7e8175486598125bb","6aebe4a1a22d9e31194dcde6d33ff3af77dda15c22b2ecba9329849b8c042687"],["64e507a02bfd8a8413117bac253b17f94b2911681ebc07c92da0de6a651dd538","513ac992d72b463da110afb612fbae36590248a0507d845ee95fab2d1caa03a4"],["47f3bd11324f6bee230a22a5bb06a3ccddbc0473b810689efaeef894a654bf0e","7e05db9b3ff886bf32608dfc8d14eaa91e2e2ef230e7c75618060e4285c492be"],["4a6d22703a7045d02d656015ea2d168385d42963a739a895e4fd87b3e55c5e0f","4c58d7a8c6ded0451798e51f16ffa5b637a87aa5defb119ba868d8cccf61776d"],["3e22af70a548097244d7798964598172a90391f84c59b04cea7af283ba368eb5","689d8b7cda23b8dea197c5119fbbbd81dd4b59a36cc283dbe292b5b6519a2968"],["61a6ba2ca42d9d557b3a2ff0867c1b8bb8fc40192d31ff637431a302bc065a10","63d805f5a79f845ea2915a25cf0a8cab2e0255212a1bd3c8852b25579b63721d"],["03d963eeae48556e88305f91c478efcfd2168c346b9ba185884ec8621e8cb414","74b75cc839a944ad8c639719d20fd9d48d2099ef24c8633eabec7a9ec1e7e183"],["0f04da69e0202f7b44c58b103c88de09a0599951fedb17e7f2152d6b93a58ae9","1fbc1c9cd03c4cfd46e8e90019debf86e8036587eade038346f91070c800b8c4"],["797899e488353ed0c6666aff11913b33be0190833766e809b2a68cbc671a9cfe","5dd70a33ff94a84b3fe660f7070e6179e86b5c846689265bf985ce424b8909cc"],["735b64bb872606510e4e7d57833eb7ffdc4aa0dbaa242439806be68379f77cdd","384aaaee3ca7ba2436fcb65910859ca5ec30c10af11df7d777d287bc1a2bce2c"],["6f6ea532a62cf4766f55a0a72a86b55e73fe9d3328ee94bfc271e122f99dc1ac","61d8203ef6da5d0b584541c02331c7f58617cf8d4f26d11776236ce8b113ac10"],["5d99a2a3d4aed730b827b68ed836a9910dce4e7b93faf456981ad6cd85748773","7eeacf5680fb6108a8b7edb45f7134644111b08e17c236469685af5a79474b9e"],["31d0b4bb57bd7b69363c064a49bf3c3b9d7635bcc287e7b3059d3d99fd8382e8","1592e581034e13d47d02b8966f5359097e652391be8fb1e803f4219a22aba2c0"],["424cf5c498bbbe8fa7e5c3247049cc3f45946d0e5f38c44a36a6c84b60a84aa0","34acd712d334a2315dc8fd00c5c9b7c5c9f29bca27380a018882a5ab4a0fcb43"],["33a6ae0522936ba774837aa7959972f9804e3ef02ae84c8039be6595598be247","37022798cc08be9b4ded34c1c5062ab3a26081d375cadf517972fb48135a6602"],["5939635b72aeba595b5f6e376d11a3e07d4b1153ab4d0a7ab267b8bcc47cc3cb","382162eb33db2322cbe01a38fa4d13720b6d8edfaf8116a628725ef4293a6c27"],["3649e78d2ae9fb0ee86b691c27386efce4f3e383790e3cfee2bd59c2e85c4036","09b0d9e0dd82e697b9be9d61ce0d1410e281122b483125c48f7942b22f5d5be4"],["62c7585d1677b7619d8200175346ec99118416d8fdf0103730d165934e96a973","5fef7955ee07304429995433a468d68dec4ecf6b08bbe8cd06869080094044de"],["0c94537d311e17f5b0c58989b5be7e40c88b978a8c074a1e9bb07a713f77f6d3","6deaaa5001bcbbbe9ae436fe42f7042ce74fbf83c14058427fad4587ed33c4e2"],["6f5c6894a8d3877312e608c11809c15dffec3df551711095c8cfc810533e1b3e","74eadab9389b40d6ac6cc0d6e333d628ced60a9ef7617751c20630d23477af7b"],["4e16e88e171f9a07e11f97bba65c0fe5483501f255343afb3335ed47fbcee08f","41bcd7dd328871247cb7995bc6bd2e1961e94b0fb12e5fb2f264f9ad2cf47d4c"],["65d8484cef146e6c232fb262c2ac8200a52c63ccec26ff6f038aa5c74982c741","67283346bbae9391952b141e57ca8e3a36f0363d3b81b1c0f2b3c30a92c74235"],["1c588485b64be8cb99bf97f065e75a82138ea2e035ba90b63745354e9cf729f8","7c9a18d6ebf5465a197989cfb9b5b2a66a5402f46c4708ac04187c6b157a0d77"],["2c80c4ad0aebcafab7e9d2519a329f8a1c7df21cb6b1acec7403c0204d6dce71","7f8e62983160756e35356df95d44467e621c7274372997ca74a9fb760b4db36f"],["1e1e5fc87fa2c49e2c44d5718e3d73c73a91a64ac1374652080bd9004291b9c6","153828e90ed8d94c0f86e0eb54ccb31073cd29ed62c34cd9f2dbc5d98872e597"],["0ce0488a30ed446d445efb1bd21ba32ec3d05d538e6393bc0e58e0849ad57129","7278074ac66ac779136f4d6a334b27633645dea0fc98d137e3dbd4015d12b5a1"],["01a6b81f7285f293f19ba019b009aed8280ce285af42fab91e87fb0bbfa6dea4","60f910dc7c9a82e7836f36acfe7ec26b9babfa8bf26b2945b3c1a43b0c19b4dc"],["79b4ce3c6990023859646690c9ea800174902acfa1aad7ff34eca032dbde7150","53a1053d3fc6c749bf8a928854f392d09fa851ba963ca661bffbe74f012ba45b"],["220ee355b5c39c1901ed34c0f50f7778ad1bedcd7259ae167c16514ffe333498","05fd9374986e1e06035dbfada0117035b96b159354262f2b2695af1256d6aa2a"],["1e2f97d2cb4a19ca40403b364253da71f65d2d4665894267e3c6a9db8b4a3a18","22804fb035acb519210ff99ed7a974a725d896a77933789b4dd45a37dea3466d"],["35b8699fa20987876ac3b3086965b05f8cc809d71cab45e017c68ac96e24ed5b","155079de21981778dc438353bf2c6a65967a1a33ebb74c866fb42f4e3cce3e39"],["3cb40c55f5f19c52958e8c4ecd9c459b1d3268b3971b2286d3e58d1fc6b6a6bd","379e1f1f59df05c74485615b87441ba6203f0cdddc6873a883d4cc6dd1b75921"],["6ad916290e0d003ce5c961679f77704dcd768589d7cb728c60f56852031803bf","1e602b4a6725832a56944234f84c4f85f79911b55beef903549089925f2ccbea"],["7c0162492ae668160aa56a60e8bd43ec088555f750d2223cc37362dead5de123","34e60b446eae100d4c3abc6cb02e4ca559457fb5a9030a290a2568fa4cbf118f"],["354c25bf7b3e83dd0c5e1f39b82e3567edeb5337634056c1091cd6a016caacdf","7abb271ef121630f85a9a1049b3ad78d5b889f533b37a713b8801de46770fc3a"],["1e581a4bcf7504f33f4342b2097504d13f9b5a27f4790a6cdde1242209862850","2164d56564360fd2b5dba2f2c6ef1045ab448c3b60b2f2196c2f74625fc39e07"],["533b56f18283ee79b9a180b887c298961bd9aaa6fa3ef97fcb0d5688e694bc3d","6011366753812df2bce83634a92dbac18dd1cffdbf9a97fa1b1d5b49e0026764"],["4b508b94e6e2e6cd260a20664ea7d727ad20587b63ebe826032e0d20cdc6627b","1e8ecd6ff5aabae78172a0214d07a5013992d133af58afa74049de726df2a6c4"],["3398c0c0219f5ac87a8c73fcd17b89311d120a53f5231cb761030c194fed4265","025b234a1dc8662c068c4ba903939c2f79f3f7a3ae64e5edbf667b13599142d9"],["5941a17b04cd3465031cb6745cb94eed24e1ff8d38a6e832f1637ae8e89c78e6","5309792c546b6cda458be331957763b5adb5d535d54a4a61023678faa2ee02ee"],["2cb490d2c0047fcbaffe1df26640bee73c158af6fec91343d606ce9d124a20c9","2e2952ebf089200aebfa3947f241e2fe85797afebdc1ea06d9d26de1b446a964"],["79305236b583232a91c63c7d9ca3750be7ee21711e4d6d257c39ae398212bde1","6f9ecdfa953e302c2014fd8512405e4be0d48302acd15e93936e8dba7d01053b"],["57d9fcb884b94664f35387fa6665cd9bc8136f90d804d77416ea99c3c653ee63","14197e65f0a3599c0b9fcef75b5fbb93580d1b2457b59fb70ce7b9bac88d0fbc"],["6d99df2c28c9fa1e38acddefd3e0931109143d873f3330377a9926bdacdd6523","2f21987905f397f092fc56c5ccd301a1e6afa3c4611627e25017b2e68d07c150"],["749d19591f1755bd481fa12a288166aac42911654c8c551395b265116269ceb9","7ec145aa7558d0342cd87b1750933cb6f3717e727a86a1cc1f2b0c274213688d"],["340f7f5ae19292957902635a5786d14fa38036b324ae759da501e32b8c4073f1","64e231a413f1379a26f4e8223ff91fe2ccd865549571d3c6c28871964b40a0ea"],["4aa33e00bf6e92cac4e84384e5dde0727394233afd5d24d357a8afeb94b08109","3385bb4fbc441937ee01b671d506227a654fd6c1c532cf5221710c6c56ec7e21"],["34b2ffca05f01088de266306c5cc122661e9308eab16929774e58565afc0e4eb","7662faf0f70e82c062c2b835fc6da3353d3cb20b80611ffa6ef2982cf62fa605"],["820fcb51326f1536ddb8dc1052aa198406c7e48f2c81e7664d15f8f9d3715e","756574c23bb01170b97d9fa1663a8ff2f5b97eaa5cd53f34140c1bcec8c262d9"],["0861d7e84cec6d6e33641ff6c85202fc0e9160797809ddc2193802499caf05d3","34936e0a5dc7e2a6217d475fbb8c1c607fb8b3565908a04fd5948abdd399c59f"],["5b4a1dc887ef684d7b4b165b70acb70842a2fa105935af15ecb4a097e33b8f2b","54d21511c05805e5298a72372b8289e9d59c46dc8b5c368bbfda620b68aa652c"],["755493ed60b13f03f9c019362a5af73fb49842dd6916e2572b1b6a312cd20cfc","0750bcbf7e449cec422b93ace1489e1b177d4dbbaa781d315c74d54bb444e9a9"],["5f1c341065b6a81ed2edb6bc38ba81b4c2e3fe2058e5baa13e1406eb2c5b4b4b","6179ebfa7f8086f26820fc99ca2f94c1be19bca672d79cea5b02a836119e06ba"],["1915024ee86acfba3f61ced9707521197195166fb1c4639bf3b3fcf0bf0ded46","5f2e0547032221d2b00937cf524590e3d90901ef0286ea0b032c1a81461b6d92"],["4e942d95930f38c8786ff4a8e576e7a29fb7627afe1fff91cda5006ba0624f5d","45902f695d512d70ce4c1e0520c0060896b94e14d2960b2fcf2ed5e138e0217b"],["63e45f3d91ab915d412bbaa17d1d249e1a1445077fbfaa6be7d35041c5116a91","46dad5a4ec2ad0b86938f5e09f1c03b53b660fc5137648b08527cd20708003da"],["5e2ddd2175417f72c9962c503ac5adf94ed11f28b9d41fccb6a4512886f3cc87","3523b218478911145af1dc431feb7db0a04066eb6e2ade3c7b67d11bc55323aa"],["62ff30a6b179a26e7247a8312cb3af3289e5d722f76a29f203aa623889aa05ec","562beb7999019346beaa80dfd5b95d614e1ff96c1cb1037f65c44997b797d066"],["14988b5d62084fb8335c2f261cdeddc1b634b09cedfce713ff5f0a0bb588a556","447068731fb98e821b8e413b3b48f2d1c8bea308f05aac877006b0f4c3b0cab3"],["1ac777f708a5942cc434236920e82ccc6af920c0a0676712255aa7082b37a5b6","52a6f88d92af1887c781501c6e3a88169a2831b74aefd416f22b47e8335ce317"],["5959792833b71bd5042b78e42212af671f5f87a08eafd8cdde2dcec8140e4bb3","41ce94633eabb8a1b08fac66f762997ed8c9e2af3558e1f6586ad6a5bf5b7b64"],["4464a7962e6722b457336fe98c91765b1ff178f9e892e90129e65fa7688a0607","3d1510b92fd33c501f058a7a86bddedf1b83f9b6e4f04829d321117013f891fe"],["62906d81e7f800e662519f4324ab4c8aac197661c729eed3e744d09efe721c08","4b68efb5b1b709ab86e3253d70bee87ba07875c04a64ecf7e35cd8cdc6c0f7d8"],["4300ff025ac78ef36e58ee7d0d732cf76cd0929fe265b3a093a57f23fc326757","2f92880570846ff2e90d91f16bce3705c9c3ca8011cc543091463b623e4b3c01"],["5427ba28d94652527a9b0c76f57a451e46bdc06cbc8a2481df17f66ffb1524e3","547a97c4afc8d1f74a5d51f7e524f68472f589cc0b396b21368628721537d722"],["424c4493810bfd5e3ffa21776326d8ff62bf8fe74504d7a2db5d3f74e5ce1015","74d0daa832d40405d01551a58b330ffc5abd5356230d6d7cabeb5b1a55046f32"],["54e10980d81b4ae8778896684295fa5c5475e8d68ec2a26e1b0a65383507b3cd","6b1eb48da6886c4d88cea720e9dc8b0d8c51a8f0e1943afa31a40eeb553c0676"],["732eb9e9ebb556e9f024c5574166738f4707b0fd005f568212ab575c1db71ddb","1fc6b00c89e48114d6b13d9920a0c78093994f2b08df147bdbb56bead2cea165"],["74029c04b34b7f314855fee42a04d0ddfdeb92ef3bf7cff629928a97733d96fb","501f63a252dfbc090733b5a208bfe08f81c91419ce3d2d6c0de8cdc5a5625014"],["04524402ebb71a60bf1055001000203a6d4917f112e50dd766cdd7b718a6edd7","71c9e2d15cdc47c565a696ffbe55277570930ed7ade13b9a254059365d5bf338"],["2555c620a50f2bbeeacac66228a96941fa733aa6070855331613578ed7c12794","2b3c1bc5cda7f93242561dbf7572237ac43bf013553230633a5e18b7e71597e5"],["555ea607b0ad18afaf70d7450543d7ffb5b883a3cad3e2778826ca97bf3211a6","6df903158f51aa530d411720a760f8ad0ce9904d54955fda74a349be58eddf5f"],["4db3cfa284207a250a9c83e1fec07e804d70065da586ff2c2a7d2bcb92e6fca6","2a4fbf1c51dc0b2a7783db2be3bd35c2d6462470c88c8b73ae3ce8503fa07154"],["5174e33ffdf28a87184a4d6427d821cbaa3b88ac293a90ca7e1eeae8c5050b16","315ca6bc8e35e4a3d06f89e1db1575b16197963ee8e64746fa998ccd403561cc"]]},doubles:{step:4,points:[["23a4860627e53aeeb8e22b1508249c9109578d33e7bf237459b2596d6c28f9f8","709696f2827fc3729f980f2e3aad6e78b06a11ff8e079c27d87aab37c16727eb"],["5e7e07ed4e1decbfe6e9cbc126905449d4b578fbb561576d20b8bcdd0cc2a556","0f55755c51f102796bf5ebaa81d3260e7d1b3d9ac127d9a80e142031566cf6c7"],["7d13c0248b891b47eb524f2692008e2f97b199bac426cb5902b9003a29ded6ea","59a976ab2c01a81a91f1a56c75ccc77a9e1e9e878e9fe9c3952080a6805b20d5"],["5de7faa2ee4e70132f541f79ca07cd54a39fe1347a6844d19e9d678a8411a565","2c9f23641e1c2e0aab8ea9926b432d92c0e8bc08901d6ff6df85e4cef854ec36"],["06b349eebfed4dad4a805b63a6ed2231a565cda752d9477ff427dd9a8c9ab5ed","07a09289ff3e1f9aab68aa374c48df65f550c2323607b97744dee990608b64f8"],["0af367956af630266b1cc760154256ed79da960dddca9d72a1e8cf27d8d43a77","21108d900134d3b3708dd28ace96b0b23dda9100e4b6a62a8131bd2f2ba408c5"],["1e45a60140a3b2dee9b8dc6ff307154a1b410bcd38e0e38fb10b2f6da1afbe2b","0e730da473dffd60d2f3241a85e68acb47d26e5043ad047d893f072c8dda0a76"],["4d1e116d136158c5ddabd4276832800f2c081c1072de6f2d931797a46abc0cbb","6d415be49d4e35b65cc51354b5008f8c43e84b7b5e8a4b84f44e1efb10c9b91a"],["2b6b892ae94b454b2c2d92bb947fc4d506d173d281779c2c153c001ded42d3d0","7f1cf64e0e180fc4d6e12c1b5c5285f376e979616a52c94a0dea4d48c5880cd2"],["0f6c3a96e0032a9394337a02ffb2c83ba70efb8f566feab530fc90fa3b4710e5","3d4e97e286378675038a4b58e84224ee515e1d6697ac79389f78479be167635a"],["52ee53b981dfbc41ddaa5ddc2754c4175f4811aa45f8e2b19a425657c238a83e","7eb0a1be3400dec87b388cad51613957643cdf0595b891cc6f925fb36da7f1c3"],["52a837bc7a7bc9459bcc2ecf80f74d9ed99def0342e18cfbe8e799fbc504fd52","50d6460185d8924e5485f23f36a98c86053514d163547adab6fe91478a411196"],["6b2bd5d00fab38ceca21a27d6aaec82626b14b555d859527718f8ca404eba4","727340c27a15f6ab3d80547f0827c56ab1ba33bc30d1ef3909ea9a3af10c67e5"],["71dd75fe35761c01a48597ec730bc33237902fd4ad8612cbed1031eebdf40de4","39674a4532078e34378667beae5cb55f814ead9bbaf7e01b3b69533e9f88a411"],["57426aefc21be9ccf162e23d25ac3002ba8534351e65613f870f690f2fd46cf5","6b45b002fb4e8a6f59a6ffb006ed71f75434217333b266325204c7d1ac2e1f34"],["6222bd88bf2df9d5d44b60cfb4a08a960078db7ed51a35eb3e0b6b8ff4eda202","0325bb42ea4ed025dd6bdaed261b7c4f5410b608ba902b068f1efa5782e45313"],["71ac99647b61b9eca6f0c23432a518f738aee708d5932d4ef0f172240250a226","3a96c2c028ebe5f48913be30147e41bc5e1cab9595d5404138a9aa1b5574cf25"],["1f6a1fd8cc0e05b2742ba0fc0369b5247670543637dd033e64dbce90b2f23e9f","779964401ee869a9b31c0ef874a86440ba85d25c2ce932bd31a0865869605e19"],["22e2c039067920c42980dcb3a905fc91601c2b34e819ce1532ada4a5fc39d5cc","631cf9945a09bf26d7e595b3f8e3390696870512820df63c5418577089e1a8bb"],["608de273a9f6a534219d7aaede3cf65a81e4dc03d7a2765eced1d2b7be4610f4","3b31d0113f98d81ab1312fb2837aa9c8dcc7960f84eb371358c6d841f67144fa"],["3f748617ca63ab3e44c6e34f63e7328ea56a2a146da34368a57dca181254fe02","0fed89e6420fc47b3938a2891ba9acee4cbb2899ee4e9ca15a13dc527dc1641e"],["69d98b5ecc35d56c97c0bf312955d199befe116b417d70f5f57e2dfd0af81ce5","3e26d487fbfe36ab44e0ca3b248fe94bce92a69b8154d50e2d5481f8259f4e8e"],["1e34443347f9e627b3531157faab6eaca1bc3114df4a1423cc12bf8417b5d622","295955a5ed061eca7f87b9485666ba9489ec20a9c484224dc920350bb4a6fc79"],["51f4ff8c599b1c96da82941520a9f5abf4a31eb8b84fc95056145ceb3b5775d0","35ac9588d46e41f3f6f99aee3852eeb4b12e807807d4bd1b7f8406b0d7863ac1"],["3faa2a093a19a02424f65a10955101f4dc015c43b2dfce8e001507abd741b845","7a1de10dacfda389ca663b15574bdc8ae8c5b6e7cee647e77b11ddbfc6eb8edc"],["1924416956ea2c1269062588569b18178011ea7cba1a3266284f48aa01d5a90f","0c8e28127b7dcdd206fb6fee96eb88cfc7db7319826ac8cdb8b1fb8adaf021de"],["49761c57ce3c8c4f1435d495903e2f536f3be3712e76af8d0b5a8b7d1ebc8fac","3225035e1065094ef32d7f3e7a6f8ff2748025f96e0c0b44eb35576b61e150a8"],["4339fa86a23242851a16afc3ab05b352a7b4bf53599a49dd7e29d364fc3a757b","6d07cc3462bae9160bbebb997510817040767faa9dbd13f158a5fe8a63a34b0e"],["6bda13918dcbaf8529d6326ae7a9c278b72417c2188c5ea4f062fc50639295fb","2c3fa803b162ee887d0d97a6734866f992f846625f314117075da54bb6c20a36"],["4da4821314574d4fed4dcf692c8b15b99b73f13633210333ce7871359b6e6424","314016034673d2d20529bc93a2dab6e462bcb5f66e1f4a6bf2170759a40a6e65"],["0b2cea0029ee963c0034b61bf19e384435f14554a7d297b5144838c38e375586","47ea95da28d39aaade5edb8ed941c687603cfdd1508776e96d6683199e99daea"],["4c27afff3c45f32c952d3984e14e29a098e685c9c2e723e5fc8047ae60b7e824","5f2c99e6526dc87d95f11eb626c29c3a90d0be1e51a4c49e5bbabd114bf5a66b"],["53e2a4ed1bbb48bd016c524a02f797654cfc969849f867681da94e341f377534","5a2334fdda642732a3c9520ce06581aa7f0f082882554c37b8d390a25a9bd559"],["7b8d2c823baafe0d878a55e8af1db150dec85b1424a4901f9beffd3a6196e3d6","1c45a557b3624f9b89ed15b3c3e1a065f1b453d948f7cf45d9494483f8af0c85"],["78877b5d8777410997dacaeea59400fc9db4421fac02c4282301c67d35fb7ffe","0341b46c328333e4484ce8607619014d41775c408c88856d2f9e19812d90fbf5"],["2b556bbc070b5c4bae9e575836d1d68ee9fbe800448c0d2c233f78185eed3f91","7ba01332807ebd892e00ddb368c0fa1b3f19b5b32efd90b178d984e1d7174d6f"],["0f72556998b0044799f0fd03210ded3d984e3843bbaf3c1d5d692bc94d43c4e7","16c19c5037c103d447caef4efe6bd81a490e7c668f6870f1b080863b5315df5e"],["1cd96ef237b213cd446f13b3ec40d32ecc593bc6ea71e77efc284341a5f3da1a","7a626aeb91efcb5f9777264f5e17ced8b411f68c713673ef0f184a5ccd60dbe3"],["31a75b21cb532622a7caf9e29e652ac4e47b1450edf6655acaf3797b55a7ca46","77006e7cf104982f8865081a2ff8a6911546755e31c3586353b0bd0826c5d790"],["543d84cb04fb2bf787b7aa382eaab5cd8d050ad8ee52aa8a285b945652014031","0358fdc5b63ed49e693d838f182b275846f42dd49a42ec2e6e932ba4de59ef20"],["0a2818f5f5d8937800c30ac6b847db2cdef655b864126302249144a5a15b205a","187c76a49af10851bb049ba97c0fbbb14b2621522a4e8d9670ea46e56c9a1bd6"],["7efb45d3a2851109d7a8d50ddb08fe308bbf674c019b965cdad4570a141e648a","0fe1198b11a1bf56867091c69d71f8b7792257dda321d43652e818acd0c28cda"],["472e960dd122a534f52377235350549df4a1dd7a08cfc580bff5fb4b0a70aa7b","10585d04fc529fef4c0c0776154fc7ebbaedbae8a99937e47598d0578932b7cc"],["04892cfff7f94ff7f07c1241e3ac4945bc46ea9d6a3c1c3adbce109a9afceb6a","3ae2aa25e2555135a7a3251c11a3f8eebe81758bc1c3e2cbc6e6ca461a543130"],["2401d311a3abfd2583f1c6aa519c1f18ff730a0abf730ddcc9c9739b04d8a85e","653224f3488cae1ae19a414a9932035a2bf2c46803b5532bbb645e62387ee34d"],["0ea2c846a535a115972161612a192588d92d68a3c9050eae91b2817b94e68325","3b82a8337b05f11bbac176a113be183a50a0331f3d3116f24b971b5a8b0d031b"],["0fb3f87c2c6c89c65b74299b77f3736546a8b9e41b19197476bff27354e1c128","1034d42c15a2bfe3e682fad49dbc2812caadf0c584bc30b51625b85d74e9d5f7"],["1bc7af1e38185e7c2d8d04371c7e177d7a9ddee1b81d7d26db7ad644c7dad28d","61d909d855661f2f7a5eef87795dc0491d027e12631b270fcaf2f65900314833"],["469d0960dbd0ef9c91c4597ccf7c209549b187ff63bd378b7dac577198d74a4d","0b5f21c7f86832241f2157c288bdc9394f83f8d57457f6d9f6b345e4909478cb"],["5e9ac4ab2f4a3c3526e1317f913d69e3826fe862efd0c80d9310319170c5cbeb","505f00fa8aee03ccbd2f33529ae1e4e4bcf2644fe673d0b0290ec32be5b51bab"],["11cd80e1fdcbc565efed81d17f3f54643ffeed1cff38f3825e115adbd82759f1","43f11943f7ef3fa68b980fee45e98134f1df22263b2d14419d61ffe62822dbe0"],["3328bc121616a9477165ed282053d203c24f4826076c638a2c6723d42c9bfadb","2bbf3f26c21b5cb273e5f4f0114c6718c5eb7291939b7697c74333cdfafac039"],["0ba774bb605dd804cae6887e81f6bd2c59e024fac8bf5f5c48a841a037c28398","54ba013ad2d04dcdfb5a151b7347ee9a10067ddd0a3907e9bc337a77bf911321"],["1074ff0267662dc2b4ce65aaa0229c375a3d0d843ce9349233949581c869b64c","299be0decb680ec28923da4d049770107d42c180b460da13a7b1efc7e6d5b022"],["25ed76d78c87c3bd64b4331902c5a853734283e25f19f320295667b80a340d35","179b5f92f545c7b326b3a63fb0b32a0f52b4159988436d5af50c1d0d76373947"],["75d942c04210dcde5d1bd4fabfc732d3f95568e399382c0423c83c41cb05dc3f","696cc14856cdc13c8fd7e2c5771731cbf38e3fad47a424679765c4874e35ab2d"],["5d9324f56975477d5945599eeeccec67708c996cd3f3f2818bf2591507e3502a","10985a3cfd573205281aec24e2c8b41f5cd8cdfc9d7be34675cf306bbe1b4f6a"],["7511066c0e12105a7b937c7ecef367d5afe6e621e5cabf4e490b09b7ada7ee07","604df365b8391cbca8848f88daa700b770da5bb136f70bfb0a3ea33ba386fcd5"],["2596e5b3cf5494e60d2a750d03c66abc2e0183af53620b893f9cf9fc3b76dc26","68a0a7ac9a0cc093884a6b84f45a2cde595194e0f48dbd566fa78a3174b182fe"],["28bd38d44030dd9ca028b2a2f31a795f4c7a5e85a785df7847e3d525e99d4787","552dd7405c4183733ad3c4e7ccb999b4fed81b7a4444aab499d41d6d78d5bbfc"],["59233a3346f61135f431f96cf0197e24ad38240b222c010a6ce538cf4c24347b","3cce55908611d2b93f221613f09cfc4dbcd2e2b609233eea5439ad1908a10b20"],["5830f025f1078d408948f73096af97de1e9e70b3be85890acb21132c34ff961f","67d451752c2433ffe66e47242e301e56db2b2f8203553cab9de717e25793d41e"],["6a0c8b194571e874b82d904da36d43096bbe36d512e24ff8dcb2b00b57ffd3ec","5f85adb7749cc735ec838bcccfe7d4b52902c6132998d7ac8e032cad031c42b8"],["53b3f967bff8760948dec5e9282f35d1434a5503790b9012e17faefbe7c4d699","404462283c8664a17daa5b4059dcd10e2699fd86d0140de9f3e8ad0566098ae5"]]}}});var Nf=C((xI,Bu)=>{"use strict";var vm=_u(),gm=Au();Bu.exports=new vm("X25519","ED25519",gm)});var qu=C((vI,ku)=>{ku.exports=function(e){return e!=null&&e.constructor!=null&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}});var xs=C((gI,Cu)=>{"use strict";var{Buffer:Xr}=Ht(),Tu=Symbol.for("BufferList");function tt(r){if(!(this instanceof tt))return new tt(r);tt._init.call(this,r)}tt._init=function(e){Object.defineProperty(this,Tu,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};tt.prototype._new=function(e){return new tt(e)};tt.prototype._offset=function(e){if(e===0)return[0,0];let t=0;for(let i=0;i<this._bufs.length;i++){let n=t+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-t];t=n}};tt.prototype._reverseOffset=function(r){let e=r[0],t=r[1];for(let i=0;i<e;i++)t+=this._bufs[i].length;return t};tt.prototype.get=function(e){if(e>this.length||e<0)return;let t=this._offset(e);return this._bufs[t[0]][t[1]]};tt.prototype.slice=function(e,t){return typeof e=="number"&&e<0&&(e+=this.length),typeof t=="number"&&t<0&&(t+=this.length),this.copy(null,0,e,t)};tt.prototype.copy=function(e,t,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||Xr.alloc(0);let s=!!e,f=this._offset(i),a=n-i,o=a,c=s&&t||0,d=f[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:Xr.concat(this._bufs,this.length);for(let u=0;u<this._bufs.length;u++)this._bufs[u].copy(e,c),c+=this._bufs[u].length;return e}if(o<=this._bufs[f[0]].length-d)return s?this._bufs[f[0]].copy(e,t,d,d+o):this._bufs[f[0]].slice(d,d+o);s||(e=Xr.allocUnsafe(a));for(let u=f[0];u<this._bufs.length;u++){let p=this._bufs[u].length-d;if(o>p)this._bufs[u].copy(e,c,d),c+=p;else{this._bufs[u].copy(e,c,d,d+o),c+=p;break}o-=p,d&&(d=0)}return e.length>c?e.slice(0,c):e};tt.prototype.shallowSlice=function(e,t){if(e=e||0,t=typeof t!="number"?this.length:t,e<0&&(e+=this.length),t<0&&(t+=this.length),e===t)return this._new();let i=this._offset(e),n=this._offset(t),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};tt.prototype.toString=function(e,t,i){return this.slice(t,i).toString(e)};tt.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};tt.prototype.duplicate=function(){let e=this._new();for(let t=0;t<this._bufs.length;t++)e.append(this._bufs[t]);return e};tt.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(Xr.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let t=0;t<e.length;t++)this.append(e[t]);else if(this._isBufferList(e))for(let t=0;t<e._bufs.length;t++)this.append(e._bufs[t]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(Xr.from(e));return this};tt.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};tt.prototype.indexOf=function(r,e,t){if(t===void 0&&typeof e=="string"&&(t=e,e=void 0),typeof r=="function"||Array.isArray(r))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof r=="number"?r=Xr.from([r]):typeof r=="string"?r=Xr.from(r,t):this._isBufferList(r)?r=r.slice():Array.isArray(r.buffer)?r=Xr.from(r.buffer,r.byteOffset,r.byteLength):Xr.isBuffer(r)||(r=Xr.from(r)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),r.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let f=this._bufs[n];for(;s<f.length;)if(f.length-s>=r.length){let o=f.indexOf(r,s);if(o!==-1)return this._reverseOffset([n,o]);s=f.length-r.length+1}else{let o=this._reverseOffset([n,s]);if(this._match(o,r))return o;s++}s=0}return-1};tt.prototype._match=function(r,e){if(this.length-r<e.length)return!1;for(let t=0;t<e.length;t++)if(this.get(r+t)!==e[t])return!1;return!0};(function(){let r={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in r)(function(t){r[t]===null?tt.prototype[t]=function(i,n){return this.slice(i,i+n)[t](0,n)}:tt.prototype[t]=function(i=0){return this.slice(i,i+r[t])[t](0)}})(e)})();tt.prototype._isBufferList=function(e){return e instanceof tt||tt.isBufferList(e)};tt.isBufferList=function(e){return e!=null&&e[Tu]};Cu.exports=tt});var Pu=C((wI,Nu)=>{var Ro=xs();Nu.exports=r=>{let e=async function*(){let t=yield,i=new Ro;for await(let n of r){if(!t){t=yield i.append(n),i=new Ro;continue}for(i.append(n);i.length>=t;){let s=i.shallowSlice(0,t);if(i.consume(t),t=yield s,!t){i.length&&(t=yield i,i=new Ro);break}}}if(t)throw Object.assign(new Error(`stream ended before ${t} bytes became available`),{code:"ERR_UNDER_READ",buffer:i})}();return e.next(),e}});var Ku=C((EI,Ru)=>{Ru.exports=class{constructor(e){if(!(e>0)||(e-1&e)!=0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}}});var Du=C((_I,Lu)=>{var Fu=Ku();Lu.exports=class{constructor(e){this.hwm=e||16,this.head=new Fu(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){let t=this.head;this.head=t.next=new Fu(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next){let t=this.tail.next;return this.tail.next=null,this.tail=t,this.tail.shift()}return e}isEmpty(){return this.head.isEmpty()}}});var Ou=C((II,zu)=>{var Ko=Du();zu.exports=r=>{r=r||{};let e;typeof r=="function"?(e=r,r={}):e=r.onEnd;let t=new Ko,i,n,s,f=()=>{if(!t.isEmpty()){if(r.writev){let g,M=[];for(;!t.isEmpty();){if(g=t.shift(),g.error)throw g.error;M.push(g.value)}return{done:g.done,value:M}}let y=t.shift();if(y.error)throw y.error;return y}return s?{done:!0}:new Promise((y,g)=>{n=M=>(n=null,M.error?g(M.error):r.writev&&!M.done?y({done:M.done,value:[M.value]}):y(M),i)})},a=y=>n?n(y):(t.push(y),i),o=y=>(t=new Ko,n?n({error:y}):(t.push({error:y}),i)),c=y=>s?i:a({done:!1,value:y}),d=y=>s?i:(s=!0,y?o(y):a({done:!0})),u=()=>(t=new Ko,d(),{done:!0}),p=y=>(d(y),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:f,return:u,throw:p,push:c,end:d},!e)return i;let x=i;return i={[Symbol.asyncIterator](){return this},next(){return x.next()},throw(y){return x.throw(y),e&&(e(y),e=null),{done:!0}},return(){return x.return(),e&&(e(),e=null),{done:!0}},push:c,end(y){return x.end(y),e&&(e(y),e=null),i}},i}});var Hu=C((AI,Uu)=>{"use strict";var wm=()=>{let r={};return r.promise=new Promise((e,t)=>{r.resolve=e,r.reject=t}),r};Uu.exports=wm});var Ju=C((BI,Vu)=>{"use strict";var Sm=Pu(),Em=Ou(),Mm=Hu();Vu.exports=r=>{let e=Em(),t=Sm(r.source),i=Mm(),n,s=r.sink(async function*(){yield*e,yield*await i.promise}());return s.catch(a=>{n=a}),{reader:t,writer:e,stream:{sink:a=>n?Promise.reject(n):(i.resolve(a),s),source:t},rest:()=>e.end(),write:e.push,read:async()=>(await t.next()).value}}});var Zu=C((kI,Gu)=>{Gu.exports=Xu;var Yu=128,_m=127,Im=~_m,Am=Math.pow(2,31);function Xu(r,e,t){e=e||[],t=t||0;for(var i=t;r>=Am;)e[t++]=r&255|Yu,r/=128;for(;r&Im;)e[t++]=r&255|Yu,r>>>=7;return e[t]=r|0,Xu.bytes=t-i+1,e}});var $u=C((qI,Wu)=>{Wu.exports=Lo;var Bm=128,ju=127;function Lo(r,e){var t=0,e=e||0,i=0,n=e,s,f=r.length;do{if(n>=f)throw Lo.bytes=0,new RangeError("Could not decode varint");s=r[n++],t+=i<28?(s&ju)<<i:(s&ju)*Math.pow(2,i),i+=7}while(s>=Bm);return Lo.bytes=n-e,t}});var el=C((CI,Qu)=>{var km=Math.pow(2,7),qm=Math.pow(2,14),Cm=Math.pow(2,21),Tm=Math.pow(2,28),Nm=Math.pow(2,35),Pm=Math.pow(2,42),Rm=Math.pow(2,49),Km=Math.pow(2,56),Lm=Math.pow(2,63);Qu.exports=function(r){return r<km?1:r<qm?2:r<Cm?3:r<Tm?4:r<Nm?5:r<Pm?6:r<Rm?7:r<Km?8:r<Lm?9:10}});var Cr=C((TI,tl)=>{tl.exports={encode:Zu(),decode:$u(),encodingLength:el()}});var Fo=C((NI,rl)=>{"use strict";var il=Cr(),{Buffer:Fm}=Ht(),nl=(r,e,t)=>{let i=il.encode(r,e,t);return nl.bytes=il.encode.bytes,e||Fm.from(i)};rl.exports=nl});var dl=C((PI,Pf)=>{"use strict";var{Buffer:sl}=Ht(),fl=xs(),al=Fo(),Do=8,ol=10*1024;function cl(r){r=r||{};let e=Math.max(r.poolSize||ol,r.minPoolSize||Do),t=r.lengthEncoder||al;return i=>async function*(){let n=sl.alloc(e),s=0;for await(let f of i){t(f.length,n,s);let a=n.slice(s,s+t.bytes);s+=t.bytes,n.length-s<Do&&(n=sl.alloc(e),s=0),yield new fl().append(a).append(f)}}()}cl.single=(r,e)=>{e=e||{};let t=e.lengthEncoder||al;return new fl([t(r.length),r])};Pf.exports=cl;Pf.exports.MIN_POOL_SIZE=Do;Pf.exports.DEFAULT_POOL_SIZE=ol});var zo=C((RI,hl)=>{"use strict";var{Buffer:Dm}=Ht(),ul=Cr(),zm=r=>new Proxy({},{get:(e,t)=>t[0]==="l"?r[t]:r.get(parseInt(t))}),ll=r=>{let e=ul.decode(Dm.isBuffer(r)?r:zm(r));return ll.bytes=ul.decode.bytes,e};hl.exports=ll});var ml=C((KI,Rf)=>{"use strict";var{Buffer:Om}=Ht(),Oo=xs(),Um=zo(),bl=8,pl=1024*1024*4,yl=Om.alloc(0),$i={LENGTH:"readLength",DATA:"readData"},Hm={[$i.LENGTH]:(r,e,t,i)=>{e=e.append(r);let n;try{n=i.lengthDecoder(e)}catch(s){if(e.length>i.maxLengthLength)throw Object.assign(s,{message:"message length too long",code:"ERR_MSG_LENGTH_TOO_LONG"});if(s instanceof RangeError)return{mode:$i.LENGTH,buffer:e};throw s}if(n>i.maxDataLength)throw Object.assign(new Error("message data too long"),{code:"ERR_MSG_DATA_TOO_LONG"});return r=e.shallowSlice(i.lengthDecoder.bytes),e=new Oo,i.onLength&&i.onLength(n),n<=0?(i.onData&&i.onData(yl),{mode:$i.LENGTH,chunk:r,buffer:e,data:yl}):{mode:$i.DATA,chunk:r,buffer:e,state:{dataLength:n}}},[$i.DATA]:(r,e,t,i)=>{if(e=e.append(r),e.length<t.dataLength)return{mode:$i.DATA,buffer:e,state:t};let{dataLength:n}=t,s=e.shallowSlice(0,n);return r=e.length>n?e.shallowSlice(n):null,e=new Oo,i.onData&&i.onData(s),{mode:$i.LENGTH,chunk:r,buffer:e,data:s}}};function Uo(r){return r=r||{},r.lengthDecoder=r.lengthDecoder||Um,r.maxLengthLength=r.maxLengthLength||bl,r.maxDataLength=r.maxDataLength||pl,e=>async function*(){let t=new Oo,i=$i.LENGTH,n;for await(let s of e)for(;s;){let f=Hm[i](s,t,n,r);({mode:i,chunk:s,buffer:t,state:n}=f),f.data&&(yield f.data)}if(t.length)throw Object.assign(new Error("unexpected end of input"),{code:"ERR_UNEXPECTED_EOF"})}()}Uo.fromReader=(r,e)=>{e=e||{};let t=1,i={[Symbol.asyncIterator](){return this},next:async()=>{try{return await r.next(t)}catch(n){if(n.code==="ERR_UNDER_READ")return{done:!0,value:null};throw n}finally{t=1}}};return e.onLength=n=>{t=n},Uo(e)(i)};Rf.exports=Uo;Rf.exports.MAX_LENGTH_LENGTH=bl;Rf.exports.MAX_DATA_LENGTH=pl});var gl=C((LI,xl)=>{"use strict";var{Buffer:Vm}=Ht(),vl=(r,e,t)=>(e=e||Vm.allocUnsafe(4),e.writeInt32BE(r,t),e);vl.bytes=4;xl.exports=vl});var El=C((FI,wl)=>{"use strict";var Sl=r=>{if(r.length<4)throw RangeError("Could not decode int32BE");return r.readInt32BE(0)};Sl.bytes=4;wl.exports=Sl});var Ho=C(Ln=>{"use strict";Ln.encode=dl();Ln.decode=ml();Ln.varintEncode=Fo();Ln.varintDecode=zo();Ln.int32BEEncode=gl();Ln.int32BEDecode=El()});var Il=C((zI,Ml)=>{"use strict";var Jm=qu(),Gm=Ju(),_l=Ho();Ml.exports=(r,e={})=>{let t=Gm(r),i=_l.decode.fromReader(t.reader,e),n=!1,s={read:async f=>{let{value:a,done:o}=await t.reader.next(f);if(o&&a.length<f)throw new Error("Couldn't read enough bytes");if(n=o,!a)throw new Error("Value is null");return a},readLP:async()=>{let{value:f,done:a}=await i.next();if(n=a,!f)throw new Error("Value is null");return f},readPB:async f=>{let a=await s.readLP();if(!a)throw new Error("Value is null");let o=Jm(a)?a:a.slice();return f.decode(o)},write:f=>{t.writer.push(f)},writeLP:f=>{s.write(_l.encode.single(f,e))},writePB:(f,a)=>{s.writeLP(a.encode(f))},pb:f=>({read:()=>s.readPB(f),write:a=>s.writePB(a,f)}),unwrap:()=>(t.rest(),t.stream)};return s}});var Bl=C((OI,Al)=>{Al.exports=function(e){if(e){if(typeof e[Symbol.iterator]=="function")return e[Symbol.iterator]();if(typeof e[Symbol.asyncIterator]=="function")return e[Symbol.asyncIterator]();if(typeof e.next=="function")return e}throw new Error("argument is not an iterator or iterable")}});var ql=C((UI,kl)=>{"use strict";var Xm=Bl();kl.exports=function(){let e,t,i=async s=>{if(e)throw new Error("already piped");e=Xm(s),t&&t(e)},n={[Symbol.asyncIterator](){return this},next(){return e?e.next():new Promise(s=>{t=f=>{t=null,s(f.next())}})}};return{sink:i,source:n}}});var Nl=C((HI,Cl)=>{var Tl=ql();Cl.exports=function(){var r=Tl(),e=Tl();return[{source:r.source,sink:e.sink},{source:e.source,sink:r.sink}]}});var Pl=C((VI,vs)=>{"use strict";var{Buffer:Kf}=Ht(),Lf=xs();vs.exports=async function*(r){for await(let e of r)Kf.isBuffer(e)?yield e:Lf.isBufferList(e)?yield e.slice():yield Kf.from(e)};vs.exports.toBuffer=vs.exports;vs.exports.toList=async function*(r){for await(let e of r)Kf.isBuffer(e)?yield new Lf().append(e):Lf.isBufferList(e)?yield e:yield new Lf().append(Kf.from(e))}});var Ll=C((JI,I0)=>{var Rl=(...r)=>{let e;for(;r.length;)e=r.shift()(e);return e},Vo=r=>r&&(typeof r[Symbol.asyncIterator]=="function"||typeof r[Symbol.iterator]=="function"||typeof r.next=="function"),Ff=r=>r&&typeof r.sink=="function"&&Vo(r.source),Ym=r=>e=>(r.sink(e),r.source),Kl=(...r)=>{if(Ff(r[0])){let e=r[0];r[0]=()=>e.source}else if(Vo(r[0])){let e=r[0];r[0]=()=>e}if(r.length>1&&Ff(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let e=1;e<r.length-1;e++)Ff(r[e])&&(r[e]=Ym(r[e]));return Rl(...r)};I0.exports=Kl;I0.exports.pipe=Kl;I0.exports.rawPipe=Rl;I0.exports.isIterable=Vo;I0.exports.isDuplex=Ff});var zl=C(gs=>{"use strict";var ws=Ki();function Fl(r,e,t){return ws(r&&typeof r.id=="string"),e==null&&(e=Buffer.alloc(0)),t==null&&(t=Buffer.alloc(r.size,0)),r.mac(e,t)}function Dl(r,e,t,i){if(t==null&&(t=Buffer.alloc(0)),ws(r&&typeof r.id=="string"),ws(Buffer.isBuffer(e)),ws(Buffer.isBuffer(t)),ws(i>>>0===i),e.length!==r.size)throw new RangeError("Invalid PRK length.");let n=Math.ceil(i/r.size);if(n>255)throw new RangeError("Invalid output length.");let s=Buffer.alloc(n*r.size),f=Buffer.from([0]),a=r.hmac(),o=Buffer.alloc(0),c=0;for(let d=0;d<n;d++)f[0]+=1,a.init(e),a.update(o),a.update(t),a.update(f),o=a.final(),c+=o.copy(s,c);return s.slice(0,i)}function Zm(r,e,t,i,n){let s=Fl(r,e,t);return Dl(r,s,i,n)}gs.native=0;gs.extract=Fl;gs.expand=Dl;gs.derive=Zm});var Ul=C((XI,Ol)=>{"use strict";Ol.exports=zl()});var Jl=C((YI,Hl)=>{"use strict";var A0=Ki(),Vl=class{constructor(e,t,i=[],n=[]){A0(typeof e=="function"),A0(t>>>0===t),A0(Array.isArray(i)),A0(Array.isArray(n)),this.hash=e,this.size=t,this.x=i,this.y=n,this.inner=new e,this.outer=new e}init(e){if(A0(Buffer.isBuffer(e)),e.length>this.size){let i=this.hash,n=new i;n.init(...this.x),n.update(e),e=n.final(...this.y),A0(e.length<=this.size)}let t=Buffer.alloc(this.size);for(let i=0;i<e.length;i++)t[i]=e[i]^54;for(let i=e.length;i<t.length;i++)t[i]=54;this.inner.init(...this.x),this.inner.update(t);for(let i=0;i<e.length;i++)t[i]=e[i]^92;for(let i=e.length;i<t.length;i++)t[i]=92;return this.outer.init(...this.x),this.outer.update(t),this}update(e){return this.inner.update(e),this}final(){return this.outer.update(this.inner.final(...this.y)),this.outer.final(...this.y)}};Hl.exports=Vl});var Xo=C((ZI,Gl)=>{"use strict";var Ss=Ki(),Wm=Jl(),Df=-1,Jo=Buffer.alloc(8,0),Xl=Buffer.alloc(64,0);Xl[0]=128;var jm=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),nr=class{constructor(){this.state=new Uint32Array(8),this.msg=new Uint32Array(64),this.block=Buffer.alloc(64),this.size=Df}init(){return this.state[0]=1779033703,this.state[1]=3144134277,this.state[2]=1013904242,this.state[3]=2773480762,this.state[4]=1359893119,this.state[5]=2600822924,this.state[6]=528734635,this.state[7]=1541459225,this.size=0,this}update(e){return Ss(Buffer.isBuffer(e)),this._update(e,e.length),this}final(){return this._final(Buffer.alloc(32))}_update(e,t){Ss(this.size!==Df,"Context is not initialized.");let i=this.size&63,n=0;if(this.size+=t,i>0){let s=64-i;if(s>t&&(s=t),e.copy(this.block,i,n,n+s),i+=s,t-=s,n+=s,i<64)return;this._transform(this.block,0)}for(;t>=64;)this._transform(e,n),n+=64,t-=64;t>0&&e.copy(this.block,0,n,n+t)}_final(e){Ss(this.size!==Df,"Context is not initialized.");let t=this.size&63,i=this.size*8;Go(Jo,i*(1/4294967296)>>>0,0),Go(Jo,i>>>0,4),this._update(Xl,1+(119-t&63)),this._update(Jo,8);for(let n=0;n<8;n++)Go(e,this.state[n],n*4),this.state[n]=0;for(let n=0;n<64;n++)this.msg[n]=0;for(let n=0;n<64;n++)this.block[n]=0;return this.size=Df,e}_transform(e,t){let i=this.msg,n=this.state[0],s=this.state[1],f=this.state[2],a=this.state[3],o=this.state[4],c=this.state[5],d=this.state[6],u=this.state[7],p=0;for(;p<16;p++)i[p]=nx(e,t+p*4);for(;p<64;p++)i[p]=tx(i[p-2])+i[p-7]+ex(i[p-15])+i[p-16];for(p=0;p<64;p++){let x=u+Qm(o)+rx(o,c,d)+jm[p]+i[p],y=$m(n)+ix(n,s,f);u=d,d=c,c=o,o=a+x>>>0,a=f,f=s,s=n,n=x+y>>>0}this.state[0]+=n,this.state[1]+=s,this.state[2]+=f,this.state[3]+=a,this.state[4]+=o,this.state[5]+=c,this.state[6]+=d,this.state[7]+=u}static hash(){return new nr}static hmac(){return new Wm(nr,64)}static digest(e){return nr.ctx.init().update(e).final()}static root(e,t){return Ss(Buffer.isBuffer(e)&&e.length===32),Ss(Buffer.isBuffer(t)&&t.length===32),nr.ctx.init().update(e).update(t).final()}static multi(e,t,i){let{ctx:n}=nr;return n.init(),n.update(e),n.update(t),i&&n.update(i),n.final()}static mac(e,t){return nr.hmac().init(t).update(e).final()}};nr.native=0;nr.id="SHA256";nr.size=32;nr.bits=256;nr.blockSize=64;nr.zero=Buffer.alloc(32,0);nr.ctx=new nr;function $m(r){return(r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10)}function Qm(r){return(r>>>6|r<<26)^(r>>>11|r<<21)^(r>>>25|r<<7)}function ex(r){return(r>>>7|r<<25)^(r>>>18|r<<14)^r>>>3}function tx(r){return(r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10}function rx(r,e,t){return t^r&(e^t)}function ix(r,e,t){return r&e|t&(r|e)}function nx(r,e){return r[e++]*16777216+r[e++]*65536+r[e++]*256+r[e]}function Go(r,e,t){return r[t++]=e>>>24,r[t++]=e>>>16,r[t++]=e>>>8,r[t++]=e,t}Gl.exports=nr});var Zl=C((WI,Yl)=>{"use strict";function sx(r){if(r.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),t=0;t<e.length;t++)e[t]=255;for(var i=0;i<r.length;i++){var n=r.charAt(i),s=n.charCodeAt(0);if(e[s]!==255)throw new TypeError(n+" is ambiguous");e[s]=i}var f=r.length,a=r.charAt(0),o=Math.log(f)/Math.log(256),c=Math.log(256)/Math.log(f);function d(x){if(x instanceof Uint8Array||(ArrayBuffer.isView(x)?x=new Uint8Array(x.buffer,x.byteOffset,x.byteLength):Array.isArray(x)&&(x=Uint8Array.from(x))),!(x instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(x.length===0)return"";for(var y=0,g=0,M=0,k=x.length;M!==k&&x[M]===0;)M++,y++;for(var R=(k-M)*c+1>>>0,K=new Uint8Array(R);M!==k;){for(var L=x[M],O=0,F=R-1;(L!==0||O<g)&&F!==-1;F--,O++)L+=256*K[F]>>>0,K[F]=L%f>>>0,L=L/f>>>0;if(L!==0)throw new Error("Non-zero carry");g=O,M++}for(var G=R-g;G!==R&&K[G]===0;)G++;for(var B=a.repeat(y);G<R;++G)B+=r.charAt(K[G]);return B}function u(x){if(typeof x!="string")throw new TypeError("Expected String");if(x.length===0)return new Uint8Array;var y=0;if(x[y]!==" "){for(var g=0,M=0;x[y]===a;)g++,y++;for(var k=(x.length-y)*o+1>>>0,R=new Uint8Array(k);x[y];){var K=e[x.charCodeAt(y)];if(K===255)return;for(var L=0,O=k-1;(K!==0||L<M)&&O!==-1;O--,L++)K+=f*R[O]>>>0,R[O]=K%256>>>0,K=K/256>>>0;if(K!==0)throw new Error("Non-zero carry");M=L,y++}if(x[y]!==" "){for(var F=k-M;F!==k&&R[F]===0;)F++;for(var G=new Uint8Array(g+(k-F)),B=g;F!==k;)G[B++]=R[F++];return G}}}function p(x){var y=u(x);if(y)return y;throw new Error("Non-base"+f+" character")}return{encode:d,decodeUnsafe:u,decode:p}}Yl.exports=sx});var di=C(Yo=>{"use strict";Yo.TextEncoder=TextEncoder;Yo.TextDecoder=TextDecoder});var zf=C(($I,Wl)=>{"use strict";var{TextEncoder:fx,TextDecoder:ax}=di(),ox=new ax,cx=r=>ox.decode(r),dx=new fx,hx=r=>dx.encode(r);function ux(r,e){let t=new Uint8Array(e),i=0;for(let n of r)t.set(n,i),i+=n.length;return t}Wl.exports={decodeText:cx,encodeText:hx,concat:ux}});var Ql=C((QI,jl)=>{"use strict";var{encodeText:lx}=zf(),$l=class{constructor(e,t,i,n){this.name=e,this.code=t,this.codeBuf=lx(this.code),this.alphabet=n,this.codec=i(n)}encode(e){return this.codec.encode(e)}decode(e){for(let t of e)if(this.alphabet&&this.alphabet.indexOf(t)<0)throw new Error(`invalid character '${t}' in '${e}'`);return this.codec.decode(e)}};jl.exports=$l});var t1=C((eA,e1)=>{"use strict";var bx=(r,e,t)=>{let i={};for(let c=0;c<e.length;++c)i[e[c]]=c;let n=r.length;for(;r[n-1]==="=";)--n;let s=new Uint8Array(n*t/8|0),f=0,a=0,o=0;for(let c=0;c<n;++c){let d=i[r[c]];if(d===void 0)throw new SyntaxError("Invalid character "+r[c]);a=a<<t|d,f+=t,f>=8&&(f-=8,s[o++]=255&a>>f)}if(f>=t||255&a<<8-f)throw new SyntaxError("Unexpected end of data");return s},px=(r,e,t)=>{let i=e[e.length-1]==="=",n=(1<<t)-1,s="",f=0,a=0;for(let o=0;o<r.length;++o)for(a=a<<8|r[o],f+=8;f>t;)f-=t,s+=e[n&a>>f];if(f&&(s+=e[n&a<<t-f]),i)for(;s.length*t&7;)s+="=";return s},yx=r=>e=>({encode(t){return px(t,e,r)},decode(t){return bx(t,e,r)}});e1.exports={rfc4648:yx}});var Qi=C((tA,r1)=>{"use strict";var Es=Zl(),mx=Ql(),{rfc4648:sr}=t1(),{decodeText:xx,encodeText:vx}=zf(),gx=()=>({encode:xx,decode:vx}),i1=[["identity","\0",gx,""],["base2","0",sr(1),"01"],["base8","7",sr(3),"01234567"],["base10","9",Es,"0123456789"],["base16","f",sr(4),"0123456789abcdef"],["base16upper","F",sr(4),"0123456789ABCDEF"],["base32hex","v",sr(5),"0123456789abcdefghijklmnopqrstuv"],["base32hexupper","V",sr(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV"],["base32hexpad","t",sr(5),"0123456789abcdefghijklmnopqrstuv="],["base32hexpadupper","T",sr(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV="],["base32","b",sr(5),"abcdefghijklmnopqrstuvwxyz234567"],["base32upper","B",sr(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"],["base32pad","c",sr(5),"abcdefghijklmnopqrstuvwxyz234567="],["base32padupper","C",sr(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="],["base32z","h",sr(5),"ybndrfg8ejkmcpqxot1uwisza345h769"],["base36","k",Es,"0123456789abcdefghijklmnopqrstuvwxyz"],["base36upper","K",Es,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"],["base58btc","z",Es,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base58flickr","Z",Es,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base64","m",sr(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",sr(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",sr(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",sr(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],n1=i1.reduce((r,e)=>(r[e[0]]=new mx(e[0],e[1],e[2],e[3]),r),{}),wx=i1.reduce((r,e)=>(r[e[1]]=n1[e[0]],r),{});r1.exports={names:n1,codes:wx}});var en=C((Fi,s1)=>{"use strict";var B0=Qi(),{encodeText:Sx,decodeText:Of,concat:f1}=zf();function Mx(r,e){if(!e)throw new Error("requires an encoded Uint8Array");let{name:t,codeBuf:i}=Fn(r);return Ex(t,e),f1([i,e],i.length+e.length)}function _x(r,e){let t=Fn(r),i=Sx(t.encode(e));return f1([t.codeBuf,i],t.codeBuf.length+i.length)}function Ix(r){r instanceof Uint8Array&&(r=Of(r));let e=r[0];return["f","F","v","V","t","T","b","B","c","C","h","k","K"].includes(e)&&(r=r.toLowerCase()),Fn(r[0]).decode(r.substring(1))}function Ax(r){if(r instanceof Uint8Array&&(r=Of(r)),Object.prototype.toString.call(r)!=="[object String]")return!1;try{return Fn(r[0]).name}catch(e){return!1}}function Ex(r,e){Fn(r).decode(Of(e))}function Fn(r){if(B0.names[r])return B0.names[r];if(B0.codes[r])return B0.codes[r];throw new Error(`Unsupported encoding: ${r}`)}function Bx(r){return r instanceof Uint8Array&&(r=Of(r)),Fn(r[0])}Fi=s1.exports=Mx;Fi.encode=_x;Fi.decode=Ix;Fi.isEncoded=Ax;Fi.encoding=Fn;Fi.encodingFromData=Bx;Fi.names=Object.freeze(B0.names);Fi.codes=Object.freeze(B0.codes)});var c1=C((rA,a1)=>{a1.exports=Zo;var o1=128,kx=127,qx=~kx,Cx=Math.pow(2,31);function Zo(r,e,t){if(Number.MAX_SAFE_INTEGER&&r>Number.MAX_SAFE_INTEGER)throw Zo.bytes=0,new RangeError("Could not encode varint");e=e||[],t=t||0;for(var i=t;r>=Cx;)e[t++]=r&255|o1,r/=128;for(;r&qx;)e[t++]=r&255|o1,r>>>=7;return e[t]=r|0,Zo.bytes=t-i+1,e}});var u1=C((iA,d1)=>{d1.exports=Wo;var Tx=128,h1=127;function Wo(r,e){var t=0,e=e||0,i=0,n=e,s,f=r.length;do{if(n>=f||i>49)throw Wo.bytes=0,new RangeError("Could not decode varint");s=r[n++],t+=i<28?(s&h1)<<i:(s&h1)*Math.pow(2,i),i+=7}while(s>=Tx);return Wo.bytes=n-e,t}});var b1=C((nA,l1)=>{var Nx=Math.pow(2,7),Px=Math.pow(2,14),Rx=Math.pow(2,21),Kx=Math.pow(2,28),Lx=Math.pow(2,35),Fx=Math.pow(2,42),Dx=Math.pow(2,49),zx=Math.pow(2,56),Ox=Math.pow(2,63);l1.exports=function(r){return r<Nx?1:r<Px?2:r<Rx?3:r<Kx?4:r<Lx?5:r<Fx?6:r<Dx?7:r<zx?8:r<Ox?9:10}});var y1=C((sA,p1)=>{p1.exports={encode:c1(),decode:u1(),encodingLength:b1()}});var x1=C((fA,m1)=>{"use strict";var Ux=Object.freeze({identity:0,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,"murmur3-128":34,"murmur3-32":35,"dbl-sha2-256":86,md4:212,md5:213,bmt:214,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,kangarootwelve:7425,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082});m1.exports={names:Ux}});var Uf=C((aA,v1)=>{"use strict";var{encoding:Hx}=en(),{TextDecoder:Vx}=di(),Jx=new Vx("utf8");function Gx(r){let e="";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e}function Xx(r,e="utf8"){return e==="utf8"||e==="utf-8"?Jx.decode(r):e==="ascii"?Gx(r):Hx(e).encode(r)}v1.exports=Xx});var jo=C((oA,g1)=>{"use strict";var{encoding:Yx}=en(),{TextEncoder:Zx}=di(),Wx=new Zx;function jx(r){let e=new Uint8Array(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}function $x(r,e="utf8"){return e==="utf8"||e==="utf-8"?Wx.encode(r):e==="ascii"?jx(r):Yx(e).decode(r)}g1.exports=$x});var $o=C((cA,w1)=>{"use strict";function Qx(r,e){e||(e=r.reduce((n,s)=>n+s.length,0));let t=new Uint8Array(e),i=0;for(let n of r)t.set(n,i),i+=n.length;return t}w1.exports=Qx});var Is=C((dA,S1)=>{"use strict";var E1=en(),k0=y1(),{names:Ms}=x1(),Hf=Uf(),ev=jo(),tv=$o(),_s={};for(let r in Ms){let e=r;_s[Ms[e]]=e}function rv(r){if(!(r instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return Hf(r,"base16")}function iv(r){return ev(r,"base16")}function nv(r){if(!(r instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return Hf(E1.encode("base58btc",r)).slice(1)}function sv(r){let e=r instanceof Uint8Array?Hf(r):r;return E1.decode("z"+e)}function _1(r){if(!(r instanceof Uint8Array))throw new Error("multihash must be a Uint8Array");if(r.length<2)throw new Error("multihash too short. must be > 2 bytes.");let e=k0.decode(r);if(!M1(e))throw new Error(`multihash unknown function code: 0x${e.toString(16)}`);r=r.slice(k0.decode.bytes);let t=k0.decode(r);if(t<0)throw new Error(`multihash invalid length: ${t}`);if(r=r.slice(k0.decode.bytes),r.length!==t)throw new Error(`multihash length inconsistent: 0x${Hf(r,"base16")}`);return{code:e,name:_s[e],length:t,digest:r}}function fv(r,e,t){if(!r||e===void 0)throw new Error("multihash encode requires at least two args: digest, code");let i=I1(e);if(!(r instanceof Uint8Array))throw new Error("digest should be a Uint8Array");if(t==null&&(t=r.length),t&&r.length!==t)throw new Error("digest length should be equal to specified length.");let n=k0.encode(i),s=k0.encode(t);return tv([n,s,r],n.length+s.length+r.length)}function I1(r){let e=r;if(typeof r=="string"){if(Ms[r]===void 0)throw new Error(`Unrecognized hash function named: ${r}`);e=Ms[r]}if(typeof e!="number")throw new Error(`Hash function code should be a number. Got: ${e}`);if(_s[e]===void 0&&!Qo(e))throw new Error(`Unrecognized function code: ${e}`);return e}function Qo(r){return r>0&&r<16}function M1(r){return!!(Qo(r)||_s[r])}function A1(r){_1(r)}function av(r){return A1(r),r.subarray(0,2)}S1.exports={names:Ms,codes:Object.freeze(_s),toHexString:rv,fromHexString:iv,toB58String:nv,fromB58String:sv,decode:_1,encode:fv,coerceCode:I1,isAppCode:Qo,validate:A1,prefix:av,isValidCode:M1}});var q1=C((hA,B1)=>{B1.exports=ec;var k1=128,ov=127,cv=~ov,dv=Math.pow(2,31);function ec(r,e,t){if(Number.MAX_SAFE_INTEGER&&r>Number.MAX_SAFE_INTEGER)throw ec.bytes=0,new RangeError("Could not encode varint");e=e||[],t=t||0;for(var i=t;r>=dv;)e[t++]=r&255|k1,r/=128;for(;r&cv;)e[t++]=r&255|k1,r>>>=7;return e[t]=r|0,ec.bytes=t-i+1,e}});var N1=C((uA,C1)=>{C1.exports=tc;var hv=128,T1=127;function tc(r,e){var t=0,e=e||0,i=0,n=e,s,f=r.length;do{if(n>=f||i>49)throw tc.bytes=0,new RangeError("Could not decode varint");s=r[n++],t+=i<28?(s&T1)<<i:(s&T1)*Math.pow(2,i),i+=7}while(s>=hv);return tc.bytes=n-e,t}});var R1=C((lA,P1)=>{var uv=Math.pow(2,7),lv=Math.pow(2,14),bv=Math.pow(2,21),pv=Math.pow(2,28),yv=Math.pow(2,35),mv=Math.pow(2,42),xv=Math.pow(2,49),vv=Math.pow(2,56),gv=Math.pow(2,63);P1.exports=function(r){return r<uv?1:r<lv?2:r<bv?3:r<pv?4:r<yv?5:r<mv?6:r<xv?7:r<vv?8:r<gv?9:10}});var rc=C((bA,K1)=>{K1.exports={encode:q1(),decode:N1(),encodingLength:R1()}});var q0=C((pA,L1)=>{"use strict";var wv=Object.freeze({identity:0,cidv1:1,cidv2:2,cidv3:3,ip4:4,tcp:6,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,dccp:33,"murmur3-128":34,"murmur3-32":35,ip6:41,ip6zone:42,path:47,multicodec:48,multihash:49,multiaddr:50,multibase:51,dns:53,dns4:54,dns6:55,dnsaddr:56,protobuf:80,cbor:81,raw:85,"dbl-sha2-256":86,rlp:96,bencode:99,"dag-pb":112,"dag-cbor":113,"libp2p-key":114,"git-raw":120,"torrent-info":123,"torrent-file":124,"leofcoin-block":129,"leofcoin-tx":130,"leofcoin-pr":131,sctp:132,"dag-jose":133,"dag-cose":134,"eth-block":144,"eth-block-list":145,"eth-tx-trie":146,"eth-tx":147,"eth-tx-receipt-trie":148,"eth-tx-receipt":149,"eth-state-trie":150,"eth-account-snapshot":151,"eth-storage-trie":152,"bitcoin-block":176,"bitcoin-tx":177,"bitcoin-witness-commitment":178,"zcash-block":192,"zcash-tx":193,docid:206,"stellar-block":208,"stellar-tx":209,md4:212,md5:213,bmt:214,"decred-block":224,"decred-tx":225,"ipld-ns":226,"ipfs-ns":227,"swarm-ns":228,"ipns-ns":229,zeronet:230,"secp256k1-pub":231,"bls12_381-g1-pub":234,"bls12_381-g2-pub":235,"x25519-pub":236,"ed25519-pub":237,"bls12_381-g1g2-pub":238,"dash-block":240,"dash-tx":241,"swarm-manifest":250,"swarm-feed":251,udp:273,"p2p-webrtc-star":275,"p2p-webrtc-direct":276,"p2p-stardust":277,"p2p-circuit":290,"dag-json":297,udt:301,utp:302,unix:400,p2p:421,ipfs:421,https:443,onion:444,onion3:445,garlic64:446,garlic32:447,tls:448,quic:460,ws:477,wss:478,"p2p-websocket-star":479,http:480,json:512,messagepack:513,"libp2p-peer-record":769,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,"p256-pub":4608,"p384-pub":4609,"p521-pub":4610,"ed448-pub":4611,"x448-pub":4612,"ed25519-priv":4864,kangarootwelve:7425,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082,"zeroxcert-imprint-256":52753,"fil-commitment-unsealed":61697,"fil-commitment-sealed":61698,"holochain-adr-v0":8417572,"holochain-adr-v1":8483108,"holochain-key-v0":9728292,"holochain-key-v1":9793828,"holochain-sig-v0":10645796,"holochain-sig-v1":10711332,"skynet-ns":11639056});L1.exports={baseTable:wv}});var O1=C((yA,F1)=>{"use strict";var{baseTable:D1}=q0(),z1=new Map;for(let r in D1){let e=D1[r];z1.set(e,r)}F1.exports=Object.freeze(z1)});var H1=C((mA,U1)=>{"use strict";var{names:Sv}=Qi(),{TextDecoder:Ev}=di(),Mv=new Ev("utf8");function _v(r){let e="";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e}function Iv(r,e="utf8"){if(e==="utf8"||e==="utf-8")return Mv.decode(r);if(e==="ascii")return _v(r);let t=Sv[e];if(!t)throw new Error("Unknown base");return t.encode(r)}U1.exports=Iv});var J1=C((xA,V1)=>{"use strict";var{names:Av}=Qi(),{TextEncoder:Bv}=di(),kv=new Bv;function qv(r){let e=new Uint8Array(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}function Cv(r,e="utf8"){if(e==="utf8"||e==="utf-8")return kv.encode(r);if(e==="ascii")return qv(r);let t=Av[e];if(!t)throw new Error("Unknown base");return t.decode(r)}V1.exports=Cv});var ic=C((vA,G1)=>{"use strict";var X1=rc(),Tv=H1(),Nv=J1();G1.exports={numberToUint8Array:Pv,uint8ArrayToNumber:Y1,varintUint8ArrayEncode:Rv,varintEncode:Kv};function Y1(r){return parseInt(Tv(r,"base16"),16)}function Pv(r){let e=r.toString(16);return e.length%2==1&&(e="0"+e),Nv(e,"base16")}function Rv(r){return Uint8Array.from(X1.encode(Y1(r)))}function Kv(r){return Uint8Array.from(X1.encode(r))}});var $1=C((gA,Z1)=>{"use strict";var{baseTable:W1}=q0(),Lv=ic().varintEncode,j1={};for(let r in W1){let e=W1[r];j1[r]=Lv(e)}Z1.exports=Object.freeze(j1)});var e2=C((wA,Q1)=>{"use strict";function Fv(r,e){e||(e=r.reduce((n,s)=>n+s.length,0));let t=new Uint8Array(e),i=0;for(let n of r)t.set(n,i),i+=n.length;return t}Q1.exports=Fv});var i2=C((SA,t2)=>{"use strict";var{baseTable:Dv}=q0(),r2={};for(let[r,e]of Object.entries(Dv)){let t=r.toUpperCase().replace(/-/g,"_");r2[t]=e}t2.exports=Object.freeze(r2)});var s2=C((EA,n2)=>{"use strict";var{baseTable:zv}=q0(),nc={};for(let[r,e]of Object.entries(zv))nc[e]===void 0&&(nc[e]=r);n2.exports=Object.freeze(nc)});var o2=C((MA,f2)=>{"use strict";var C0=rc(),a2=O1(),Vf=$1(),Ov=ic(),Uv=e2();function Hv(r,e){let t;if(r instanceof Uint8Array)t=Ov.varintUint8ArrayEncode(r);else if(Vf[r])t=Vf[r];else throw new Error("multicodec not recognized");return Uv([t,e],t.length+e.length)}function Vv(r){return C0.decode(r),r.slice(C0.decode.bytes)}function Jv(r){let e=C0.decode(r),t=a2.get(e);if(t===void 0)throw new Error(`Code ${e} not found`);return t}function Gv(r){return a2.get(r)}function Xv(r){let e=Vf[r];if(e===void 0)throw new Error("Codec `"+r+"` not found");return C0.decode(e)}function Yv(r){return C0.decode(r)}function Zv(r){let e=Vf[r];if(e===void 0)throw new Error("Codec `"+r+"` not found");return e}function Wv(r){return C0.encode(r)}var jv=i2(),$v=s2();f2.exports={addPrefix:Hv,rmPrefix:Vv,getCodec:Jv,getName:Gv,getNumber:Xv,getCode:Yv,getCodeVarint:Zv,getVarint:Wv,print:$v,...jv}});var d2=C((_A,c2)=>{"use strict";var Qv=Is(),eg={checkCIDComponents:function(r){if(r==null)return"null values are not valid CIDs";if(!(r.version===0||r.version===1))return"Invalid version, must be a number equal to 1 or 0";if(typeof r.codec!="string")return"codec must be string";if(r.version===0){if(r.codec!=="dag-pb")return"codec must be 'dag-pb' for CIDv0";if(r.multibaseName!=="base58btc")return"multibaseName must be 'base58btc' for CIDv0"}if(!(r.multihash instanceof Uint8Array))return"multihash must be a Uint8Array";try{Qv.validate(r.multihash)}catch(e){let t=e.message;return t||(t="Multihash validation failed"),t}}};c2.exports=eg});var Jf=C((IA,h2)=>{"use strict";function tg(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}h2.exports=tg});var p2=C((AA,u2)=>{"use strict";var Gf=Is(),sc=en(),T0=o2(),{baseTable:Xf}=q0(),rg=d2(),l2=$o(),ig=Uf(),ng=Jf(),sg=Object.keys(Xf).reduce((r,e)=>(r[Xf[e]]=e,r),{}),b2=Symbol.for("@ipld/js-cid/CID"),Yr=class{constructor(e,t,i,n){if(this.version,this.codec,this.multihash,Object.defineProperty(this,b2,{value:!0}),Yr.isCID(e)){let s=e;this.version=s.version,this.codec=s.codec,this.multihash=s.multihash,this.multibaseName=s.multibaseName||(s.version===0?"base58btc":"base32");return}if(typeof e=="string"){let s=sc.isEncoded(e);if(s){let f=sc.decode(e);this.version=parseInt(f[0].toString(),16),this.codec=T0.getCodec(f.slice(1)),this.multihash=T0.rmPrefix(f.slice(1)),this.multibaseName=s}else this.version=0,this.codec="dag-pb",this.multihash=Gf.fromB58String(e),this.multibaseName="base58btc";Yr.validateCID(this),Object.defineProperty(this,"string",{value:e});return}if(e instanceof Uint8Array){let s=parseInt(e[0].toString(),16);if(s===1){let f=e;this.version=s,this.codec=T0.getCodec(f.slice(1)),this.multihash=T0.rmPrefix(f.slice(1)),this.multibaseName="base32"}else this.version=0,this.codec="dag-pb",this.multihash=e,this.multibaseName="base58btc";Yr.validateCID(this);return}this.version=e,typeof t=="number"&&(t=sg[t]),this.codec=t,this.multihash=i,this.multibaseName=n||(e===0?"base58btc":"base32"),Yr.validateCID(this)}get bytes(){let e=this._bytes;if(!e){if(this.version===0)e=this.multihash;else if(this.version===1){let t=T0.getCodeVarint(this.codec);e=l2([[1],t,this.multihash],1+t.byteLength+this.multihash.byteLength)}else throw new Error("unsupported version");Object.defineProperty(this,"_bytes",{value:e})}return e}get prefix(){let e=T0.getCodeVarint(this.codec),t=Gf.prefix(this.multihash);return l2([[this.version],e,t],1+e.byteLength+t.byteLength)}get code(){return Xf[this.codec]}toV0(){if(this.codec!=="dag-pb")throw new Error("Cannot convert a non dag-pb CID to CIDv0");let{name:e,length:t}=Gf.decode(this.multihash);if(e!=="sha2-256")throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");if(t!==32)throw new Error("Cannot convert non 32 byte multihash CID to CIDv0");return new Yr(0,this.codec,this.multihash)}toV1(){return new Yr(1,this.codec,this.multihash)}toBaseEncodedString(e=this.multibaseName){if(this.string&&this.string.length!==0&&e===this.multibaseName)return this.string;let t;if(this.version===0){if(e!=="base58btc")throw new Error("not supported with CIDv0, to support different bases, please migrate the instance do CIDv1, you can do that through cid.toV1()");t=Gf.toB58String(this.multihash)}else if(this.version===1)t=ig(sc.encode(e,this.bytes));else throw new Error("unsupported version");return e===this.multibaseName&&Object.defineProperty(this,"string",{value:t}),t}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}toString(e){return this.toBaseEncodedString(e)}toJSON(){return{codec:this.codec,version:this.version,hash:this.multihash}}equals(e){return this.codec===e.codec&&this.version===e.version&&ng(this.multihash,e.multihash)}static validateCID(e){let t=rg.checkCIDComponents(e);if(t)throw new Error(t)}static isCID(e){return e instanceof Yr||Boolean(e&&e[b2])}};Yr.codecs=Xf;u2.exports=Yr});var m2=C((BA,y2)=>{y2.exports=function(r){var e=function(a){var o=a.indexOf("//");return o>-1?a.slice(0,o):a},t=function(){var a=!1;return function(o){return o==="/*"?(a=!0,!1):o==="*/"?(a=!1,!1):!a}},i=function(a){return a.trim()},n=function(a){return function(o){var c="$"+a.length+"$";return a.push(o),c}},s=function(a){var o=/^\$(\d+)\$$/;return function(c){var d=c.match(o);return d?a[+d[1]]:c}},f=[];return r.replace(/"(\\"|[^"\n])*?"|'(\\'|[^'\n])*?'/gm,n(f)).replace(/([;,{}()=:[\]<>]|\/\*|\*\/)/g," $1 ").split(/\n/).map(i).filter(Boolean).map(e).map(i).filter(Boolean).join(`
`).split(/\s+|\n+/gm).filter(t()).map(s(f))}});var E2=C((kA,x2)=>{var fg=m2(),ag=536870911,og=["int32","int64","uint32","uint64","sint32","sint64","bool","fixed64","sfixed64","double","fixed32","sfixed32","float"],v2=function(r){var e=r.shift();if(e!=="{")return e;e={};for(var t="";r.length;)switch(r[0]){case"}":return r.shift(),e;case":":r.shift(),e[t]=v2(r);break;default:t=r.shift()}},g2=function(r){for(var e={};r.length;)switch(r[0]){case"[":case",":{r.shift();var t=r.shift();t==="("&&(t=r.shift(),r.shift());var i=[];if(r[0][0]==="."&&(i=r[0].substr(1).split("."),r.shift()),r[0]!=="=")throw new Error("Unexpected token in field options: "+r[0]);if(r.shift(),r[0]==="]")throw new Error("Unexpected ] in field option");var n=[t].concat(i),s=n.pop(),f=n.reduce(function(a,o,c){return a[o]==null&&(a[o]={}),a[o]},e);f[s]=v2(r);break}case"]":return r.shift(),e;default:throw new Error("Unexpected token in field options: "+r[0])}throw new Error("No closing tag for field options")},fc=function(r){for(var e={name:null,type:null,tag:-1,map:null,oneof:null,required:!1,repeated:!1,options:{}};r.length;)switch(r[0]){case"=":r.shift(),e.tag=Number(r.shift());break;case"map":if(e.type="map",e.map={from:null,to:null},r.shift(),r[0]!=="<")throw new Error("Unexpected token in map type: "+r[0]);if(r.shift(),e.map.from=r.shift(),r[0]!==",")throw new Error("Unexpected token in map type: "+r[0]);if(r.shift(),e.map.to=r.shift(),r[0]!==">")throw new Error("Unexpected token in map type: "+r[0]);r.shift(),e.name=r.shift();break;case"repeated":case"required":case"optional":var t=r.shift();e.required=t==="required",e.repeated=t==="repeated",e.type=r.shift(),e.name=r.shift();break;case"[":e.options=g2(r);break;case";":if(e.name===null)throw new Error("Missing field name");if(e.type===null)throw new Error("Missing type in message field: "+e.name);if(e.tag===-1)throw new Error("Missing tag number in message field: "+e.name);return r.shift(),e;default:throw new Error("Unexpected token in message field: "+r[0])}throw new Error("No ; found for message field")},dg=function(r){for(var e={enums:[],options:{},messages:[],fields:[],extends:[],extensions:null};r.length;)switch(r[0]){case"map":case"repeated":case"optional":case"required":e.fields.push(fc(r));break;case"enum":e.enums.push(S2(r));break;case"message":e.messages.push(ac(r));break;case"extensions":e.extensions=cg(r);break;case"oneof":r.shift();var t=r.shift();if(r[0]!=="{")throw new Error("Unexpected token in oneof: "+r[0]);for(r.shift();r[0]!=="}";){r.unshift("optional");var i=fc(r);i.oneof=t,e.fields.push(i)}r.shift();break;case"extend":e.extends.push(w2(r));break;case";":r.shift();break;case"reserved":for(r.shift();r[0]!==";";)r.shift();break;case"option":var n=As(r);if(e.options[n.name]!==void 0)throw new Error("Duplicate option "+n.name);e.options[n.name]=n.value;break;default:r.unshift("optional"),e.fields.push(fc(r))}return e},w2=function(r){var e={name:r[1],message:ac(r)};return e},cg=function(r){r.shift();var e=Number(r.shift());if(isNaN(e))throw new Error("Invalid from in extensions definition");if(r.shift()!=="to")throw new Error("Expected keyword 'to' in extensions definition");var t=r.shift();if(t==="max"&&(t=ag),t=Number(t),isNaN(t))throw new Error("Invalid to in extensions definition");if(r.shift()!==";")throw new Error("Missing ; in extensions definition");return{from:e,to:t}},ac=function(r){r.shift();var e=1,t=[],i={name:r.shift(),options:{},enums:[],extends:[],messages:[],fields:[]};if(r[0]!=="{")throw new Error("Expected { but found "+r[0]);for(r.shift();r.length;){if(r[0]==="{"?e++:r[0]==="}"&&e--,!e)return r.shift(),t=dg(t),i.enums=t.enums,i.messages=t.messages,i.fields=t.fields,i.extends=t.extends,i.extensions=t.extensions,i.options=t.options,i;t.push(r.shift())}if(e)throw new Error("No closing tag for message")},hg=function(r){r.shift();var e=r.shift();if(r[0]!==";")throw new Error("Expected ; but found "+r[0]);return r.shift(),e},ug=function(r){if(r.shift(),r[0]!=="=")throw new Error("Expected = but found "+r[0]);r.shift();var e=r.shift();switch(e){case'"proto2"':e=2;break;case'"proto3"':e=3;break;default:throw new Error("Expected protobuf syntax version but found "+e)}if(r[0]!==";")throw new Error("Expected ; but found "+r[0]);return r.shift(),e},lg=function(r){if(r.length<4)throw new Error("Invalid enum value: "+r.slice(0,3).join(" "));if(r[1]!=="=")throw new Error("Expected = but found "+r[1]);if(r[3]!==";"&&r[3]!=="[")throw new Error("Expected ; or [ but found "+r[1]);var e=r.shift();r.shift();var t={value:null,options:{}};return t.value=Number(r.shift()),r[0]==="["&&(t.options=g2(r)),r.shift(),{name:e,val:t}},S2=function(r){r.shift();var e={},t={name:r.shift(),values:{},options:{}};if(r[0]!=="{")throw new Error("Expected { but found "+r[0]);for(r.shift();r.length;){if(r[0]==="}")return r.shift(),r[0]===";"&&r.shift(),t;if(r[0]==="option"){e=As(r),t.options[e.name]=e.value;continue}var i=lg(r);t.values[i.name]=i.val}throw new Error("No closing tag for enum")},As=function(r){for(var e=null,t=null,i=function(s){return s==="true"?!0:s==="false"?!1:s.replace(/^"+|"+$/gm,"")};r.length;){if(r[0]===";")return r.shift(),{name:e,value:t};switch(r[0]){case"option":r.shift();var n=r[0]==="(";if(n&&r.shift(),e=r.shift(),n){if(r[0]!==")")throw new Error("Expected ) but found "+r[0]);r.shift()}r[0][0]==="."&&(e+=r.shift());break;case"=":if(r.shift(),e===null)throw new Error("Expected key for option with value: "+r[0]);if(t=i(r.shift()),e==="optimize_for"&&!/^(SPEED|CODE_SIZE|LITE_RUNTIME)$/.test(t))throw new Error("Unexpected value for option optimize_for: "+t);t==="{"&&(t=oc(r));break;default:throw new Error("Unexpected token in option: "+r[0])}}},oc=function(r){for(var e=function(f){return f==="true"?!0:f==="false"?!1:f.replace(/^"+|"+$/gm,"")},t={};r.length;){if(r[0]==="}")return r.shift(),t;var i=r[0]==="(";i&&r.shift();var n=r.shift();if(i){if(r[0]!==")")throw new Error("Expected ) but found "+r[0]);r.shift()}var s=null;switch(r[0]){case":":if(t[n]!==void 0)throw new Error("Duplicate option map key "+n);r.shift(),s=e(r.shift()),s==="{"&&(s=oc(r)),t[n]=s,r[0]===";"&&r.shift();break;case"{":if(r.shift(),s=oc(r),t[n]===void 0&&(t[n]=[]),!Array.isArray(t[n]))throw new Error("Duplicate option map key "+n);t[n].push(s);break;default:throw new Error("Unexpected token in option map: "+r[0])}}throw new Error("No closing tag for option map")},bg=function(r){r.shift();var e=r.shift().replace(/^"+|"+$/gm,"");if(r[0]!==";")throw new Error("Unexpected token: "+r[0]+'. Expected ";"');return r.shift(),e},yg=function(r){r.shift();var e={name:r.shift(),methods:[],options:{}};if(r[0]!=="{")throw new Error("Expected { but found "+r[0]);for(r.shift();r.length;){if(r[0]==="}")return r.shift(),r[0]===";"&&r.shift(),e;switch(r[0]){case"option":var t=As(r);if(e.options[t.name]!==void 0)throw new Error("Duplicate option "+t.name);e.options[t.name]=t.value;break;case"rpc":e.methods.push(pg(r));break;default:throw new Error("Unexpected token in service: "+r[0])}}throw new Error("No closing tag for service")},pg=function(r){r.shift();var e={name:r.shift(),input_type:null,output_type:null,client_streaming:!1,server_streaming:!1,options:{}};if(r[0]!=="(")throw new Error("Expected ( but found "+r[0]);if(r.shift(),r[0]==="stream"&&(r.shift(),e.client_streaming=!0),e.input_type=r.shift(),r[0]!==")")throw new Error("Expected ) but found "+r[0]);if(r.shift(),r[0]!=="returns")throw new Error("Expected returns but found "+r[0]);if(r.shift(),r[0]!=="(")throw new Error("Expected ( but found "+r[0]);if(r.shift(),r[0]==="stream"&&(r.shift(),e.server_streaming=!0),e.output_type=r.shift(),r[0]!==")")throw new Error("Expected ) but found "+r[0]);if(r.shift(),r[0]===";")return r.shift(),e;if(r[0]!=="{")throw new Error("Expected { but found "+r[0]);for(r.shift();r.length;){if(r[0]==="}")return r.shift(),r[0]===";"&&r.shift(),e;if(r[0]==="option"){var t=As(r);if(e.options[t.name]!==void 0)throw new Error("Duplicate option "+t.name);e.options[t.name]=t.value}else throw new Error("Unexpected token in rpc options: "+r[0])}throw new Error("No closing tag for rpc")},mg=function(r){for(var e=fg(r.toString()),t=0;t<e.length;t++)if(/^("|')([^'"]*)$/.test(e[t])){var i;for(e[t].length===1?i=t+1:i=t,i;i<e.length;i++)if(/^[^'"\\]*(?:\\.[^'"\\]*)*("|')$/.test(e[i])){e=e.slice(0,t).concat(e.slice(t,i+1).join("")).concat(e.slice(i+1));break}}for(var n={syntax:3,package:null,imports:[],enums:[],messages:[],options:{},extends:[]},s=!0;e.length;){switch(e[0]){case"package":n.package=hg(e);break;case"syntax":if(!s)throw new Error("Protobuf syntax version should be first thing in file");n.syntax=ug(e);break;case"message":n.messages.push(ac(e));break;case"enum":n.enums.push(S2(e));break;case"option":var f=As(e);if(n.options[f.name])throw new Error("Duplicate option "+f.name);n.options[f.name]=f.value;break;case"import":n.imports.push(bg(e));break;case"extend":n.extends.push(w2(e));break;case"service":n.services||(n.services=[]),n.services.push(yg(e));break;default:throw new Error("Unexpected token: "+e[0])}s=!1}return n.extends.forEach(function(a){n.messages.forEach(function(o){o.name===a.name&&a.message.fields.forEach(function(c){if(!o.extensions||c.tag<o.extensions.from||c.tag>o.extensions.to)throw new Error(o.name+" does not declare "+c.tag+" as an extension number");o.fields.push(c)})})}),n.messages.forEach(function(a){a.fields.forEach(function(o){var c,d,u,p;function x(g){return g.name===o.type}function y(g){return g.name===u}if(o.options&&o.options.packed==="true"&&og.indexOf(o.type)===-1){if(o.type.indexOf(".")===-1){if(a.enums&&a.enums.some(x))return}else{if(c=o.type.split("."),c.length>2)throw new Error("what is this?");if(d=c[0],u=c[1],n.messages.some(function(g){if(g.name===d)return p=g,g}),p&&p.enums&&p.enums.some(y))return}throw new Error("Fields of type "+o.type+' cannot be declared [packed=true]. Only repeated fields of primitive numeric types (types which use the varint, 32-bit, or 64-bit wire types) can be declared "packed". See https://developers.google.com/protocol-buffers/docs/encoding#optional')}})}),n};x2.exports=mg});var k2=C((qA,M2)=>{var _2=function(r,e){var t=r.repeated?"repeated":r.required?"required":"optional";r.type==="map"&&(t="map<"+r.map.from+","+r.map.to+">"),r.oneof&&(t="");var i=Object.keys(r.options||{}).map(function(n){return n+" = "+r.options[n]}).join(",");return i&&(i=" ["+i+"]"),e.push((t?t+" ":"")+(r.map==="map"?"":r.type+" ")+r.name+" = "+r.tag+i+";"),e},I2=function(r,e){e.push("message "+r.name+" {"),r.options||(r.options={}),Bs(r.options,e),r.enums||(r.enums=[]),r.enums.forEach(function(i){e.push(A2(i,[]))}),r.messages||(r.messages=[]),r.messages.forEach(function(i){e.push(I2(i,[]))});var t={};return r.fields||(r.fields=[]),r.fields.forEach(function(i){i.oneof?(t[i.oneof]||(t[i.oneof]=[]),t[i.oneof].push(_2(i,[]))):e.push(_2(i,[]))}),Object.keys(t).forEach(function(i){t[i].unshift("oneof "+i+" {"),t[i].push("}"),e.push(t[i])}),e.push("}",""),e},A2=function(r,e){e.push("enum "+r.name+" {"),r.options||(r.options={});var t=Bs(r.options,[]);return t.length>1&&e.push(t.slice(0,-1)),Object.keys(r.values).map(function(i){var n=xg(r.values[i]);e.push([i+" = "+n+";"])}),e.push("}",""),e},xg=function(r,e){var t=Object.keys(r.options||{}).map(function(n){return n+" = "+r.options[n]}).join(",");t&&(t=" ["+t+"]");var i=r.value+t;return i},Bs=function(r,e){var t=Object.keys(r);return t.forEach(function(i){var n=r[i];~i.indexOf(".")&&(i="("+i+")");var s=typeof n;s==="object"?(n=cc(n,[]),n.length&&e.push("option "+i+" = {",n,"};")):(s==="string"&&i!=="optimize_for"&&(n='"'+n+'"'),e.push("option "+i+" = "+n+";"))}),t.length>0&&e.push(""),e},cc=function(r,e){var t=Object.keys(r);return t.forEach(function(i){var n=r[i],s=typeof n;s==="object"?Array.isArray(n)?n.forEach(function(f){f=cc(f,[]),f.length&&e.push(i+" {",f,"}")}):(n=cc(n,[]),n.length&&e.push(i+" {",n,"}")):(s==="string"&&(n='"'+n+'"'),e.push(i+": "+n))}),e},gg=function(r,e){return e.push("service "+r.name+" {"),r.options||(r.options={}),Bs(r.options,e),r.methods||(r.methods=[]),r.methods.forEach(function(t){e.push(vg(t,[]))}),e.push("}",""),e},vg=function(r,e){var t="rpc "+r.name+"(";r.client_streaming&&(t+="stream "),t+=r.input_type+") returns (",r.server_streaming&&(t+="stream "),t+=r.output_type+")",r.options||(r.options={});var i=Bs(r.options,[]);return i.length>1?e.push(t+" {",i.slice(0,-1),"}"):e.push(t+";"),e},B2=function(r){return function(e){return Array.isArray(e)?e.map(B2(r+"  ")).join(`
`):r+e}};M2.exports=function(r){var e=[];return e.push('syntax = "proto'+r.syntax+'";',""),r.package&&e.push("package "+r.package+";",""),r.options||(r.options={}),Bs(r.options,e),r.enums||(r.enums=[]),r.enums.forEach(function(t){A2(t,e)}),r.messages||(r.messages=[]),r.messages.forEach(function(t){I2(t,e)}),r.services&&r.services.forEach(function(t){gg(t,e)}),e.map(B2("")).join(`
`)}});var C2=C((CA,Yf)=>{var q2=E2(),wg=k2();Yf.exports=q2;Yf.exports.parse=q2;Yf.exports.stringify=wg});var Sr=C((TA,T2)=>{"use strict";function Sg(r,e,t,i){return e.bytes=t.bytes=0,{type:r,encode:e,decode:t,encodingLength:i}}T2.exports=Sg});var L2=C((NA,N2)=>{"use strict";var ks=Cr(),Eg=Sr();function P2(r){return r.byteLength}function Mg(r){let e=P2(r);return ks.encodingLength(e)+e}function R2(r,e,t,i){let n=i,s=P2(r);ks.encode(s,e,i),i+=ks.encode.bytes,e.set(r,i),i+=s,R2.bytes=i-n}function K2(r,e,t){let i=t,n=ks.decode(r,t);t+=ks.decode.bytes;let s=r.slice(t,t+n);return t+=s.length,K2.bytes=t-i,s}N2.exports=Eg(2,R2,K2,Mg)});var D2=C((PA,F2)=>{"use strict";var{names:_g}=Qi(),{TextEncoder:Ig}=di(),Ag=new Ig;function Bg(r){let e=new Uint8Array(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}function kg(r,e="utf8"){if(e==="utf8"||e==="utf-8")return Ag.encode(r);if(e==="ascii")return Bg(r);let t=_g[e];if(!t)throw new Error("Unknown base");return t.decode(r)}F2.exports=kg});var O2=C((RA,z2)=>{"use strict";var{names:qg}=Qi(),{TextDecoder:Cg}=di(),Tg=new Cg("utf8");function Ng(r){let e="";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e}function Pg(r,e="utf8"){if(e==="utf8"||e==="utf-8")return Tg.decode(r);if(e==="ascii")return Ng(r);let t=qg[e];if(!t)throw new Error("Unknown base");return t.encode(r)}z2.exports=Pg});var J2=C((KA,U2)=>{"use strict";var qs=Cr(),dc=D2(),Rg=O2(),Kg=Sr();function Lg(r){let e=dc(r).byteLength;return qs.encodingLength(e)+e}function H2(r,e,t,i){let n=i,s=dc(r).byteLength;qs.encode(s,e,i,"utf-8"),i+=qs.encode.bytes;let f=dc(r);e.set(f,i),i+=f.length,H2.bytes=i-n}function V2(r,e,t){let i=t,n=qs.decode(r,t);t+=qs.decode.bytes;let s=Rg(r.subarray(t,t+n));return t+=n,V2.bytes=t-i,s}U2.exports=Kg(2,H2,V2,Lg)});var Z2=C((LA,G2)=>{"use strict";var Fg=Sr();function Dg(){return 1}function X2(r,e,t,i){e[i]=r?1:0,X2.bytes=1}function Y2(r,e,t){let i=r[t]>0;return Y2.bytes=1,i}G2.exports=Fg(0,X2,Y2,Dg)});var Q2=C((FA,W2)=>{"use strict";var Cs=Cr(),zg=Sr();function j2(r,e,t,i){Cs.encode(r<0?r+4294967296:r,e,i),j2.bytes=Cs.encode.bytes}function $2(r,e,t){let i=Cs.decode(r,t);return $2.bytes=Cs.decode.bytes,i>2147483647?i-4294967296:i}function Og(r){return Cs.encodingLength(r<0?r+4294967296:r)}W2.exports=zg(0,j2,$2,Og)});var tb=C((DA,eb)=>{"use strict";var tn=Cr(),Ug=Sr();function hc(r,e,t,i){if(r<0){let n=i+9;for(tn.encode(r*-1,e,i),i+=tn.encode.bytes-1,e[i]=e[i]|128;i<n-1;)i++,e[i]=255;e[n]=1,hc.bytes=10}else tn.encode(r,e,i),hc.bytes=tn.encode.bytes}function uc(r,e,t){let i=tn.decode(r,t);if(i>=Math.pow(2,63)){let n=9;for(;r[t+n-1]===255;)n--;n=n||9;let s=r.subarray(t,t+n);s[n-1]=s[n-1]&127,i=-1*tn.decode(s,0),uc.bytes=10}else uc.bytes=tn.decode.bytes;return i}function Hg(r){return r<0?10:tn.encodingLength(r)}eb.exports=Ug(0,hc,uc,Hg)});var rb=C(Zf=>{var Ts=Cr();Zf.encode=function r(e,t,i){e=e>=0?e*2:e*-2-1;var n=Ts.encode(e,t,i);return r.bytes=Ts.encode.bytes,n};Zf.decode=function r(e,t){var i=Ts.decode(e,t);return r.bytes=Ts.decode.bytes,i&1?(i+1)/-2:i/2};Zf.encodingLength=function(r){return Ts.encodingLength(r>=0?r*2:r*-2-1)}});var fb=C((OA,ib)=>{"use strict";var Ns=rb(),Vg=Sr();function nb(r,e,t,i){Ns.encode(r,e,i),nb.bytes=Ns.encode.bytes}function sb(r,e,t){let i=Ns.decode(r,t);return sb.bytes=Ns.decode.bytes,i}ib.exports=Vg(0,nb,sb,Ns.encodingLength)});var db=C((UA,ab)=>{"use strict";var Ps=Cr(),Jg=Sr();function ob(r,e,t,i){Ps.encode(r,e,i),ob.bytes=Ps.encode.bytes}function cb(r,e,t){let i=Ps.decode(r,t);return cb.bytes=Ps.decode.bytes,i}ab.exports=Jg(0,ob,cb,Ps.encodingLength)});var bb=C((HA,hb)=>{"use strict";var Gg=Sr();function Xg(){return 8}function ub(r,e,t,i){for(let n of r)e[i]=n,i++;ub.bytes=8}function lb(r,e,t){let i=r.slice(t,t+8);return lb.bytes=8,i}hb.exports=Gg(1,ub,lb,Xg)});var xb=C((VA,pb)=>{"use strict";var Yg=Sr();function Zg(){return 8}function yb(r,e,t,i){t.setFloat64(i,r,!0),yb.bytes=8}function mb(r,e,t){let i=e.getFloat64(t,!0);return mb.bytes=8,i}pb.exports=Yg(1,yb,mb,Zg)});var Sb=C((JA,vb)=>{"use strict";var Wg=Sr();function jg(r){return 4}function gb(r,e,t,i){t.setUint32(i,r,!0),gb.bytes=4}function wb(r,e,t){let i=e.getUint32(t,!0);return wb.bytes=4,i}vb.exports=Wg(5,gb,wb,jg)});var Ib=C((GA,Eb)=>{"use strict";var $g=Sr();function Qg(r){return 4}function Mb(r,e,t,i){t.setInt32(i,r,!0),Mb.bytes=4}function _b(r,e,t){let i=e.getInt32(t,!0);return _b.bytes=4,i}Eb.exports=$g(5,Mb,_b,Qg)});var qb=C((XA,Ab)=>{"use strict";var e9=Sr();function t9(){return 4}function Bb(r,e,t,i){t.setFloat32(i,r,!0),Bb.bytes=4}function kb(r,e,t){let i=e.getFloat32(t,!0);return kb.bytes=4,i}Ab.exports=e9(5,Bb,kb,t9)});var Cb=C(Xt=>{"use strict";Xt.make=Sr();Xt.bytes=L2();Xt.string=J2();Xt.bool=Z2();Xt.int32=Q2();Xt.int64=tb();Xt.sint32=Xt.sint64=fb();Xt.uint32=Xt.uint64=Xt.enum=Xt.varint=db();Xt.fixed64=Xt.sfixed64=bb();Xt.double=xb();Xt.fixed32=Sb();Xt.sfixed32=Ib();Xt.float=qb()});var Wf=C(Tb=>{"use strict";Tb.defined=function(r){return r!=null&&(typeof r!="number"||!isNaN(r))}});var Kb=C((WA,Nb)=>{"use strict";var hi=Cr(),r9=Wf().defined;function Pb(r){return`${r.substring(0,1).toUpperCase()}${r.substring(1)}`}function Rb(r,e,t,i){if(Object.prototype.hasOwnProperty.call(r,e))return;let n=Pb(e);Object.defineProperties(r,{[e]:{enumerable:!0,configurable:!0,set:s=>{t=s},get:()=>t===void 0?i:t},[`has${n}`]:{configurable:!0,value:()=>t!==void 0},[`set${n}`]:{configurable:!0,value:s=>{t=s}},[`get${n}`]:{configurable:!0,value:()=>t},[`clear${n}`]:{configurable:!0,value:()=>{t=void 0,r[e]=void 0}}})}function f9(r,e,t){let i=[],n={},s=[],f=[];for(var a=0;a<t.length;a++){let c=r.fields[a];n[c.tag]=a;let d=c.options&&c.options.default,u=e(c.type,r.id,!1);f[a]=[d,u&&u.values],r.fields[a].packed=c.repeated&&c.options&&c.options.packed&&c.options.packed!=="false",c.required&&i.push(c.name),c.oneof&&s.push(c.name)}function o(c,d,u,p,x,y,g){let M=d.name;if(d.oneof){let K=Object.keys(u);for(var k=0;k<K.length;k++)if(s.indexOf(K[k])>-1){let L=Pb(K[k]);delete u[`has${L}`],delete u[`get${L}`],delete u[`set${L}`],delete u[`clear${L}`],delete u[K[k]]}}let R;if(c.message){let K=hi.decode(p,y);y+=hi.decode.bytes;let L=c.decode(p,x,y,y+K);d.map?(R=u[M]||{},R[L.key]=L.value):d.repeated?(R=u[M]||[],R.push(L)):R=L}else d.repeated?(R=u[M]||[],R.push(c.decode(p,x,y))):R=c.decode(p,x,y);return Rb(u,M,R),y+=c.decode.bytes,y}return function c(d,u,p,x){if(p==null&&(p=0),x==null&&(x=d.length),!(x<=d.length&&p<=d.length))throw new Error("Decoded message is not valid");u||(u=new DataView(d.buffer,d.byteOffset,d.byteLength));for(var y=p,g={},M;;){if(x<=p){var k="",R=0;for(R=0;R<i.length;R++)if(k=i[R],!r9(g[k]))throw new Error("Decoded message is not valid, missing required field: "+k);var K,L;for(R=0;R<t.length;R++){M=r.fields[R],L=f[R][0],K=f[R][1],k=M.name;let I;if(!Object.prototype.hasOwnProperty.call(g,k)){var O=!1;if(M.oneof){for(var F=Object.keys(g),G=0;G<F.length;G++)if(s.indexOf(F[G])>-1){O=!0;break}}O||(K?M.repeated?L=[]:(L=L&&K[L]?K[L].value:K[Object.keys(K)[0]].value,L=parseInt(L||0,10)):(I=n9(M),L=s9(M,L)),Rb(g,k,L,I))}}return c.bytes=p-y,g}var B=hi.decode(d,p);p+=hi.decode.bytes;var b=B>>3,m=n[b];if(m==null){p=i9(B&7,d,u,p);continue}var w=t[m];if(M=r.fields[m],M.packed){var S=hi.decode(d,p);for(p+=hi.decode.bytes,S+=p;p<S;)p=o(w,M,g,d,u,p,m)}else p=o(w,M,g,d,u,p,m)}}}var i9=function(r,e,t,i){switch(r){case 0:return hi.decode(e,i),i+hi.decode.bytes;case 1:return i+8;case 2:var n=hi.decode(e,i);return i+hi.decode.bytes+n;case 3:case 4:throw new Error("Groups are not supported");case 5:return i+4;default:throw new Error("Unknown wire type: "+r)}},n9=function(r){if(r.map)return{};if(r.repeated)return[];switch(r.type){case"string":return"";case"bool":return!1;case"float":case"double":case"sfixed32":case"fixed32":case"varint":case"enum":case"uint64":case"uint32":case"int64":case"int32":case"sint64":case"sint32":return 0;default:return null}},s9=function(r,e){if(e===void 0)return e;switch(r.type){case"bool":return e==="true";case"float":case"double":case"sfixed32":case"fixed32":case"varint":case"enum":case"uint64":case"uint32":case"int64":case"int32":case"sint64":case"sint32":return parseInt(e,10);default:return e}};Nb.exports=f9});var Db=C((jA,Lb)=>{"use strict";var Fb=Wf().defined,N0=Cr();function a9(r,e,t,i,n){let s=Object.keys(i),f=t.length,a={};for(let c=0;c<f;c++){a[c]={p:N0.encode(r.fields[c].tag<<3|2),h:N0.encode(r.fields[c].tag<<3|t[c].type)};let d=r.fields[c];r.fields[c].packed=d.repeated&&d.options&&d.options.packed&&d.options.packed!=="false"}function o(c,d,u,p,x,y,g){let M=0;if(!y)for(M=0;M<p.length;M++)c[u++]=p[M];return x.message&&(N0.encode(x.encodingLength(g),c,u),u+=N0.encode.bytes),x.encode(g,c,d,u),u+x.encode.bytes}return function c(d,u,p,x=0){u==null&&(u=new Uint8Array(n(d))),p==null&&(p=new DataView(u.buffer,u.byteOffset,u.byteLength));let y=x,g=Object.keys(d),M=0,k=!1;for(M=0;M<s.length;M++){let R=s[M],K=i[M];if(g.indexOf(K)>-1){if(k)throw new Error("only one of the properties defined in oneof "+R+" can be set");k=!0}}for(M=0;M<f;M++){let R=t[M],K=r.fields[M],L=d[K.name],O=0;if(!Fb(L)){if(K.required)throw new Error(K.name+" is required");continue}let F=a[M].p,G=a[M].h,B=K.packed;if(K.map){let b=Object.keys(L);for(O=0;O<b.length;O++)b[O]={key:b[O],value:L[b[O]]};L=b}if(B){let b=0;for(O=0;O<L.length;O++)!Object.prototype.hasOwnProperty.call(L,O)||(b+=R.encodingLength(L[O]));if(b){for(O=0;O<G.length;O++)u[x++]=F[O];N0.encode(b,u,x),x+=N0.encode.bytes}}if(K.repeated){let b;for(O=0;O<L.length;O++)b=L[O],!!Fb(b)&&(x=o(u,p,x,G,R,B,b))}else x=o(u,p,x,G,R,B,L)}return c.bytes=x-y,u}}Lb.exports=a9});var Ob=C(($A,zb)=>{"use strict";var jf=Wf().defined,Rs=Cr();function o9(r,e,t){let i=Object.keys(t),n=e.length,s=new Array(n);for(let f=0;f<r.fields.length;f++){s[f]=Rs.encodingLength(r.fields[f].tag<<3|e[f].type);let a=r.fields[f];r.fields[f].packed=a.repeated&&a.options&&a.options.packed&&a.options.packed!=="false"}return function(a){let o=0,c=0,d=0;for(c=0;c<i.length;c++){let u=i[c],p=t[u],x=!1;for(d=0;d<p.length;d++)if(jf(a[p[d]])){if(x)throw new Error("only one of the properties defined in oneof "+u+" can be set");x=!0}}for(c=0;c<n;c++){let u=e[c],p=r.fields[c],x=a[p.name],y=s[c],g;if(!jf(x)){if(p.required)throw new Error(p.name+" is required");continue}if(p.map){let M=Object.keys(x);for(d=0;d<M.length;d++)M[d]={key:M[d],value:x[M[d]]};x=M}if(p.packed){let M=0;for(d=0;d<x.length;d++)!jf(x[d])||(g=u.encodingLength(x[d]),M+=g,u.message&&(M+=Rs.encodingLength(g)));M&&(o+=y+M+Rs.encodingLength(M))}else if(p.repeated)for(d=0;d<x.length;d++)!jf(x[d])||(g=u.encodingLength(x[d]),o+=y+g+(u.message?Rs.encodingLength(g):0));else g=u.encodingLength(x),o+=y+g+(u.message?Rs.encodingLength(g):0)}return o}}zb.exports=o9});var Hb=C((QA,Ub)=>{"use strict";var lc=Cb(),c9=Kb(),d9=Db(),h9=Ob(),Ks=Cr(),u9=function(r){if(!r)return null;let e={};return Object.keys(r).forEach(function(t){e[t]=r[t].value}),e};Ub.exports=function(r,e){let t={},i={},n={},s=function(c,d){c.enums&&c.enums.forEach(function(u){u.id=d+(d?".":"")+u.name,i[u.id]=u,s(u,u.id)}),c.messages&&c.messages.forEach(function(u){u.id=d+(d?".":"")+u.name,t[u.id]=u,u.fields.forEach(function(p){if(!p.map)return;let x="Map_"+p.map.from+"_"+p.map.to,y={name:x,enums:[],messages:[],fields:[{name:"key",type:p.map.from,tag:1,repeated:!1,required:!0},{name:"value",type:p.map.to,tag:2,repeated:!1,required:!1}],extensions:null,id:d+(d?".":"")+x};t[y.id]||(t[y.id]=y,c.messages.push(y)),p.type=x,p.repeated=!0}),s(u,u.id)})};s(r,"");let f=function(c){let d=Object.keys(c.values||[]).map(function(x){return parseInt(c.values[x].value,10)}),u=function x(y,g,M,k){if(!d.length||d.indexOf(y)===-1)throw new Error("Invalid enum value: "+y);return Ks.encode(y,g,k),x.bytes=Ks.encode.bytes,g},p=function x(y,g,M){var k=Ks.decode(y,M);if(!d.length||d.indexOf(k)===-1)throw new Error("Invalid enum value: "+k);return x.bytes=Ks.decode.bytes,k};return lc.make(0,u,p,Ks.encodingLength)},a=function(c,d){c.messages.forEach(function(M){d[M.name]=o(M.name,c.id)}),c.enums.forEach(function(M){d[M.name]=u9(M.values)}),d.type=2,d.message=!0,d.name=c.name;let u={};c.fields.forEach(function(M){!M.oneof||(u[M.oneof]||(u[M.oneof]=[]),u[M.oneof].push(M.name))});let p=c.fields.map(function(M){return o(M.type,c.id)}),x=h9(c,p,u),y=d9(c,o,p,u,x),g=c9(c,o,p);return y.bytes=g.bytes=0,d.buffer=!0,d.encode=y,d.decode=g,d.encodingLength=x,d},o=function(c,d,u){if(e&&e[c])return e[c];if(lc[c])return lc[c];let p=(d?d+"."+c:c).split(".").map(function(y,g,M){return M.slice(0,g).concat(c).join(".")}).reverse().reduce(function(y,g){return y||t[g]||i[g]},null);if(u===!1)return p;if(!p)throw new Error("Could not resolve "+c);return p.values?f(p):n[p.id]||a(p,n[p.id]={})};return(r.enums||[]).concat((r.messages||[]).map(function(c){return o(c.id)}))}});var Ls=C((eB,Vb)=>{"use strict";var Jb=C2(),l9=Hb(),b9=function(r){if(!r)return null;var e={};return Object.keys(r).forEach(function(t){e[t]=r[t].value}),e};Vb.exports=function(r,e){if(e||(e={}),!r)throw new Error("Pass in a .proto string or a protobuf-schema parsed object");var t=typeof r=="object"&&!(r instanceof Uint8Array)?r:Jb.parse(r),i=function(){var n=this;l9(t,e.encodings||{}).forEach(function(s){n[s.name]=b9(s.values)||s})};return i.prototype.toString=function(){return Jb.stringify(t)},i.prototype.toJSON=function(){return t},new i}});var $f=C((tB,Gb)=>{"use strict";Gb.exports=`enum KeyType {
  RSA = 0;
  Ed25519 = 1;
  Secp256k1 = 2;
}
message PublicKey {
  required KeyType Type = 1;
  required bytes Data = 2;
}
message PrivateKey {
  required KeyType Type = 1;
  required bytes Data = 2;
}`});var He=C((rB,Xb)=>{Xb.exports={options:{usePureJavaScript:!1}}});var Wb=C((iB,Yb)=>{var bc={};Yb.exports=bc;var Zb={};bc.encode=function(r,e,t){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(t!==void 0&&typeof t!="number")throw new TypeError('"maxline" must be a number.');var i="";if(!(r instanceof Uint8Array))i=p9(r,e);else{var n=0,s=e.length,f=e.charAt(0),a=[0];for(n=0;n<r.length;++n){for(var o=0,c=r[n];o<a.length;++o)c+=a[o]<<8,a[o]=c%s,c=c/s|0;for(;c>0;)a.push(c%s),c=c/s|0}for(n=0;r[n]===0&&n<r.length-1;++n)i+=f;for(n=a.length-1;n>=0;--n)i+=e[a[n]]}if(t){var d=new RegExp(".{1,"+t+"}","g");i=i.match(d).join(`\r
`)}return i};bc.decode=function(r,e){if(typeof r!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var t=Zb[e];if(!t){t=Zb[e]=[];for(var i=0;i<e.length;++i)t[e.charCodeAt(i)]=i}r=r.replace(/\s/g,"");for(var n=e.length,s=e.charAt(0),f=[0],i=0;i<r.length;i++){var a=t[r.charCodeAt(i)];if(a===void 0)return;for(var o=0,c=a;o<f.length;++o)c+=f[o]*n,f[o]=c&255,c>>=8;for(;c>0;)f.push(c&255),c>>=8}for(var d=0;r[d]===s&&d<r.length-1;++d)f.push(0);return typeof Buffer!="undefined"?Buffer.from(f.reverse()):new Uint8Array(f.reverse())};function p9(r,e){var t=0,i=e.length,n=e.charAt(0),s=[0];for(t=0;t<r.length();++t){for(var f=0,a=r.at(t);f<s.length;++f)a+=s[f]<<8,s[f]=a%i,a=a/i|0;for(;a>0;)s.push(a%i),a=a/i|0}var o="";for(t=0;r.at(t)===0&&t<r.length()-1;++t)o+=n;for(t=s.length-1;t>=0;--t)o+=e[s[t]];return o}});var Kt=C((nB,jb)=>{var $b=He(),Qb=Wb(),P=jb.exports=$b.util=$b.util||{};(function(){if(typeof process!="undefined"&&process.nextTick&&!process.browser){P.nextTick=process.nextTick,typeof setImmediate=="function"?P.setImmediate=setImmediate:P.setImmediate=P.nextTick;return}if(typeof setImmediate=="function"){P.setImmediate=function(){return setImmediate.apply(void 0,arguments)},P.nextTick=function(a){return setImmediate(a)};return}if(P.setImmediate=function(a){setTimeout(a,0)},typeof window!="undefined"&&typeof window.postMessage=="function"){let a=function(o){if(o.source===window&&o.data===r){o.stopPropagation();var c=e.slice();e.length=0,c.forEach(function(d){d()})}};var f=a,r="forge.setImmediate",e=[];P.setImmediate=function(o){e.push(o),e.length===1&&window.postMessage(r,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver!="undefined"){var t=Date.now(),i=!0,n=document.createElement("div"),e=[];new MutationObserver(function(){var o=e.slice();e.length=0,o.forEach(function(c){c()})}).observe(n,{attributes:!0});var s=P.setImmediate;P.setImmediate=function(o){Date.now()-t>15?(t=Date.now(),s(o)):(e.push(o),e.length===1&&n.setAttribute("a",i=!i))}}P.nextTick=P.setImmediate})();P.isNodejs=typeof process!="undefined"&&process.versions&&process.versions.node;P.globalScope=function(){return P.isNodejs?globalThis:typeof self=="undefined"?window:self}();P.isArray=Array.isArray||function(r){return Object.prototype.toString.call(r)==="[object Array]"};P.isArrayBuffer=function(r){return typeof ArrayBuffer!="undefined"&&r instanceof ArrayBuffer};P.isArrayBufferView=function(r){return r&&P.isArrayBuffer(r.buffer)&&r.byteLength!==void 0};function Fs(r){if(!(r===8||r===16||r===24||r===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+r)}P.ByteBuffer=pc;function pc(r){if(this.data="",this.read=0,typeof r=="string")this.data=r;else if(P.isArrayBuffer(r)||P.isArrayBufferView(r))if(typeof Buffer!="undefined"&&r instanceof Buffer)this.data=r.toString("binary");else{var e=new Uint8Array(r);try{this.data=String.fromCharCode.apply(null,e)}catch(i){for(var t=0;t<e.length;++t)this.putByte(e[t])}}else(r instanceof pc||typeof r=="object"&&typeof r.data=="string"&&typeof r.read=="number")&&(this.data=r.data,this.read=r.read);this._constructedStringLength=0}P.ByteStringBuffer=pc;var y9=4096;P.ByteStringBuffer.prototype._optimizeConstructedString=function(r){this._constructedStringLength+=r,this._constructedStringLength>y9&&(this.data.substr(0,1),this._constructedStringLength=0)};P.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};P.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};P.ByteStringBuffer.prototype.putByte=function(r){return this.putBytes(String.fromCharCode(r))};P.ByteStringBuffer.prototype.fillWithByte=function(r,e){r=String.fromCharCode(r);for(var t=this.data;e>0;)e&1&&(t+=r),e>>>=1,e>0&&(r+=r);return this.data=t,this._optimizeConstructedString(e),this};P.ByteStringBuffer.prototype.putBytes=function(r){return this.data+=r,this._optimizeConstructedString(r.length),this};P.ByteStringBuffer.prototype.putString=function(r){return this.putBytes(P.encodeUtf8(r))};P.ByteStringBuffer.prototype.putInt16=function(r){return this.putBytes(String.fromCharCode(r>>8&255)+String.fromCharCode(r&255))};P.ByteStringBuffer.prototype.putInt24=function(r){return this.putBytes(String.fromCharCode(r>>16&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r&255))};P.ByteStringBuffer.prototype.putInt32=function(r){return this.putBytes(String.fromCharCode(r>>24&255)+String.fromCharCode(r>>16&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r&255))};P.ByteStringBuffer.prototype.putInt16Le=function(r){return this.putBytes(String.fromCharCode(r&255)+String.fromCharCode(r>>8&255))};P.ByteStringBuffer.prototype.putInt24Le=function(r){return this.putBytes(String.fromCharCode(r&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r>>16&255))};P.ByteStringBuffer.prototype.putInt32Le=function(r){return this.putBytes(String.fromCharCode(r&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r>>16&255)+String.fromCharCode(r>>24&255))};P.ByteStringBuffer.prototype.putInt=function(r,e){Fs(e);var t="";do e-=8,t+=String.fromCharCode(r>>e&255);while(e>0);return this.putBytes(t)};P.ByteStringBuffer.prototype.putSignedInt=function(r,e){return r<0&&(r+=2<<e-1),this.putInt(r,e)};P.ByteStringBuffer.prototype.putBuffer=function(r){return this.putBytes(r.getBytes())};P.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};P.ByteStringBuffer.prototype.getInt16=function(){var r=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,r};P.ByteStringBuffer.prototype.getInt24=function(){var r=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,r};P.ByteStringBuffer.prototype.getInt32=function(){var r=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,r};P.ByteStringBuffer.prototype.getInt16Le=function(){var r=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,r};P.ByteStringBuffer.prototype.getInt24Le=function(){var r=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,r};P.ByteStringBuffer.prototype.getInt32Le=function(){var r=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,r};P.ByteStringBuffer.prototype.getInt=function(r){Fs(r);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),r-=8;while(r>0);return e};P.ByteStringBuffer.prototype.getSignedInt=function(r){var e=this.getInt(r),t=2<<r-2;return e>=t&&(e-=t<<1),e};P.ByteStringBuffer.prototype.getBytes=function(r){var e;return r?(r=Math.min(this.length(),r),e=this.data.slice(this.read,this.read+r),this.read+=r):r===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};P.ByteStringBuffer.prototype.bytes=function(r){return typeof r=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+r)};P.ByteStringBuffer.prototype.at=function(r){return this.data.charCodeAt(this.read+r)};P.ByteStringBuffer.prototype.setAt=function(r,e){return this.data=this.data.substr(0,this.read+r)+String.fromCharCode(e)+this.data.substr(this.read+r+1),this};P.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};P.ByteStringBuffer.prototype.copy=function(){var r=P.createBuffer(this.data);return r.read=this.read,r};P.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};P.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};P.ByteStringBuffer.prototype.truncate=function(r){var e=Math.max(0,this.length()-r);return this.data=this.data.substr(this.read,e),this.read=0,this};P.ByteStringBuffer.prototype.toHex=function(){for(var r="",e=this.read;e<this.data.length;++e){var t=this.data.charCodeAt(e);t<16&&(r+="0"),r+=t.toString(16)}return r};P.ByteStringBuffer.prototype.toString=function(){return P.decodeUtf8(this.bytes())};function m9(r,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var t=P.isArrayBuffer(r),i=P.isArrayBufferView(r);if(t||i){t?this.data=new DataView(r):this.data=new DataView(r.buffer,r.byteOffset,r.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,r!=null&&this.putBytes(r),"writeOffset"in e&&(this.write=e.writeOffset)}P.DataBuffer=m9;P.DataBuffer.prototype.length=function(){return this.write-this.read};P.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};P.DataBuffer.prototype.accommodate=function(r,e){if(this.length()>=r)return this;e=Math.max(e||this.growSize,r);var t=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),i=new Uint8Array(this.length()+e);return i.set(t),this.data=new DataView(i.buffer),this};P.DataBuffer.prototype.putByte=function(r){return this.accommodate(1),this.data.setUint8(this.write++,r),this};P.DataBuffer.prototype.fillWithByte=function(r,e){this.accommodate(e);for(var t=0;t<e;++t)this.data.setUint8(r);return this};P.DataBuffer.prototype.putBytes=function(r,e){if(P.isArrayBufferView(r)){var t=new Uint8Array(r.buffer,r.byteOffset,r.byteLength),i=t.byteLength-t.byteOffset;this.accommodate(i);var n=new Uint8Array(this.data.buffer,this.write);return n.set(t),this.write+=i,this}if(P.isArrayBuffer(r)){var t=new Uint8Array(r);this.accommodate(t.byteLength);var n=new Uint8Array(this.data.buffer);return n.set(t,this.write),this.write+=t.byteLength,this}if(r instanceof P.DataBuffer||typeof r=="object"&&typeof r.read=="number"&&typeof r.write=="number"&&P.isArrayBufferView(r.data)){var t=new Uint8Array(r.data.byteLength,r.read,r.length());this.accommodate(t.byteLength);var n=new Uint8Array(r.data.byteLength,this.write);return n.set(t),this.write+=t.byteLength,this}if(r instanceof P.ByteStringBuffer&&(r=r.data,e="binary"),e=e||"binary",typeof r=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(r.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=P.binary.hex.decode(r,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(r.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=P.binary.base64.decode(r,s,this.write),this;if(e==="utf8"&&(r=P.encodeUtf8(r),e="binary"),e==="binary"||e==="raw")return this.accommodate(r.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=P.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(r.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=P.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+r)};P.DataBuffer.prototype.putBuffer=function(r){return this.putBytes(r),r.clear(),this};P.DataBuffer.prototype.putString=function(r){return this.putBytes(r,"utf16")};P.DataBuffer.prototype.putInt16=function(r){return this.accommodate(2),this.data.setInt16(this.write,r),this.write+=2,this};P.DataBuffer.prototype.putInt24=function(r){return this.accommodate(3),this.data.setInt16(this.write,r>>8&65535),this.data.setInt8(this.write,r>>16&255),this.write+=3,this};P.DataBuffer.prototype.putInt32=function(r){return this.accommodate(4),this.data.setInt32(this.write,r),this.write+=4,this};P.DataBuffer.prototype.putInt16Le=function(r){return this.accommodate(2),this.data.setInt16(this.write,r,!0),this.write+=2,this};P.DataBuffer.prototype.putInt24Le=function(r){return this.accommodate(3),this.data.setInt8(this.write,r>>16&255),this.data.setInt16(this.write,r>>8&65535,!0),this.write+=3,this};P.DataBuffer.prototype.putInt32Le=function(r){return this.accommodate(4),this.data.setInt32(this.write,r,!0),this.write+=4,this};P.DataBuffer.prototype.putInt=function(r,e){Fs(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,r>>e&255);while(e>0);return this};P.DataBuffer.prototype.putSignedInt=function(r,e){return Fs(e),this.accommodate(e/8),r<0&&(r+=2<<e-1),this.putInt(r,e)};P.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};P.DataBuffer.prototype.getInt16=function(){var r=this.data.getInt16(this.read);return this.read+=2,r};P.DataBuffer.prototype.getInt24=function(){var r=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,r};P.DataBuffer.prototype.getInt32=function(){var r=this.data.getInt32(this.read);return this.read+=4,r};P.DataBuffer.prototype.getInt16Le=function(){var r=this.data.getInt16(this.read,!0);return this.read+=2,r};P.DataBuffer.prototype.getInt24Le=function(){var r=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,r};P.DataBuffer.prototype.getInt32Le=function(){var r=this.data.getInt32(this.read,!0);return this.read+=4,r};P.DataBuffer.prototype.getInt=function(r){Fs(r);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),r-=8;while(r>0);return e};P.DataBuffer.prototype.getSignedInt=function(r){var e=this.getInt(r),t=2<<r-2;return e>=t&&(e-=t<<1),e};P.DataBuffer.prototype.getBytes=function(r){var e;return r?(r=Math.min(this.length(),r),e=this.data.slice(this.read,this.read+r),this.read+=r):r===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};P.DataBuffer.prototype.bytes=function(r){return typeof r=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+r)};P.DataBuffer.prototype.at=function(r){return this.data.getUint8(this.read+r)};P.DataBuffer.prototype.setAt=function(r,e){return this.data.setUint8(r,e),this};P.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};P.DataBuffer.prototype.copy=function(){return new P.DataBuffer(this)};P.DataBuffer.prototype.compact=function(){if(this.read>0){var r=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(r.byteLength);e.set(r),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};P.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};P.DataBuffer.prototype.truncate=function(r){return this.write=Math.max(0,this.length()-r),this.read=Math.min(this.read,this.write),this};P.DataBuffer.prototype.toHex=function(){for(var r="",e=this.read;e<this.data.byteLength;++e){var t=this.data.getUint8(e);t<16&&(r+="0"),r+=t.toString(16)}return r};P.DataBuffer.prototype.toString=function(r){var e=new Uint8Array(this.data,this.read,this.length());if(r=r||"utf8",r==="binary"||r==="raw")return P.binary.raw.encode(e);if(r==="hex")return P.binary.hex.encode(e);if(r==="base64")return P.binary.base64.encode(e);if(r==="utf8")return P.text.utf8.decode(e);if(r==="utf16")return P.text.utf16.decode(e);throw new Error("Invalid encoding: "+r)};P.createBuffer=function(r,e){return e=e||"raw",r!==void 0&&e==="utf8"&&(r=P.encodeUtf8(r)),new P.ByteBuffer(r)};P.fillString=function(r,e){for(var t="";e>0;)e&1&&(t+=r),e>>>=1,e>0&&(r+=r);return t};P.xorBytes=function(r,e,t){for(var i="",n="",s="",f=0,a=0;t>0;--t,++f)n=r.charCodeAt(f)^e.charCodeAt(f),a>=10&&(i+=s,s="",a=0),s+=String.fromCharCode(n),++a;return i+=s,i};P.hexToBytes=function(r){var e="",t=0;for(r.length&!0&&(t=1,e+=String.fromCharCode(parseInt(r[0],16)));t<r.length;t+=2)e+=String.fromCharCode(parseInt(r.substr(t,2),16));return e};P.bytesToHex=function(r){return P.createBuffer(r).toHex()};P.int32ToBytes=function(r){return String.fromCharCode(r>>24&255)+String.fromCharCode(r>>16&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r&255)};var rn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",nn=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],e3="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";P.encode64=function(r,e){for(var t="",i="",n,s,f,a=0;a<r.length;)n=r.charCodeAt(a++),s=r.charCodeAt(a++),f=r.charCodeAt(a++),t+=rn.charAt(n>>2),t+=rn.charAt((n&3)<<4|s>>4),isNaN(s)?t+="==":(t+=rn.charAt((s&15)<<2|f>>6),t+=isNaN(f)?"=":rn.charAt(f&63)),e&&t.length>e&&(i+=t.substr(0,e)+`\r
`,t=t.substr(e));return i+=t,i};P.decode64=function(r){r=r.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",t,i,n,s,f=0;f<r.length;)t=nn[r.charCodeAt(f++)-43],i=nn[r.charCodeAt(f++)-43],n=nn[r.charCodeAt(f++)-43],s=nn[r.charCodeAt(f++)-43],e+=String.fromCharCode(t<<2|i>>4),n!==64&&(e+=String.fromCharCode((i&15)<<4|n>>2),s!==64&&(e+=String.fromCharCode((n&3)<<6|s)));return e};P.encodeUtf8=function(r){return unescape(encodeURIComponent(r))};P.decodeUtf8=function(r){return decodeURIComponent(escape(r))};P.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:Qb.encode,decode:Qb.decode}};P.binary.raw.encode=function(r){return String.fromCharCode.apply(null,r)};P.binary.raw.decode=function(r,e,t){var i=e;i||(i=new Uint8Array(r.length)),t=t||0;for(var n=t,s=0;s<r.length;++s)i[n++]=r.charCodeAt(s);return e?n-t:i};P.binary.hex.encode=P.bytesToHex;P.binary.hex.decode=function(r,e,t){var i=e;i||(i=new Uint8Array(Math.ceil(r.length/2))),t=t||0;var n=0,s=t;for(r.length&1&&(n=1,i[s++]=parseInt(r[0],16));n<r.length;n+=2)i[s++]=parseInt(r.substr(n,2),16);return e?s-t:i};P.binary.base64.encode=function(r,e){for(var t="",i="",n,s,f,a=0;a<r.byteLength;)n=r[a++],s=r[a++],f=r[a++],t+=rn.charAt(n>>2),t+=rn.charAt((n&3)<<4|s>>4),isNaN(s)?t+="==":(t+=rn.charAt((s&15)<<2|f>>6),t+=isNaN(f)?"=":rn.charAt(f&63)),e&&t.length>e&&(i+=t.substr(0,e)+`\r
`,t=t.substr(e));return i+=t,i};P.binary.base64.decode=function(r,e,t){var i=e;i||(i=new Uint8Array(Math.ceil(r.length/4)*3)),r=r.replace(/[^A-Za-z0-9\+\/\=]/g,""),t=t||0;for(var n,s,f,a,o=0,c=t;o<r.length;)n=nn[r.charCodeAt(o++)-43],s=nn[r.charCodeAt(o++)-43],f=nn[r.charCodeAt(o++)-43],a=nn[r.charCodeAt(o++)-43],i[c++]=n<<2|s>>4,f!==64&&(i[c++]=(s&15)<<4|f>>2,a!==64&&(i[c++]=(f&3)<<6|a));return e?c-t:i.subarray(0,c)};P.binary.base58.encode=function(r,e){return P.binary.baseN.encode(r,e3,e)};P.binary.base58.decode=function(r,e){return P.binary.baseN.decode(r,e3,e)};P.text={utf8:{},utf16:{}};P.text.utf8.encode=function(r,e,t){r=P.encodeUtf8(r);var i=e;i||(i=new Uint8Array(r.length)),t=t||0;for(var n=t,s=0;s<r.length;++s)i[n++]=r.charCodeAt(s);return e?n-t:i};P.text.utf8.decode=function(r){return P.decodeUtf8(String.fromCharCode.apply(null,r))};P.text.utf16.encode=function(r,e,t){var i=e;i||(i=new Uint8Array(r.length*2));var n=new Uint16Array(i.buffer);t=t||0;for(var s=t,f=t,a=0;a<r.length;++a)n[f++]=r.charCodeAt(a),s+=2;return e?s-t:i};P.text.utf16.decode=function(r){return String.fromCharCode.apply(null,new Uint16Array(r.buffer))};P.deflate=function(r,e,t){if(e=P.decode64(r.deflate(P.encode64(e)).rval),t){var i=2,n=e.charCodeAt(1);n&32&&(i=6),e=e.substring(i,e.length-4)}return e};P.inflate=function(r,e,t){var i=r.inflate(P.encode64(e)).rval;return i===null?null:P.decode64(i)};var yc=function(r,e,t){if(!r)throw new Error("WebStorage not available.");var i;if(t===null?i=r.removeItem(e):(t=P.encode64(JSON.stringify(t)),i=r.setItem(e,t)),typeof i!="undefined"&&i.rval!==!0){var n=new Error(i.error.message);throw n.id=i.error.id,n.name=i.error.name,n}},mc=function(r,e){if(!r)throw new Error("WebStorage not available.");var t=r.getItem(e);if(r.init)if(t.rval===null){if(t.error){var i=new Error(t.error.message);throw i.id=t.error.id,i.name=t.error.name,i}t=null}else t=t.rval;return t!==null&&(t=JSON.parse(P.decode64(t))),t},x9=function(r,e,t,i){var n=mc(r,e);n===null&&(n={}),n[t]=i,yc(r,e,n)},v9=function(r,e,t){var i=mc(r,e);return i!==null&&(i=t in i?i[t]:null),i},g9=function(r,e,t){var i=mc(r,e);if(i!==null&&t in i){delete i[t];var n=!0;for(var s in i){n=!1;break}n&&(i=null),yc(r,e,i)}},w9=function(r,e){yc(r,e,null)},Qf=function(r,e,t){var i=null;typeof t=="undefined"&&(t=["web","flash"]);var n,s=!1,f=null;for(var a in t){n=t[a];try{if(n==="flash"||n==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");i=r.apply(this,e),s=n==="flash"}(n==="web"||n==="both")&&(e[0]=localStorage,i=r.apply(this,e),s=!0)}catch(o){f=o}if(s)break}if(!s)throw f;return i};P.setItem=function(r,e,t,i,n){Qf(x9,arguments,n)};P.getItem=function(r,e,t,i){return Qf(v9,arguments,i)};P.removeItem=function(r,e,t,i){Qf(g9,arguments,i)};P.clearItems=function(r,e,t){Qf(w9,arguments,t)};P.parseUrl=function(r){var e=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;e.lastIndex=0;var t=e.exec(r),i=t===null?null:{full:r,scheme:t[1],host:t[2],port:t[3],path:t[4]};return i&&(i.fullHost=i.host,i.port?(i.port!==80&&i.scheme==="http"||i.port!==443&&i.scheme==="https")&&(i.fullHost+=":"+i.port):i.scheme==="http"?i.port=80:i.scheme==="https"&&(i.port=443),i.full=i.scheme+"://"+i.fullHost),i};var ea=null;P.getQueryVariables=function(r){var e=function(i){for(var n={},s=i.split("&"),f=0;f<s.length;f++){var a=s[f].indexOf("="),o,c;a>0?(o=s[f].substring(0,a),c=s[f].substring(a+1)):(o=s[f],c=null),o in n||(n[o]=[]),!(o in Object.prototype)&&c!==null&&n[o].push(unescape(c))}return n},t;return typeof r=="undefined"?(ea===null&&(typeof window!="undefined"&&window.location&&window.location.search?ea=e(window.location.search.substring(1)):ea={}),t=ea):t=e(r),t};P.parseFragment=function(r){var e=r,t="",i=r.indexOf("?");i>0&&(e=r.substring(0,i),t=r.substring(i+1));var n=e.split("/");n.length>0&&n[0]===""&&n.shift();var s=t===""?{}:P.getQueryVariables(t);return{pathString:e,queryString:t,path:n,query:s}};P.makeRequest=function(r){var e=P.parseFragment(r),t={path:e.pathString,query:e.queryString,getPath:function(i){return typeof i=="undefined"?e.path:e.path[i]},getQuery:function(i,n){var s;return typeof i=="undefined"?s=e.query:(s=e.query[i],s&&typeof n!="undefined"&&(s=s[n])),s},getQueryLast:function(i,n){var s,f=t.getQuery(i);return f?s=f[f.length-1]:s=n,s}};return t};P.makeLink=function(r,e,t){r=jQuery.isArray(r)?r.join("/"):r;var i=jQuery.param(e||{});return t=t||"",r+(i.length>0?"?"+i:"")+(t.length>0?"#"+t:"")};P.isEmpty=function(r){for(var e in r)if(r.hasOwnProperty(e))return!1;return!0};P.format=function(r){for(var e=/%./g,t,i,n=0,s=[],f=0;t=e.exec(r);){i=r.substring(f,e.lastIndex-2),i.length>0&&s.push(i),f=e.lastIndex;var a=t[0][1];switch(a){case"s":case"o":n<arguments.length?s.push(arguments[n+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+a+"?>")}}return s.push(r.substring(f)),s.join("")};P.formatNumber=function(r,e,t,i){var n=r,s=isNaN(e=Math.abs(e))?2:e,f=t===void 0?",":t,a=i===void 0?".":i,o=n<0?"-":"",c=parseInt(n=Math.abs(+n||0).toFixed(s),10)+"",d=c.length>3?c.length%3:0;return o+(d?c.substr(0,d)+a:"")+c.substr(d).replace(/(\d{3})(?=\d)/g,"$1"+a)+(s?f+Math.abs(n-c).toFixed(s).slice(2):"")};P.formatSize=function(r){return r>=1073741824?r=P.formatNumber(r/1073741824,2,".","")+" GiB":r>=1048576?r=P.formatNumber(r/1048576,2,".","")+" MiB":r>=1024?r=P.formatNumber(r/1024,0)+" KiB":r=P.formatNumber(r,0)+" bytes",r};P.bytesFromIP=function(r){return r.indexOf(".")!==-1?P.bytesFromIPv4(r):r.indexOf(":")!==-1?P.bytesFromIPv6(r):null};P.bytesFromIPv4=function(r){if(r=r.split("."),r.length!==4)return null;for(var e=P.createBuffer(),t=0;t<r.length;++t){var i=parseInt(r[t],10);if(isNaN(i))return null;e.putByte(i)}return e.getBytes()};P.bytesFromIPv6=function(r){var e=0;r=r.split(":").filter(function(f){return f.length===0&&++e,!0});for(var t=(8-r.length+e)*2,i=P.createBuffer(),n=0;n<8;++n){if(!r[n]||r[n].length===0){i.fillWithByte(0,t),t=0;continue}var s=P.hexToBytes(r[n]);s.length<2&&i.putByte(0),i.putBytes(s)}return i.getBytes()};P.bytesToIP=function(r){return r.length===4?P.bytesToIPv4(r):r.length===16?P.bytesToIPv6(r):null};P.bytesToIPv4=function(r){if(r.length!==4)return null;for(var e=[],t=0;t<r.length;++t)e.push(r.charCodeAt(t));return e.join(".")};P.bytesToIPv6=function(r){if(r.length!==16)return null;for(var e=[],t=[],i=0,n=0;n<r.length;n+=2){for(var s=P.bytesToHex(r[n]+r[n+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var f=t[t.length-1],a=e.length;!f||a!==f.end+1?t.push({start:a,end:a}):(f.end=a,f.end-f.start>t[i].end-t[i].start&&(i=t.length-1))}e.push(s)}if(t.length>0){var o=t[i];o.end-o.start>0&&(e.splice(o.start,o.end-o.start+1,""),o.start===0&&e.unshift(""),o.end===7&&e.push(""))}return e.join(":")};P.estimateCores=function(r,e){if(typeof r=="function"&&(e=r,r={}),r=r||{},"cores"in P&&!r.update)return e(null,P.cores);if(typeof navigator!="undefined"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return P.cores=navigator.hardwareConcurrency,e(null,P.cores);if(typeof Worker=="undefined")return P.cores=1,e(null,P.cores);if(typeof Blob=="undefined")return P.cores=2,e(null,P.cores);var t=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(f){for(var a=Date.now(),o=a+4;Date.now()<o;);self.postMessage({st:a,et:o})})}.toString(),")()"],{type:"application/javascript"}));i([],5,16);function i(f,a,o){if(a===0){var c=Math.floor(f.reduce(function(d,u){return d+u},0)/f.length);return P.cores=Math.max(1,c),URL.revokeObjectURL(t),e(null,P.cores)}n(o,function(d,u){f.push(s(o,u)),i(f,a-1,o)})}function n(f,a){for(var o=[],c=[],d=0;d<f;++d){var u=new Worker(t);u.addEventListener("message",function(p){if(c.push(p.data),c.length===f){for(var x=0;x<f;++x)o[x].terminate();a(null,c)}}),o.push(u)}for(var d=0;d<f;++d)o[d].postMessage(d)}function s(f,a){for(var o=[],c=0;c<f;++c)for(var d=a[c],u=o[c]=[],p=0;p<f;++p)if(c!==p){var x=a[p];(d.st>x.st&&d.st<x.et||x.st>d.st&&x.st<d.et)&&u.push(p)}return o.reduce(function(y,g){return Math.max(y,g.length)},0)}}});var ta=C((sB,t3)=>{var Ds=He();Ds.pki=Ds.pki||{};var xc=t3.exports=Ds.pki.oids=Ds.oids=Ds.oids||{};function Z(r,e){xc[r]=e,xc[e]=r}function Xe(r,e){xc[r]=e}Z("1.2.840.113549.1.1.1","rsaEncryption");Z("1.2.840.113549.1.1.4","md5WithRSAEncryption");Z("1.2.840.113549.1.1.5","sha1WithRSAEncryption");Z("1.2.840.113549.1.1.7","RSAES-OAEP");Z("1.2.840.113549.1.1.8","mgf1");Z("1.2.840.113549.1.1.9","pSpecified");Z("1.2.840.113549.1.1.10","RSASSA-PSS");Z("1.2.840.113549.1.1.11","sha256WithRSAEncryption");Z("1.2.840.113549.1.1.12","sha384WithRSAEncryption");Z("1.2.840.113549.1.1.13","sha512WithRSAEncryption");Z("1.3.101.112","EdDSA25519");Z("1.2.840.10040.4.3","dsa-with-sha1");Z("1.3.14.3.2.7","desCBC");Z("1.3.14.3.2.26","sha1");Z("2.16.840.1.101.3.4.2.1","sha256");Z("2.16.840.1.101.3.4.2.2","sha384");Z("2.16.840.1.101.3.4.2.3","sha512");Z("1.2.840.113549.2.5","md5");Z("1.2.840.113549.1.7.1","data");Z("1.2.840.113549.1.7.2","signedData");Z("1.2.840.113549.1.7.3","envelopedData");Z("1.2.840.113549.1.7.4","signedAndEnvelopedData");Z("1.2.840.113549.1.7.5","digestedData");Z("1.2.840.113549.1.7.6","encryptedData");Z("1.2.840.113549.1.9.1","emailAddress");Z("1.2.840.113549.1.9.2","unstructuredName");Z("1.2.840.113549.1.9.3","contentType");Z("1.2.840.113549.1.9.4","messageDigest");Z("1.2.840.113549.1.9.5","signingTime");Z("1.2.840.113549.1.9.6","counterSignature");Z("1.2.840.113549.1.9.7","challengePassword");Z("1.2.840.113549.1.9.8","unstructuredAddress");Z("1.2.840.113549.1.9.14","extensionRequest");Z("1.2.840.113549.1.9.20","friendlyName");Z("1.2.840.113549.1.9.21","localKeyId");Z("1.2.840.113549.1.9.22.1","x509Certificate");Z("1.2.840.113549.1.12.10.1.1","keyBag");Z("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");Z("1.2.840.113549.1.12.10.1.3","certBag");Z("1.2.840.113549.1.12.10.1.4","crlBag");Z("1.2.840.113549.1.12.10.1.5","secretBag");Z("1.2.840.113549.1.12.10.1.6","safeContentsBag");Z("1.2.840.113549.1.5.13","pkcs5PBES2");Z("1.2.840.113549.1.5.12","pkcs5PBKDF2");Z("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");Z("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");Z("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");Z("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");Z("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");Z("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");Z("1.2.840.113549.2.7","hmacWithSHA1");Z("1.2.840.113549.2.8","hmacWithSHA224");Z("1.2.840.113549.2.9","hmacWithSHA256");Z("1.2.840.113549.2.10","hmacWithSHA384");Z("1.2.840.113549.2.11","hmacWithSHA512");Z("1.2.840.113549.3.7","des-EDE3-CBC");Z("2.16.840.1.101.3.4.1.2","aes128-CBC");Z("2.16.840.1.101.3.4.1.22","aes192-CBC");Z("2.16.840.1.101.3.4.1.42","aes256-CBC");Z("2.5.4.3","commonName");Z("2.5.4.5","serialName");Z("2.5.4.6","countryName");Z("2.5.4.7","localityName");Z("2.5.4.8","stateOrProvinceName");Z("2.5.4.9","streetAddress");Z("2.5.4.10","organizationName");Z("2.5.4.11","organizationalUnitName");Z("2.5.4.13","description");Z("2.5.4.15","businessCategory");Z("2.5.4.17","postalCode");Z("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");Z("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");Z("2.16.840.1.113730.1.1","nsCertType");Z("2.16.840.1.113730.1.13","nsComment");Xe("2.5.29.1","authorityKeyIdentifier");Xe("2.5.29.2","keyAttributes");Xe("2.5.29.3","certificatePolicies");Xe("2.5.29.4","keyUsageRestriction");Xe("2.5.29.5","policyMapping");Xe("2.5.29.6","subtreesConstraint");Xe("2.5.29.7","subjectAltName");Xe("2.5.29.8","issuerAltName");Xe("2.5.29.9","subjectDirectoryAttributes");Xe("2.5.29.10","basicConstraints");Xe("2.5.29.11","nameConstraints");Xe("2.5.29.12","policyConstraints");Xe("2.5.29.13","basicConstraints");Z("2.5.29.14","subjectKeyIdentifier");Z("2.5.29.15","keyUsage");Xe("2.5.29.16","privateKeyUsagePeriod");Z("2.5.29.17","subjectAltName");Z("2.5.29.18","issuerAltName");Z("2.5.29.19","basicConstraints");Xe("2.5.29.20","cRLNumber");Xe("2.5.29.21","cRLReason");Xe("2.5.29.22","expirationDate");Xe("2.5.29.23","instructionCode");Xe("2.5.29.24","invalidityDate");Xe("2.5.29.25","cRLDistributionPoints");Xe("2.5.29.26","issuingDistributionPoint");Xe("2.5.29.27","deltaCRLIndicator");Xe("2.5.29.28","issuingDistributionPoint");Xe("2.5.29.29","certificateIssuer");Xe("2.5.29.30","nameConstraints");Z("2.5.29.31","cRLDistributionPoints");Z("2.5.29.32","certificatePolicies");Xe("2.5.29.33","policyMappings");Xe("2.5.29.34","policyConstraints");Z("2.5.29.35","authorityKeyIdentifier");Xe("2.5.29.36","policyConstraints");Z("2.5.29.37","extKeyUsage");Xe("2.5.29.46","freshestCRL");Xe("2.5.29.54","inhibitAnyPolicy");Z("1.3.6.1.4.1.11129.2.4.2","timestampList");Z("1.3.6.1.5.5.7.1.1","authorityInfoAccess");Z("1.3.6.1.5.5.7.3.1","serverAuth");Z("1.3.6.1.5.5.7.3.2","clientAuth");Z("1.3.6.1.5.5.7.3.3","codeSigning");Z("1.3.6.1.5.5.7.3.4","emailProtection");Z("1.3.6.1.5.5.7.3.8","timeStamping")});var P0=C((fB,r3)=>{var Et=He();Kt();ta();var Q=r3.exports=Et.asn1=Et.asn1||{};Q.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};Q.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};Q.create=function(r,e,t,i,n){if(Et.util.isArray(i)){for(var s=[],f=0;f<i.length;++f)i[f]!==void 0&&s.push(i[f]);i=s}var a={tagClass:r,type:e,constructed:t,composed:t||Et.util.isArray(i),value:i};return n&&"bitStringContents"in n&&(a.bitStringContents=n.bitStringContents,a.original=Q.copy(a)),a};Q.copy=function(r,e){var t;if(Et.util.isArray(r)){t=[];for(var i=0;i<r.length;++i)t.push(Q.copy(r[i],e));return t}return typeof r=="string"?r:(t={tagClass:r.tagClass,type:r.type,constructed:r.constructed,composed:r.composed,value:Q.copy(r.value,e)},e&&!e.excludeBitStringContents&&(t.bitStringContents=r.bitStringContents),t)};Q.equals=function(r,e,t){if(Et.util.isArray(r)){if(!Et.util.isArray(e)||r.length!==e.length)return!1;for(var i=0;i<r.length;++i)if(!Q.equals(r[i],e[i]))return!1;return!0}if(typeof r!=typeof e)return!1;if(typeof r=="string")return r===e;var n=r.tagClass===e.tagClass&&r.type===e.type&&r.constructed===e.constructed&&r.composed===e.composed&&Q.equals(r.value,e.value);return t&&t.includeBitStringContents&&(n=n&&r.bitStringContents===e.bitStringContents),n};Q.getBerValueLength=function(r){var e=r.getByte();if(e!==128){var t,i=e&128;return i?t=r.getInt((e&127)<<3):t=e,t}};function zs(r,e,t){if(t>e){var i=new Error("Too few bytes to parse DER.");throw i.available=r.length(),i.remaining=e,i.requested=t,i}}var S9=function(r,e){var t=r.getByte();if(e--,t!==128){var i,n=t&128;if(!n)i=t;else{var s=t&127;zs(r,e,s),i=r.getInt(s<<3)}if(i<0)throw new Error("Negative length: "+i);return i}};Q.fromDer=function(r,e){return e===void 0&&(e={strict:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof r=="string"&&(r=Et.util.createBuffer(r)),ra(r,r.length(),0,e)};function ra(r,e,t,i){var n;zs(r,e,2);var s=r.getByte();e--;var f=s&192,a=s&31;n=r.length();var o=S9(r,e);if(e-=n-r.length(),o!==void 0&&o>e){if(i.strict){var c=new Error("Too few bytes to read ASN.1 value.");throw c.available=r.length(),c.remaining=e,c.requested=o,c}o=e}var d,u,p=(s&32)==32;if(p)if(d=[],o===void 0)for(;;){if(zs(r,e,2),r.bytes(2)===String.fromCharCode(0,0)){r.getBytes(2),e-=2;break}n=r.length(),d.push(ra(r,e,t+1,i)),e-=n-r.length()}else for(;o>0;)n=r.length(),d.push(ra(r,o,t+1,i)),e-=n-r.length(),o-=n-r.length();if(d===void 0&&f===Q.Class.UNIVERSAL&&a===Q.Type.BITSTRING&&(u=r.bytes(o)),d===void 0&&i.decodeBitStrings&&f===Q.Class.UNIVERSAL&&a===Q.Type.BITSTRING&&o>1){var x=r.read,y=e,g=0;if(a===Q.Type.BITSTRING&&(zs(r,e,1),g=r.getByte(),e--),g===0)try{n=r.length();var M={verbose:i.verbose,strict:!0,decodeBitStrings:!0},k=ra(r,e,t+1,M),R=n-r.length();e-=R,a==Q.Type.BITSTRING&&R++;var K=k.tagClass;R===o&&(K===Q.Class.UNIVERSAL||K===Q.Class.CONTEXT_SPECIFIC)&&(d=[k])}catch(O){}d===void 0&&(r.read=x,e=y)}if(d===void 0){if(o===void 0){if(i.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");o=e}if(a===Q.Type.BMPSTRING)for(d="";o>0;o-=2)zs(r,e,2),d+=String.fromCharCode(r.getInt16()),e-=2;else d=r.getBytes(o)}var L=u===void 0?null:{bitStringContents:u};return Q.create(f,a,p,d,L)}Q.toDer=function(r){var e=Et.util.createBuffer(),t=r.tagClass|r.type,i=Et.util.createBuffer(),n=!1;if("bitStringContents"in r&&(n=!0,r.original&&(n=Q.equals(r,r.original))),n)i.putBytes(r.bitStringContents);else if(r.composed){r.constructed?t|=32:i.putByte(0);for(var s=0;s<r.value.length;++s)r.value[s]!==void 0&&i.putBuffer(Q.toDer(r.value[s]))}else if(r.type===Q.Type.BMPSTRING)for(var s=0;s<r.value.length;++s)i.putInt16(r.value.charCodeAt(s));else r.type===Q.Type.INTEGER&&r.value.length>1&&(r.value.charCodeAt(0)===0&&(r.value.charCodeAt(1)&128)==0||r.value.charCodeAt(0)===255&&(r.value.charCodeAt(1)&128)==128)?i.putBytes(r.value.substr(1)):i.putBytes(r.value);if(e.putByte(t),i.length()<=127)e.putByte(i.length()&127);else{var f=i.length(),a="";do a+=String.fromCharCode(f&255),f=f>>>8;while(f>0);e.putByte(a.length|128);for(var s=a.length-1;s>=0;--s)e.putByte(a.charCodeAt(s))}return e.putBuffer(i),e};Q.oidToDer=function(r){var e=r.split("."),t=Et.util.createBuffer();t.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var i,n,s,f,a=2;a<e.length;++a){i=!0,n=[],s=parseInt(e[a],10);do f=s&127,s=s>>>7,i||(f|=128),n.push(f),i=!1;while(s>0);for(var o=n.length-1;o>=0;--o)t.putByte(n[o])}return t};Q.derToOid=function(r){var e;typeof r=="string"&&(r=Et.util.createBuffer(r));var t=r.getByte();e=Math.floor(t/40)+"."+t%40;for(var i=0;r.length()>0;)t=r.getByte(),i=i<<7,t&128?i+=t&127:(e+="."+(i+t),i=0);return e};Q.utcTimeToDate=function(r){var e=new Date,t=parseInt(r.substr(0,2),10);t=t>=50?1900+t:2e3+t;var i=parseInt(r.substr(2,2),10)-1,n=parseInt(r.substr(4,2),10),s=parseInt(r.substr(6,2),10),f=parseInt(r.substr(8,2),10),a=0;if(r.length>11){var o=r.charAt(10),c=10;o!=="+"&&o!=="-"&&(a=parseInt(r.substr(10,2),10),c+=2)}if(e.setUTCFullYear(t,i,n),e.setUTCHours(s,f,a,0),c&&(o=r.charAt(c),o==="+"||o==="-")){var d=parseInt(r.substr(c+1,2),10),u=parseInt(r.substr(c+4,2),10),p=d*60+u;p*=6e4,o==="+"?e.setTime(+e-p):e.setTime(+e+p)}return e};Q.generalizedTimeToDate=function(r){var e=new Date,t=parseInt(r.substr(0,4),10),i=parseInt(r.substr(4,2),10)-1,n=parseInt(r.substr(6,2),10),s=parseInt(r.substr(8,2),10),f=parseInt(r.substr(10,2),10),a=parseInt(r.substr(12,2),10),o=0,c=0,d=!1;r.charAt(r.length-1)==="Z"&&(d=!0);var u=r.length-5,p=r.charAt(u);if(p==="+"||p==="-"){var x=parseInt(r.substr(u+1,2),10),y=parseInt(r.substr(u+4,2),10);c=x*60+y,c*=6e4,p==="+"&&(c*=-1),d=!0}return r.charAt(14)==="."&&(o=parseFloat(r.substr(14),10)*1e3),d?(e.setUTCFullYear(t,i,n),e.setUTCHours(s,f,a,o),e.setTime(+e+c)):(e.setFullYear(t,i,n),e.setHours(s,f,a,o)),e};Q.dateToUtcTime=function(r){if(typeof r=="string")return r;var e="",t=[];t.push((""+r.getUTCFullYear()).substr(2)),t.push(""+(r.getUTCMonth()+1)),t.push(""+r.getUTCDate()),t.push(""+r.getUTCHours()),t.push(""+r.getUTCMinutes()),t.push(""+r.getUTCSeconds());for(var i=0;i<t.length;++i)t[i].length<2&&(e+="0"),e+=t[i];return e+="Z",e};Q.dateToGeneralizedTime=function(r){if(typeof r=="string")return r;var e="",t=[];t.push(""+r.getUTCFullYear()),t.push(""+(r.getUTCMonth()+1)),t.push(""+r.getUTCDate()),t.push(""+r.getUTCHours()),t.push(""+r.getUTCMinutes()),t.push(""+r.getUTCSeconds());for(var i=0;i<t.length;++i)t[i].length<2&&(e+="0"),e+=t[i];return e+="Z",e};Q.integerToDer=function(r){var e=Et.util.createBuffer();if(r>=-128&&r<128)return e.putSignedInt(r,8);if(r>=-32768&&r<32768)return e.putSignedInt(r,16);if(r>=-8388608&&r<8388608)return e.putSignedInt(r,24);if(r>=-2147483648&&r<2147483648)return e.putSignedInt(r,32);var t=new Error("Integer too large; max is 32-bits.");throw t.integer=r,t};Q.derToInteger=function(r){typeof r=="string"&&(r=Et.util.createBuffer(r));var e=r.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return r.getSignedInt(e)};Q.validate=function(r,e,t,i){var n=!1;if((r.tagClass===e.tagClass||typeof e.tagClass=="undefined")&&(r.type===e.type||typeof e.type=="undefined"))if(r.constructed===e.constructed||typeof e.constructed=="undefined"){if(n=!0,e.value&&Et.util.isArray(e.value))for(var s=0,f=0;n&&f<e.value.length;++f)n=e.value[f].optional||!1,r.value[s]&&(n=Q.validate(r.value[s],e.value[f],t,i),n?++s:e.value[f].optional&&(n=!0)),!n&&i&&i.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+r.value.length+'"');if(n&&t&&(e.capture&&(t[e.capture]=r.value),e.captureAsn1&&(t[e.captureAsn1]=r),e.captureBitStringContents&&"bitStringContents"in r&&(t[e.captureBitStringContents]=r.bitStringContents),e.captureBitStringValue&&"bitStringContents"in r)){var a;if(r.bitStringContents.length<2)t[e.captureBitStringValue]="";else{var o=r.bitStringContents.charCodeAt(0);if(o!==0)throw new Error("captureBitStringValue only supported for zero unused bits");t[e.captureBitStringValue]=r.bitStringContents.slice(1)}}}else i&&i.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+r.constructed+'"');else i&&(r.tagClass!==e.tagClass&&i.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+r.tagClass+'"'),r.type!==e.type&&i.push("["+e.name+'] Expected type "'+e.type+'", got "'+r.type+'"'));return n};var i3=/[^\\u0000-\\u00ff]/;Q.prettyPrint=function(r,e,t){var i="";e=e||0,t=t||2,e>0&&(i+=`
`);for(var n="",s=0;s<e*t;++s)n+=" ";switch(i+=n+"Tag: ",r.tagClass){case Q.Class.UNIVERSAL:i+="Universal:";break;case Q.Class.APPLICATION:i+="Application:";break;case Q.Class.CONTEXT_SPECIFIC:i+="Context-Specific:";break;case Q.Class.PRIVATE:i+="Private:";break}if(r.tagClass===Q.Class.UNIVERSAL)switch(i+=r.type,r.type){case Q.Type.NONE:i+=" (None)";break;case Q.Type.BOOLEAN:i+=" (Boolean)";break;case Q.Type.INTEGER:i+=" (Integer)";break;case Q.Type.BITSTRING:i+=" (Bit string)";break;case Q.Type.OCTETSTRING:i+=" (Octet string)";break;case Q.Type.NULL:i+=" (Null)";break;case Q.Type.OID:i+=" (Object Identifier)";break;case Q.Type.ODESC:i+=" (Object Descriptor)";break;case Q.Type.EXTERNAL:i+=" (External or Instance of)";break;case Q.Type.REAL:i+=" (Real)";break;case Q.Type.ENUMERATED:i+=" (Enumerated)";break;case Q.Type.EMBEDDED:i+=" (Embedded PDV)";break;case Q.Type.UTF8:i+=" (UTF8)";break;case Q.Type.ROID:i+=" (Relative Object Identifier)";break;case Q.Type.SEQUENCE:i+=" (Sequence)";break;case Q.Type.SET:i+=" (Set)";break;case Q.Type.PRINTABLESTRING:i+=" (Printable String)";break;case Q.Type.IA5String:i+=" (IA5String (ASCII))";break;case Q.Type.UTCTIME:i+=" (UTC time)";break;case Q.Type.GENERALIZEDTIME:i+=" (Generalized time)";break;case Q.Type.BMPSTRING:i+=" (BMP String)";break}else i+=r.type;if(i+=`
`,i+=n+"Constructed: "+r.constructed+`
`,r.composed){for(var f=0,a="",s=0;s<r.value.length;++s)r.value[s]!==void 0&&(f+=1,a+=Q.prettyPrint(r.value[s],e+1,t),s+1<r.value.length&&(a+=","));i+=n+"Sub values: "+f+a}else{if(i+=n+"Value: ",r.type===Q.Type.OID){var o=Q.derToOid(r.value);i+=o,Et.pki&&Et.pki.oids&&o in Et.pki.oids&&(i+=" ("+Et.pki.oids[o]+") ")}if(r.type===Q.Type.INTEGER)try{i+=Q.derToInteger(r.value)}catch(d){i+="0x"+Et.util.bytesToHex(r.value)}else if(r.type===Q.Type.BITSTRING){if(r.value.length>1?i+="0x"+Et.util.bytesToHex(r.value.slice(1)):i+="(none)",r.value.length>0){var c=r.value.charCodeAt(0);c==1?i+=" (1 unused bit shown)":c>1&&(i+=" ("+c+" unused bits shown)")}}else r.type===Q.Type.OCTETSTRING?(i3.test(r.value)||(i+="("+r.value+") "),i+="0x"+Et.util.bytesToHex(r.value)):r.type===Q.Type.UTF8?i+=Et.util.decodeUtf8(r.value):r.type===Q.Type.PRINTABLESTRING||r.type===Q.Type.IA5String?i+=r.value:i3.test(r.value)?i+="0x"+Et.util.bytesToHex(r.value):r.value.length===0?i+="[null]":i+=r.value}return i}});var gc=C((aB,n3)=>{var Wt=He();Kt();n3.exports=Wt.cipher=Wt.cipher||{};Wt.cipher.algorithms=Wt.cipher.algorithms||{};Wt.cipher.createCipher=function(r,e){var t=r;if(typeof t=="string"&&(t=Wt.cipher.getAlgorithm(t),t&&(t=t())),!t)throw new Error("Unsupported algorithm: "+r);return new Wt.cipher.BlockCipher({algorithm:t,key:e,decrypt:!1})};Wt.cipher.createDecipher=function(r,e){var t=r;if(typeof t=="string"&&(t=Wt.cipher.getAlgorithm(t),t&&(t=t())),!t)throw new Error("Unsupported algorithm: "+r);return new Wt.cipher.BlockCipher({algorithm:t,key:e,decrypt:!0})};Wt.cipher.registerAlgorithm=function(r,e){r=r.toUpperCase(),Wt.cipher.algorithms[r]=e};Wt.cipher.getAlgorithm=function(r){return r=r.toUpperCase(),r in Wt.cipher.algorithms?Wt.cipher.algorithms[r]:null};var vc=Wt.cipher.BlockCipher=function(r){this.algorithm=r.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=r.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=r.decrypt,this.algorithm.initialize(r)};vc.prototype.start=function(r){r=r||{};var e={};for(var t in r)e[t]=r[t];e.decrypt=this._decrypt,this._finish=!1,this._input=Wt.util.createBuffer(),this.output=r.output||Wt.util.createBuffer(),this.mode.start(e)};vc.prototype.update=function(r){for(r&&this._input.putBuffer(r);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};vc.prototype.finish=function(r){r&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(t){return r(this.blockSize,t,!1)},this.mode.unpad=function(t){return r(this.blockSize,t,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var Sc=C((oB,s3)=>{var jt=He();Kt();jt.cipher=jt.cipher||{};var Ke=s3.exports=jt.cipher.modes=jt.cipher.modes||{};Ke.ecb=function(r){r=r||{},this.name="ECB",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Ke.ecb.prototype.start=function(r){};Ke.ecb.prototype.encrypt=function(r,e,t){if(r.length()<this.blockSize&&!(t&&r.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=r.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i])};Ke.ecb.prototype.decrypt=function(r,e,t){if(r.length()<this.blockSize&&!(t&&r.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=r.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i])};Ke.ecb.prototype.pad=function(r,e){var t=r.length()===this.blockSize?this.blockSize:this.blockSize-r.length();return r.fillWithByte(t,t),!0};Ke.ecb.prototype.unpad=function(r,e){if(e.overflow>0)return!1;var t=r.length(),i=r.at(t-1);return i>this.blockSize<<2?!1:(r.truncate(i),!0)};Ke.cbc=function(r){r=r||{},this.name="CBC",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Ke.cbc.prototype.start=function(r){if(r.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in r)this._iv=ia(r.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};Ke.cbc.prototype.encrypt=function(r,e,t){if(r.length()<this.blockSize&&!(t&&r.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=this._prev[i]^r.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]);this._prev=this._outBlock};Ke.cbc.prototype.decrypt=function(r,e,t){if(r.length()<this.blockSize&&!(t&&r.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=r.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._prev[i]^this._outBlock[i]);this._prev=this._inBlock.slice(0)};Ke.cbc.prototype.pad=function(r,e){var t=r.length()===this.blockSize?this.blockSize:this.blockSize-r.length();return r.fillWithByte(t,t),!0};Ke.cbc.prototype.unpad=function(r,e){if(e.overflow>0)return!1;var t=r.length(),i=r.at(t-1);return i>this.blockSize<<2?!1:(r.truncate(i),!0)};Ke.cfb=function(r){r=r||{},this.name="CFB",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=jt.util.createBuffer(),this._partialBytes=0};Ke.cfb.prototype.start=function(r){if(!("iv"in r))throw new Error("Invalid IV parameter.");this._iv=ia(r.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Ke.cfb.prototype.encrypt=function(r,e,t){var i=r.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=r.getInt32()^this._outBlock[n],e.putInt32(this._inBlock[n]);return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=r.getInt32()^this._outBlock[n],this._partialOutput.putInt32(this._partialBlock[n]);if(s>0)r.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};Ke.cfb.prototype.decrypt=function(r,e,t){var i=r.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=r.getInt32(),e.putInt32(this._inBlock[n]^this._outBlock[n]);return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=r.getInt32(),this._partialOutput.putInt32(this._partialBlock[n]^this._outBlock[n]);if(s>0)r.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};Ke.ofb=function(r){r=r||{},this.name="OFB",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=jt.util.createBuffer(),this._partialBytes=0};Ke.ofb.prototype.start=function(r){if(!("iv"in r))throw new Error("Invalid IV parameter.");this._iv=ia(r.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Ke.ofb.prototype.encrypt=function(r,e,t){var i=r.length();if(r.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)e.putInt32(r.getInt32()^this._outBlock[n]),this._inBlock[n]=this._outBlock[n];return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(r.getInt32()^this._outBlock[n]);if(s>0)r.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._outBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};Ke.ofb.prototype.decrypt=Ke.ofb.prototype.encrypt;Ke.ctr=function(r){r=r||{},this.name="CTR",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=jt.util.createBuffer(),this._partialBytes=0};Ke.ctr.prototype.start=function(r){if(!("iv"in r))throw new Error("Invalid IV parameter.");this._iv=ia(r.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Ke.ctr.prototype.encrypt=function(r,e,t){var i=r.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize)for(var n=0;n<this._ints;++n)e.putInt32(r.getInt32()^this._outBlock[n]);else{var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(r.getInt32()^this._outBlock[n]);if(s>0&&(r.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}na(this._inBlock)};Ke.ctr.prototype.decrypt=Ke.ctr.prototype.encrypt;Ke.gcm=function(r){r=r||{},this.name="GCM",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=jt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};Ke.gcm.prototype.start=function(r){if(!("iv"in r))throw new Error("Invalid IV parameter.");var e=jt.util.createBuffer(r.iv);this._cipherLength=0;var t;if("additionalData"in r?t=jt.util.createBuffer(r.additionalData):t=jt.util.createBuffer(),"tagLength"in r?this._tagLength=r.tagLength:this._tagLength=128,this._tag=null,r.decrypt&&(this._tag=jt.util.createBuffer(r.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var i=e.length();if(i===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(wc(i*8)))}this._inBlock=this._j0.slice(0),na(this._inBlock),this._partialBytes=0,t=jt.util.createBuffer(t),this._aDataLength=wc(t.length()*8);var n=t.length()%this.blockSize;for(n&&t.fillWithByte(0,this.blockSize-n),this._s=[0,0,0,0];t.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])};Ke.gcm.prototype.encrypt=function(r,e,t){var i=r.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]^=r.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(r.getInt32()^this._outBlock[n]);if(s<=0||t){if(t){var f=i%this.blockSize;this._cipherLength+=f,this._partialOutput.truncate(this.blockSize-f)}else this._cipherLength+=this.blockSize;for(var n=0;n<this._ints;++n)this._outBlock[n]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return r.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),na(this._inBlock)};Ke.gcm.prototype.decrypt=function(r,e,t){var i=r.length();if(i<this.blockSize&&!(t&&i>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),na(this._inBlock),this._hashBlock[0]=r.getInt32(),this._hashBlock[1]=r.getInt32(),this._hashBlock[2]=r.getInt32(),this._hashBlock[3]=r.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]^this._hashBlock[n]);i<this.blockSize?this._cipherLength+=i%this.blockSize:this._cipherLength+=this.blockSize};Ke.gcm.prototype.afterFinish=function(r,e){var t=!0;e.decrypt&&e.overflow&&r.truncate(this.blockSize-e.overflow),this.tag=jt.util.createBuffer();var i=this._aDataLength.concat(wc(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,i);var n=[];this.cipher.encrypt(this._j0,n);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^n[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(t=!1),t};Ke.gcm.prototype.multiply=function(r,e){for(var t=[0,0,0,0],i=e.slice(0),n=0;n<128;++n){var s=r[n/32|0]&1<<31-n%32;s&&(t[0]^=i[0],t[1]^=i[1],t[2]^=i[2],t[3]^=i[3]),this.pow(i,i)}return t};Ke.gcm.prototype.pow=function(r,e){for(var t=r[3]&1,i=3;i>0;--i)e[i]=r[i]>>>1|(r[i-1]&1)<<31;e[0]=r[0]>>>1,t&&(e[0]^=this._R)};Ke.gcm.prototype.tableMultiply=function(r){for(var e=[0,0,0,0],t=0;t<32;++t){var i=t/8|0,n=r[i]>>>(7-t%8)*4&15,s=this._m[t][n];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};Ke.gcm.prototype.ghash=function(r,e,t){return e[0]^=t[0],e[1]^=t[1],e[2]^=t[2],e[3]^=t[3],this.tableMultiply(e)};Ke.gcm.prototype.generateHashTable=function(r,e){for(var t=8/e,i=4*t,n=16*t,s=new Array(n),f=0;f<n;++f){var a=[0,0,0,0],o=f/i|0,c=(i-1-f%i)*e;a[o]=1<<e-1<<c,s[f]=this.generateSubHashTable(this.multiply(a,r),e)}return s};Ke.gcm.prototype.generateSubHashTable=function(r,e){var t=1<<e,i=t>>>1,n=new Array(t);n[i]=r.slice(0);for(var s=i>>>1;s>0;)this.pow(n[2*s],n[s]=[]),s>>=1;for(s=2;s<i;){for(var f=1;f<s;++f){var a=n[s],o=n[f];n[s+f]=[a[0]^o[0],a[1]^o[1],a[2]^o[2],a[3]^o[3]]}s*=2}for(n[0]=[0,0,0,0],s=i+1;s<t;++s){var c=n[s^i];n[s]=[r[0]^c[0],r[1]^c[1],r[2]^c[2],r[3]^c[3]]}return n};function ia(r,e){if(typeof r=="string"&&(r=jt.util.createBuffer(r)),jt.util.isArray(r)&&r.length>4){var t=r;r=jt.util.createBuffer();for(var i=0;i<t.length;++i)r.putByte(t[i])}if(r.length()<e)throw new Error("Invalid IV length; got "+r.length()+" bytes and expected "+e+" bytes.");if(!jt.util.isArray(r)){for(var n=[],s=e/4,i=0;i<s;++i)n.push(r.getInt32());r=n}return r}function na(r){r[r.length-1]=r[r.length-1]+1&4294967295}function wc(r){return[r/4294967296|0,r&4294967295]}});var fa=C((cB,f3)=>{var rt=He();gc();Sc();Kt();f3.exports=rt.aes=rt.aes||{};rt.aes.startEncrypting=function(r,e,t,i){var n=sa({key:r,output:t,decrypt:!1,mode:i});return n.start(e),n};rt.aes.createEncryptionCipher=function(r,e){return sa({key:r,output:null,decrypt:!1,mode:e})};rt.aes.startDecrypting=function(r,e,t,i){var n=sa({key:r,output:t,decrypt:!0,mode:i});return n.start(e),n};rt.aes.createDecryptionCipher=function(r,e){return sa({key:r,output:null,decrypt:!0,mode:e})};rt.aes.Algorithm=function(r,e){Ec||a3();var t=this;t.name=r,t.mode=new e({blockSize:16,cipher:{encrypt:function(i,n){return Mc(t._w,i,n,!1)},decrypt:function(i,n){return Mc(t._w,i,n,!0)}}}),t._init=!1};rt.aes.Algorithm.prototype.initialize=function(r){if(!this._init){var e=r.key,t;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=rt.util.createBuffer(e);else if(rt.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){t=e,e=rt.util.createBuffer();for(var i=0;i<t.length;++i)e.putByte(t[i])}if(!rt.util.isArray(e)){t=e,e=[];var n=t.length();if(n===16||n===24||n===32){n=n>>>2;for(var i=0;i<n;++i)e.push(t.getInt32())}}if(!rt.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,f=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=o3(e,r.decrypt&&!f),this._init=!0}};rt.aes._expandKey=function(r,e){return Ec||a3(),o3(r,e)};rt.aes._updateBlock=Mc;R0("AES-ECB",rt.cipher.modes.ecb);R0("AES-CBC",rt.cipher.modes.cbc);R0("AES-CFB",rt.cipher.modes.cfb);R0("AES-OFB",rt.cipher.modes.ofb);R0("AES-CTR",rt.cipher.modes.ctr);R0("AES-GCM",rt.cipher.modes.gcm);function R0(r,e){var t=function(){return new rt.aes.Algorithm(r,e)};rt.cipher.registerAlgorithm(r,t)}var Ec=!1,K0=4,xr,_c,c3,Dn,Zr;function a3(){Ec=!0,c3=[0,1,2,4,8,16,32,64,128,27,54];for(var r=new Array(256),e=0;e<128;++e)r[e]=e<<1,r[e+128]=e+128<<1^283;xr=new Array(256),_c=new Array(256),Dn=new Array(4),Zr=new Array(4);for(var e=0;e<4;++e)Dn[e]=new Array(256),Zr[e]=new Array(256);for(var t=0,i=0,n,s,f,a,o,c,d,e=0;e<256;++e){a=i^i<<1^i<<2^i<<3^i<<4,a=a>>8^a&255^99,xr[t]=a,_c[a]=t,o=r[a],n=r[t],s=r[n],f=r[s],c=o<<24^a<<16^a<<8^(a^o),d=(n^s^f)<<24^(t^f)<<16^(t^s^f)<<8^(t^n^f);for(var u=0;u<4;++u)Dn[u][t]=c,Zr[u][a]=d,c=c<<24|c>>>8,d=d<<24|d>>>8;t===0?t=i=1:(t=n^r[r[r[n^f]]],i^=r[r[i]])}}function o3(r,e){for(var t=r.slice(0),i,n=1,s=t.length,f=s+6+1,a=K0*f,o=s;o<a;++o)i=t[o-1],o%s==0?(i=xr[i>>>16&255]<<24^xr[i>>>8&255]<<16^xr[i&255]<<8^xr[i>>>24]^c3[n]<<24,n++):s>6&&o%s==4&&(i=xr[i>>>24]<<24^xr[i>>>16&255]<<16^xr[i>>>8&255]<<8^xr[i&255]),t[o]=t[o-s]^i;if(e){var c,d=Zr[0],u=Zr[1],p=Zr[2],x=Zr[3],y=t.slice(0);a=t.length;for(var o=0,g=a-K0;o<a;o+=K0,g-=K0)if(o===0||o===a-K0)y[o]=t[g],y[o+1]=t[g+3],y[o+2]=t[g+2],y[o+3]=t[g+1];else for(var M=0;M<K0;++M)c=t[g+M],y[o+(3&-M)]=d[xr[c>>>24]]^u[xr[c>>>16&255]]^p[xr[c>>>8&255]]^x[xr[c&255]];t=y}return t}function Mc(r,e,t,i){var n=r.length/4-1,s,f,a,o,c;i?(s=Zr[0],f=Zr[1],a=Zr[2],o=Zr[3],c=_c):(s=Dn[0],f=Dn[1],a=Dn[2],o=Dn[3],c=xr);var d,u,p,x,y,g,M;d=e[0]^r[0],u=e[i?3:1]^r[1],p=e[2]^r[2],x=e[i?1:3]^r[3];for(var k=3,R=1;R<n;++R)y=s[d>>>24]^f[u>>>16&255]^a[p>>>8&255]^o[x&255]^r[++k],g=s[u>>>24]^f[p>>>16&255]^a[x>>>8&255]^o[d&255]^r[++k],M=s[p>>>24]^f[x>>>16&255]^a[d>>>8&255]^o[u&255]^r[++k],x=s[x>>>24]^f[d>>>16&255]^a[u>>>8&255]^o[p&255]^r[++k],d=y,u=g,p=M;t[0]=c[d>>>24]<<24^c[u>>>16&255]<<16^c[p>>>8&255]<<8^c[x&255]^r[++k],t[i?3:1]=c[u>>>24]<<24^c[p>>>16&255]<<16^c[x>>>8&255]<<8^c[d&255]^r[++k],t[2]=c[p>>>24]<<24^c[x>>>16&255]<<16^c[d>>>8&255]<<8^c[u&255]^r[++k],t[i?1:3]=c[x>>>24]<<24^c[d>>>16&255]<<16^c[u>>>8&255]<<8^c[p&255]^r[++k]}function sa(r){r=r||{};var e=(r.mode||"CBC").toUpperCase(),t="AES-"+e,i;r.decrypt?i=rt.cipher.createDecipher(t,r.key):i=rt.cipher.createCipher(t,r.key);var n=i.start;return i.start=function(s,f){var a=null;f instanceof rt.util.ByteBuffer&&(a=f,f={}),f=f||{},f.output=a,f.iv=s,n.call(i,f)},i}});var u3=C((dB,d3)=>{var Mt=He();gc();Sc();Kt();d3.exports=Mt.des=Mt.des||{};Mt.des.startEncrypting=function(r,e,t,i){var n=aa({key:r,output:t,decrypt:!1,mode:i||(e===null?"ECB":"CBC")});return n.start(e),n};Mt.des.createEncryptionCipher=function(r,e){return aa({key:r,output:null,decrypt:!1,mode:e})};Mt.des.startDecrypting=function(r,e,t,i){var n=aa({key:r,output:t,decrypt:!0,mode:i||(e===null?"ECB":"CBC")});return n.start(e),n};Mt.des.createDecryptionCipher=function(r,e){return aa({key:r,output:null,decrypt:!0,mode:e})};Mt.des.Algorithm=function(r,e){var t=this;t.name=r,t.mode=new e({blockSize:8,cipher:{encrypt:function(i,n){return h3(t._keys,i,n,!1)},decrypt:function(i,n){return h3(t._keys,i,n,!0)}}}),t._init=!1};Mt.des.Algorithm.prototype.initialize=function(r){if(!this._init){var e=Mt.util.createBuffer(r.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=E9(e),this._init=!0}};ui("DES-ECB",Mt.cipher.modes.ecb);ui("DES-CBC",Mt.cipher.modes.cbc);ui("DES-CFB",Mt.cipher.modes.cfb);ui("DES-OFB",Mt.cipher.modes.ofb);ui("DES-CTR",Mt.cipher.modes.ctr);ui("3DES-ECB",Mt.cipher.modes.ecb);ui("3DES-CBC",Mt.cipher.modes.cbc);ui("3DES-CFB",Mt.cipher.modes.cfb);ui("3DES-OFB",Mt.cipher.modes.ofb);ui("3DES-CTR",Mt.cipher.modes.ctr);function ui(r,e){var t=function(){return new Mt.des.Algorithm(r,e)};Mt.cipher.registerAlgorithm(r,t)}var M9=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],_9=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],I9=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],A9=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],B9=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],k9=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],q9=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],C9=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function E9(r){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],t=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],i=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],n=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],f=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],o=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],d=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],u=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],p=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],x=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],y=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=r.length()>8?3:1,M=[],k=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],R=0,K,L=0;L<g;L++){var O=r.getInt32(),F=r.getInt32();K=(O>>>4^F)&252645135,F^=K,O^=K<<4,K=(F>>>-16^O)&65535,O^=K,F^=K<<-16,K=(O>>>2^F)&858993459,F^=K,O^=K<<2,K=(F>>>-16^O)&65535,O^=K,F^=K<<-16,K=(O>>>1^F)&1431655765,F^=K,O^=K<<1,K=(F>>>8^O)&16711935,O^=K,F^=K<<8,K=(O>>>1^F)&1431655765,F^=K,O^=K<<1,K=O<<8|F>>>20&240,O=F<<24|F<<8&16711680|F>>>8&65280|F>>>24&240,F=K;for(var G=0;G<k.length;++G){k[G]?(O=O<<2|O>>>26,F=F<<2|F>>>26):(O=O<<1|O>>>27,F=F<<1|F>>>27),O&=-15,F&=-15;var B=e[O>>>28]|t[O>>>24&15]|i[O>>>20&15]|n[O>>>16&15]|s[O>>>12&15]|f[O>>>8&15]|a[O>>>4&15],b=o[F>>>28]|c[F>>>24&15]|d[F>>>20&15]|u[F>>>16&15]|p[F>>>12&15]|x[F>>>8&15]|y[F>>>4&15];K=(b>>>16^B)&65535,M[R++]=B^K,M[R++]=b^K<<16}}return M}function h3(r,e,t,i){var n=r.length===32?3:9,s;n===3?s=i?[30,-2,-2]:[0,32,2]:s=i?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var f,a=e[0],o=e[1];f=(a>>>4^o)&252645135,o^=f,a^=f<<4,f=(a>>>16^o)&65535,o^=f,a^=f<<16,f=(o>>>2^a)&858993459,a^=f,o^=f<<2,f=(o>>>8^a)&16711935,a^=f,o^=f<<8,f=(a>>>1^o)&1431655765,o^=f,a^=f<<1,a=a<<1|a>>>31,o=o<<1|o>>>31;for(var c=0;c<n;c+=3){for(var d=s[c+1],u=s[c+2],p=s[c];p!=d;p+=u){var x=o^r[p],y=(o>>>4|o<<28)^r[p+1];f=a,a=o,o=f^(_9[x>>>24&63]|A9[x>>>16&63]|k9[x>>>8&63]|C9[x&63]|M9[y>>>24&63]|I9[y>>>16&63]|B9[y>>>8&63]|q9[y&63])}f=a,a=o,o=f}a=a>>>1|a<<31,o=o>>>1|o<<31,f=(a>>>1^o)&1431655765,o^=f,a^=f<<1,f=(o>>>8^a)&16711935,a^=f,o^=f<<8,f=(o>>>2^a)&858993459,a^=f,o^=f<<2,f=(a>>>16^o)&65535,o^=f,a^=f<<16,f=(a>>>4^o)&252645135,o^=f,a^=f<<4,t[0]=a,t[1]=o}function aa(r){r=r||{};var e=(r.mode||"CBC").toUpperCase(),t="DES-"+e,i;r.decrypt?i=Mt.cipher.createDecipher(t,r.key):i=Mt.cipher.createCipher(t,r.key);var n=i.start;return i.start=function(s,f){var a=null;f instanceof Mt.util.ByteBuffer&&(a=f,f={}),f=f||{},f.output=a,f.iv=s,n.call(i,f)},i}});var zn=C((hB,l3)=>{var oa=He();l3.exports=oa.md=oa.md||{};oa.md.algorithms=oa.md.algorithms||{}});var p3=C((uB,b3)=>{var Di=He();zn();Kt();var T9=b3.exports=Di.hmac=Di.hmac||{};T9.create=function(){var r=null,e=null,t=null,i=null,n={};return n.start=function(s,f){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in Di.md.algorithms)e=Di.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(f===null)f=r;else{if(typeof f=="string")f=Di.util.createBuffer(f);else if(Di.util.isArray(f)){var a=f;f=Di.util.createBuffer();for(var o=0;o<a.length;++o)f.putByte(a[o])}var c=f.length();c>e.blockLength&&(e.start(),e.update(f.bytes()),f=e.digest()),t=Di.util.createBuffer(),i=Di.util.createBuffer(),c=f.length();for(var o=0;o<c;++o){var a=f.at(o);t.putByte(54^a),i.putByte(92^a)}if(c<e.blockLength)for(var a=e.blockLength-c,o=0;o<a;++o)t.putByte(54),i.putByte(92);r=f,t=t.bytes(),i=i.bytes()}e.start(),e.update(t)},n.update=function(s){e.update(s)},n.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(i),e.update(s),e.digest()},n.digest=n.getMac,n}});var Os=C(()=>{});var Ic=C((pB,y3)=>{var vr=He();p3();zn();Kt();var N9=vr.pkcs5=vr.pkcs5||{},zi;vr.util.isNodejs&&!vr.options.usePureJavaScript&&(zi=Os());y3.exports=vr.pbkdf2=N9.pbkdf2=function(r,e,t,i,n,s){if(typeof n=="function"&&(s=n,n=null),vr.util.isNodejs&&!vr.options.usePureJavaScript&&zi.pbkdf2&&(n===null||typeof n!="object")&&(zi.pbkdf2Sync.length>4||!n||n==="sha1"))return typeof n!="string"&&(n="sha1"),r=Buffer.from(r,"binary"),e=Buffer.from(e,"binary"),s?zi.pbkdf2Sync.length===4?zi.pbkdf2(r,e,t,i,function(K,L){if(K)return s(K);s(null,L.toString("binary"))}):zi.pbkdf2(r,e,t,i,n,function(K,L){if(K)return s(K);s(null,L.toString("binary"))}):zi.pbkdf2Sync.length===4?zi.pbkdf2Sync(r,e,t,i).toString("binary"):zi.pbkdf2Sync(r,e,t,i,n).toString("binary");if((typeof n=="undefined"||n===null)&&(n="sha1"),typeof n=="string"){if(!(n in vr.md.algorithms))throw new Error("Unknown hash algorithm: "+n);n=vr.md[n].create()}var f=n.digestLength;if(i>4294967295*f){var a=new Error("Derived key is too long.");if(s)return s(a);throw a}var o=Math.ceil(i/f),c=i-(o-1)*f,d=vr.hmac.create();d.start(n,r);var u="",p,x,y;if(!s){for(var g=1;g<=o;++g){d.start(null,null),d.update(e),d.update(vr.util.int32ToBytes(g)),p=y=d.digest().getBytes();for(var M=2;M<=t;++M)d.start(null,null),d.update(y),x=d.digest().getBytes(),p=vr.util.xorBytes(p,x,f),y=x;u+=g<o?p:p.substr(0,c)}return u}var g=1,M;function k(){if(g>o)return s(null,u);d.start(null,null),d.update(e),d.update(vr.util.int32ToBytes(g)),p=y=d.digest().getBytes(),M=2,R()}function R(){if(M<=t)return d.start(null,null),d.update(y),x=d.digest().getBytes(),p=vr.util.xorBytes(p,x,f),y=x,++M,vr.util.setImmediate(R);u+=g<o?p:p.substr(0,c),++g,k()}k()}});var v3=C((yB,m3)=>{var ca=He();Kt();var x3=m3.exports=ca.pem=ca.pem||{};x3.encode=function(r,e){e=e||{};var t="-----BEGIN "+r.type+`-----\r
`,i;if(r.procType&&(i={name:"Proc-Type",values:[String(r.procType.version),r.procType.type]},t+=da(i)),r.contentDomain&&(i={name:"Content-Domain",values:[r.contentDomain]},t+=da(i)),r.dekInfo&&(i={name:"DEK-Info",values:[r.dekInfo.algorithm]},r.dekInfo.parameters&&i.values.push(r.dekInfo.parameters),t+=da(i)),r.headers)for(var n=0;n<r.headers.length;++n)t+=da(r.headers[n]);return r.procType&&(t+=`\r
`),t+=ca.util.encode64(r.body,e.maxline||64)+`\r
`,t+="-----END "+r.type+`-----\r
`,t};x3.decode=function(r){for(var e=[],t=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,i=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,n=/\r?\n/,s;s=t.exec(r),!!s;){var f={type:s[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:ca.util.decode64(s[3])};if(e.push(f),!!s[2]){for(var a=s[2].split(n),o=0;s&&o<a.length;){for(var c=a[o].replace(/\s+$/,""),d=o+1;d<a.length;++d){var u=a[d];if(!/\s/.test(u[0]))break;c+=u,o=d}if(s=c.match(i),s){for(var p={name:s[1],values:[]},x=s[2].split(","),y=0;y<x.length;++y)p.values.push(P9(x[y]));if(f.procType)if(!f.contentDomain&&p.name==="Content-Domain")f.contentDomain=x[0]||"";else if(!f.dekInfo&&p.name==="DEK-Info"){if(p.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');f.dekInfo={algorithm:x[0],parameters:x[1]||null}}else f.headers.push(p);else{if(p.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(p.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');f.procType={version:x[0],type:x[1]}}}++o}if(f.procType==="ENCRYPTED"&&!f.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function da(r){for(var e=r.name+": ",t=[],i=function(o,c){return" "+c},n=0;n<r.values.length;++n)t.push(r.values[n].replace(/^(\S+\r\n)/,i));e+=t.join(",")+`\r
`;for(var s=0,f=-1,n=0;n<e.length;++n,++s)if(s>65&&f!==-1){var a=e[f];a===","?(++f,e=e.substr(0,f)+`\r
 `+e.substr(f)):e=e.substr(0,f)+`\r
`+a+e.substr(f+1),s=n-f-1,f=-1,++n}else(e[n]===" "||e[n]==="	"||e[n]===",")&&(f=n);return e}function P9(r){return r.replace(/^\s+/,"")}});var _3=C((mB,g3)=>{var li=He();zn();Kt();var w3=g3.exports=li.sha256=li.sha256||{};li.md.sha256=li.md.algorithms.sha256=w3;w3.create=function(){S3||R9();var r=null,e=li.util.createBuffer(),t=new Array(64),i={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return i.start=function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var n=i.messageLengthSize/4,s=0;s<n;++s)i.fullMessageLength.push(0);return e=li.util.createBuffer(),r={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},i},i.start(),i.update=function(n,s){s==="utf8"&&(n=li.util.encodeUtf8(n));var f=n.length;i.messageLength+=f,f=[f/4294967296>>>0,f>>>0];for(var a=i.fullMessageLength.length-1;a>=0;--a)i.fullMessageLength[a]+=f[1],f[1]=f[0]+(i.fullMessageLength[a]/4294967296>>>0),i.fullMessageLength[a]=i.fullMessageLength[a]>>>0,f[0]=f[1]/4294967296>>>0;return e.putBytes(n),E3(r,t,e),(e.read>2048||e.length()===0)&&e.compact(),i},i.digest=function(){var n=li.util.createBuffer();n.putBytes(e.bytes());var s=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize,f=s&i.blockLength-1;n.putBytes(Ac.substr(0,i.blockLength-f));for(var a,o,c=i.fullMessageLength[0]*8,d=0;d<i.fullMessageLength.length-1;++d)a=i.fullMessageLength[d+1]*8,o=a/4294967296>>>0,c+=o,n.putInt32(c>>>0),c=a>>>0;n.putInt32(c);var u={h0:r.h0,h1:r.h1,h2:r.h2,h3:r.h3,h4:r.h4,h5:r.h5,h6:r.h6,h7:r.h7};E3(u,t,n);var p=li.util.createBuffer();return p.putInt32(u.h0),p.putInt32(u.h1),p.putInt32(u.h2),p.putInt32(u.h3),p.putInt32(u.h4),p.putInt32(u.h5),p.putInt32(u.h6),p.putInt32(u.h7),p},i};var Ac=null,S3=!1,M3=null;function R9(){Ac=String.fromCharCode(128),Ac+=li.util.fillString(String.fromCharCode(0),64),M3=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],S3=!0}function E3(r,e,t){for(var i,n,s,f,a,o,c,d,u,p,x,y,g,M,k,R=t.length();R>=64;){for(c=0;c<16;++c)e[c]=t.getInt32();for(;c<64;++c)i=e[c-2],i=(i>>>17|i<<15)^(i>>>19|i<<13)^i>>>10,n=e[c-15],n=(n>>>7|n<<25)^(n>>>18|n<<14)^n>>>3,e[c]=i+e[c-7]+n+e[c-16]|0;for(d=r.h0,u=r.h1,p=r.h2,x=r.h3,y=r.h4,g=r.h5,M=r.h6,k=r.h7,c=0;c<64;++c)f=(y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7),a=M^y&(g^M),s=(d>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10),o=d&u|p&(d^u),i=k+f+a+M3[c]+e[c],n=s+o,k=M,M=g,g=y,y=x+i>>>0,x=p,p=u,u=d,d=i+n>>>0;r.h0=r.h0+d|0,r.h1=r.h1+u|0,r.h2=r.h2+p|0,r.h3=r.h3+x|0,r.h4=r.h4+y|0,r.h5=r.h5+g|0,r.h6=r.h6+M|0,r.h7=r.h7+k|0,R-=64}}});var A3=C((xB,I3)=>{var bi=He();Kt();var ha=null;bi.util.isNodejs&&!bi.options.usePureJavaScript&&!process.versions["node-webkit"]&&(ha=Os());var K9=I3.exports=bi.prng=bi.prng||{};K9.create=function(r){for(var e={plugin:r,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},t=r.md,i=new Array(32),n=0;n<32;++n)i[n]=t.create();e.pools=i,e.pool=0,e.generate=function(c,d){if(!d)return e.generateSync(c);var u=e.plugin.cipher,p=e.plugin.increment,x=e.plugin.formatKey,y=e.plugin.formatSeed,g=bi.util.createBuffer();e.key=null,M();function M(k){if(k)return d(k);if(g.length()>=c)return d(null,g.getBytes(c));if(e.generated>1048575&&(e.key=null),e.key===null)return bi.util.nextTick(function(){s(M)});var R=u(e.key,e.seed);e.generated+=R.length,g.putBytes(R),e.key=x(u(e.key,p(e.seed))),e.seed=y(u(e.key,e.seed)),bi.util.setImmediate(M)}},e.generateSync=function(c){var d=e.plugin.cipher,u=e.plugin.increment,p=e.plugin.formatKey,x=e.plugin.formatSeed;e.key=null;for(var y=bi.util.createBuffer();y.length()<c;){e.generated>1048575&&(e.key=null),e.key===null&&f();var g=d(e.key,e.seed);e.generated+=g.length,y.putBytes(g),e.key=p(d(e.key,u(e.seed))),e.seed=x(d(e.key,e.seed))}return y.getBytes(c)};function s(c){if(e.pools[0].messageLength>=32)return a(),c();var d=32-e.pools[0].messageLength<<5;e.seedFile(d,function(u,p){if(u)return c(u);e.collect(p),a(),c()})}function f(){if(e.pools[0].messageLength>=32)return a();var c=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(c)),a()}function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var c=e.plugin.md.create();c.update(e.keyBytes);for(var d=1,u=0;u<32;++u)e.reseeds%d==0&&(c.update(e.pools[u].digest().getBytes()),e.pools[u].start()),d=d<<1;e.keyBytes=c.digest().getBytes(),c.start(),c.update(e.keyBytes);var p=c.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(p),e.generated=0}function o(c){var d=null,u=bi.util.globalScope,p=u.crypto||u.msCrypto;p&&p.getRandomValues&&(d=function(O){return p.getRandomValues(O)});var x=bi.util.createBuffer();if(d)for(;x.length()<c;){var y=Math.max(1,Math.min(c-x.length(),65536)/4),g=new Uint32Array(Math.floor(y));try{d(g);for(var M=0;M<g.length;++M)x.putInt32(g[M])}catch(O){if(!(typeof QuotaExceededError!="undefined"&&O instanceof QuotaExceededError))throw O}}if(x.length()<c)for(var k,R,K,L=Math.floor(Math.random()*65536);x.length()<c;){R=16807*(L&65535),k=16807*(L>>16),R+=(k&32767)<<16,R+=k>>15,R=(R&2147483647)+(R>>31),L=R&4294967295;for(var M=0;M<3;++M)K=L>>>(M<<3),K^=Math.floor(Math.random()*256),x.putByte(String.fromCharCode(K&255))}return x.getBytes(c)}return ha?(e.seedFile=function(c,d){ha.randomBytes(c,function(u,p){if(u)return d(u);d(null,p.toString())})},e.seedFileSync=function(c){return ha.randomBytes(c).toString()}):(e.seedFile=function(c,d){try{d(null,o(c))}catch(u){d(u)}},e.seedFileSync=o),e.collect=function(c){for(var d=c.length,u=0;u<d;++u)e.pools[e.pool].update(c.substr(u,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(c,d){for(var u="",p=0;p<d;p+=8)u+=String.fromCharCode(c>>p&255);e.collect(u)},e.registerWorker=function(c){if(c===self)e.seedFile=function(u,p){function x(y){var g=y.data;g.forge&&g.forge.prng&&(self.removeEventListener("message",x),p(g.forge.prng.err,g.forge.prng.bytes))}self.addEventListener("message",x),self.postMessage({forge:{prng:{needed:u}}})};else{var d=function(u){var p=u.data;p.forge&&p.forge.prng&&e.seedFile(p.forge.prng.needed,function(x,y){c.postMessage({forge:{prng:{err:x,bytes:y}}})})};c.addEventListener("message",d)}},e}});var L0=C((vB,Bc)=>{var $t=He();fa();_3();A3();Kt();(function(){if($t.random&&$t.random.getBytes){Bc.exports=$t.random;return}(function(r){var e={},t=new Array(4),i=$t.util.createBuffer();e.formatKey=function(u){var p=$t.util.createBuffer(u);return u=new Array(4),u[0]=p.getInt32(),u[1]=p.getInt32(),u[2]=p.getInt32(),u[3]=p.getInt32(),$t.aes._expandKey(u,!1)},e.formatSeed=function(u){var p=$t.util.createBuffer(u);return u=new Array(4),u[0]=p.getInt32(),u[1]=p.getInt32(),u[2]=p.getInt32(),u[3]=p.getInt32(),u},e.cipher=function(u,p){return $t.aes._updateBlock(u,p,t,!1),i.putInt32(t[0]),i.putInt32(t[1]),i.putInt32(t[2]),i.putInt32(t[3]),i.getBytes()},e.increment=function(u){return++u[3],u},e.md=$t.md.sha256;function n(){var u=$t.prng.create(e);return u.getBytes=function(p,x){return u.generate(p,x)},u.getBytesSync=function(p){return u.generate(p)},u}var s=n(),f=null,a=$t.util.globalScope,o=a.crypto||a.msCrypto;if(o&&o.getRandomValues&&(f=function(u){return o.getRandomValues(u)}),$t.options.usePureJavaScript||!$t.util.isNodejs&&!f){if(typeof window=="undefined"||window.document===void 0,s.collectInt(+new Date,32),typeof navigator!="undefined"){var c="";for(var d in navigator)try{typeof navigator[d]=="string"&&(c+=navigator[d])}catch(u){}s.collect(c),c=null}r&&(r().mousemove(function(u){s.collectInt(u.clientX,16),s.collectInt(u.clientY,16)}),r().keypress(function(u){s.collectInt(u.charCode,8)}))}if(!$t.random)$t.random=s;else for(var d in s)$t.random[d]=s[d];$t.random.createInstance=n,Bc.exports=$t.random})(typeof jQuery!="undefined"?jQuery:null)})()});var C3=C((gB,B3)=>{var Er=He();Kt();var kc=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],k3=[1,2,3,5],L9=function(r,e){return r<<e&65535|(r&65535)>>16-e},F9=function(r,e){return(r&65535)>>e|r<<16-e&65535};B3.exports=Er.rc2=Er.rc2||{};Er.rc2.expandKey=function(r,e){typeof r=="string"&&(r=Er.util.createBuffer(r)),e=e||128;var t=r,i=r.length(),n=e,s=Math.ceil(n/8),f=255>>(n&7),a;for(a=i;a<128;a++)t.putByte(kc[t.at(a-1)+t.at(a-i)&255]);for(t.setAt(128-s,kc[t.at(128-s)&f]),a=127-s;a>=0;a--)t.setAt(a,kc[t.at(a+1)^t.at(a+s)]);return t};var q3=function(r,e,t){var i=!1,n=null,s=null,f=null,a,o,c,d,u=[];for(r=Er.rc2.expandKey(r,e),c=0;c<64;c++)u.push(r.getInt16Le());t?(a=function(y){for(c=0;c<4;c++)y[c]+=u[d]+(y[(c+3)%4]&y[(c+2)%4])+(~y[(c+3)%4]&y[(c+1)%4]),y[c]=L9(y[c],k3[c]),d++},o=function(y){for(c=0;c<4;c++)y[c]+=u[y[(c+3)%4]&63]}):(a=function(y){for(c=3;c>=0;c--)y[c]=F9(y[c],k3[c]),y[c]-=u[d]+(y[(c+3)%4]&y[(c+2)%4])+(~y[(c+3)%4]&y[(c+1)%4]),d--},o=function(y){for(c=3;c>=0;c--)y[c]-=u[y[(c+3)%4]&63]});var p=function(y){var g=[];for(c=0;c<4;c++){var M=n.getInt16Le();f!==null&&(t?M^=f.getInt16Le():f.putInt16Le(M)),g.push(M&65535)}d=t?0:63;for(var k=0;k<y.length;k++)for(var R=0;R<y[k][0];R++)y[k][1](g);for(c=0;c<4;c++)f!==null&&(t?f.putInt16Le(g[c]):g[c]^=f.getInt16Le()),s.putInt16Le(g[c])},x=null;return x={start:function(y,g){y&&typeof y=="string"&&(y=Er.util.createBuffer(y)),i=!1,n=Er.util.createBuffer(),s=g||new Er.util.createBuffer,f=y,x.output=s},update:function(y){for(i||n.putBuffer(y);n.length()>=8;)p([[5,a],[1,o],[6,a],[1,o],[5,a]])},finish:function(y){var g=!0;if(t)if(y)g=y(8,n,!t);else{var M=n.length()===8?8:8-n.length();n.fillWithByte(M,M)}if(g&&(i=!0,x.update()),!t&&(g=n.length()===0,g))if(y)g=y(8,s,!t);else{var k=s.length(),R=s.at(k-1);R>k?g=!1:s.truncate(R)}return g}},x};Er.rc2.startEncrypting=function(r,e,t){var i=Er.rc2.createEncryptionCipher(r,128);return i.start(e,t),i};Er.rc2.createEncryptionCipher=function(r,e){return q3(r,e,!0)};Er.rc2.startDecrypting=function(r,e,t){var i=Er.rc2.createDecryptionCipher(r,128);return i.start(e,t),i};Er.rc2.createDecryptionCipher=function(r,e){return q3(r,e,!1)}});var Hs=C((wB,T3)=>{var qc=He();T3.exports=qc.jsbn=qc.jsbn||{};var Oi,D9=244837814094590,N3=(D9&16777215)==15715070;function X(r,e,t){this.data=[],r!=null&&(typeof r=="number"?this.fromNumber(r,e,t):e==null&&typeof r!="string"?this.fromString(r,256):this.fromString(r,e))}qc.jsbn.BigInteger=X;function Oe(){return new X(null)}function z9(r,e,t,i,n,s){for(;--s>=0;){var f=e*this.data[r++]+t.data[i]+n;n=Math.floor(f/67108864),t.data[i++]=f&67108863}return n}function O9(r,e,t,i,n,s){for(var f=e&32767,a=e>>15;--s>=0;){var o=this.data[r]&32767,c=this.data[r++]>>15,d=a*o+c*f;o=f*o+((d&32767)<<15)+t.data[i]+(n&1073741823),n=(o>>>30)+(d>>>15)+a*c+(n>>>30),t.data[i++]=o&1073741823}return n}function P3(r,e,t,i,n,s){for(var f=e&16383,a=e>>14;--s>=0;){var o=this.data[r]&16383,c=this.data[r++]>>14,d=a*o+c*f;o=f*o+((d&16383)<<14)+t.data[i]+n,n=(o>>28)+(d>>14)+a*c,t.data[i++]=o&268435455}return n}typeof navigator=="undefined"?(X.prototype.am=P3,Oi=28):N3&&navigator.appName=="Microsoft Internet Explorer"?(X.prototype.am=O9,Oi=30):N3&&navigator.appName!="Netscape"?(X.prototype.am=z9,Oi=26):(X.prototype.am=P3,Oi=28);X.prototype.DB=Oi;X.prototype.DM=(1<<Oi)-1;X.prototype.DV=1<<Oi;var Cc=52;X.prototype.FV=Math.pow(2,Cc);X.prototype.F1=Cc-Oi;X.prototype.F2=2*Oi-Cc;var U9="0123456789abcdefghijklmnopqrstuvwxyz",ua=new Array,F0,Kr;F0="0".charCodeAt(0);for(Kr=0;Kr<=9;++Kr)ua[F0++]=Kr;F0="a".charCodeAt(0);for(Kr=10;Kr<36;++Kr)ua[F0++]=Kr;F0="A".charCodeAt(0);for(Kr=10;Kr<36;++Kr)ua[F0++]=Kr;function R3(r){return U9.charAt(r)}function K3(r,e){var t=ua[r.charCodeAt(e)];return t??-1}function H9(r){for(var e=this.t-1;e>=0;--e)r.data[e]=this.data[e];r.t=this.t,r.s=this.s}function V9(r){this.t=1,this.s=r<0?-1:0,r>0?this.data[0]=r:r<-1?this.data[0]=r+this.DV:this.t=0}function sn(r){var e=Oe();return e.fromInt(r),e}function J9(r,e){var t;if(e==16)t=4;else if(e==8)t=3;else if(e==256)t=8;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else{this.fromRadix(r,e);return}this.t=0,this.s=0;for(var i=r.length,n=!1,s=0;--i>=0;){var f=t==8?r[i]&255:K3(r,i);if(f<0){r.charAt(i)=="-"&&(n=!0);continue}n=!1,s==0?this.data[this.t++]=f:s+t>this.DB?(this.data[this.t-1]|=(f&(1<<this.DB-s)-1)<<s,this.data[this.t++]=f>>this.DB-s):this.data[this.t-1]|=f<<s,s+=t,s>=this.DB&&(s-=this.DB)}t==8&&(r[0]&128)!=0&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),n&&X.ZERO.subTo(this,this)}function G9(){for(var r=this.s&this.DM;this.t>0&&this.data[this.t-1]==r;)--this.t}function X9(r){if(this.s<0)return"-"+this.negate().toString(r);var e;if(r==16)e=4;else if(r==8)e=3;else if(r==2)e=1;else if(r==32)e=5;else if(r==4)e=2;else return this.toRadix(r);var t=(1<<e)-1,i,n=!1,s="",f=this.t,a=this.DB-f*this.DB%e;if(f-- >0)for(a<this.DB&&(i=this.data[f]>>a)>0&&(n=!0,s=R3(i));f>=0;)a<e?(i=(this.data[f]&(1<<a)-1)<<e-a,i|=this.data[--f]>>(a+=this.DB-e)):(i=this.data[f]>>(a-=e)&t,a<=0&&(a+=this.DB,--f)),i>0&&(n=!0),n&&(s+=R3(i));return n?s:"0"}function Y9(){var r=Oe();return X.ZERO.subTo(this,r),r}function Z9(){return this.s<0?this.negate():this}function W9(r){var e=this.s-r.s;if(e!=0)return e;var t=this.t;if(e=t-r.t,e!=0)return this.s<0?-e:e;for(;--t>=0;)if((e=this.data[t]-r.data[t])!=0)return e;return 0}function la(r){var e=1,t;return(t=r>>>16)!=0&&(r=t,e+=16),(t=r>>8)!=0&&(r=t,e+=8),(t=r>>4)!=0&&(r=t,e+=4),(t=r>>2)!=0&&(r=t,e+=2),(t=r>>1)!=0&&(r=t,e+=1),e}function j9(){return this.t<=0?0:this.DB*(this.t-1)+la(this.data[this.t-1]^this.s&this.DM)}function $9(r,e){var t;for(t=this.t-1;t>=0;--t)e.data[t+r]=this.data[t];for(t=r-1;t>=0;--t)e.data[t]=0;e.t=this.t+r,e.s=this.s}function Q9(r,e){for(var t=r;t<this.t;++t)e.data[t-r]=this.data[t];e.t=Math.max(this.t-r,0),e.s=this.s}function e7(r,e){var t=r%this.DB,i=this.DB-t,n=(1<<i)-1,s=Math.floor(r/this.DB),f=this.s<<t&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+s+1]=this.data[a]>>i|f,f=(this.data[a]&n)<<t;for(a=s-1;a>=0;--a)e.data[a]=0;e.data[s]=f,e.t=this.t+s+1,e.s=this.s,e.clamp()}function t7(r,e){e.s=this.s;var t=Math.floor(r/this.DB);if(t>=this.t){e.t=0;return}var i=r%this.DB,n=this.DB-i,s=(1<<i)-1;e.data[0]=this.data[t]>>i;for(var f=t+1;f<this.t;++f)e.data[f-t-1]|=(this.data[f]&s)<<n,e.data[f-t]=this.data[f]>>i;i>0&&(e.data[this.t-t-1]|=(this.s&s)<<n),e.t=this.t-t,e.clamp()}function r7(r,e){for(var t=0,i=0,n=Math.min(r.t,this.t);t<n;)i+=this.data[t]-r.data[t],e.data[t++]=i&this.DM,i>>=this.DB;if(r.t<this.t){for(i-=r.s;t<this.t;)i+=this.data[t],e.data[t++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;t<r.t;)i-=r.data[t],e.data[t++]=i&this.DM,i>>=this.DB;i-=r.s}e.s=i<0?-1:0,i<-1?e.data[t++]=this.DV+i:i>0&&(e.data[t++]=i),e.t=t,e.clamp()}function i7(r,e){var t=this.abs(),i=r.abs(),n=t.t;for(e.t=n+i.t;--n>=0;)e.data[n]=0;for(n=0;n<i.t;++n)e.data[n+t.t]=t.am(0,i.data[n],e,n,0,t.t);e.s=0,e.clamp(),this.s!=r.s&&X.ZERO.subTo(e,e)}function n7(r){for(var e=this.abs(),t=r.t=2*e.t;--t>=0;)r.data[t]=0;for(t=0;t<e.t-1;++t){var i=e.am(t,e.data[t],r,2*t,0,1);(r.data[t+e.t]+=e.am(t+1,2*e.data[t],r,2*t+1,i,e.t-t-1))>=e.DV&&(r.data[t+e.t]-=e.DV,r.data[t+e.t+1]=1)}r.t>0&&(r.data[r.t-1]+=e.am(t,e.data[t],r,2*t,0,1)),r.s=0,r.clamp()}function s7(r,e,t){var i=r.abs();if(!(i.t<=0)){var n=this.abs();if(n.t<i.t){e!=null&&e.fromInt(0),t!=null&&this.copyTo(t);return}t==null&&(t=Oe());var s=Oe(),f=this.s,a=r.s,o=this.DB-la(i.data[i.t-1]);o>0?(i.lShiftTo(o,s),n.lShiftTo(o,t)):(i.copyTo(s),n.copyTo(t));var c=s.t,d=s.data[c-1];if(d!=0){var u=d*(1<<this.F1)+(c>1?s.data[c-2]>>this.F2:0),p=this.FV/u,x=(1<<this.F1)/u,y=1<<this.F2,g=t.t,M=g-c,k=e??Oe();for(s.dlShiftTo(M,k),t.compareTo(k)>=0&&(t.data[t.t++]=1,t.subTo(k,t)),X.ONE.dlShiftTo(c,k),k.subTo(s,s);s.t<c;)s.data[s.t++]=0;for(;--M>=0;){var R=t.data[--g]==d?this.DM:Math.floor(t.data[g]*p+(t.data[g-1]+y)*x);if((t.data[g]+=s.am(0,R,t,M,0,c))<R)for(s.dlShiftTo(M,k),t.subTo(k,t);t.data[g]<--R;)t.subTo(k,t)}e!=null&&(t.drShiftTo(c,e),f!=a&&X.ZERO.subTo(e,e)),t.t=c,t.clamp(),o>0&&t.rShiftTo(o,t),f<0&&X.ZERO.subTo(t,t)}}}function f7(r){var e=Oe();return this.abs().divRemTo(r,null,e),this.s<0&&e.compareTo(X.ZERO)>0&&r.subTo(e,e),e}function On(r){this.m=r}function a7(r){return r.s<0||r.compareTo(this.m)>=0?r.mod(this.m):r}function o7(r){return r}function c7(r){r.divRemTo(this.m,null,r)}function d7(r,e,t){r.multiplyTo(e,t),this.reduce(t)}function h7(r,e){r.squareTo(e),this.reduce(e)}On.prototype.convert=a7;On.prototype.revert=o7;On.prototype.reduce=c7;On.prototype.mulTo=d7;On.prototype.sqrTo=h7;function u7(){if(this.t<1)return 0;var r=this.data[0];if((r&1)==0)return 0;var e=r&3;return e=e*(2-(r&15)*e)&15,e=e*(2-(r&255)*e)&255,e=e*(2-((r&65535)*e&65535))&65535,e=e*(2-r*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Un(r){this.m=r,this.mp=r.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<r.DB-15)-1,this.mt2=2*r.t}function l7(r){var e=Oe();return r.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),r.s<0&&e.compareTo(X.ZERO)>0&&this.m.subTo(e,e),e}function b7(r){var e=Oe();return r.copyTo(e),this.reduce(e),e}function p7(r){for(;r.t<=this.mt2;)r.data[r.t++]=0;for(var e=0;e<this.m.t;++e){var t=r.data[e]&32767,i=t*this.mpl+((t*this.mph+(r.data[e]>>15)*this.mpl&this.um)<<15)&r.DM;for(t=e+this.m.t,r.data[t]+=this.m.am(0,i,r,e,0,this.m.t);r.data[t]>=r.DV;)r.data[t]-=r.DV,r.data[++t]++}r.clamp(),r.drShiftTo(this.m.t,r),r.compareTo(this.m)>=0&&r.subTo(this.m,r)}function y7(r,e){r.squareTo(e),this.reduce(e)}function m7(r,e,t){r.multiplyTo(e,t),this.reduce(t)}Un.prototype.convert=l7;Un.prototype.revert=b7;Un.prototype.reduce=p7;Un.prototype.mulTo=m7;Un.prototype.sqrTo=y7;function x7(){return(this.t>0?this.data[0]&1:this.s)==0}function v7(r,e){if(r>4294967295||r<1)return X.ONE;var t=Oe(),i=Oe(),n=e.convert(this),s=la(r)-1;for(n.copyTo(t);--s>=0;)if(e.sqrTo(t,i),(r&1<<s)>0)e.mulTo(i,n,t);else{var f=t;t=i,i=f}return e.revert(t)}function g7(r,e){var t;return r<256||e.isEven()?t=new On(e):t=new Un(e),this.exp(r,t)}X.prototype.copyTo=H9;X.prototype.fromInt=V9;X.prototype.fromString=J9;X.prototype.clamp=G9;X.prototype.dlShiftTo=$9;X.prototype.drShiftTo=Q9;X.prototype.lShiftTo=e7;X.prototype.rShiftTo=t7;X.prototype.subTo=r7;X.prototype.multiplyTo=i7;X.prototype.squareTo=n7;X.prototype.divRemTo=s7;X.prototype.invDigit=u7;X.prototype.isEven=x7;X.prototype.exp=v7;X.prototype.toString=X9;X.prototype.negate=Y9;X.prototype.abs=Z9;X.prototype.compareTo=W9;X.prototype.bitLength=j9;X.prototype.mod=f7;X.prototype.modPowInt=g7;X.ZERO=sn(0);X.ONE=sn(1);function w7(){var r=Oe();return this.copyTo(r),r}function S7(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function E7(){return this.t==0?this.s:this.data[0]<<24>>24}function M7(){return this.t==0?this.s:this.data[0]<<16>>16}function _7(r){return Math.floor(Math.LN2*this.DB/Math.log(r))}function I7(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function A7(r){if(r==null&&(r=10),this.signum()==0||r<2||r>36)return"0";var e=this.chunkSize(r),t=Math.pow(r,e),i=sn(t),n=Oe(),s=Oe(),f="";for(this.divRemTo(i,n,s);n.signum()>0;)f=(t+s.intValue()).toString(r).substr(1)+f,n.divRemTo(i,n,s);return s.intValue().toString(r)+f}function B7(r,e){this.fromInt(0),e==null&&(e=10);for(var t=this.chunkSize(e),i=Math.pow(e,t),n=!1,s=0,f=0,a=0;a<r.length;++a){var o=K3(r,a);if(o<0){r.charAt(a)=="-"&&this.signum()==0&&(n=!0);continue}f=e*f+o,++s>=t&&(this.dMultiply(i),this.dAddOffset(f,0),s=0,f=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(f,0)),n&&X.ZERO.subTo(this,this)}function k7(r,e,t){if(typeof e=="number")if(r<2)this.fromInt(1);else for(this.fromNumber(r,t),this.testBit(r-1)||this.bitwiseTo(X.ONE.shiftLeft(r-1),Tc,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>r&&this.subTo(X.ONE.shiftLeft(r-1),this);else{var i=new Array,n=r&7;i.length=(r>>3)+1,e.nextBytes(i),n>0?i[0]&=(1<<n)-1:i[0]=0,this.fromString(i,256)}}function q7(){var r=this.t,e=new Array;e[0]=this.s;var t=this.DB-r*this.DB%8,i,n=0;if(r-- >0)for(t<this.DB&&(i=this.data[r]>>t)!=(this.s&this.DM)>>t&&(e[n++]=i|this.s<<this.DB-t);r>=0;)t<8?(i=(this.data[r]&(1<<t)-1)<<8-t,i|=this.data[--r]>>(t+=this.DB-8)):(i=this.data[r]>>(t-=8)&255,t<=0&&(t+=this.DB,--r)),(i&128)!=0&&(i|=-256),n==0&&(this.s&128)!=(i&128)&&++n,(n>0||i!=this.s)&&(e[n++]=i);return e}function C7(r){return this.compareTo(r)==0}function T7(r){return this.compareTo(r)<0?this:r}function N7(r){return this.compareTo(r)>0?this:r}function P7(r,e,t){var i,n,s=Math.min(r.t,this.t);for(i=0;i<s;++i)t.data[i]=e(this.data[i],r.data[i]);if(r.t<this.t){for(n=r.s&this.DM,i=s;i<this.t;++i)t.data[i]=e(this.data[i],n);t.t=this.t}else{for(n=this.s&this.DM,i=s;i<r.t;++i)t.data[i]=e(n,r.data[i]);t.t=r.t}t.s=e(this.s,r.s),t.clamp()}function R7(r,e){return r&e}function K7(r){var e=Oe();return this.bitwiseTo(r,R7,e),e}function Tc(r,e){return r|e}function L7(r){var e=Oe();return this.bitwiseTo(r,Tc,e),e}function L3(r,e){return r^e}function F7(r){var e=Oe();return this.bitwiseTo(r,L3,e),e}function F3(r,e){return r&~e}function D7(r){var e=Oe();return this.bitwiseTo(r,F3,e),e}function z7(){for(var r=Oe(),e=0;e<this.t;++e)r.data[e]=this.DM&~this.data[e];return r.t=this.t,r.s=~this.s,r}function O7(r){var e=Oe();return r<0?this.rShiftTo(-r,e):this.lShiftTo(r,e),e}function U7(r){var e=Oe();return r<0?this.lShiftTo(-r,e):this.rShiftTo(r,e),e}function H7(r){if(r==0)return-1;var e=0;return(r&65535)==0&&(r>>=16,e+=16),(r&255)==0&&(r>>=8,e+=8),(r&15)==0&&(r>>=4,e+=4),(r&3)==0&&(r>>=2,e+=2),(r&1)==0&&++e,e}function V7(){for(var r=0;r<this.t;++r)if(this.data[r]!=0)return r*this.DB+H7(this.data[r]);return this.s<0?this.t*this.DB:-1}function J7(r){for(var e=0;r!=0;)r&=r-1,++e;return e}function G7(){for(var r=0,e=this.s&this.DM,t=0;t<this.t;++t)r+=J7(this.data[t]^e);return r}function X7(r){var e=Math.floor(r/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<r%this.DB)!=0}function Y7(r,e){var t=X.ONE.shiftLeft(r);return this.bitwiseTo(t,e,t),t}function Z7(r){return this.changeBit(r,Tc)}function W7(r){return this.changeBit(r,F3)}function j7(r){return this.changeBit(r,L3)}function $7(r,e){for(var t=0,i=0,n=Math.min(r.t,this.t);t<n;)i+=this.data[t]+r.data[t],e.data[t++]=i&this.DM,i>>=this.DB;if(r.t<this.t){for(i+=r.s;t<this.t;)i+=this.data[t],e.data[t++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;t<r.t;)i+=r.data[t],e.data[t++]=i&this.DM,i>>=this.DB;i+=r.s}e.s=i<0?-1:0,i>0?e.data[t++]=i:i<-1&&(e.data[t++]=this.DV+i),e.t=t,e.clamp()}function Q7(r){var e=Oe();return this.addTo(r,e),e}function ew(r){var e=Oe();return this.subTo(r,e),e}function tw(r){var e=Oe();return this.multiplyTo(r,e),e}function rw(r){var e=Oe();return this.divRemTo(r,e,null),e}function iw(r){var e=Oe();return this.divRemTo(r,null,e),e}function nw(r){var e=Oe(),t=Oe();return this.divRemTo(r,e,t),new Array(e,t)}function sw(r){this.data[this.t]=this.am(0,r-1,this,0,0,this.t),++this.t,this.clamp()}function fw(r,e){if(r!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=r;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function Us(){}function D3(r){return r}function aw(r,e,t){r.multiplyTo(e,t)}function ow(r,e){r.squareTo(e)}Us.prototype.convert=D3;Us.prototype.revert=D3;Us.prototype.mulTo=aw;Us.prototype.sqrTo=ow;function cw(r){return this.exp(r,new Us)}function dw(r,e,t){var i=Math.min(this.t+r.t,e);for(t.s=0,t.t=i;i>0;)t.data[--i]=0;var n;for(n=t.t-this.t;i<n;++i)t.data[i+this.t]=this.am(0,r.data[i],t,i,0,this.t);for(n=Math.min(r.t,e);i<n;++i)this.am(0,r.data[i],t,i,0,e-i);t.clamp()}function hw(r,e,t){--e;var i=t.t=this.t+r.t-e;for(t.s=0;--i>=0;)t.data[i]=0;for(i=Math.max(e-this.t,0);i<r.t;++i)t.data[this.t+i-e]=this.am(e-i,r.data[i],t,0,0,this.t+i-e);t.clamp(),t.drShiftTo(1,t)}function D0(r){this.r2=Oe(),this.q3=Oe(),X.ONE.dlShiftTo(2*r.t,this.r2),this.mu=this.r2.divide(r),this.m=r}function uw(r){if(r.s<0||r.t>2*this.m.t)return r.mod(this.m);if(r.compareTo(this.m)<0)return r;var e=Oe();return r.copyTo(e),this.reduce(e),e}function lw(r){return r}function bw(r){for(r.drShiftTo(this.m.t-1,this.r2),r.t>this.m.t+1&&(r.t=this.m.t+1,r.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);r.compareTo(this.r2)<0;)r.dAddOffset(1,this.m.t+1);for(r.subTo(this.r2,r);r.compareTo(this.m)>=0;)r.subTo(this.m,r)}function pw(r,e){r.squareTo(e),this.reduce(e)}function yw(r,e,t){r.multiplyTo(e,t),this.reduce(t)}D0.prototype.convert=uw;D0.prototype.revert=lw;D0.prototype.reduce=bw;D0.prototype.mulTo=yw;D0.prototype.sqrTo=pw;function mw(r,e){var t=r.bitLength(),i,n=sn(1),s;if(t<=0)return n;t<18?i=1:t<48?i=3:t<144?i=4:t<768?i=5:i=6,t<8?s=new On(e):e.isEven()?s=new D0(e):s=new Un(e);var f=new Array,a=3,o=i-1,c=(1<<i)-1;if(f[1]=s.convert(this),i>1){var d=Oe();for(s.sqrTo(f[1],d);a<=c;)f[a]=Oe(),s.mulTo(d,f[a-2],f[a]),a+=2}var u=r.t-1,p,x=!0,y=Oe(),g;for(t=la(r.data[u])-1;u>=0;){for(t>=o?p=r.data[u]>>t-o&c:(p=(r.data[u]&(1<<t+1)-1)<<o-t,u>0&&(p|=r.data[u-1]>>this.DB+t-o)),a=i;(p&1)==0;)p>>=1,--a;if((t-=a)<0&&(t+=this.DB,--u),x)f[p].copyTo(n),x=!1;else{for(;a>1;)s.sqrTo(n,y),s.sqrTo(y,n),a-=2;a>0?s.sqrTo(n,y):(g=n,n=y,y=g),s.mulTo(y,f[p],n)}for(;u>=0&&(r.data[u]&1<<t)==0;)s.sqrTo(n,y),g=n,n=y,y=g,--t<0&&(t=this.DB-1,--u)}return s.revert(n)}function xw(r){var e=this.s<0?this.negate():this.clone(),t=r.s<0?r.negate():r.clone();if(e.compareTo(t)<0){var i=e;e=t,t=i}var n=e.getLowestSetBit(),s=t.getLowestSetBit();if(s<0)return e;for(n<s&&(s=n),s>0&&(e.rShiftTo(s,e),t.rShiftTo(s,t));e.signum()>0;)(n=e.getLowestSetBit())>0&&e.rShiftTo(n,e),(n=t.getLowestSetBit())>0&&t.rShiftTo(n,t),e.compareTo(t)>=0?(e.subTo(t,e),e.rShiftTo(1,e)):(t.subTo(e,t),t.rShiftTo(1,t));return s>0&&t.lShiftTo(s,t),t}function vw(r){if(r<=0)return 0;var e=this.DV%r,t=this.s<0?r-1:0;if(this.t>0)if(e==0)t=this.data[0]%r;else for(var i=this.t-1;i>=0;--i)t=(e*t+this.data[i])%r;return t}function gw(r){var e=r.isEven();if(this.isEven()&&e||r.signum()==0)return X.ZERO;for(var t=r.clone(),i=this.clone(),n=sn(1),s=sn(0),f=sn(0),a=sn(1);t.signum()!=0;){for(;t.isEven();)t.rShiftTo(1,t),e?((!n.isEven()||!s.isEven())&&(n.addTo(this,n),s.subTo(r,s)),n.rShiftTo(1,n)):s.isEven()||s.subTo(r,s),s.rShiftTo(1,s);for(;i.isEven();)i.rShiftTo(1,i),e?((!f.isEven()||!a.isEven())&&(f.addTo(this,f),a.subTo(r,a)),f.rShiftTo(1,f)):a.isEven()||a.subTo(r,a),a.rShiftTo(1,a);t.compareTo(i)>=0?(t.subTo(i,t),e&&n.subTo(f,n),s.subTo(a,s)):(i.subTo(t,i),e&&f.subTo(n,f),a.subTo(s,a))}if(i.compareTo(X.ONE)!=0)return X.ZERO;if(a.compareTo(r)>=0)return a.subtract(r);if(a.signum()<0)a.addTo(r,a);else return a;return a.signum()<0?a.add(r):a}var Wr=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],ww=(1<<26)/Wr[Wr.length-1];function Sw(r){var e,t=this.abs();if(t.t==1&&t.data[0]<=Wr[Wr.length-1]){for(e=0;e<Wr.length;++e)if(t.data[0]==Wr[e])return!0;return!1}if(t.isEven())return!1;for(e=1;e<Wr.length;){for(var i=Wr[e],n=e+1;n<Wr.length&&i<ww;)i*=Wr[n++];for(i=t.modInt(i);e<n;)if(i%Wr[e++]==0)return!1}return t.millerRabin(r)}function Mw(r){var e=this.subtract(X.ONE),t=e.getLowestSetBit();if(t<=0)return!1;for(var i=e.shiftRight(t),n=Ew(),s,f=0;f<r;++f){do s=new X(this.bitLength(),n);while(s.compareTo(X.ONE)<=0||s.compareTo(e)>=0);var a=s.modPow(i,this);if(a.compareTo(X.ONE)!=0&&a.compareTo(e)!=0){for(var o=1;o++<t&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(X.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}function Ew(){return{nextBytes:function(r){for(var e=0;e<r.length;++e)r[e]=Math.floor(Math.random()*256)}}}X.prototype.chunkSize=_7;X.prototype.toRadix=A7;X.prototype.fromRadix=B7;X.prototype.fromNumber=k7;X.prototype.bitwiseTo=P7;X.prototype.changeBit=Y7;X.prototype.addTo=$7;X.prototype.dMultiply=sw;X.prototype.dAddOffset=fw;X.prototype.multiplyLowerTo=dw;X.prototype.multiplyUpperTo=hw;X.prototype.modInt=vw;X.prototype.millerRabin=Mw;X.prototype.clone=w7;X.prototype.intValue=S7;X.prototype.byteValue=E7;X.prototype.shortValue=M7;X.prototype.signum=I7;X.prototype.toByteArray=q7;X.prototype.equals=C7;X.prototype.min=T7;X.prototype.max=N7;X.prototype.and=K7;X.prototype.or=L7;X.prototype.xor=F7;X.prototype.andNot=D7;X.prototype.not=z7;X.prototype.shiftLeft=O7;X.prototype.shiftRight=U7;X.prototype.getLowestSetBit=V7;X.prototype.bitCount=G7;X.prototype.testBit=X7;X.prototype.setBit=Z7;X.prototype.clearBit=W7;X.prototype.flipBit=j7;X.prototype.add=Q7;X.prototype.subtract=ew;X.prototype.multiply=tw;X.prototype.divide=rw;X.prototype.remainder=iw;X.prototype.divideAndRemainder=nw;X.prototype.modPow=mw;X.prototype.modInverse=gw;X.prototype.pow=cw;X.prototype.gcd=xw;X.prototype.isProbablePrime=Sw});var V3=C((SB,z3)=>{var pi=He();zn();Kt();var O3=z3.exports=pi.sha1=pi.sha1||{};pi.md.sha1=pi.md.algorithms.sha1=O3;O3.create=function(){U3||_w();var r=null,e=pi.util.createBuffer(),t=new Array(80),i={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return i.start=function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var n=i.messageLengthSize/4,s=0;s<n;++s)i.fullMessageLength.push(0);return e=pi.util.createBuffer(),r={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},i},i.start(),i.update=function(n,s){s==="utf8"&&(n=pi.util.encodeUtf8(n));var f=n.length;i.messageLength+=f,f=[f/4294967296>>>0,f>>>0];for(var a=i.fullMessageLength.length-1;a>=0;--a)i.fullMessageLength[a]+=f[1],f[1]=f[0]+(i.fullMessageLength[a]/4294967296>>>0),i.fullMessageLength[a]=i.fullMessageLength[a]>>>0,f[0]=f[1]/4294967296>>>0;return e.putBytes(n),H3(r,t,e),(e.read>2048||e.length()===0)&&e.compact(),i},i.digest=function(){var n=pi.util.createBuffer();n.putBytes(e.bytes());var s=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize,f=s&i.blockLength-1;n.putBytes(Nc.substr(0,i.blockLength-f));for(var a,o,c=i.fullMessageLength[0]*8,d=0;d<i.fullMessageLength.length-1;++d)a=i.fullMessageLength[d+1]*8,o=a/4294967296>>>0,c+=o,n.putInt32(c>>>0),c=a>>>0;n.putInt32(c);var u={h0:r.h0,h1:r.h1,h2:r.h2,h3:r.h3,h4:r.h4};H3(u,t,n);var p=pi.util.createBuffer();return p.putInt32(u.h0),p.putInt32(u.h1),p.putInt32(u.h2),p.putInt32(u.h3),p.putInt32(u.h4),p},i};var Nc=null,U3=!1;function _w(){Nc=String.fromCharCode(128),Nc+=pi.util.fillString(String.fromCharCode(0),64),U3=!0}function H3(r,e,t){for(var i,n,s,f,a,o,c,d,u=t.length();u>=64;){for(n=r.h0,s=r.h1,f=r.h2,a=r.h3,o=r.h4,d=0;d<16;++d)i=t.getInt32(),e[d]=i,c=a^s&(f^a),i=(n<<5|n>>>27)+c+o+1518500249+i,o=a,a=f,f=(s<<30|s>>>2)>>>0,s=n,n=i;for(;d<20;++d)i=e[d-3]^e[d-8]^e[d-14]^e[d-16],i=i<<1|i>>>31,e[d]=i,c=a^s&(f^a),i=(n<<5|n>>>27)+c+o+1518500249+i,o=a,a=f,f=(s<<30|s>>>2)>>>0,s=n,n=i;for(;d<32;++d)i=e[d-3]^e[d-8]^e[d-14]^e[d-16],i=i<<1|i>>>31,e[d]=i,c=s^f^a,i=(n<<5|n>>>27)+c+o+1859775393+i,o=a,a=f,f=(s<<30|s>>>2)>>>0,s=n,n=i;for(;d<40;++d)i=e[d-6]^e[d-16]^e[d-28]^e[d-32],i=i<<2|i>>>30,e[d]=i,c=s^f^a,i=(n<<5|n>>>27)+c+o+1859775393+i,o=a,a=f,f=(s<<30|s>>>2)>>>0,s=n,n=i;for(;d<60;++d)i=e[d-6]^e[d-16]^e[d-28]^e[d-32],i=i<<2|i>>>30,e[d]=i,c=s&f|a&(s^f),i=(n<<5|n>>>27)+c+o+2400959708+i,o=a,a=f,f=(s<<30|s>>>2)>>>0,s=n,n=i;for(;d<80;++d)i=e[d-6]^e[d-16]^e[d-28]^e[d-32],i=i<<2|i>>>30,e[d]=i,c=s^f^a,i=(n<<5|n>>>27)+c+o+3395469782+i,o=a,a=f,f=(s<<30|s>>>2)>>>0,s=n,n=i;r.h0=r.h0+n|0,r.h1=r.h1+s|0,r.h2=r.h2+f|0,r.h3=r.h3+a|0,r.h4=r.h4+o|0,u-=64}}});var X3=C((EB,J3)=>{var yi=He();Kt();L0();V3();var G3=J3.exports=yi.pkcs1=yi.pkcs1||{};G3.encode_rsa_oaep=function(r,e,t){var i,n,s,f;typeof t=="string"?(i=t,n=arguments[3]||void 0,s=arguments[4]||void 0):t&&(i=t.label||void 0,n=t.seed||void 0,s=t.md||void 0,t.mgf1&&t.mgf1.md&&(f=t.mgf1.md)),s?s.start():s=yi.md.sha1.create(),f||(f=s);var a=Math.ceil(r.n.bitLength()/8),o=a-2*s.digestLength-2;if(e.length>o){var c=new Error("RSAES-OAEP input message length is too long.");throw c.length=e.length,c.maxLength=o,c}i||(i=""),s.update(i,"raw");for(var d=s.digest(),u="",p=o-e.length,x=0;x<p;x++)u+="\0";var y=d.getBytes()+u+""+e;if(!n)n=yi.random.getBytes(s.digestLength);else if(n.length!==s.digestLength){var c=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw c.seedLength=n.length,c.digestLength=s.digestLength,c}var g=ba(n,a-s.digestLength-1,f),M=yi.util.xorBytes(y,g,y.length),k=ba(M,s.digestLength,f),R=yi.util.xorBytes(n,k,n.length);return"\0"+R+M};G3.decode_rsa_oaep=function(r,e,t){var i,n,s;typeof t=="string"?(i=t,n=arguments[3]||void 0):t&&(i=t.label||void 0,n=t.md||void 0,t.mgf1&&t.mgf1.md&&(s=t.mgf1.md));var f=Math.ceil(r.n.bitLength()/8);if(e.length!==f){var M=new Error("RSAES-OAEP encoded message length is invalid.");throw M.length=e.length,M.expectedLength=f,M}if(n===void 0?n=yi.md.sha1.create():n.start(),s||(s=n),f<2*n.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");i||(i=""),n.update(i,"raw");for(var a=n.digest().getBytes(),o=e.charAt(0),c=e.substring(1,n.digestLength+1),d=e.substring(1+n.digestLength),u=ba(d,n.digestLength,s),p=yi.util.xorBytes(c,u,c.length),x=ba(p,f-n.digestLength-1,s),y=yi.util.xorBytes(d,x,d.length),g=y.substring(0,n.digestLength),M=o!=="\0",k=0;k<n.digestLength;++k)M|=a.charAt(k)!==g.charAt(k);for(var R=1,K=n.digestLength,L=n.digestLength;L<y.length;L++){var O=y.charCodeAt(L),F=O&1^1,G=R?65534:0;M|=O&G,R=R&F,K+=R}if(M||y.charCodeAt(K)!==1)throw new Error("Invalid RSAES-OAEP padding.");return y.substring(K+1)};function ba(r,e,t){t||(t=yi.md.sha1.create());for(var i="",n=Math.ceil(e/t.digestLength),s=0;s<n;++s){var f=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);t.start(),t.update(r+f),i+=t.digest().getBytes()}return i.substring(0,e)}});var Y3=C((MB,Pc)=>{var fn=He();Kt();Hs();L0();(function(){if(fn.prime){Pc.exports=fn.prime;return}var r=Pc.exports=fn.prime=fn.prime||{},e=fn.jsbn.BigInteger,t=[6,4,2,4,2,4,6,2],i=new e(null);i.fromInt(30);var n=function(u,p){return u|p};r.generateProbablePrime=function(u,p,x){typeof p=="function"&&(x=p,p={}),p=p||{};var y=p.algorithm||"PRIMEINC";typeof y=="string"&&(y={name:y}),y.options=y.options||{};var g=p.prng||fn.random,M={nextBytes:function(k){for(var R=g.getBytesSync(k.length),K=0;K<k.length;++K)k[K]=R.charCodeAt(K)}};if(y.name==="PRIMEINC")return s(u,M,y.options,x);throw new Error("Invalid prime generation algorithm: "+y.name)};function s(u,p,x,y){return"workers"in x?o(u,p,x,y):f(u,p,x,y)}function f(u,p,x,y){var g=c(u,p),M=0,k=d(g.bitLength());"millerRabinTests"in x&&(k=x.millerRabinTests);var R=10;"maxBlockTime"in x&&(R=x.maxBlockTime),a(g,u,p,M,k,R,y)}function a(u,p,x,y,g,M,k){var R=+new Date;do{if(u.bitLength()>p&&(u=c(p,x)),u.isProbablePrime(g))return k(null,u);u.dAddOffset(t[y++%8],0)}while(M<0||+new Date-R<M);fn.util.setImmediate(function(){a(u,p,x,y,g,M,k)})}function o(u,p,x,y){if(typeof Worker=="undefined")return f(u,p,x,y);var g=c(u,p),M=x.workers,k=x.workLoad||100,R=k*30/8,K=x.workerScript||"forge/prime.worker.js";if(M===-1)return fn.util.estimateCores(function(O,F){O&&(F=2),M=F-1,L()});L();function L(){M=Math.max(1,M);for(var O=[],F=0;F<M;++F)O[F]=new Worker(K);for(var G=M,F=0;F<M;++F)O[F].addEventListener("message",b);var B=!1;function b(m){if(!B){--G;var w=m.data;if(w.found){for(var S=0;S<O.length;++S)O[S].terminate();return B=!0,y(null,new e(w.prime,16))}g.bitLength()>u&&(g=c(u,p));var I=g.toString(16);m.target.postMessage({hex:I,workLoad:k}),g.dAddOffset(R,0)}}}}function c(u,p){var x=new e(u,p),y=u-1;return x.testBit(y)||x.bitwiseTo(e.ONE.shiftLeft(y),n,x),x.dAddOffset(31-x.mod(i).byteValue(),0),x}function d(u){return u<=100?27:u<=150?18:u<=200?15:u<=250?12:u<=300?9:u<=350?8:u<=400?7:u<=500?6:u<=600?5:u<=800?4:u<=1250?3:2}})()});var ya=C((_B,Z3)=>{var ve=He();P0();Hs();ta();X3();Y3();L0();Kt();typeof De=="undefined"&&(De=ve.jsbn.BigInteger);var De,Rc=ve.util.isNodejs?Os():null,z=ve.asn1,Lr=ve.util;ve.pki=ve.pki||{};Z3.exports=ve.pki.rsa=ve.rsa=ve.rsa||{};var ge=ve.pki,Iw=[6,4,2,4,2,4,6,2],Aw={name:"PrivateKeyInfo",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:z.Class.UNIVERSAL,type:z.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:z.Class.UNIVERSAL,type:z.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Bw={name:"RSAPrivateKey",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},kw={name:"RSAPublicKey",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},qw=ve.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:z.Class.UNIVERSAL,type:z.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:z.Class.UNIVERSAL,type:z.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Cw=function(r){var e;if(r.algorithm in ge.oids)e=ge.oids[r.algorithm];else{var t=new Error("Unknown message digest algorithm.");throw t.algorithm=r.algorithm,t}var i=z.oidToDer(e).getBytes(),n=z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[]),s=z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[]);s.value.push(z.create(z.Class.UNIVERSAL,z.Type.OID,!1,i)),s.value.push(z.create(z.Class.UNIVERSAL,z.Type.NULL,!1,""));var f=z.create(z.Class.UNIVERSAL,z.Type.OCTETSTRING,!1,r.digest().getBytes());return n.value.push(s),n.value.push(f),z.toDer(n).getBytes()},W3=function(r,e,t){if(t)return r.modPow(e.e,e.n);if(!e.p||!e.q)return r.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(De.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(De.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var i;do i=new De(ve.util.bytesToHex(ve.random.getBytes(e.n.bitLength()/8)),16);while(i.compareTo(e.n)>=0||!i.gcd(e.n).equals(De.ONE));r=r.multiply(i.modPow(e.e,e.n)).mod(e.n);for(var n=r.mod(e.p).modPow(e.dP,e.p),s=r.mod(e.q).modPow(e.dQ,e.q);n.compareTo(s)<0;)n=n.add(e.p);var f=n.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return f=f.multiply(i.modInverse(e.n)).mod(e.n),f};ge.rsa.encrypt=function(r,e,t){var i=t,n,s=Math.ceil(e.n.bitLength()/8);t!==!1&&t!==!0?(i=t===2,n=j3(r,e,t)):(n=ve.util.createBuffer(),n.putBytes(r));for(var f=new De(n.toHex(),16),a=W3(f,e,i),o=a.toString(16),c=ve.util.createBuffer(),d=s-Math.ceil(o.length/2);d>0;)c.putByte(0),--d;return c.putBytes(ve.util.hexToBytes(o)),c.getBytes()};ge.rsa.decrypt=function(r,e,t,i){var n=Math.ceil(e.n.bitLength()/8);if(r.length!==n){var s=new Error("Encrypted message length is invalid.");throw s.length=r.length,s.expected=n,s}var f=new De(ve.util.createBuffer(r).toHex(),16);if(f.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=W3(f,e,t),o=a.toString(16),c=ve.util.createBuffer(),d=n-Math.ceil(o.length/2);d>0;)c.putByte(0),--d;return c.putBytes(ve.util.hexToBytes(o)),i!==!1?pa(c.getBytes(),e,t):c.getBytes()};ge.rsa.createKeyPairGenerationState=function(r,e,t){typeof r=="string"&&(r=parseInt(r,10)),r=r||2048,t=t||{};var i=t.prng||ve.random,n={nextBytes:function(a){for(var o=i.getBytesSync(a.length),c=0;c<a.length;++c)a[c]=o.charCodeAt(c)}},s=t.algorithm||"PRIMEINC",f;if(s==="PRIMEINC")f={algorithm:s,state:0,bits:r,rng:n,eInt:e||65537,e:new De(null),p:null,q:null,qBits:r>>1,pBits:r-(r>>1),pqState:0,num:null,keys:null},f.e.fromInt(f.eInt);else throw new Error("Invalid key generation algorithm: "+s);return f};ge.rsa.stepKeyPairGenerationState=function(r,e){"algorithm"in r||(r.algorithm="PRIMEINC");var t=new De(null);t.fromInt(30);for(var i=0,n=function(u,p){return u|p},s=+new Date,f,a=0;r.keys===null&&(e<=0||a<e);){if(r.state===0){var o=r.p===null?r.pBits:r.qBits,c=o-1;r.pqState===0?(r.num=new De(o,r.rng),r.num.testBit(c)||r.num.bitwiseTo(De.ONE.shiftLeft(c),n,r.num),r.num.dAddOffset(31-r.num.mod(t).byteValue(),0),i=0,++r.pqState):r.pqState===1?r.num.bitLength()>o?r.pqState=0:r.num.isProbablePrime(Tw(r.num.bitLength()))?++r.pqState:r.num.dAddOffset(Iw[i++%8],0):r.pqState===2?r.pqState=r.num.subtract(De.ONE).gcd(r.e).compareTo(De.ONE)===0?3:0:r.pqState===3&&(r.pqState=0,r.p===null?r.p=r.num:r.q=r.num,r.p!==null&&r.q!==null&&++r.state,r.num=null)}else if(r.state===1)r.p.compareTo(r.q)<0&&(r.num=r.p,r.p=r.q,r.q=r.num),++r.state;else if(r.state===2)r.p1=r.p.subtract(De.ONE),r.q1=r.q.subtract(De.ONE),r.phi=r.p1.multiply(r.q1),++r.state;else if(r.state===3)r.phi.gcd(r.e).compareTo(De.ONE)===0?++r.state:(r.p=null,r.q=null,r.state=0);else if(r.state===4)r.n=r.p.multiply(r.q),r.n.bitLength()===r.bits?++r.state:(r.q=null,r.state=0);else if(r.state===5){var d=r.e.modInverse(r.phi);r.keys={privateKey:ge.rsa.setPrivateKey(r.n,r.e,d,r.p,r.q,d.mod(r.p1),d.mod(r.q1),r.q.modInverse(r.p)),publicKey:ge.rsa.setPublicKey(r.n,r.e)}}f=+new Date,a+=f-s,s=f}return r.keys!==null};ge.rsa.generateKeyPair=function(r,e,t,i){if(arguments.length===1?typeof r=="object"?(t=r,r=void 0):typeof r=="function"&&(i=r,r=void 0):arguments.length===2?typeof r=="number"?typeof e=="function"?(i=e,e=void 0):typeof e!="number"&&(t=e,e=void 0):(t=r,i=e,r=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof t=="function"&&(i=t,t=void 0):(i=t,t=e,e=void 0)),t=t||{},r===void 0&&(r=t.bits||2048),e===void 0&&(e=t.e||65537),!ve.options.usePureJavaScript&&!t.prng&&r>=256&&r<=16384&&(e===65537||e===3)){if(i){if($3("generateKeyPair"))return Rc.generateKeyPair("rsa",{modulusLength:r,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,o,c){if(a)return i(a);i(null,{privateKey:ge.privateKeyFromPem(c),publicKey:ge.publicKeyFromPem(o)})});if(Q3("generateKey")&&Q3("exportKey"))return Lr.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:tp(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return Lr.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){i(a)}).then(function(a){if(a){var o=ge.privateKeyFromAsn1(z.fromDer(ve.util.createBuffer(a)));i(null,{privateKey:o,publicKey:ge.setRsaPublicKey(o.n,o.e)})}});if(ep("generateKey")&&ep("exportKey")){var n=Lr.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:tp(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);n.oncomplete=function(a){var o=a.target.result,c=Lr.globalScope.msCrypto.subtle.exportKey("pkcs8",o.privateKey);c.oncomplete=function(d){var u=d.target.result,p=ge.privateKeyFromAsn1(z.fromDer(ve.util.createBuffer(u)));i(null,{privateKey:p,publicKey:ge.setRsaPublicKey(p.n,p.e)})},c.onerror=function(d){i(d)}},n.onerror=function(a){i(a)};return}}else if($3("generateKeyPairSync")){var s=Rc.generateKeyPairSync("rsa",{modulusLength:r,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:ge.privateKeyFromPem(s.privateKey),publicKey:ge.publicKeyFromPem(s.publicKey)}}}var f=ge.rsa.createKeyPairGenerationState(r,e,t);if(!i)return ge.rsa.stepKeyPairGenerationState(f,0),f.keys;Nw(f,t,i)};ge.setRsaPublicKey=ge.rsa.setPublicKey=function(r,e){var t={n:r,e};return t.encrypt=function(i,n,s){if(typeof n=="string"?n=n.toUpperCase():n===void 0&&(n="RSAES-PKCS1-V1_5"),n==="RSAES-PKCS1-V1_5")n={encode:function(a,o,c){return j3(a,o,2).getBytes()}};else if(n==="RSA-OAEP"||n==="RSAES-OAEP")n={encode:function(a,o){return ve.pkcs1.encode_rsa_oaep(o,a,s)}};else if(["RAW","NONE","NULL",null].indexOf(n)!==-1)n={encode:function(a){return a}};else if(typeof n=="string")throw new Error('Unsupported encryption scheme: "'+n+'".');var f=n.encode(i,t,!0);return ge.rsa.encrypt(f,t,!0)},t.verify=function(i,n,s){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),s==="RSASSA-PKCS1-V1_5"?s={verify:function(a,o){o=pa(o,t,!0);var c=z.fromDer(o);return a===c.value[1].value}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(a,o){return o=pa(o,t,!0),a===o}});var f=ge.rsa.decrypt(n,t,!0,!1);return s.verify(i,f,t.n.bitLength())},t};ge.setRsaPrivateKey=ge.rsa.setPrivateKey=function(r,e,t,i,n,s,f,a){var o={n:r,e,d:t,p:i,q:n,dP:s,dQ:f,qInv:a};return o.decrypt=function(c,d,u){typeof d=="string"?d=d.toUpperCase():d===void 0&&(d="RSAES-PKCS1-V1_5");var p=ge.rsa.decrypt(c,o,!1,!1);if(d==="RSAES-PKCS1-V1_5")d={decode:pa};else if(d==="RSA-OAEP"||d==="RSAES-OAEP")d={decode:function(x,y){return ve.pkcs1.decode_rsa_oaep(y,x,u)}};else if(["RAW","NONE","NULL",null].indexOf(d)!==-1)d={decode:function(x){return x}};else throw new Error('Unsupported encryption scheme: "'+d+'".');return d.decode(p,o,!1)},o.sign=function(c,d){var u=!1;typeof d=="string"&&(d=d.toUpperCase()),d===void 0||d==="RSASSA-PKCS1-V1_5"?(d={encode:Cw},u=1):(d==="NONE"||d==="NULL"||d===null)&&(d={encode:function(){return c}},u=1);var p=d.encode(c,o.n.bitLength());return ge.rsa.encrypt(p,o,u)},o};ge.wrapRsaPrivateKey=function(r){return z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,z.integerToDer(0).getBytes()),z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(ge.oids.rsaEncryption).getBytes()),z.create(z.Class.UNIVERSAL,z.Type.NULL,!1,"")]),z.create(z.Class.UNIVERSAL,z.Type.OCTETSTRING,!1,z.toDer(r).getBytes())])};ge.privateKeyFromAsn1=function(r){var e={},t=[];if(z.validate(r,Aw,e,t)&&(r=z.fromDer(ve.util.createBuffer(e.privateKey))),e={},t=[],!z.validate(r,Bw,e,t)){var i=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw i.errors=t,i}var n,s,f,a,o,c,d,u;return n=ve.util.createBuffer(e.privateKeyModulus).toHex(),s=ve.util.createBuffer(e.privateKeyPublicExponent).toHex(),f=ve.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=ve.util.createBuffer(e.privateKeyPrime1).toHex(),o=ve.util.createBuffer(e.privateKeyPrime2).toHex(),c=ve.util.createBuffer(e.privateKeyExponent1).toHex(),d=ve.util.createBuffer(e.privateKeyExponent2).toHex(),u=ve.util.createBuffer(e.privateKeyCoefficient).toHex(),ge.setRsaPrivateKey(new De(n,16),new De(s,16),new De(f,16),new De(a,16),new De(o,16),new De(c,16),new De(d,16),new De(u,16))};ge.privateKeyToAsn1=ge.privateKeyToRSAPrivateKey=function(r){return z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,z.integerToDer(0).getBytes()),z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,mi(r.n)),z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,mi(r.e)),z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,mi(r.d)),z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,mi(r.p)),z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,mi(r.q)),z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,mi(r.dP)),z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,mi(r.dQ)),z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,mi(r.qInv))])};ge.publicKeyFromAsn1=function(r){var e={},t=[];if(z.validate(r,qw,e,t)){var i=z.derToOid(e.publicKeyOid);if(i!==ge.oids.rsaEncryption){var n=new Error("Cannot read public key. Unknown OID.");throw n.oid=i,n}r=e.rsaPublicKey}if(t=[],!z.validate(r,kw,e,t)){var n=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw n.errors=t,n}var s=ve.util.createBuffer(e.publicKeyModulus).toHex(),f=ve.util.createBuffer(e.publicKeyExponent).toHex();return ge.setRsaPublicKey(new De(s,16),new De(f,16))};ge.publicKeyToAsn1=ge.publicKeyToSubjectPublicKeyInfo=function(r){return z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(ge.oids.rsaEncryption).getBytes()),z.create(z.Class.UNIVERSAL,z.Type.NULL,!1,"")]),z.create(z.Class.UNIVERSAL,z.Type.BITSTRING,!1,[ge.publicKeyToRSAPublicKey(r)])])};ge.publicKeyToRSAPublicKey=function(r){return z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,mi(r.n)),z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,mi(r.e))])};function j3(r,e,t){var i=ve.util.createBuffer(),n=Math.ceil(e.n.bitLength()/8);if(r.length>n-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=r.length,s.max=n-11,s}i.putByte(0),i.putByte(t);var f=n-3-r.length,a;if(t===0||t===1){a=t===0?0:255;for(var o=0;o<f;++o)i.putByte(a)}else for(;f>0;){for(var c=0,d=ve.random.getBytes(f),o=0;o<f;++o)a=d.charCodeAt(o),a===0?++c:i.putByte(a);f=c}return i.putByte(0),i.putBytes(r),i}function pa(r,e,t,i){var n=Math.ceil(e.n.bitLength()/8),s=ve.util.createBuffer(r),f=s.getByte(),a=s.getByte();if(f!==0||t&&a!==0&&a!==1||!t&&a!=2||t&&a===0&&typeof i=="undefined")throw new Error("Encryption block is invalid.");var o=0;if(a===0){o=n-3-i;for(var c=0;c<o;++c)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(o=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++o}else if(a===2)for(o=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++o}var d=s.getByte();if(d!==0||o!==n-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function Nw(r,e,t){typeof e=="function"&&(t=e,e={}),e=e||{};var i={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(i.prng=e.prng),n();function n(){s(r.pBits,function(a,o){if(a)return t(a);if(r.p=o,r.q!==null)return f(a,r.q);s(r.qBits,f)})}function s(a,o){ve.prime.generateProbablePrime(a,i,o)}function f(a,o){if(a)return t(a);if(r.q=o,r.p.compareTo(r.q)<0){var c=r.p;r.p=r.q,r.q=c}if(r.p.subtract(De.ONE).gcd(r.e).compareTo(De.ONE)!==0){r.p=null,n();return}if(r.q.subtract(De.ONE).gcd(r.e).compareTo(De.ONE)!==0){r.q=null,s(r.qBits,f);return}if(r.p1=r.p.subtract(De.ONE),r.q1=r.q.subtract(De.ONE),r.phi=r.p1.multiply(r.q1),r.phi.gcd(r.e).compareTo(De.ONE)!==0){r.p=r.q=null,n();return}if(r.n=r.p.multiply(r.q),r.n.bitLength()!==r.bits){r.q=null,s(r.qBits,f);return}var d=r.e.modInverse(r.phi);r.keys={privateKey:ge.rsa.setPrivateKey(r.n,r.e,d,r.p,r.q,d.mod(r.p1),d.mod(r.q1),r.q.modInverse(r.p)),publicKey:ge.rsa.setPublicKey(r.n,r.e)},t(null,r.keys)}}function mi(r){var e=r.toString(16);e[0]>="8"&&(e="00"+e);var t=ve.util.hexToBytes(e);return t.length>1&&(t.charCodeAt(0)===0&&(t.charCodeAt(1)&128)==0||t.charCodeAt(0)===255&&(t.charCodeAt(1)&128)==128)?t.substr(1):t}function Tw(r){return r<=100?27:r<=150?18:r<=200?15:r<=250?12:r<=300?9:r<=350?8:r<=400?7:r<=500?6:r<=600?5:r<=800?4:r<=1250?3:2}function $3(r){return ve.util.isNodejs&&typeof Rc[r]=="function"}function Q3(r){return typeof Lr.globalScope!="undefined"&&typeof Lr.globalScope.crypto=="object"&&typeof Lr.globalScope.crypto.subtle=="object"&&typeof Lr.globalScope.crypto.subtle[r]=="function"}function ep(r){return typeof Lr.globalScope!="undefined"&&typeof Lr.globalScope.msCrypto=="object"&&typeof Lr.globalScope.msCrypto.subtle=="object"&&typeof Lr.globalScope.msCrypto.subtle[r]=="function"}function tp(r){for(var e=ve.util.hexToBytes(r.toString(16)),t=new Uint8Array(e.length),i=0;i<e.length;++i)t[i]=e.charCodeAt(i);return t}});var ap=C((IB,rp)=>{var ee=He();fa();P0();u3();zn();ta();Ic();v3();L0();C3();ya();Kt();typeof ip=="undefined"&&(ip=ee.jsbn.BigInteger);var ip,V=ee.asn1,Ae=ee.pki=ee.pki||{};rp.exports=Ae.pbe=ee.pbe=ee.pbe||{};var Hn=Ae.oids,Pw={name:"EncryptedPrivateKeyInfo",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:V.Class.UNIVERSAL,type:V.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:V.Class.UNIVERSAL,type:V.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Rw={name:"PBES2Algorithms",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:V.Class.UNIVERSAL,type:V.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:V.Class.UNIVERSAL,type:V.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:V.Class.UNIVERSAL,type:V.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:V.Class.UNIVERSAL,type:V.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:V.Class.UNIVERSAL,type:V.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:V.Class.UNIVERSAL,type:V.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:V.Class.UNIVERSAL,type:V.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Kw={name:"pkcs-12PbeParams",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:V.Class.UNIVERSAL,type:V.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:V.Class.UNIVERSAL,type:V.Type.INTEGER,constructed:!1,capture:"iterations"}]};Ae.encryptPrivateKeyInfo=function(r,e,t){t=t||{},t.saltSize=t.saltSize||8,t.count=t.count||2048,t.algorithm=t.algorithm||"aes128",t.prfAlgorithm=t.prfAlgorithm||"sha1";var i=ee.random.getBytesSync(t.saltSize),n=t.count,s=V.integerToDer(n),f,a,o;if(t.algorithm.indexOf("aes")===0||t.algorithm==="des"){var c,d,u;switch(t.algorithm){case"aes128":f=16,c=16,d=Hn["aes128-CBC"],u=ee.aes.createEncryptionCipher;break;case"aes192":f=24,c=16,d=Hn["aes192-CBC"],u=ee.aes.createEncryptionCipher;break;case"aes256":f=32,c=16,d=Hn["aes256-CBC"],u=ee.aes.createEncryptionCipher;break;case"des":f=8,c=8,d=Hn.desCBC,u=ee.des.createEncryptionCipher;break;default:var p=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw p.algorithm=t.algorithm,p}var x="hmacWith"+t.prfAlgorithm.toUpperCase(),y=np(x),g=ee.pkcs5.pbkdf2(e,i,n,f,y),M=ee.random.getBytesSync(c),k=u(g);k.start(M),k.update(V.toDer(r)),k.finish(),o=k.output.getBytes();var R=Lw(i,s,f,x);a=V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.OID,!1,V.oidToDer(Hn.pkcs5PBES2).getBytes()),V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.OID,!1,V.oidToDer(Hn.pkcs5PBKDF2).getBytes()),R]),V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.OID,!1,V.oidToDer(d).getBytes()),V.create(V.Class.UNIVERSAL,V.Type.OCTETSTRING,!1,M)])])])}else if(t.algorithm==="3des"){f=24;var K=new ee.util.ByteBuffer(i),g=Ae.pbe.generatePkcs12Key(e,K,1,n,f),M=Ae.pbe.generatePkcs12Key(e,K,2,n,f),k=ee.des.createEncryptionCipher(g);k.start(M),k.update(V.toDer(r)),k.finish(),o=k.output.getBytes(),a=V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.OID,!1,V.oidToDer(Hn["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.OCTETSTRING,!1,i),V.create(V.Class.UNIVERSAL,V.Type.INTEGER,!1,s.getBytes())])])}else{var p=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw p.algorithm=t.algorithm,p}var L=V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[a,V.create(V.Class.UNIVERSAL,V.Type.OCTETSTRING,!1,o)]);return L};Ae.decryptPrivateKeyInfo=function(r,e){var t=null,i={},n=[];if(!V.validate(r,Pw,i,n)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}var f=V.derToOid(i.encryptionOid),a=Ae.pbe.getCipher(f,i.encryptionParams,e),o=ee.util.createBuffer(i.encryptedData);return a.update(o),a.finish()&&(t=V.fromDer(a.output)),t};Ae.encryptedPrivateKeyToPem=function(r,e){var t={type:"ENCRYPTED PRIVATE KEY",body:V.toDer(r).getBytes()};return ee.pem.encode(t,{maxline:e})};Ae.encryptedPrivateKeyFromPem=function(r){var e=ee.pem.decode(r)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var t=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw t.headerType=e.type,t}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return V.fromDer(e.body)};Ae.encryptRsaPrivateKey=function(r,e,t){if(t=t||{},!t.legacy){var i=Ae.wrapRsaPrivateKey(Ae.privateKeyToAsn1(r));return i=Ae.encryptPrivateKeyInfo(i,e,t),Ae.encryptedPrivateKeyToPem(i)}var n,s,f,a;switch(t.algorithm){case"aes128":n="AES-128-CBC",f=16,s=ee.random.getBytesSync(16),a=ee.aes.createEncryptionCipher;break;case"aes192":n="AES-192-CBC",f=24,s=ee.random.getBytesSync(16),a=ee.aes.createEncryptionCipher;break;case"aes256":n="AES-256-CBC",f=32,s=ee.random.getBytesSync(16),a=ee.aes.createEncryptionCipher;break;case"3des":n="DES-EDE3-CBC",f=24,s=ee.random.getBytesSync(8),a=ee.des.createEncryptionCipher;break;case"des":n="DES-CBC",f=8,s=ee.random.getBytesSync(8),a=ee.des.createEncryptionCipher;break;default:var o=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+t.algorithm+'".');throw o.algorithm=t.algorithm,o}var c=ee.pbe.opensslDeriveBytes(e,s.substr(0,8),f),d=a(c);d.start(s),d.update(V.toDer(Ae.privateKeyToAsn1(r))),d.finish();var u={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:n,parameters:ee.util.bytesToHex(s).toUpperCase()},body:d.output.getBytes()};return ee.pem.encode(u)};Ae.decryptRsaPrivateKey=function(r,e){var t=null,i=ee.pem.decode(r)[0];if(i.type!=="ENCRYPTED PRIVATE KEY"&&i.type!=="PRIVATE KEY"&&i.type!=="RSA PRIVATE KEY"){var n=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw n.headerType=n,n}if(i.procType&&i.procType.type==="ENCRYPTED"){var s,f;switch(i.dekInfo.algorithm){case"DES-CBC":s=8,f=ee.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,f=ee.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,f=ee.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,f=ee.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,f=ee.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,f=function(u){return ee.rc2.createDecryptionCipher(u,40)};break;case"RC2-64-CBC":s=8,f=function(u){return ee.rc2.createDecryptionCipher(u,64)};break;case"RC2-128-CBC":s=16,f=function(u){return ee.rc2.createDecryptionCipher(u,128)};break;default:var n=new Error('Could not decrypt private key; unsupported encryption algorithm "'+i.dekInfo.algorithm+'".');throw n.algorithm=i.dekInfo.algorithm,n}var a=ee.util.hexToBytes(i.dekInfo.parameters),o=ee.pbe.opensslDeriveBytes(e,a.substr(0,8),s),c=f(o);if(c.start(a),c.update(ee.util.createBuffer(i.body)),c.finish())t=c.output.getBytes();else return t}else t=i.body;return i.type==="ENCRYPTED PRIVATE KEY"?t=Ae.decryptPrivateKeyInfo(V.fromDer(t),e):t=V.fromDer(t),t!==null&&(t=Ae.privateKeyFromAsn1(t)),t};Ae.pbe.generatePkcs12Key=function(r,e,t,i,n,s){var f,a;if(typeof s=="undefined"||s===null){if(!("sha1"in ee.md))throw new Error('"sha1" hash algorithm unavailable.');s=ee.md.sha1.create()}var o=s.digestLength,c=s.blockLength,d=new ee.util.ByteBuffer,u=new ee.util.ByteBuffer;if(r!=null){for(a=0;a<r.length;a++)u.putInt16(r.charCodeAt(a));u.putInt16(0)}var p=u.length(),x=e.length(),y=new ee.util.ByteBuffer;y.fillWithByte(t,c);var g=c*Math.ceil(x/c),M=new ee.util.ByteBuffer;for(a=0;a<g;a++)M.putByte(e.at(a%x));var k=c*Math.ceil(p/c),R=new ee.util.ByteBuffer;for(a=0;a<k;a++)R.putByte(u.at(a%p));var K=M;K.putBuffer(R);for(var L=Math.ceil(n/o),O=1;O<=L;O++){var F=new ee.util.ByteBuffer;F.putBytes(y.bytes()),F.putBytes(K.bytes());for(var G=0;G<i;G++)s.start(),s.update(F.getBytes()),F=s.digest();var B=new ee.util.ByteBuffer;for(a=0;a<c;a++)B.putByte(F.at(a%o));var b=Math.ceil(x/c)+Math.ceil(p/c),m=new ee.util.ByteBuffer;for(f=0;f<b;f++){var w=new ee.util.ByteBuffer(K.getBytes(c)),S=511;for(a=B.length()-1;a>=0;a--)S=S>>8,S+=B.at(a)+w.at(a),w.setAt(a,S&255);m.putBuffer(w)}K=m,d.putBuffer(F)}return d.truncate(d.length()-n),d};Ae.pbe.getCipher=function(r,e,t){switch(r){case Ae.oids.pkcs5PBES2:return Ae.pbe.getCipherForPBES2(r,e,t);case Ae.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case Ae.oids["pbewithSHAAnd40BitRC2-CBC"]:return Ae.pbe.getCipherForPKCS12PBE(r,e,t);default:var i=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw i.oid=r,i.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],i}};Ae.pbe.getCipherForPBES2=function(r,e,t){var i={},n=[];if(!V.validate(e,Rw,i,n)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}if(r=V.derToOid(i.kdfOid),r!==Ae.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=r,s.supportedOids=["pkcs5PBKDF2"],s}if(r=V.derToOid(i.encOid),r!==Ae.oids["aes128-CBC"]&&r!==Ae.oids["aes192-CBC"]&&r!==Ae.oids["aes256-CBC"]&&r!==Ae.oids["des-EDE3-CBC"]&&r!==Ae.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=r,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var f=i.kdfSalt,a=ee.util.createBuffer(i.kdfIterationCount);a=a.getInt(a.length()<<3);var o,c;switch(Ae.oids[r]){case"aes128-CBC":o=16,c=ee.aes.createDecryptionCipher;break;case"aes192-CBC":o=24,c=ee.aes.createDecryptionCipher;break;case"aes256-CBC":o=32,c=ee.aes.createDecryptionCipher;break;case"des-EDE3-CBC":o=24,c=ee.des.createDecryptionCipher;break;case"desCBC":o=8,c=ee.des.createDecryptionCipher;break}var d=sp(i.prfOid),u=ee.pkcs5.pbkdf2(t,f,a,o,d),p=i.encIv,x=c(u);return x.start(p),x};Ae.pbe.getCipherForPKCS12PBE=function(r,e,t){var i={},n=[];if(!V.validate(e,Kw,i,n)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}var f=ee.util.createBuffer(i.salt),a=ee.util.createBuffer(i.iterations);a=a.getInt(a.length()<<3);var o,c,d;switch(r){case Ae.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:o=24,c=8,d=ee.des.startDecrypting;break;case Ae.oids["pbewithSHAAnd40BitRC2-CBC"]:o=5,c=8,d=function(g,M){var k=ee.rc2.createDecryptionCipher(g,40);return k.start(M,null),k};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=r,s}var u=sp(i.prfOid),p=Ae.pbe.generatePkcs12Key(t,f,1,a,o,u);u.start();var x=Ae.pbe.generatePkcs12Key(t,f,2,a,c,u);return d(p,x)};Ae.pbe.opensslDeriveBytes=function(r,e,t,i){if(typeof i=="undefined"||i===null){if(!("md5"in ee.md))throw new Error('"md5" hash algorithm unavailable.');i=ee.md.md5.create()}e===null&&(e="");for(var n=[fp(i,r+e)],s=16,f=1;s<t;++f,s+=16)n.push(fp(i,n[f-1]+r+e));return n.join("").substr(0,t)};function fp(r,e){return r.start().update(e).digest().getBytes()}function sp(r){var e;if(!r)e="hmacWithSHA1";else if(e=Ae.oids[V.derToOid(r)],!e){var t=new Error("Unsupported PRF OID.");throw t.oid=r,t.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],t}return np(e)}function np(r){var e=ee.md;switch(r){case"hmacWithSHA224":e=ee.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":r=r.substr(8).toLowerCase();break;default:var t=new Error("Unsupported PRF algorithm.");throw t.algorithm=r,t.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],t}if(!e||!(r in e))throw new Error("Unknown hash algorithm: "+r);return e[r].create()}function Lw(r,e,t,i){var n=V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.OCTETSTRING,!1,r),V.create(V.Class.UNIVERSAL,V.Type.INTEGER,!1,e.getBytes())]);return i!=="hmacWithSHA1"&&n.value.push(V.create(V.Class.UNIVERSAL,V.Type.INTEGER,!1,ee.util.hexToBytes(t.toString(16))),V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.OID,!1,V.oidToDer(Ae.oids[i]).getBytes()),V.create(V.Class.UNIVERSAL,V.Type.NULL,!1,"")])),n}});var jr=C((AB,op)=>{"use strict";function cp(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function Fw(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=void 0),e!=null&&(t.code=e);try{return cp(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),cp(new n,t)}}op.exports=Fw});var an=C((BB,dp)=>{"use strict";var{names:Dw}=Qi(),{TextEncoder:zw}=di(),Ow=new zw;function Uw(r){let e=new Uint8Array(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}function Hw(r,e="utf8"){if(e==="utf8"||e==="utf-8")return Ow.encode(r);if(e==="ascii")return Uw(r);let t=Dw[e];if(!t)throw new Error("Unknown base");return t.decode(r)}dp.exports=Hw});var Vs=C((kB,hp)=>{"use strict";function Vw(r,e){e||(e=r.reduce((n,s)=>n+s.length,0));let t=new Uint8Array(e),i=0;for(let n of r)t.set(n,i),i+=n.length;return t}hp.exports=Vw});var Js=C(up=>{"use strict";up.get=(r=self)=>{let e=r.crypto||r.msCrypto;if(!e||!e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}});var Kc=C((CB,lp)=>{"use strict";var Jw=Vs(),bp=an(),Gw=Js();function Xw({algorithm:r="AES-GCM",nonceLength:e=12,keyLength:t=16,digest:i="SHA-256",saltLength:n=16,iterations:s=32767}={}){let f=Gw.get();t*=8;async function a(c,d){let u=f.getRandomValues(new Uint8Array(n)),p=f.getRandomValues(new Uint8Array(e)),x={name:r,iv:p},y={name:"PBKDF2",salt:u,iterations:s,hash:{name:i}},g=await f.subtle.importKey("raw",bp(d),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),M=await f.subtle.deriveKey(y,g,{name:r,length:t},!0,["encrypt"]),k=await f.subtle.encrypt(x,M,c);return Jw([u,x.iv,new Uint8Array(k)])}async function o(c,d){let u=c.slice(0,n),p=c.slice(n,n+e),x=c.slice(n+e),y={name:r,iv:p},g={name:"PBKDF2",salt:u,iterations:s,hash:{name:i}},M=await f.subtle.importKey("raw",bp(d),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),k=await f.subtle.deriveKey(g,M,{name:r,length:t},!0,["decrypt"]),R=await f.subtle.decrypt(y,k,x);return new Uint8Array(R)}return{encrypt:a,decrypt:o}}lp.exports={create:Xw}});var yp=C((TB,pp)=>{"use strict";var Yw=en(),Zw=Kc();pp.exports={import:async function(r,e){let i=Yw.names.base64.decode(r);return await Zw.create().decrypt(i,e)}}});var Gs=C((NB,mp)=>{"use strict";var Ww=Is(),z0=self.crypto||self.msCrypto,Lc=async(r,e)=>{if(typeof self=="undefined"||!z0)throw new Error("Please use a browser with webcrypto support and ensure the code has been delivered securely via HTTPS/TLS and run within a Secure Context");switch(e){case"sha1":return new Uint8Array(await z0.subtle.digest({name:"SHA-1"},r));case"sha2-256":return new Uint8Array(await z0.subtle.digest({name:"SHA-256"},r));case"sha2-512":return new Uint8Array(await z0.subtle.digest({name:"SHA-512"},r));case"dbl-sha2-256":{let t=await z0.subtle.digest({name:"SHA-256"},r);return new Uint8Array(await z0.subtle.digest({name:"SHA-256"},t))}default:throw new Error(`${e} is not a supported algorithm`)}};mp.exports={factory:r=>async e=>Lc(e,r),digest:Lc,multihashing:async(r,e,t)=>{let i=await Lc(r,e);return Ww.encode(i,e,t)}}});var Xs=C((PB,xp)=>{"use strict";function jw(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}xp.exports=jw});var on=C((RB,vp)=>{"use strict";var{names:$w}=Qi(),{TextDecoder:Qw}=di(),eS=new Qw("utf8");function tS(r){let e="";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e}function rS(r,e="utf8"){if(e==="utf8"||e==="utf-8")return eS.decode(r);if(e==="ascii")return tS(r);let t=$w[e];if(!t)throw new Error("Unknown base");return t.encode(r)}vp.exports=rS});var zc=C((KB,gp)=>{var at=He();zn();Kt();var Ys=gp.exports=at.sha512=at.sha512||{};at.md.sha512=at.md.algorithms.sha512=Ys;var wp=at.sha384=at.sha512.sha384=at.sha512.sha384||{};wp.create=function(){return Ys.create("SHA-384")};at.md.sha384=at.md.algorithms.sha384=wp;at.sha512.sha256=at.sha512.sha256||{create:function(){return Ys.create("SHA-512/256")}};at.md["sha512/256"]=at.md.algorithms["sha512/256"]=at.sha512.sha256;at.sha512.sha224=at.sha512.sha224||{create:function(){return Ys.create("SHA-512/224")}};at.md["sha512/224"]=at.md.algorithms["sha512/224"]=at.sha512.sha224;Ys.create=function(r){if(Sp||iS(),typeof r=="undefined"&&(r="SHA-512"),!(r in Vn))throw new Error("Invalid SHA-512 algorithm: "+r);for(var e=Vn[r],t=null,i=at.util.createBuffer(),n=new Array(80),s=0;s<80;++s)n[s]=new Array(2);var f=64;switch(r){case"SHA-384":f=48;break;case"SHA-512/256":f=32;break;case"SHA-512/224":f=28;break}var a={algorithm:r.replace("-","").toLowerCase(),blockLength:128,digestLength:f,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var o=a.messageLengthSize/4,c=0;c<o;++c)a.fullMessageLength.push(0);i=at.util.createBuffer(),t=new Array(e.length);for(var c=0;c<e.length;++c)t[c]=e[c].slice(0);return a},a.start(),a.update=function(o,c){c==="utf8"&&(o=at.util.encodeUtf8(o));var d=o.length;a.messageLength+=d,d=[d/4294967296>>>0,d>>>0];for(var u=a.fullMessageLength.length-1;u>=0;--u)a.fullMessageLength[u]+=d[1],d[1]=d[0]+(a.fullMessageLength[u]/4294967296>>>0),a.fullMessageLength[u]=a.fullMessageLength[u]>>>0,d[0]=d[1]/4294967296>>>0;return i.putBytes(o),Ep(t,n,i),(i.read>2048||i.length()===0)&&i.compact(),a},a.digest=function(){var o=at.util.createBuffer();o.putBytes(i.bytes());var c=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,d=c&a.blockLength-1;o.putBytes(Fc.substr(0,a.blockLength-d));for(var u,p,x=a.fullMessageLength[0]*8,y=0;y<a.fullMessageLength.length-1;++y)u=a.fullMessageLength[y+1]*8,p=u/4294967296>>>0,x+=p,o.putInt32(x>>>0),x=u>>>0;o.putInt32(x);for(var g=new Array(t.length),y=0;y<t.length;++y)g[y]=t[y].slice(0);Ep(g,n,o);var M=at.util.createBuffer(),k;r==="SHA-512"?k=g.length:r==="SHA-384"?k=g.length-2:k=g.length-4;for(var y=0;y<k;++y)M.putInt32(g[y][0]),(y!==k-1||r!=="SHA-512/224")&&M.putInt32(g[y][1]);return M},a};var Fc=null,Sp=!1,Dc=null,Vn=null;function iS(){Fc=String.fromCharCode(128),Fc+=at.util.fillString(String.fromCharCode(0),128),Dc=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Vn={},Vn["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Vn["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Vn["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Vn["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],Sp=!0}function Ep(r,e,t){for(var i,n,s,f,a,o,c,d,u,p,x,y,g,M,k,R,K,L,O,F,G,B,b,m,w,S,I,q,h,_,l,A,W,$,Y,j=t.length();j>=128;){for(h=0;h<16;++h)e[h][0]=t.getInt32()>>>0,e[h][1]=t.getInt32()>>>0;for(;h<80;++h)A=e[h-2],_=A[0],l=A[1],i=((_>>>19|l<<13)^(l>>>29|_<<3)^_>>>6)>>>0,n=((_<<13|l>>>19)^(l<<3|_>>>29)^(_<<26|l>>>6))>>>0,$=e[h-15],_=$[0],l=$[1],s=((_>>>1|l<<31)^(_>>>8|l<<24)^_>>>7)>>>0,f=((_<<31|l>>>1)^(_<<24|l>>>8)^(_<<25|l>>>7))>>>0,W=e[h-7],Y=e[h-16],l=n+W[1]+f+Y[1],e[h][0]=i+W[0]+s+Y[0]+(l/4294967296>>>0)>>>0,e[h][1]=l>>>0;for(g=r[0][0],M=r[0][1],k=r[1][0],R=r[1][1],K=r[2][0],L=r[2][1],O=r[3][0],F=r[3][1],G=r[4][0],B=r[4][1],b=r[5][0],m=r[5][1],w=r[6][0],S=r[6][1],I=r[7][0],q=r[7][1],h=0;h<80;++h)c=((G>>>14|B<<18)^(G>>>18|B<<14)^(B>>>9|G<<23))>>>0,d=((G<<18|B>>>14)^(G<<14|B>>>18)^(B<<23|G>>>9))>>>0,u=(w^G&(b^w))>>>0,p=(S^B&(m^S))>>>0,a=((g>>>28|M<<4)^(M>>>2|g<<30)^(M>>>7|g<<25))>>>0,o=((g<<4|M>>>28)^(M<<30|g>>>2)^(M<<25|g>>>7))>>>0,x=(g&k|K&(g^k))>>>0,y=(M&R|L&(M^R))>>>0,l=q+d+p+Dc[h][1]+e[h][1],i=I+c+u+Dc[h][0]+e[h][0]+(l/4294967296>>>0)>>>0,n=l>>>0,l=o+y,s=a+x+(l/4294967296>>>0)>>>0,f=l>>>0,I=w,q=S,w=b,S=m,b=G,m=B,l=F+n,G=O+i+(l/4294967296>>>0)>>>0,B=l>>>0,O=K,F=L,K=k,L=R,k=g,R=M,l=n+f,g=i+s+(l/4294967296>>>0)>>>0,M=l>>>0;l=r[0][1]+M,r[0][0]=r[0][0]+g+(l/4294967296>>>0)>>>0,r[0][1]=l>>>0,l=r[1][1]+R,r[1][0]=r[1][0]+k+(l/4294967296>>>0)>>>0,r[1][1]=l>>>0,l=r[2][1]+L,r[2][0]=r[2][0]+K+(l/4294967296>>>0)>>>0,r[2][1]=l>>>0,l=r[3][1]+F,r[3][0]=r[3][0]+O+(l/4294967296>>>0)>>>0,r[3][1]=l>>>0,l=r[4][1]+B,r[4][0]=r[4][0]+G+(l/4294967296>>>0)>>>0,r[4][1]=l>>>0,l=r[5][1]+m,r[5][0]=r[5][0]+b+(l/4294967296>>>0)>>>0,r[5][1]=l>>>0,l=r[6][1]+S,r[6][0]=r[6][0]+w+(l/4294967296>>>0)>>>0,r[6][1]=l>>>0,l=r[7][1]+q,r[7][0]=r[7][0]+I+(l/4294967296>>>0)>>>0,r[7][1]=l>>>0,j-=128}}});var Mp=C(Oc=>{var nS=He();P0();var Qt=nS.asn1;Oc.privateKeyValidator={name:"PrivateKeyInfo",tagClass:Qt.Class.UNIVERSAL,type:Qt.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:Qt.Class.UNIVERSAL,type:Qt.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:Qt.Class.UNIVERSAL,type:Qt.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Qt.Class.UNIVERSAL,type:Qt.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:Qt.Class.UNIVERSAL,type:Qt.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]};Oc.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:Qt.Class.UNIVERSAL,type:Qt.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:Qt.Class.UNIVERSAL,type:Qt.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Qt.Class.UNIVERSAL,type:Qt.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:Qt.Class.UNIVERSAL,type:Qt.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}});var Wc=C((FB,_p)=>{var fr=He();Hs();L0();zc();Kt();var Ip=Mp(),sS=Ip.publicKeyValidator,fS=Ip.privateKeyValidator;typeof Ap=="undefined"&&(Ap=fr.jsbn.BigInteger);var Ap,Uc=fr.util.ByteBuffer,Mr=typeof Buffer=="undefined"?Uint8Array:Buffer;fr.pki=fr.pki||{};_p.exports=fr.pki.ed25519=fr.ed25519=fr.ed25519||{};var Le=fr.ed25519;Le.constants={};Le.constants.PUBLIC_KEY_BYTE_LENGTH=32;Le.constants.PRIVATE_KEY_BYTE_LENGTH=64;Le.constants.SEED_BYTE_LENGTH=32;Le.constants.SIGN_BYTE_LENGTH=64;Le.constants.HASH_BYTE_LENGTH=64;Le.generateKeyPair=function(r){r=r||{};var e=r.seed;if(e===void 0)e=fr.random.getBytesSync(Le.constants.SEED_BYTE_LENGTH);else if(typeof e=="string"){if(e.length!==Le.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+Le.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');e=Ui({message:e,encoding:"binary"});for(var t=new Mr(Le.constants.PUBLIC_KEY_BYTE_LENGTH),i=new Mr(Le.constants.PRIVATE_KEY_BYTE_LENGTH),n=0;n<32;++n)i[n]=e[n];return aS(t,i),{publicKey:t,privateKey:i}};Le.privateKeyFromAsn1=function(r){var e={},t=[],i=fr.asn1.validate(r,fS,e,t);if(!i){var n=new Error("Invalid Key.");throw n.errors=t,n}var s=fr.asn1.derToOid(e.privateKeyOid),f=fr.oids.EdDSA25519;if(s!==f)throw new Error('Invalid OID "'+s+'"; OID must be "'+f+'".');var a=e.privateKey,o=Ui({message:fr.asn1.fromDer(a).value,encoding:"binary"});return{privateKeyBytes:o}};Le.publicKeyFromAsn1=function(r){var e={},t=[],i=fr.asn1.validate(r,sS,e,t);if(!i){var n=new Error("Invalid Key.");throw n.errors=t,n}var s=fr.asn1.derToOid(e.publicKeyOid),f=fr.oids.EdDSA25519;if(s!==f)throw new Error('Invalid OID "'+s+'"; OID must be "'+f+'".');var a=e.ed25519PublicKey;if(a.length!==Le.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return Ui({message:a,encoding:"binary"})};Le.publicKeyFromPrivateKey=function(r){r=r||{};var e=Ui({message:r.privateKey,encoding:"binary"});if(e.length!==Le.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+Le.constants.PRIVATE_KEY_BYTE_LENGTH);for(var t=new Mr(Le.constants.PUBLIC_KEY_BYTE_LENGTH),i=0;i<t.length;++i)t[i]=e[32+i];return t};Le.sign=function(r){r=r||{};var e=Ui(r),t=Ui({message:r.privateKey,encoding:"binary"});if(t.length===Le.constants.SEED_BYTE_LENGTH){var i=Le.generateKeyPair({seed:t});t=i.privateKey}else if(t.length!==Le.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+Le.constants.SEED_BYTE_LENGTH+" or "+Le.constants.PRIVATE_KEY_BYTE_LENGTH);var n=new Mr(Le.constants.SIGN_BYTE_LENGTH+e.length);oS(n,e,e.length,t);for(var s=new Mr(Le.constants.SIGN_BYTE_LENGTH),f=0;f<s.length;++f)s[f]=n[f];return s};Le.verify=function(r){r=r||{};var e=Ui(r);if(r.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var t=Ui({message:r.signature,encoding:"binary"});if(t.length!==Le.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+Le.constants.SIGN_BYTE_LENGTH);var i=Ui({message:r.publicKey,encoding:"binary"});if(i.length!==Le.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+Le.constants.PUBLIC_KEY_BYTE_LENGTH);var n=new Mr(Le.constants.SIGN_BYTE_LENGTH+e.length),s=new Mr(Le.constants.SIGN_BYTE_LENGTH+e.length),f;for(f=0;f<Le.constants.SIGN_BYTE_LENGTH;++f)n[f]=t[f];for(f=0;f<e.length;++f)n[f+Le.constants.SIGN_BYTE_LENGTH]=e[f];return cS(s,n,n.length,i)>=0};function Ui(r){var e=r.message;if(e instanceof Uint8Array||e instanceof Mr)return e;var t=r.encoding;if(e===void 0)if(r.md)e=r.md.digest().getBytes(),t="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof e=="string"&&!t)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof e=="string"){if(typeof Buffer!="undefined")return Buffer.from(e,t);e=new Uc(e,t)}else if(!(e instanceof Uc))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var i=new Mr(e.length()),n=0;n<i.length;++n)i[n]=e.at(n);return i}var Hc=ue(),ma=ue([1]),dS=ue([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),hS=ue([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),Bp=ue([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),kp=ue([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),Vc=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),uS=ue([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function Zs(r,e){var t=fr.md.sha512.create(),i=new Uc(r);t.update(i.getBytes(e),"binary");var n=t.digest().getBytes();if(typeof Buffer!="undefined")return Buffer.from(n,"binary");for(var s=new Mr(Le.constants.HASH_BYTE_LENGTH),f=0;f<64;++f)s[f]=n.charCodeAt(f);return s}function aS(r,e){var t=[ue(),ue(),ue(),ue()],i,n=Zs(e,32);for(n[0]&=248,n[31]&=127,n[31]|=64,Gc(t,n),Jc(r,t),i=0;i<32;++i)e[i+32]=r[i];return 0}function oS(r,e,t,i){var n,s,f=new Float64Array(64),a=[ue(),ue(),ue(),ue()],o=Zs(i,32);o[0]&=248,o[31]&=127,o[31]|=64;var c=t+64;for(n=0;n<t;++n)r[64+n]=e[n];for(n=0;n<32;++n)r[32+n]=o[32+n];var d=Zs(r.subarray(32),t+32);for(Xc(d),Gc(a,d),Jc(r,a),n=32;n<64;++n)r[n]=i[n];var u=Zs(r,t+64);for(Xc(u),n=32;n<64;++n)f[n]=0;for(n=0;n<32;++n)f[n]=d[n];for(n=0;n<32;++n)for(s=0;s<32;s++)f[n+s]+=u[n]*o[s];return qp(r.subarray(32),f),c}function cS(r,e,t,i){var n,s,f=new Mr(32),a=[ue(),ue(),ue(),ue()],o=[ue(),ue(),ue(),ue()];if(s=-1,t<64||lS(o,i))return-1;for(n=0;n<t;++n)r[n]=e[n];for(n=0;n<32;++n)r[n+32]=i[n];var c=Zs(r,t);if(Xc(c),Tp(a,o,c),Gc(o,e.subarray(32)),Yc(a,o),Jc(f,a),t-=64,Cp(e,0,f,0)){for(n=0;n<t;++n)r[n]=0;return-1}for(n=0;n<t;++n)r[n]=e[n+64];return s=t,s}function qp(r,e){var t,i,n,s;for(i=63;i>=32;--i){for(t=0,n=i-32,s=i-12;n<s;++n)e[n]+=t-16*e[i]*Vc[n-(i-32)],t=e[n]+128>>8,e[n]-=t*256;e[n]+=t,e[i]=0}for(t=0,n=0;n<32;++n)e[n]+=t-(e[31]>>4)*Vc[n],t=e[n]>>8,e[n]&=255;for(n=0;n<32;++n)e[n]-=t*Vc[n];for(i=0;i<32;++i)e[i+1]+=e[i]>>8,r[i]=e[i]&255}function Xc(r){for(var e=new Float64Array(64),t=0;t<64;++t)e[t]=r[t],r[t]=0;qp(r,e)}function Yc(r,e){var t=ue(),i=ue(),n=ue(),s=ue(),f=ue(),a=ue(),o=ue(),c=ue(),d=ue();U0(t,r[1],r[0]),U0(d,e[1],e[0]),$e(t,t,d),O0(i,r[0],r[1]),O0(d,e[0],e[1]),$e(i,i,d),$e(n,r[3],e[3]),$e(n,n,hS),$e(s,r[2],e[2]),O0(s,s,s),U0(f,i,t),U0(a,s,n),O0(o,s,n),O0(c,i,t),$e(r[0],f,a),$e(r[1],c,o),$e(r[2],o,a),$e(r[3],f,c)}function Pp(r,e,t){for(var i=0;i<4;++i)Np(r[i],e[i],t)}function Jc(r,e){var t=ue(),i=ue(),n=ue();bS(n,e[2]),$e(t,e[0],n),$e(i,e[1],n),xa(r,i),r[31]^=Rp(t)<<7}function xa(r,e){var t,i,n,s=ue(),f=ue();for(t=0;t<16;++t)f[t]=e[t];for(Zc(f),Zc(f),Zc(f),i=0;i<2;++i){for(s[0]=f[0]-65517,t=1;t<15;++t)s[t]=f[t]-65535-(s[t-1]>>16&1),s[t-1]&=65535;s[15]=f[15]-32767-(s[14]>>16&1),n=s[15]>>16&1,s[14]&=65535,Np(f,s,1-n)}for(t=0;t<16;t++)r[2*t]=f[t]&255,r[2*t+1]=f[t]>>8}function lS(r,e){var t=ue(),i=ue(),n=ue(),s=ue(),f=ue(),a=ue(),o=ue();return cn(r[2],ma),pS(r[1],e),Jn(n,r[1]),$e(s,n,dS),U0(n,n,r[2]),O0(s,r[2],s),Jn(f,s),Jn(a,f),$e(o,a,f),$e(t,o,n),$e(t,t,s),yS(t,t),$e(t,t,n),$e(t,t,s),$e(t,t,s),$e(r[0],t,s),Jn(i,r[0]),$e(i,i,s),Kp(i,n)&&$e(r[0],r[0],uS),Jn(i,r[0]),$e(i,i,s),Kp(i,n)?-1:(Rp(r[0])===e[31]>>7&&U0(r[0],Hc,r[0]),$e(r[3],r[0],r[1]),0)}function pS(r,e){var t;for(t=0;t<16;++t)r[t]=e[2*t]+(e[2*t+1]<<8);r[15]&=32767}function yS(r,e){var t=ue(),i;for(i=0;i<16;++i)t[i]=e[i];for(i=250;i>=0;--i)Jn(t,t),i!==1&&$e(t,t,e);for(i=0;i<16;++i)r[i]=t[i]}function Kp(r,e){var t=new Mr(32),i=new Mr(32);return xa(t,r),xa(i,e),Cp(t,0,i,0)}function Cp(r,e,t,i){return mS(r,e,t,i,32)}function mS(r,e,t,i,n){var s,f=0;for(s=0;s<n;++s)f|=r[e+s]^t[i+s];return(1&f-1>>>8)-1}function Rp(r){var e=new Mr(32);return xa(e,r),e[0]&1}function Tp(r,e,t){var i,n;for(cn(r[0],Hc),cn(r[1],ma),cn(r[2],ma),cn(r[3],Hc),n=255;n>=0;--n)i=t[n/8|0]>>(n&7)&1,Pp(r,e,i),Yc(e,r),Yc(r,r),Pp(r,e,i)}function Gc(r,e){var t=[ue(),ue(),ue(),ue()];cn(t[0],Bp),cn(t[1],kp),cn(t[2],ma),$e(t[3],Bp,kp),Tp(r,t,e)}function cn(r,e){var t;for(t=0;t<16;t++)r[t]=e[t]|0}function bS(r,e){var t=ue(),i;for(i=0;i<16;++i)t[i]=e[i];for(i=253;i>=0;--i)Jn(t,t),i!==2&&i!==4&&$e(t,t,e);for(i=0;i<16;++i)r[i]=t[i]}function Zc(r){var e,t,i=1;for(e=0;e<16;++e)t=r[e]+i+65535,i=Math.floor(t/65536),r[e]=t-i*65536;r[0]+=i-1+37*(i-1)}function Np(r,e,t){for(var i,n=~(t-1),s=0;s<16;++s)i=n&(r[s]^e[s]),r[s]^=i,e[s]^=i}function ue(r){var e,t=new Float64Array(16);if(r)for(e=0;e<r.length;++e)t[e]=r[e];return t}function O0(r,e,t){for(var i=0;i<16;++i)r[i]=e[i]+t[i]}function U0(r,e,t){for(var i=0;i<16;++i)r[i]=e[i]-t[i]}function Jn(r,e){$e(r,e,e)}function $e(r,e,t){var i,n,s=0,f=0,a=0,o=0,c=0,d=0,u=0,p=0,x=0,y=0,g=0,M=0,k=0,R=0,K=0,L=0,O=0,F=0,G=0,B=0,b=0,m=0,w=0,S=0,I=0,q=0,h=0,_=0,l=0,A=0,W=0,$=t[0],Y=t[1],j=t[2],de=t[3],te=t[4],pe=t[5],ye=t[6],re=t[7],Be=t[8],ke=t[9],se=t[10],qe=t[11],Ce=t[12],fe=t[13],Te=t[14],Ne=t[15];i=e[0],s+=i*$,f+=i*Y,a+=i*j,o+=i*de,c+=i*te,d+=i*pe,u+=i*ye,p+=i*re,x+=i*Be,y+=i*ke,g+=i*se,M+=i*qe,k+=i*Ce,R+=i*fe,K+=i*Te,L+=i*Ne,i=e[1],f+=i*$,a+=i*Y,o+=i*j,c+=i*de,d+=i*te,u+=i*pe,p+=i*ye,x+=i*re,y+=i*Be,g+=i*ke,M+=i*se,k+=i*qe,R+=i*Ce,K+=i*fe,L+=i*Te,O+=i*Ne,i=e[2],a+=i*$,o+=i*Y,c+=i*j,d+=i*de,u+=i*te,p+=i*pe,x+=i*ye,y+=i*re,g+=i*Be,M+=i*ke,k+=i*se,R+=i*qe,K+=i*Ce,L+=i*fe,O+=i*Te,F+=i*Ne,i=e[3],o+=i*$,c+=i*Y,d+=i*j,u+=i*de,p+=i*te,x+=i*pe,y+=i*ye,g+=i*re,M+=i*Be,k+=i*ke,R+=i*se,K+=i*qe,L+=i*Ce,O+=i*fe,F+=i*Te,G+=i*Ne,i=e[4],c+=i*$,d+=i*Y,u+=i*j,p+=i*de,x+=i*te,y+=i*pe,g+=i*ye,M+=i*re,k+=i*Be,R+=i*ke,K+=i*se,L+=i*qe,O+=i*Ce,F+=i*fe,G+=i*Te,B+=i*Ne,i=e[5],d+=i*$,u+=i*Y,p+=i*j,x+=i*de,y+=i*te,g+=i*pe,M+=i*ye,k+=i*re,R+=i*Be,K+=i*ke,L+=i*se,O+=i*qe,F+=i*Ce,G+=i*fe,B+=i*Te,b+=i*Ne,i=e[6],u+=i*$,p+=i*Y,x+=i*j,y+=i*de,g+=i*te,M+=i*pe,k+=i*ye,R+=i*re,K+=i*Be,L+=i*ke,O+=i*se,F+=i*qe,G+=i*Ce,B+=i*fe,b+=i*Te,m+=i*Ne,i=e[7],p+=i*$,x+=i*Y,y+=i*j,g+=i*de,M+=i*te,k+=i*pe,R+=i*ye,K+=i*re,L+=i*Be,O+=i*ke,F+=i*se,G+=i*qe,B+=i*Ce,b+=i*fe,m+=i*Te,w+=i*Ne,i=e[8],x+=i*$,y+=i*Y,g+=i*j,M+=i*de,k+=i*te,R+=i*pe,K+=i*ye,L+=i*re,O+=i*Be,F+=i*ke,G+=i*se,B+=i*qe,b+=i*Ce,m+=i*fe,w+=i*Te,S+=i*Ne,i=e[9],y+=i*$,g+=i*Y,M+=i*j,k+=i*de,R+=i*te,K+=i*pe,L+=i*ye,O+=i*re,F+=i*Be,G+=i*ke,B+=i*se,b+=i*qe,m+=i*Ce,w+=i*fe,S+=i*Te,I+=i*Ne,i=e[10],g+=i*$,M+=i*Y,k+=i*j,R+=i*de,K+=i*te,L+=i*pe,O+=i*ye,F+=i*re,G+=i*Be,B+=i*ke,b+=i*se,m+=i*qe,w+=i*Ce,S+=i*fe,I+=i*Te,q+=i*Ne,i=e[11],M+=i*$,k+=i*Y,R+=i*j,K+=i*de,L+=i*te,O+=i*pe,F+=i*ye,G+=i*re,B+=i*Be,b+=i*ke,m+=i*se,w+=i*qe,S+=i*Ce,I+=i*fe,q+=i*Te,h+=i*Ne,i=e[12],k+=i*$,R+=i*Y,K+=i*j,L+=i*de,O+=i*te,F+=i*pe,G+=i*ye,B+=i*re,b+=i*Be,m+=i*ke,w+=i*se,S+=i*qe,I+=i*Ce,q+=i*fe,h+=i*Te,_+=i*Ne,i=e[13],R+=i*$,K+=i*Y,L+=i*j,O+=i*de,F+=i*te,G+=i*pe,B+=i*ye,b+=i*re,m+=i*Be,w+=i*ke,S+=i*se,I+=i*qe,q+=i*Ce,h+=i*fe,_+=i*Te,l+=i*Ne,i=e[14],K+=i*$,L+=i*Y,O+=i*j,F+=i*de,G+=i*te,B+=i*pe,b+=i*ye,m+=i*re,w+=i*Be,S+=i*ke,I+=i*se,q+=i*qe,h+=i*Ce,_+=i*fe,l+=i*Te,A+=i*Ne,i=e[15],L+=i*$,O+=i*Y,F+=i*j,G+=i*de,B+=i*te,b+=i*pe,m+=i*ye,w+=i*re,S+=i*Be,I+=i*ke,q+=i*se,h+=i*qe,_+=i*Ce,l+=i*fe,A+=i*Te,W+=i*Ne,s+=38*O,f+=38*F,a+=38*G,o+=38*B,c+=38*b,d+=38*m,u+=38*w,p+=38*S,x+=38*I,y+=38*q,g+=38*h,M+=38*_,k+=38*l,R+=38*A,K+=38*W,n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=f+n+65535,n=Math.floor(i/65536),f=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=p+n+65535,n=Math.floor(i/65536),p=i-n*65536,i=x+n+65535,n=Math.floor(i/65536),x=i-n*65536,i=y+n+65535,n=Math.floor(i/65536),y=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=M+n+65535,n=Math.floor(i/65536),M=i-n*65536,i=k+n+65535,n=Math.floor(i/65536),k=i-n*65536,i=R+n+65535,n=Math.floor(i/65536),R=i-n*65536,i=K+n+65535,n=Math.floor(i/65536),K=i-n*65536,i=L+n+65535,n=Math.floor(i/65536),L=i-n*65536,s+=n-1+37*(n-1),n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=f+n+65535,n=Math.floor(i/65536),f=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=p+n+65535,n=Math.floor(i/65536),p=i-n*65536,i=x+n+65535,n=Math.floor(i/65536),x=i-n*65536,i=y+n+65535,n=Math.floor(i/65536),y=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=M+n+65535,n=Math.floor(i/65536),M=i-n*65536,i=k+n+65535,n=Math.floor(i/65536),k=i-n*65536,i=R+n+65535,n=Math.floor(i/65536),R=i-n*65536,i=K+n+65535,n=Math.floor(i/65536),K=i-n*65536,i=L+n+65535,n=Math.floor(i/65536),L=i-n*65536,s+=n-1+37*(n-1),r[0]=s,r[1]=f,r[2]=a,r[3]=o,r[4]=c,r[5]=d,r[6]=u,r[7]=p,r[8]=x,r[9]=y,r[10]=g,r[11]=M,r[12]=k,r[13]=R,r[14]=K,r[15]=L}});var Lp=C((DB,jc)=>{"use strict";var Ws=self.crypto||self.msCrypto,{Buffer:xS}=Ht(),va=65536;function vS(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}Ws&&Ws.getRandomValues?jc.exports=gS:jc.exports=vS;function gS(r){let e=new Uint8Array(r),t=0;if(r>0)if(r>va)for(;t<r;)t+va>r?(Ws.getRandomValues(e.subarray(t,t+(r-t))),t+=r-t):(Ws.getRandomValues(e.subarray(t,t+va)),t+=va);else Ws.getRandomValues(e);return xS.from(e)}});var ga=C((zB,Fp)=>{"use strict";var wS=Lp(),SS=jr();Fp.exports=function(r){if(isNaN(r)||r<=0)throw SS(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return wS(r)}});var wa=C(js=>{"use strict";Kt();Hs();var ES=He(),MS=an(),Dp=on(),zp=Vs();js.bigIntegerToUintBase64url=(r,e)=>{let t=Uint8Array.from(r.abs().toByteArray());if(t=t[0]===0?t.slice(1):t,e!=null){if(t.length>e)throw new Error("byte array longer than desired length");t=zp([new Uint8Array(e-t.length),t])}return Dp(t,"base64url")};js.base64urlToBigInteger=r=>{let e=js.base64urlToBuffer(r);return new ES.jsbn.BigInteger(Dp(e,"base16"),16)};js.base64urlToBuffer=(r,e)=>{let t=MS(r,"base64urlpad");if(e!=null){if(t.length>e)throw new Error("byte array longer than desired length");t=zp([new Uint8Array(e-t.length),t])}return t}});var Hp=C($s=>{"use strict";P0();ya();var dn=He(),{bigIntegerToUintBase64url:xi,base64urlToBigInteger:vi}=wa(),Op=an(),Up=on();$s.pkcs1ToJwk=function(r){let e=dn.asn1.fromDer(Up(r,"ascii")),t=dn.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:xi(t.n),e:xi(t.e),d:xi(t.d),p:xi(t.p),q:xi(t.q),dp:xi(t.dP),dq:xi(t.dQ),qi:xi(t.qInv),alg:"RS256",kid:"2011-04-29"}};$s.jwkToPkcs1=function(r){let e=dn.pki.privateKeyToAsn1({n:vi(r.n),e:vi(r.e),d:vi(r.d),p:vi(r.p),q:vi(r.q),dP:vi(r.dp),dQ:vi(r.dq),qInv:vi(r.qi)});return Op(dn.asn1.toDer(e).getBytes(),"ascii")};$s.pkixToJwk=function(r){let e=dn.asn1.fromDer(Up(r,"ascii")),t=dn.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:xi(t.n),e:xi(t.e),alg:"RS256",kid:"2011-04-29"}};$s.jwkToPkix=function(r){let e=dn.pki.publicKeyToAsn1({n:vi(r.n),e:vi(r.e)});return Op(dn.asn1.toDer(e).getBytes(),"ascii")}});var Xp=C((HB,Vp)=>{"use strict";ya();var Jp=He(),{base64urlToBigInteger:_S}=wa();function Gp(r,e){return e.map(t=>_S(r[t]))}function IS(r){return Jp.pki.setRsaPrivateKey(...Gp(r,["n","e","d","p","q","dp","dq","qi"]))}function AS(r){return Jp.pki.setRsaPublicKey(...Gp(r,["n","e"]))}Vp.exports={jwk2pub:AS,jwk2priv:IS}});var Wp=C(Hi=>{"use strict";var Vi=Js(),BS=ga(),kS=on(),qS=an();Hi.utils=Hp();Hi.generateKey=async function(r){let e=await Vi.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),t=await Yp(e);return{privateKey:t[0],publicKey:t[1]}};Hi.unmarshalPrivateKey=async function(r){let t=[await Vi.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await CS(r)],i=await Yp({privateKey:t[0],publicKey:t[1]});return{privateKey:i[0],publicKey:i[1]}};Hi.getRandomValues=BS;Hi.hashAndSign=async function(r,e){let t=await Vi.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),i=await Vi.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},t,Uint8Array.from(e));return new Uint8Array(i,i.byteOffset,i.byteLength)};Hi.hashAndVerify=async function(r,e,t){let i=await Vi.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return Vi.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},i,e,t)};function Yp(r){return Promise.all([Vi.get().subtle.exportKey("jwk",r.privateKey),Vi.get().subtle.exportKey("jwk",r.publicKey)])}function CS(r){return Vi.get().subtle.importKey("jwk",{kty:r.kty,n:r.n,e:r.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}var{jwk2pub:TS,jwk2priv:NS}=Xp();function Zp(r,e,t,i){let n=e?TS(r):NS(r),s=kS(Uint8Array.from(t),"ascii"),f=i(s,n);return qS(f,"ascii")}Hi.encrypt=function(r,e){return Zp(r,!0,e,(t,i)=>i.encrypt(t))};Hi.decrypt=function(r,e){return Zp(r,!1,e,(t,i)=>i.decrypt(t))}});var Sa=C((JB,jp)=>{"use strict";var PS=en(),RS=Kc();jp.exports={export:async function(r,e){let i=await RS.create().encrypt(r,e);return PS.names.base64.encode(i)}}});var r4=C((GB,$p)=>{"use strict";var Qp=Gs(),KS=Ls(),e4=jr(),t4=Xs(),LS=on();zc();Wc();var Ea=He(),Fr=Wp(),Ma=KS($f()),FS=Sa(),_a=class{constructor(e){this._key=e}async verify(e,t){return Fr.hashAndVerify(this._key,t,e)}marshal(){return Fr.utils.jwkToPkix(this._key)}get bytes(){return Ma.PublicKey.encode({Type:Ma.KeyType.RSA,Data:this.marshal()})}encrypt(e){return Fr.encrypt(this._key,e)}equals(e){return t4(this.bytes,e.bytes)}async hash(){return Qp.multihashing(this.bytes,"sha2-256")}},Qs=class{constructor(e,t){this._key=e,this._publicKey=t}genSecret(){return Fr.getRandomValues(16)}async sign(e){return Fr.hashAndSign(this._key,e)}get public(){if(!this._publicKey)throw e4(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new _a(this._publicKey)}decrypt(e){return Fr.decrypt(this._key,e)}marshal(){return Fr.utils.jwkToPkcs1(this._key)}get bytes(){return Ma.PrivateKey.encode({Type:Ma.KeyType.RSA,Data:this.marshal()})}equals(e){return t4(this.bytes,e.bytes)}async hash(){return Qp.multihashing(this.bytes,"sha2-256")}async id(){let e=await this.public.hash();return LS(e,"base58btc")}async export(e,t="pkcs-8"){if(t==="pkcs-8"){let i=new Ea.util.ByteBuffer(this.marshal()),n=Ea.asn1.fromDer(i),s=Ea.pki.privateKeyFromAsn1(n),f={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Ea.pki.encryptRsaPrivateKey(s,e,f)}else{if(t==="libp2p-key")return FS.export(this.bytes,e);throw e4(new Error(`export format '${t}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function DS(r){let e=Fr.utils.pkcs1ToJwk(r),t=await Fr.unmarshalPrivateKey(e);return new Qs(t.privateKey,t.publicKey)}function zS(r){let e=Fr.utils.pkixToJwk(r);return new _a(e)}async function OS(r){let e=await Fr.unmarshalPrivateKey(r);return new Qs(e.privateKey,e.publicKey)}async function US(r){let e=await Fr.generateKey(r);return new Qs(e.privateKey,e.publicKey)}$p.exports={RsaPublicKey:_a,RsaPrivateKey:Qs,unmarshalRsaPublicKey:zS,unmarshalRsaPrivateKey:DS,generateKeyPair:US,fromJwk:OS}});var i4=C(Gn=>{"use strict";Wc();var H0=He();Gn.publicKeyLength=H0.pki.ed25519.constants.PUBLIC_KEY_BYTE_LENGTH;Gn.privateKeyLength=H0.pki.ed25519.constants.PRIVATE_KEY_BYTE_LENGTH;Gn.generateKey=async function(){return H0.pki.ed25519.generateKeyPair()};Gn.generateKeyFromSeed=async function(r){return H0.pki.ed25519.generateKeyPair({seed:r})};Gn.hashAndSign=async function(r,e){return H0.pki.ed25519.sign({message:e,privateKey:r})};Gn.hashAndVerify=async function(r,e,t){return H0.pki.ed25519.verify({signature:e,message:t,publicKey:r})}});var o4=C((YB,n4)=>{"use strict";var s4=Gs(),HS=Ls(),VS=en(),f4=jr(),a4=Xs(),ur=i4(),Ia=HS($f()),JS=Sa(),Aa=class{constructor(e){this._key=V0(e,ur.publicKeyLength)}async verify(e,t){return ur.hashAndVerify(this._key,t,e)}marshal(){return this._key}get bytes(){return Ia.PublicKey.encode({Type:Ia.KeyType.Ed25519,Data:this.marshal()})}equals(e){return a4(this.bytes,e.bytes)}async hash(){return s4.multihashing(this.bytes,"sha2-256")}},J0=class{constructor(e,t){this._key=V0(e,ur.privateKeyLength),this._publicKey=V0(t,ur.publicKeyLength)}async sign(e){return ur.hashAndSign(this._key,e)}get public(){return new Aa(this._publicKey)}marshal(){return this._key}get bytes(){return Ia.PrivateKey.encode({Type:Ia.KeyType.Ed25519,Data:this.marshal()})}equals(e){return a4(this.bytes,e.bytes)}async hash(){return s4.multihashing(this.bytes,"sha2-256")}async id(){let e=await this.public.hash();return VS.encode("base58btc",e).toString().slice(1)}async export(e,t="libp2p-key"){if(t==="libp2p-key")return JS.export(this.bytes,e);throw f4(new Error(`export format '${t}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function GS(r){if(r.length>ur.privateKeyLength){r=V0(r,ur.privateKeyLength+ur.publicKeyLength);let i=r.slice(0,ur.privateKeyLength),n=r.slice(ur.privateKeyLength,r.length);return new J0(i,n)}r=V0(r,ur.privateKeyLength);let e=r.slice(0,ur.privateKeyLength),t=r.slice(ur.publicKeyLength);return new J0(e,t)}function XS(r){return r=V0(r,ur.publicKeyLength),new Aa(r)}async function YS(){let{privateKey:r,publicKey:e}=await ur.generateKey();return new J0(r,e)}async function ZS(r){let{privateKey:e,publicKey:t}=await ur.generateKeyFromSeed(r);return new J0(e,t)}function V0(r,e){if(r=Uint8Array.from(r||[]),r.length!==e)throw f4(new Error(`Key must be a Uint8Array of length ${e}, got ${r.length}`),"ERR_INVALID_KEY_TYPE");return r}n4.exports={Ed25519PublicKey:Aa,Ed25519PrivateKey:J0,unmarshalEd25519PrivateKey:GS,unmarshalEd25519PublicKey:XS,generateKeyPair:YS,generateKeyPairFromSeed:ZS}});var d4=C((ZB,c4)=>{var Ve={IMPOSSIBLE_CASE:"Impossible case. Please create issue.",TWEAK_ADD:"The tweak was out of range or the resulted private key is invalid",TWEAK_MUL:"The tweak was out of range or equal to zero",CONTEXT_RANDOMIZE_UNKNOW:"Unknow error on context randomization",SECKEY_INVALID:"Private Key is invalid",PUBKEY_PARSE:"Public Key could not be parsed",PUBKEY_SERIALIZE:"Public Key serialization error",PUBKEY_COMBINE:"The sum of the public keys is not valid",SIG_PARSE:"Signature could not be parsed",SIGN:"The nonce generation function failed, or the private key was invalid",RECOVER:"Public key could not be recover",ECDH:"Scalar was invalid (zero or overflow)"};function Dr(r,e){if(!r)throw new Error(e)}function ze(r,e,t){if(Dr(e instanceof Uint8Array,`Expected ${r} to be an Uint8Array`),t!==void 0)if(Array.isArray(t)){let i=t.join(", "),n=`Expected ${r} to be an Uint8Array with length [${i}]`;Dr(t.includes(e.length),n)}else{let i=`Expected ${r} to be an Uint8Array with length ${t}`;Dr(e.length===t,i)}}function Xn(r){Dr(G0(r)==="Boolean","Expected compressed to be a Boolean")}function $r(r=t=>new Uint8Array(t),e){return typeof r=="function"&&(r=r(e)),ze("output",r,e),r}function G0(r){return Object.prototype.toString.call(r).slice(8,-1)}c4.exports=r=>({contextRandomize(e){switch(Dr(e===null||e instanceof Uint8Array,"Expected seed to be an Uint8Array or null"),e!==null&&ze("seed",e,32),r.contextRandomize(e)){case 1:throw new Error(Ve.CONTEXT_RANDOMIZE_UNKNOW)}},privateKeyVerify(e){return ze("private key",e,32),r.privateKeyVerify(e)===0},privateKeyNegate(e){switch(ze("private key",e,32),r.privateKeyNegate(e)){case 0:return e;case 1:throw new Error(Ve.IMPOSSIBLE_CASE)}},privateKeyTweakAdd(e,t){switch(ze("private key",e,32),ze("tweak",t,32),r.privateKeyTweakAdd(e,t)){case 0:return e;case 1:throw new Error(Ve.TWEAK_ADD)}},privateKeyTweakMul(e,t){switch(ze("private key",e,32),ze("tweak",t,32),r.privateKeyTweakMul(e,t)){case 0:return e;case 1:throw new Error(Ve.TWEAK_MUL)}},publicKeyVerify(e){return ze("public key",e,[33,65]),r.publicKeyVerify(e)===0},publicKeyCreate(e,t=!0,i){switch(ze("private key",e,32),Xn(t),i=$r(i,t?33:65),r.publicKeyCreate(i,e)){case 0:return i;case 1:throw new Error(Ve.SECKEY_INVALID);case 2:throw new Error(Ve.PUBKEY_SERIALIZE)}},publicKeyConvert(e,t=!0,i){switch(ze("public key",e,[33,65]),Xn(t),i=$r(i,t?33:65),r.publicKeyConvert(i,e)){case 0:return i;case 1:throw new Error(Ve.PUBKEY_PARSE);case 2:throw new Error(Ve.PUBKEY_SERIALIZE)}},publicKeyNegate(e,t=!0,i){switch(ze("public key",e,[33,65]),Xn(t),i=$r(i,t?33:65),r.publicKeyNegate(i,e)){case 0:return i;case 1:throw new Error(Ve.PUBKEY_PARSE);case 2:throw new Error(Ve.IMPOSSIBLE_CASE);case 3:throw new Error(Ve.PUBKEY_SERIALIZE)}},publicKeyCombine(e,t=!0,i){Dr(Array.isArray(e),"Expected public keys to be an Array"),Dr(e.length>0,"Expected public keys array will have more than zero items");for(let n of e)ze("public key",n,[33,65]);switch(Xn(t),i=$r(i,t?33:65),r.publicKeyCombine(i,e)){case 0:return i;case 1:throw new Error(Ve.PUBKEY_PARSE);case 2:throw new Error(Ve.PUBKEY_COMBINE);case 3:throw new Error(Ve.PUBKEY_SERIALIZE)}},publicKeyTweakAdd(e,t,i=!0,n){switch(ze("public key",e,[33,65]),ze("tweak",t,32),Xn(i),n=$r(n,i?33:65),r.publicKeyTweakAdd(n,e,t)){case 0:return n;case 1:throw new Error(Ve.PUBKEY_PARSE);case 2:throw new Error(Ve.TWEAK_ADD)}},publicKeyTweakMul(e,t,i=!0,n){switch(ze("public key",e,[33,65]),ze("tweak",t,32),Xn(i),n=$r(n,i?33:65),r.publicKeyTweakMul(n,e,t)){case 0:return n;case 1:throw new Error(Ve.PUBKEY_PARSE);case 2:throw new Error(Ve.TWEAK_MUL)}},signatureNormalize(e){switch(ze("signature",e,64),r.signatureNormalize(e)){case 0:return e;case 1:throw new Error(Ve.SIG_PARSE)}},signatureExport(e,t){ze("signature",e,64),t=$r(t,72);let i={output:t,outputlen:72};switch(r.signatureExport(i,e)){case 0:return t.slice(0,i.outputlen);case 1:throw new Error(Ve.SIG_PARSE);case 2:throw new Error(Ve.IMPOSSIBLE_CASE)}},signatureImport(e,t){switch(ze("signature",e),t=$r(t,64),r.signatureImport(t,e)){case 0:return t;case 1:throw new Error(Ve.SIG_PARSE);case 2:throw new Error(Ve.IMPOSSIBLE_CASE)}},ecdsaSign(e,t,i={},n){ze("message",e,32),ze("private key",t,32),Dr(G0(i)==="Object","Expected options to be an Object"),i.data!==void 0&&ze("options.data",i.data),i.noncefn!==void 0&&Dr(G0(i.noncefn)==="Function","Expected options.noncefn to be a Function"),n=$r(n,64);let s={signature:n,recid:null};switch(r.ecdsaSign(s,e,t,i.data,i.noncefn)){case 0:return s;case 1:throw new Error(Ve.SIGN);case 2:throw new Error(Ve.IMPOSSIBLE_CASE)}},ecdsaVerify(e,t,i){switch(ze("signature",e,64),ze("message",t,32),ze("public key",i,[33,65]),r.ecdsaVerify(e,t,i)){case 0:return!0;case 3:return!1;case 1:throw new Error(Ve.SIG_PARSE);case 2:throw new Error(Ve.PUBKEY_PARSE)}},ecdsaRecover(e,t,i,n=!0,s){switch(ze("signature",e,64),Dr(G0(t)==="Number"&&t>=0&&t<=3,"Expected recovery id to be a Number within interval [0, 3]"),ze("message",i,32),Xn(n),s=$r(s,n?33:65),r.ecdsaRecover(s,e,t,i)){case 0:return s;case 1:throw new Error(Ve.SIG_PARSE);case 2:throw new Error(Ve.RECOVER);case 3:throw new Error(Ve.IMPOSSIBLE_CASE)}},ecdh(e,t,i={},n){switch(ze("public key",e,[33,65]),ze("private key",t,32),Dr(G0(i)==="Object","Expected options to be an Object"),i.data!==void 0&&ze("options.data",i.data),i.hashfn!==void 0?(Dr(G0(i.hashfn)==="Function","Expected options.hashfn to be a Function"),i.xbuf!==void 0&&ze("options.xbuf",i.xbuf,32),i.ybuf!==void 0&&ze("options.ybuf",i.ybuf,32),ze("output",n)):n=$r(n,32),r.ecdh(n,e,t,i.data,i.hashfn,i.xbuf,i.ybuf)){case 0:return n;case 1:throw new Error(Ve.PUBKEY_PARSE);case 2:throw new Error(Ve.ECDH)}}})});var u4=C((WB,h4)=>{h4.exports={name:"elliptic",version:"6.5.4",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git@github.com:indutny/elliptic"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Fedor Indutny <fedor@indutny.com>",license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies:{"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}});var gi=C((l4,$c)=>{(function(r,e){"use strict";function t(B,b){if(!B)throw new Error(b||"Assertion failed")}function i(B,b){B.super_=b;var m=function(){};m.prototype=b.prototype,B.prototype=new m,B.prototype.constructor=B}function n(B,b,m){if(B!==null&&typeof B=="object"&&Array.isArray(B.words))return B;this.negative=0,this.words=null,this.length=0,this.red=null,B!==null&&((b==="le"||b==="be")&&(m=b,b=10),this._init(B||0,b||10,m||"be"))}typeof r=="object"?r.exports=n:e.BN=n,n.BN=n,n.wordSize=26,n.max=function(b,m){return b.cmp(m)>0?b:m},n.min=function(b,m){return b.cmp(m)<0?b:m},n.prototype._init=function(b,m,w){if(typeof b=="number")return this._initNumber(b,m,w);if(typeof b=="object")return this._initArray(b,m,w);m==="hex"&&(m=16),t(m===(m|0)&&m>=2&&m<=36),b=b.toString().replace(/\s+/g,"");var S=0;b[0]==="-"&&S++,m===16?this._parseHex(b,S):this._parseBase(b,m,S),b[0]==="-"&&(this.negative=1),this.strip(),w==="le"&&this._initArray(this.toArray(),m,w)},n.prototype._initNumber=function(b,m,w){b<0&&(this.negative=1,b=-b),b<67108864?(this.words=[b&67108863],this.length=1):b<4503599627370496?(this.words=[b&67108863,b/67108864&67108863],this.length=2):(t(b<9007199254740992),this.words=[b&67108863,b/67108864&67108863,1],this.length=3),w==="le"&&this._initArray(this.toArray(),m,w)},n.prototype._initArray=function(b,m,w){if(t(typeof b.length=="number"),b.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(b.length/3),this.words=new Array(this.length);for(var S=0;S<this.length;S++)this.words[S]=0;var I=0;if(w==="be")for(var S=b.length-1,q=0;S>=0;S-=3){var h=b[S]|b[S-1]<<8|b[S-2]<<16;this.words[q]|=h<<I&67108863,this.words[q+1]=h>>>26-I&67108863,I+=24,I>=26&&(I-=26,q++)}else if(w==="le")for(var S=0,q=0;S<b.length;S+=3){var h=b[S]|b[S+1]<<8|b[S+2]<<16;this.words[q]|=h<<I&67108863,this.words[q+1]=h>>>26-I&67108863,I+=24,I>=26&&(I-=26,q++)}return this.strip()};function s(B,b,m){for(var w=0,S=Math.min(B.length,m),I=b;I<S;I++){var q=B.charCodeAt(I)-48;w<<=4,q>=49&&q<=54?w|=q-49+10:q>=17&&q<=22?w|=q-17+10:w|=q&15}return w}n.prototype._parseHex=function(b,m){this.length=Math.ceil((b.length-m)/6),this.words=new Array(this.length);for(var w=0;w<this.length;w++)this.words[w]=0;for(var S=0,w=b.length-6,I=0;w>=m;w-=6){var q=s(b,w,w+6);this.words[I]|=q<<S&67108863,this.words[I+1]|=q>>>26-S&4194303,S+=24,S>=26&&(S-=26,I++)}if(w+6!==m){var q=s(b,m,w+6);this.words[I]|=q<<S&67108863,this.words[I+1]|=q>>>26-S&4194303}this.strip()};function f(B,b,m,w){for(var S=0,I=Math.min(B.length,m),q=b;q<I;q++){var h=B.charCodeAt(q)-48;S*=w,h>=49?S+=h-49+10:h>=17?S+=h-17+10:S+=h}return S}n.prototype._parseBase=function(b,m,w){this.words=[0],this.length=1;for(var S=0,I=1;I<=67108863;I*=m)S++;S--,I=I/m|0;for(var q=b.length-w,h=q%S,_=Math.min(q,q-h)+w,l=0,A=w;A<_;A+=S)l=f(b,A,A+S,m),this.imuln(I),this.words[0]+l<67108864?this.words[0]+=l:this._iaddn(l);if(h!==0){for(var W=1,l=f(b,A,b.length,m),A=0;A<h;A++)W*=m;this.imuln(W),this.words[0]+l<67108864?this.words[0]+=l:this._iaddn(l)}},n.prototype.copy=function(b){b.words=new Array(this.length);for(var m=0;m<this.length;m++)b.words[m]=this.words[m];b.length=this.length,b.negative=this.negative,b.red=this.red},n.prototype.clone=function(){var b=new n(null);return this.copy(b),b},n.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},n.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var a=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],o=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],c=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];n.prototype.toString=function(b,m){b=b||10;var m=m|0||1;if(b===16||b==="hex"){for(var w="",S=0,I=0,q=0;q<this.length;q++){var h=this.words[q],_=((h<<S|I)&16777215).toString(16);I=h>>>24-S&16777215,I!==0||q!==this.length-1?w=a[6-_.length]+_+w:w=_+w,S+=2,S>=26&&(S-=26,q--)}for(I!==0&&(w=I.toString(16)+w);w.length%m!=0;)w="0"+w;return this.negative!==0&&(w="-"+w),w}else if(b===(b|0)&&b>=2&&b<=36){var l=o[b],A=c[b],w="",W=this.clone();for(W.negative=0;W.cmpn(0)!==0;){var $=W.modn(A).toString(b);W=W.idivn(A),W.cmpn(0)!==0?w=a[l-$.length]+$+w:w=$+w}for(this.cmpn(0)===0&&(w="0"+w);w.length%m!=0;)w="0"+w;return this.negative!==0&&(w="-"+w),w}else t(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){return t(this.bitLength()<=53,"Number can only safely store up to 53 bits"),parseInt(this.toString(),10)},n.prototype.toJSON=function(){return this.toString(16)},n.prototype.toArray=function(b,m){this.strip();var w=b==="le",S=new Array(this.byteLength());S[0]=0;var I=this.clone();if(w)for(var q=0;I.cmpn(0)!==0;q++){var h=I.andln(255);I.iushrn(8),S[q]=h}else for(var q=0;I.cmpn(0)!==0;q++){var h=I.andln(255);I.iushrn(8),S[S.length-q-1]=h}if(m)for(t(S.length<=m,"byte array longer than desired length");S.length<m;)w?S.push(0):S.unshift(0);return S},Math.clz32?n.prototype._countBits=function(b){return 32-Math.clz32(b)}:n.prototype._countBits=function(b){var m=b,w=0;return m>=4096&&(w+=13,m>>>=13),m>=64&&(w+=7,m>>>=7),m>=8&&(w+=4,m>>>=4),m>=2&&(w+=2,m>>>=2),w+m},n.prototype._zeroBits=function(b){if(b===0)return 26;var m=b,w=0;return(m&8191)==0&&(w+=13,m>>>=13),(m&127)==0&&(w+=7,m>>>=7),(m&15)==0&&(w+=4,m>>>=4),(m&3)==0&&(w+=2,m>>>=2),(m&1)==0&&w++,w},n.prototype.bitLength=function(){var b=0,m=this.words[this.length-1],b=this._countBits(m);return(this.length-1)*26+b};function d(B){for(var b=new Array(B.bitLength()),m=0;m<b.length;m++){var w=m/26|0,S=m%26;b[m]=(B.words[w]&1<<S)>>>S}return b}n.prototype.zeroBits=function(){if(this.cmpn(0)===0)return 0;for(var b=0,m=0;m<this.length;m++){var w=this._zeroBits(this.words[m]);if(b+=w,w!==26)break}return b},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.isNeg=function(){return this.negative!==0},n.prototype.neg=function(){if(this.cmpn(0)===0)return this.clone();var b=this.clone();return b.negative=this.negative^1,b},n.prototype.ineg=function(){return this.negative^=1,this},n.prototype.iuor=function(b){for(;this.length<b.length;)this.words[this.length++]=0;for(var m=0;m<b.length;m++)this.words[m]=this.words[m]|b.words[m];return this.strip()},n.prototype.ior=function(b){return t((this.negative|b.negative)==0),this.iuor(b)},n.prototype.or=function(b){return this.length>b.length?this.clone().ior(b):b.clone().ior(this)},n.prototype.uor=function(b){return this.length>b.length?this.clone().iuor(b):b.clone().iuor(this)},n.prototype.iuand=function(b){var m;this.length>b.length?m=b:m=this;for(var w=0;w<m.length;w++)this.words[w]=this.words[w]&b.words[w];return this.length=m.length,this.strip()},n.prototype.iand=function(b){return t((this.negative|b.negative)==0),this.iuand(b)},n.prototype.and=function(b){return this.length>b.length?this.clone().iand(b):b.clone().iand(this)},n.prototype.uand=function(b){return this.length>b.length?this.clone().iuand(b):b.clone().iuand(this)},n.prototype.iuxor=function(b){var m,w;this.length>b.length?(m=this,w=b):(m=b,w=this);for(var S=0;S<w.length;S++)this.words[S]=m.words[S]^w.words[S];if(this!==m)for(;S<m.length;S++)this.words[S]=m.words[S];return this.length=m.length,this.strip()},n.prototype.ixor=function(b){return t((this.negative|b.negative)==0),this.iuxor(b)},n.prototype.xor=function(b){return this.length>b.length?this.clone().ixor(b):b.clone().ixor(this)},n.prototype.uxor=function(b){return this.length>b.length?this.clone().iuxor(b):b.clone().iuxor(this)},n.prototype.setn=function(b,m){t(typeof b=="number"&&b>=0);for(var w=b/26|0,S=b%26;this.length<=w;)this.words[this.length++]=0;return m?this.words[w]=this.words[w]|1<<S:this.words[w]=this.words[w]&~(1<<S),this.strip()},n.prototype.iadd=function(b){if(this.negative!==0&&b.negative===0){this.negative=0;var m=this.isub(b);return this.negative^=1,this._normSign()}else if(this.negative===0&&b.negative!==0){b.negative=0;var m=this.isub(b);return b.negative=1,m._normSign()}var w,S;this.length>b.length?(w=this,S=b):(w=b,S=this);for(var I=0,q=0;q<S.length;q++){var m=(w.words[q]|0)+(S.words[q]|0)+I;this.words[q]=m&67108863,I=m>>>26}for(;I!==0&&q<w.length;q++){var m=(w.words[q]|0)+I;this.words[q]=m&67108863,I=m>>>26}if(this.length=w.length,I!==0)this.words[this.length]=I,this.length++;else if(w!==this)for(;q<w.length;q++)this.words[q]=w.words[q];return this},n.prototype.add=function(b){if(b.negative!==0&&this.negative===0){b.negative=0;var m=this.sub(b);return b.negative^=1,m}else if(b.negative===0&&this.negative!==0){this.negative=0;var m=b.sub(this);return this.negative=1,m}return this.length>b.length?this.clone().iadd(b):b.clone().iadd(this)},n.prototype.isub=function(b){if(b.negative!==0){b.negative=0;var m=this.iadd(b);return b.negative=1,m._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(b),this.negative=1,this._normSign();var w=this.cmp(b);if(w===0)return this.negative=0,this.length=1,this.words[0]=0,this;var S,I;w>0?(S=this,I=b):(S=b,I=this);for(var q=0,h=0;h<I.length;h++){var m=(S.words[h]|0)-(I.words[h]|0)+q;q=m>>26,this.words[h]=m&67108863}for(;q!==0&&h<S.length;h++){var m=(S.words[h]|0)+q;q=m>>26,this.words[h]=m&67108863}if(q===0&&h<S.length&&S!==this)for(;h<S.length;h++)this.words[h]=S.words[h];return this.length=Math.max(this.length,h),S!==this&&(this.negative=1),this.strip()},n.prototype.sub=function(b){return this.clone().isub(b)};function u(B,b,m){m.negative=b.negative^B.negative;var w=B.length+b.length|0;m.length=w,w=w-1|0;var S=B.words[0]|0,I=b.words[0]|0,q=S*I,h=q&67108863,_=q/67108864|0;m.words[0]=h;for(var l=1;l<w;l++){for(var A=_>>>26,W=_&67108863,$=Math.min(l,b.length-1),Y=Math.max(0,l-B.length+1);Y<=$;Y++){var j=l-Y|0,S=B.words[j]|0,I=b.words[Y]|0,q=S*I,h=q&67108863;A=A+(q/67108864|0)|0,h=h+W|0,W=h&67108863,A=A+(h>>>26)|0}m.words[l]=W|0,_=A|0}return _!==0?m.words[l]=_|0:m.length--,m.strip()}var p=function(b,m,w){var S=b.words,I=m.words,q=w.words,h=0,_,l,A,W=S[0]|0,$=W&8191,Y=W>>>13,j=S[1]|0,de=j&8191,te=j>>>13,pe=S[2]|0,ye=pe&8191,re=pe>>>13,Be=S[3]|0,ke=Be&8191,se=Be>>>13,qe=S[4]|0,Ce=qe&8191,fe=qe>>>13,Te=S[5]|0,Ne=Te&8191,Se=Te>>>13,_t=S[6]|0,It=_t&8191,Ee=_t>>>13,At=S[7]|0,Bt=At&8191,Me=At>>>13,kt=S[8]|0,qt=kt&8191,_e=kt>>>13,Ct=S[9]|0,Tt=Ct&8191,Ie=Ct>>>13,Nt=I[0]|0,ie=Nt&8191,T=Nt>>>13,v=I[1]|0,N=v&8191,ot=v>>>13,d0=I[2]|0,ct=d0&8191,dt=d0>>>13,h0=I[3]|0,ht=h0&8191,ut=h0>>>13,u0=I[4]|0,lt=u0&8191,bt=u0>>>13,l0=I[5]|0,pt=l0&8191,yt=l0>>>13,b0=I[6]|0,mt=b0&8191,xt=b0>>>13,p0=I[7]|0,vt=p0&8191,gt=p0>>>13,nh=I[8]|0,Dt=nh&8191,zt=nh>>>13,sh=I[9]|0,Ot=sh&8191,Ut=sh>>>13;w.length=19;var Bn=h;h=0,_=Math.imul($,ie),l=Math.imul($,T),l=l+Math.imul(Y,ie)|0,A=Math.imul(Y,T),Bn=Bn+_|0,Bn=Bn+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Bn>>>26)|0,Bn&=67108863;var kr=h;h=0,_=Math.imul(de,ie),l=Math.imul(de,T),l=l+Math.imul(te,ie)|0,A=Math.imul(te,T),kr=kr+_|0,kr=kr+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(kr>>>26)|0,kr&=67108863,_=Math.imul($,N),l=Math.imul($,ot),l=l+Math.imul(Y,N)|0,A=Math.imul(Y,ot),kr=kr+_|0,kr=kr+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(kr>>>26)|0,kr&=67108863;var Vt=h;h=0,_=Math.imul(ye,ie),l=Math.imul(ye,T),l=l+Math.imul(re,ie)|0,A=Math.imul(re,T),Vt=Vt+_|0,Vt=Vt+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Vt>>>26)|0,Vt&=67108863,_=Math.imul(de,N),l=Math.imul(de,ot),l=l+Math.imul(te,N)|0,A=Math.imul(te,ot),Vt=Vt+_|0,Vt=Vt+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Vt>>>26)|0,Vt&=67108863,_=Math.imul($,ct),l=Math.imul($,dt),l=l+Math.imul(Y,ct)|0,A=Math.imul(Y,dt),Vt=Vt+_|0,Vt=Vt+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Vt>>>26)|0,Vt&=67108863;var nt=h;h=0,_=Math.imul(ke,ie),l=Math.imul(ke,T),l=l+Math.imul(se,ie)|0,A=Math.imul(se,T),nt=nt+_|0,nt=nt+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(nt>>>26)|0,nt&=67108863,_=Math.imul(ye,N),l=Math.imul(ye,ot),l=l+Math.imul(re,N)|0,A=Math.imul(re,ot),nt=nt+_|0,nt=nt+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(nt>>>26)|0,nt&=67108863,_=Math.imul(de,ct),l=Math.imul(de,dt),l=l+Math.imul(te,ct)|0,A=Math.imul(te,dt),nt=nt+_|0,nt=nt+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(nt>>>26)|0,nt&=67108863,_=Math.imul($,ht),l=Math.imul($,ut),l=l+Math.imul(Y,ht)|0,A=Math.imul(Y,ut),nt=nt+_|0,nt=nt+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(nt>>>26)|0,nt&=67108863;var Je=h;h=0,_=Math.imul(Ce,ie),l=Math.imul(Ce,T),l=l+Math.imul(fe,ie)|0,A=Math.imul(fe,T),Je=Je+_|0,Je=Je+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Je>>>26)|0,Je&=67108863,_=Math.imul(ke,N),l=Math.imul(ke,ot),l=l+Math.imul(se,N)|0,A=Math.imul(se,ot),Je=Je+_|0,Je=Je+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Je>>>26)|0,Je&=67108863,_=Math.imul(ye,ct),l=Math.imul(ye,dt),l=l+Math.imul(re,ct)|0,A=Math.imul(re,dt),Je=Je+_|0,Je=Je+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Je>>>26)|0,Je&=67108863,_=Math.imul(de,ht),l=Math.imul(de,ut),l=l+Math.imul(te,ht)|0,A=Math.imul(te,ut),Je=Je+_|0,Je=Je+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Je>>>26)|0,Je&=67108863,_=Math.imul($,lt),l=Math.imul($,bt),l=l+Math.imul(Y,lt)|0,A=Math.imul(Y,bt),Je=Je+_|0,Je=Je+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Je>>>26)|0,Je&=67108863;var Pe=h;h=0,_=Math.imul(Ne,ie),l=Math.imul(Ne,T),l=l+Math.imul(Se,ie)|0,A=Math.imul(Se,T),Pe=Pe+_|0,Pe=Pe+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Pe>>>26)|0,Pe&=67108863,_=Math.imul(Ce,N),l=Math.imul(Ce,ot),l=l+Math.imul(fe,N)|0,A=Math.imul(fe,ot),Pe=Pe+_|0,Pe=Pe+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Pe>>>26)|0,Pe&=67108863,_=Math.imul(ke,ct),l=Math.imul(ke,dt),l=l+Math.imul(se,ct)|0,A=Math.imul(se,dt),Pe=Pe+_|0,Pe=Pe+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Pe>>>26)|0,Pe&=67108863,_=Math.imul(ye,ht),l=Math.imul(ye,ut),l=l+Math.imul(re,ht)|0,A=Math.imul(re,ut),Pe=Pe+_|0,Pe=Pe+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Pe>>>26)|0,Pe&=67108863,_=Math.imul(de,lt),l=Math.imul(de,bt),l=l+Math.imul(te,lt)|0,A=Math.imul(te,bt),Pe=Pe+_|0,Pe=Pe+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Pe>>>26)|0,Pe&=67108863,_=Math.imul($,pt),l=Math.imul($,yt),l=l+Math.imul(Y,pt)|0,A=Math.imul(Y,yt),Pe=Pe+_|0,Pe=Pe+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Pe>>>26)|0,Pe&=67108863;var me=h;h=0,_=Math.imul(It,ie),l=Math.imul(It,T),l=l+Math.imul(Ee,ie)|0,A=Math.imul(Ee,T),me=me+_|0,me=me+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(me>>>26)|0,me&=67108863,_=Math.imul(Ne,N),l=Math.imul(Ne,ot),l=l+Math.imul(Se,N)|0,A=Math.imul(Se,ot),me=me+_|0,me=me+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(me>>>26)|0,me&=67108863,_=Math.imul(Ce,ct),l=Math.imul(Ce,dt),l=l+Math.imul(fe,ct)|0,A=Math.imul(fe,dt),me=me+_|0,me=me+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(me>>>26)|0,me&=67108863,_=Math.imul(ke,ht),l=Math.imul(ke,ut),l=l+Math.imul(se,ht)|0,A=Math.imul(se,ut),me=me+_|0,me=me+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(me>>>26)|0,me&=67108863,_=Math.imul(ye,lt),l=Math.imul(ye,bt),l=l+Math.imul(re,lt)|0,A=Math.imul(re,bt),me=me+_|0,me=me+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(me>>>26)|0,me&=67108863,_=Math.imul(de,pt),l=Math.imul(de,yt),l=l+Math.imul(te,pt)|0,A=Math.imul(te,yt),me=me+_|0,me=me+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(me>>>26)|0,me&=67108863,_=Math.imul($,mt),l=Math.imul($,xt),l=l+Math.imul(Y,mt)|0,A=Math.imul(Y,xt),me=me+_|0,me=me+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(me>>>26)|0,me&=67108863;var le=h;h=0,_=Math.imul(Bt,ie),l=Math.imul(Bt,T),l=l+Math.imul(Me,ie)|0,A=Math.imul(Me,T),le=le+_|0,le=le+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(le>>>26)|0,le&=67108863,_=Math.imul(It,N),l=Math.imul(It,ot),l=l+Math.imul(Ee,N)|0,A=Math.imul(Ee,ot),le=le+_|0,le=le+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(le>>>26)|0,le&=67108863,_=Math.imul(Ne,ct),l=Math.imul(Ne,dt),l=l+Math.imul(Se,ct)|0,A=Math.imul(Se,dt),le=le+_|0,le=le+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(le>>>26)|0,le&=67108863,_=Math.imul(Ce,ht),l=Math.imul(Ce,ut),l=l+Math.imul(fe,ht)|0,A=Math.imul(fe,ut),le=le+_|0,le=le+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(le>>>26)|0,le&=67108863,_=Math.imul(ke,lt),l=Math.imul(ke,bt),l=l+Math.imul(se,lt)|0,A=Math.imul(se,bt),le=le+_|0,le=le+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(le>>>26)|0,le&=67108863,_=Math.imul(ye,pt),l=Math.imul(ye,yt),l=l+Math.imul(re,pt)|0,A=Math.imul(re,yt),le=le+_|0,le=le+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(le>>>26)|0,le&=67108863,_=Math.imul(de,mt),l=Math.imul(de,xt),l=l+Math.imul(te,mt)|0,A=Math.imul(te,xt),le=le+_|0,le=le+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(le>>>26)|0,le&=67108863,_=Math.imul($,vt),l=Math.imul($,gt),l=l+Math.imul(Y,vt)|0,A=Math.imul(Y,gt),le=le+_|0,le=le+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(le>>>26)|0,le&=67108863;var oe=h;h=0,_=Math.imul(qt,ie),l=Math.imul(qt,T),l=l+Math.imul(_e,ie)|0,A=Math.imul(_e,T),oe=oe+_|0,oe=oe+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(oe>>>26)|0,oe&=67108863,_=Math.imul(Bt,N),l=Math.imul(Bt,ot),l=l+Math.imul(Me,N)|0,A=Math.imul(Me,ot),oe=oe+_|0,oe=oe+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(oe>>>26)|0,oe&=67108863,_=Math.imul(It,ct),l=Math.imul(It,dt),l=l+Math.imul(Ee,ct)|0,A=Math.imul(Ee,dt),oe=oe+_|0,oe=oe+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(oe>>>26)|0,oe&=67108863,_=Math.imul(Ne,ht),l=Math.imul(Ne,ut),l=l+Math.imul(Se,ht)|0,A=Math.imul(Se,ut),oe=oe+_|0,oe=oe+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(oe>>>26)|0,oe&=67108863,_=Math.imul(Ce,lt),l=Math.imul(Ce,bt),l=l+Math.imul(fe,lt)|0,A=Math.imul(fe,bt),oe=oe+_|0,oe=oe+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(oe>>>26)|0,oe&=67108863,_=Math.imul(ke,pt),l=Math.imul(ke,yt),l=l+Math.imul(se,pt)|0,A=Math.imul(se,yt),oe=oe+_|0,oe=oe+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(oe>>>26)|0,oe&=67108863,_=Math.imul(ye,mt),l=Math.imul(ye,xt),l=l+Math.imul(re,mt)|0,A=Math.imul(re,xt),oe=oe+_|0,oe=oe+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(oe>>>26)|0,oe&=67108863,_=Math.imul(de,vt),l=Math.imul(de,gt),l=l+Math.imul(te,vt)|0,A=Math.imul(te,gt),oe=oe+_|0,oe=oe+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(oe>>>26)|0,oe&=67108863,_=Math.imul($,Dt),l=Math.imul($,zt),l=l+Math.imul(Y,Dt)|0,A=Math.imul(Y,zt),oe=oe+_|0,oe=oe+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(oe>>>26)|0,oe&=67108863;var ne=h;h=0,_=Math.imul(Tt,ie),l=Math.imul(Tt,T),l=l+Math.imul(Ie,ie)|0,A=Math.imul(Ie,T),ne=ne+_|0,ne=ne+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(ne>>>26)|0,ne&=67108863,_=Math.imul(qt,N),l=Math.imul(qt,ot),l=l+Math.imul(_e,N)|0,A=Math.imul(_e,ot),ne=ne+_|0,ne=ne+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(ne>>>26)|0,ne&=67108863,_=Math.imul(Bt,ct),l=Math.imul(Bt,dt),l=l+Math.imul(Me,ct)|0,A=Math.imul(Me,dt),ne=ne+_|0,ne=ne+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(ne>>>26)|0,ne&=67108863,_=Math.imul(It,ht),l=Math.imul(It,ut),l=l+Math.imul(Ee,ht)|0,A=Math.imul(Ee,ut),ne=ne+_|0,ne=ne+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(ne>>>26)|0,ne&=67108863,_=Math.imul(Ne,lt),l=Math.imul(Ne,bt),l=l+Math.imul(Se,lt)|0,A=Math.imul(Se,bt),ne=ne+_|0,ne=ne+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(ne>>>26)|0,ne&=67108863,_=Math.imul(Ce,pt),l=Math.imul(Ce,yt),l=l+Math.imul(fe,pt)|0,A=Math.imul(fe,yt),ne=ne+_|0,ne=ne+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(ne>>>26)|0,ne&=67108863,_=Math.imul(ke,mt),l=Math.imul(ke,xt),l=l+Math.imul(se,mt)|0,A=Math.imul(se,xt),ne=ne+_|0,ne=ne+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(ne>>>26)|0,ne&=67108863,_=Math.imul(ye,vt),l=Math.imul(ye,gt),l=l+Math.imul(re,vt)|0,A=Math.imul(re,gt),ne=ne+_|0,ne=ne+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(ne>>>26)|0,ne&=67108863,_=Math.imul(de,Dt),l=Math.imul(de,zt),l=l+Math.imul(te,Dt)|0,A=Math.imul(te,zt),ne=ne+_|0,ne=ne+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(ne>>>26)|0,ne&=67108863,_=Math.imul($,Ot),l=Math.imul($,Ut),l=l+Math.imul(Y,Ot)|0,A=Math.imul(Y,Ut),ne=ne+_|0,ne=ne+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(ne>>>26)|0,ne&=67108863;var ce=h;h=0,_=Math.imul(Tt,N),l=Math.imul(Tt,ot),l=l+Math.imul(Ie,N)|0,A=Math.imul(Ie,ot),ce=ce+_|0,ce=ce+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(ce>>>26)|0,ce&=67108863,_=Math.imul(qt,ct),l=Math.imul(qt,dt),l=l+Math.imul(_e,ct)|0,A=Math.imul(_e,dt),ce=ce+_|0,ce=ce+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(ce>>>26)|0,ce&=67108863,_=Math.imul(Bt,ht),l=Math.imul(Bt,ut),l=l+Math.imul(Me,ht)|0,A=Math.imul(Me,ut),ce=ce+_|0,ce=ce+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(ce>>>26)|0,ce&=67108863,_=Math.imul(It,lt),l=Math.imul(It,bt),l=l+Math.imul(Ee,lt)|0,A=Math.imul(Ee,bt),ce=ce+_|0,ce=ce+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(ce>>>26)|0,ce&=67108863,_=Math.imul(Ne,pt),l=Math.imul(Ne,yt),l=l+Math.imul(Se,pt)|0,A=Math.imul(Se,yt),ce=ce+_|0,ce=ce+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(ce>>>26)|0,ce&=67108863,_=Math.imul(Ce,mt),l=Math.imul(Ce,xt),l=l+Math.imul(fe,mt)|0,A=Math.imul(fe,xt),ce=ce+_|0,ce=ce+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(ce>>>26)|0,ce&=67108863,_=Math.imul(ke,vt),l=Math.imul(ke,gt),l=l+Math.imul(se,vt)|0,A=Math.imul(se,gt),ce=ce+_|0,ce=ce+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(ce>>>26)|0,ce&=67108863,_=Math.imul(ye,Dt),l=Math.imul(ye,zt),l=l+Math.imul(re,Dt)|0,A=Math.imul(re,zt),ce=ce+_|0,ce=ce+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(ce>>>26)|0,ce&=67108863,_=Math.imul(de,Ot),l=Math.imul(de,Ut),l=l+Math.imul(te,Ot)|0,A=Math.imul(te,Ut),ce=ce+_|0,ce=ce+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(ce>>>26)|0,ce&=67108863;var be=h;h=0,_=Math.imul(Tt,ct),l=Math.imul(Tt,dt),l=l+Math.imul(Ie,ct)|0,A=Math.imul(Ie,dt),be=be+_|0,be=be+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(be>>>26)|0,be&=67108863,_=Math.imul(qt,ht),l=Math.imul(qt,ut),l=l+Math.imul(_e,ht)|0,A=Math.imul(_e,ut),be=be+_|0,be=be+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(be>>>26)|0,be&=67108863,_=Math.imul(Bt,lt),l=Math.imul(Bt,bt),l=l+Math.imul(Me,lt)|0,A=Math.imul(Me,bt),be=be+_|0,be=be+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(be>>>26)|0,be&=67108863,_=Math.imul(It,pt),l=Math.imul(It,yt),l=l+Math.imul(Ee,pt)|0,A=Math.imul(Ee,yt),be=be+_|0,be=be+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(be>>>26)|0,be&=67108863,_=Math.imul(Ne,mt),l=Math.imul(Ne,xt),l=l+Math.imul(Se,mt)|0,A=Math.imul(Se,xt),be=be+_|0,be=be+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(be>>>26)|0,be&=67108863,_=Math.imul(Ce,vt),l=Math.imul(Ce,gt),l=l+Math.imul(fe,vt)|0,A=Math.imul(fe,gt),be=be+_|0,be=be+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(be>>>26)|0,be&=67108863,_=Math.imul(ke,Dt),l=Math.imul(ke,zt),l=l+Math.imul(se,Dt)|0,A=Math.imul(se,zt),be=be+_|0,be=be+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(be>>>26)|0,be&=67108863,_=Math.imul(ye,Ot),l=Math.imul(ye,Ut),l=l+Math.imul(re,Ot)|0,A=Math.imul(re,Ut),be=be+_|0,be=be+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(be>>>26)|0,be&=67108863;var xe=h;h=0,_=Math.imul(Tt,ht),l=Math.imul(Tt,ut),l=l+Math.imul(Ie,ht)|0,A=Math.imul(Ie,ut),xe=xe+_|0,xe=xe+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(xe>>>26)|0,xe&=67108863,_=Math.imul(qt,lt),l=Math.imul(qt,bt),l=l+Math.imul(_e,lt)|0,A=Math.imul(_e,bt),xe=xe+_|0,xe=xe+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(xe>>>26)|0,xe&=67108863,_=Math.imul(Bt,pt),l=Math.imul(Bt,yt),l=l+Math.imul(Me,pt)|0,A=Math.imul(Me,yt),xe=xe+_|0,xe=xe+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(xe>>>26)|0,xe&=67108863,_=Math.imul(It,mt),l=Math.imul(It,xt),l=l+Math.imul(Ee,mt)|0,A=Math.imul(Ee,xt),xe=xe+_|0,xe=xe+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(xe>>>26)|0,xe&=67108863,_=Math.imul(Ne,vt),l=Math.imul(Ne,gt),l=l+Math.imul(Se,vt)|0,A=Math.imul(Se,gt),xe=xe+_|0,xe=xe+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(xe>>>26)|0,xe&=67108863,_=Math.imul(Ce,Dt),l=Math.imul(Ce,zt),l=l+Math.imul(fe,Dt)|0,A=Math.imul(fe,zt),xe=xe+_|0,xe=xe+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(xe>>>26)|0,xe&=67108863,_=Math.imul(ke,Ot),l=Math.imul(ke,Ut),l=l+Math.imul(se,Ot)|0,A=Math.imul(se,Ut),xe=xe+_|0,xe=xe+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(xe>>>26)|0,xe&=67108863;var Re=h;h=0,_=Math.imul(Tt,lt),l=Math.imul(Tt,bt),l=l+Math.imul(Ie,lt)|0,A=Math.imul(Ie,bt),Re=Re+_|0,Re=Re+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Re>>>26)|0,Re&=67108863,_=Math.imul(qt,pt),l=Math.imul(qt,yt),l=l+Math.imul(_e,pt)|0,A=Math.imul(_e,yt),Re=Re+_|0,Re=Re+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Re>>>26)|0,Re&=67108863,_=Math.imul(Bt,mt),l=Math.imul(Bt,xt),l=l+Math.imul(Me,mt)|0,A=Math.imul(Me,xt),Re=Re+_|0,Re=Re+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Re>>>26)|0,Re&=67108863,_=Math.imul(It,vt),l=Math.imul(It,gt),l=l+Math.imul(Ee,vt)|0,A=Math.imul(Ee,gt),Re=Re+_|0,Re=Re+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Re>>>26)|0,Re&=67108863,_=Math.imul(Ne,Dt),l=Math.imul(Ne,zt),l=l+Math.imul(Se,Dt)|0,A=Math.imul(Se,zt),Re=Re+_|0,Re=Re+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Re>>>26)|0,Re&=67108863,_=Math.imul(Ce,Ot),l=Math.imul(Ce,Ut),l=l+Math.imul(fe,Ot)|0,A=Math.imul(fe,Ut),Re=Re+_|0,Re=Re+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Re>>>26)|0,Re&=67108863;var Ge=h;h=0,_=Math.imul(Tt,pt),l=Math.imul(Tt,yt),l=l+Math.imul(Ie,pt)|0,A=Math.imul(Ie,yt),Ge=Ge+_|0,Ge=Ge+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Ge>>>26)|0,Ge&=67108863,_=Math.imul(qt,mt),l=Math.imul(qt,xt),l=l+Math.imul(_e,mt)|0,A=Math.imul(_e,xt),Ge=Ge+_|0,Ge=Ge+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Ge>>>26)|0,Ge&=67108863,_=Math.imul(Bt,vt),l=Math.imul(Bt,gt),l=l+Math.imul(Me,vt)|0,A=Math.imul(Me,gt),Ge=Ge+_|0,Ge=Ge+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Ge>>>26)|0,Ge&=67108863,_=Math.imul(It,Dt),l=Math.imul(It,zt),l=l+Math.imul(Ee,Dt)|0,A=Math.imul(Ee,zt),Ge=Ge+_|0,Ge=Ge+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Ge>>>26)|0,Ge&=67108863,_=Math.imul(Ne,Ot),l=Math.imul(Ne,Ut),l=l+Math.imul(Se,Ot)|0,A=Math.imul(Se,Ut),Ge=Ge+_|0,Ge=Ge+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Ge>>>26)|0,Ge&=67108863;var st=h;h=0,_=Math.imul(Tt,mt),l=Math.imul(Tt,xt),l=l+Math.imul(Ie,mt)|0,A=Math.imul(Ie,xt),st=st+_|0,st=st+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(st>>>26)|0,st&=67108863,_=Math.imul(qt,vt),l=Math.imul(qt,gt),l=l+Math.imul(_e,vt)|0,A=Math.imul(_e,gt),st=st+_|0,st=st+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(st>>>26)|0,st&=67108863,_=Math.imul(Bt,Dt),l=Math.imul(Bt,zt),l=l+Math.imul(Me,Dt)|0,A=Math.imul(Me,zt),st=st+_|0,st=st+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(st>>>26)|0,st&=67108863,_=Math.imul(It,Ot),l=Math.imul(It,Ut),l=l+Math.imul(Ee,Ot)|0,A=Math.imul(Ee,Ut),st=st+_|0,st=st+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(st>>>26)|0,st&=67108863;var Jt=h;h=0,_=Math.imul(Tt,vt),l=Math.imul(Tt,gt),l=l+Math.imul(Ie,vt)|0,A=Math.imul(Ie,gt),Jt=Jt+_|0,Jt=Jt+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Jt>>>26)|0,Jt&=67108863,_=Math.imul(qt,Dt),l=Math.imul(qt,zt),l=l+Math.imul(_e,Dt)|0,A=Math.imul(_e,zt),Jt=Jt+_|0,Jt=Jt+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Jt>>>26)|0,Jt&=67108863,_=Math.imul(Bt,Ot),l=Math.imul(Bt,Ut),l=l+Math.imul(Me,Ot)|0,A=Math.imul(Me,Ut),Jt=Jt+_|0,Jt=Jt+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(Jt>>>26)|0,Jt&=67108863;var qr=h;h=0,_=Math.imul(Tt,Dt),l=Math.imul(Tt,zt),l=l+Math.imul(Ie,Dt)|0,A=Math.imul(Ie,zt),qr=qr+_|0,qr=qr+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(qr>>>26)|0,qr&=67108863,_=Math.imul(qt,Ot),l=Math.imul(qt,Ut),l=l+Math.imul(_e,Ot)|0,A=Math.imul(_e,Ut),qr=qr+_|0,qr=qr+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(qr>>>26)|0,qr&=67108863;var kn=h;return h=0,_=Math.imul(Tt,Ot),l=Math.imul(Tt,Ut),l=l+Math.imul(Ie,Ot)|0,A=Math.imul(Ie,Ut),kn=kn+_|0,kn=kn+((l&8191)<<13)|0,h=h+A|0,h=h+(l>>>13)|0,h=h+(kn>>>26)|0,kn&=67108863,q[0]=Bn,q[1]=kr,q[2]=Vt,q[3]=nt,q[4]=Je,q[5]=Pe,q[6]=me,q[7]=le,q[8]=oe,q[9]=ne,q[10]=ce,q[11]=be,q[12]=xe,q[13]=Re,q[14]=Ge,q[15]=st,q[16]=Jt,q[17]=qr,q[18]=kn,h!==0&&(q[19]=h,w.length++),w};Math.imul||(p=u);function x(B,b,m){m.negative=b.negative^B.negative,m.length=B.length+b.length;for(var w=0,S=0,I=0;I<m.length-1;I++){var q=S;S=0;for(var h=w&67108863,_=Math.min(I,b.length-1),l=Math.max(0,I-B.length+1);l<=_;l++){var A=I-l,W=B.words[A]|0,$=b.words[l]|0,Y=W*$,j=Y&67108863;q=q+(Y/67108864|0)|0,j=j+h|0,h=j&67108863,q=q+(j>>>26)|0,S+=q>>>26,q&=67108863}m.words[I]=h,w=q,q=S}return w!==0?m.words[I]=w:m.length--,m.strip()}function y(B,b,m){var w=new g;return w.mulp(B,b,m)}n.prototype.mulTo=function(b,m){var w,S=this.length+b.length;return this.length===10&&b.length===10?w=p(this,b,m):S<63?w=u(this,b,m):S<1024?w=x(this,b,m):w=y(this,b,m),w};function g(B,b){this.x=B,this.y=b}g.prototype.makeRBT=function(b){for(var m=new Array(b),w=n.prototype._countBits(b)-1,S=0;S<b;S++)m[S]=this.revBin(S,w,b);return m},g.prototype.revBin=function(b,m,w){if(b===0||b===w-1)return b;for(var S=0,I=0;I<m;I++)S|=(b&1)<<m-I-1,b>>=1;return S},g.prototype.permute=function(b,m,w,S,I,q){for(var h=0;h<q;h++)S[h]=m[b[h]],I[h]=w[b[h]]},g.prototype.transform=function(b,m,w,S,I,q){this.permute(q,b,m,w,S,I);for(var h=1;h<I;h<<=1)for(var _=h<<1,l=Math.cos(2*Math.PI/_),A=Math.sin(2*Math.PI/_),W=0;W<I;W+=_)for(var $=l,Y=A,j=0;j<h;j++){var de=w[W+j],te=S[W+j],pe=w[W+j+h],ye=S[W+j+h],re=$*pe-Y*ye;ye=$*ye+Y*pe,pe=re,w[W+j]=de+pe,S[W+j]=te+ye,w[W+j+h]=de-pe,S[W+j+h]=te-ye,j!==_&&(re=l*$-A*Y,Y=l*Y+A*$,$=re)}},g.prototype.guessLen13b=function(b,m){var w=Math.max(m,b)|1,S=w&1,I=0;for(w=w/2|0;w;w=w>>>1)I++;return 1<<I+1+S},g.prototype.conjugate=function(b,m,w){if(!(w<=1))for(var S=0;S<w/2;S++){var I=b[S];b[S]=b[w-S-1],b[w-S-1]=I,I=m[S],m[S]=-m[w-S-1],m[w-S-1]=-I}},g.prototype.normalize13b=function(b,m){for(var w=0,S=0;S<m/2;S++){var I=Math.round(b[2*S+1]/m)*8192+Math.round(b[2*S]/m)+w;b[S]=I&67108863,I<67108864?w=0:w=I/67108864|0}return b},g.prototype.convert13b=function(b,m,w,S){for(var I=0,q=0;q<m;q++){var I=I+(b[q]|0);w[2*q]=I&8191,I=I>>>13,w[2*q+1]=I&8191,I=I>>>13}for(var q=2*m;q<S;++q)w[q]=0;t(I===0),t((I&~8191)==0)},g.prototype.stub=function(b){for(var m=new Array(b),w=0;w<b;w++)m[w]=0;return m},g.prototype.mulp=function(b,m,w){var S=2*this.guessLen13b(b.length,m.length),I=this.makeRBT(S),q=this.stub(S),h=new Array(S),_=new Array(S),l=new Array(S),A=new Array(S),W=new Array(S),$=new Array(S),Y=w.words;Y.length=S,this.convert13b(b.words,b.length,h,S),this.convert13b(m.words,m.length,A,S),this.transform(h,q,_,l,S,I),this.transform(A,q,W,$,S,I);for(var j=0;j<S;j++){var de=_[j]*W[j]-l[j]*$[j];l[j]=_[j]*$[j]+l[j]*W[j],_[j]=de}return this.conjugate(_,l,S),this.transform(_,l,Y,q,S,I),this.conjugate(Y,q,S),this.normalize13b(Y,S),w.negative=b.negative^m.negative,w.length=b.length+m.length,w.strip()},n.prototype.mul=function(b){var m=new n(null);return m.words=new Array(this.length+b.length),this.mulTo(b,m)},n.prototype.mulf=function(b){var m=new n(null);return m.words=new Array(this.length+b.length),y(this,b,m)},n.prototype.imul=function(b){return this.clone().mulTo(b,this)},n.prototype.imuln=function(b){t(typeof b=="number");for(var m=0,w=0;w<this.length;w++){var S=(this.words[w]|0)*b,I=(S&67108863)+(m&67108863);m>>=26,m+=S/67108864|0,m+=I>>>26,this.words[w]=I&67108863}return m!==0&&(this.words[w]=m,this.length++),this},n.prototype.muln=function(b){return this.clone().imuln(b)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(b){var m=d(b);if(m.length===0)return new n(1);for(var w=this,S=0;S<m.length&&m[S]===0;S++,w=w.sqr());if(++S<m.length)for(var I=w.sqr();S<m.length;S++,I=I.sqr())m[S]!==0&&(w=w.mul(I));return w},n.prototype.iushln=function(b){t(typeof b=="number"&&b>=0);var m=b%26,w=(b-m)/26,S=67108863>>>26-m<<26-m;if(m!==0){for(var I=0,q=0;q<this.length;q++){var h=this.words[q]&S,_=(this.words[q]|0)-h<<m;this.words[q]=_|I,I=h>>>26-m}I&&(this.words[q]=I,this.length++)}if(w!==0){for(var q=this.length-1;q>=0;q--)this.words[q+w]=this.words[q];for(var q=0;q<w;q++)this.words[q]=0;this.length+=w}return this.strip()},n.prototype.ishln=function(b){return t(this.negative===0),this.iushln(b)},n.prototype.iushrn=function(b,m,w){t(typeof b=="number"&&b>=0);var S;m?S=(m-m%26)/26:S=0;var I=b%26,q=Math.min((b-I)/26,this.length),h=67108863^67108863>>>I<<I,_=w;if(S-=q,S=Math.max(0,S),_){for(var l=0;l<q;l++)_.words[l]=this.words[l];_.length=q}if(q!==0)if(this.length>q){this.length-=q;for(var l=0;l<this.length;l++)this.words[l]=this.words[l+q]}else this.words[0]=0,this.length=1;for(var A=0,l=this.length-1;l>=0&&(A!==0||l>=S);l--){var W=this.words[l]|0;this.words[l]=A<<26-I|W>>>I,A=W&h}return _&&A!==0&&(_.words[_.length++]=A),this.length===0&&(this.words[0]=0,this.length=1),this.strip(),this},n.prototype.ishrn=function(b,m,w){return t(this.negative===0),this.iushrn(b,m,w)},n.prototype.shln=function(b){return this.clone().ishln(b)},n.prototype.ushln=function(b){return this.clone().iushln(b)},n.prototype.shrn=function(b){return this.clone().ishrn(b)},n.prototype.ushrn=function(b){return this.clone().iushrn(b)},n.prototype.testn=function(b){t(typeof b=="number"&&b>=0);var m=b%26,w=(b-m)/26,S=1<<m;if(this.length<=w)return!1;var I=this.words[w];return!!(I&S)},n.prototype.imaskn=function(b){t(typeof b=="number"&&b>=0);var m=b%26,w=(b-m)/26;if(t(this.negative===0,"imaskn works only with positive numbers"),m!==0&&w++,this.length=Math.min(w,this.length),m!==0){var S=67108863^67108863>>>m<<m;this.words[this.length-1]&=S}return this.strip()},n.prototype.maskn=function(b){return this.clone().imaskn(b)},n.prototype.iaddn=function(b){return t(typeof b=="number"),b<0?this.isubn(-b):this.negative!==0?this.length===1&&(this.words[0]|0)<b?(this.words[0]=b-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(b),this.negative=1,this):this._iaddn(b)},n.prototype._iaddn=function(b){this.words[0]+=b;for(var m=0;m<this.length&&this.words[m]>=67108864;m++)this.words[m]-=67108864,m===this.length-1?this.words[m+1]=1:this.words[m+1]++;return this.length=Math.max(this.length,m+1),this},n.prototype.isubn=function(b){if(t(typeof b=="number"),b<0)return this.iaddn(-b);if(this.negative!==0)return this.negative=0,this.iaddn(b),this.negative=1,this;this.words[0]-=b;for(var m=0;m<this.length&&this.words[m]<0;m++)this.words[m]+=67108864,this.words[m+1]-=1;return this.strip()},n.prototype.addn=function(b){return this.clone().iaddn(b)},n.prototype.subn=function(b){return this.clone().isubn(b)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(b,m,w){var S=b.length+w,I;if(this.words.length<S){for(var q=new Array(S),I=0;I<this.length;I++)q[I]=this.words[I];this.words=q}else I=this.length;for(this.length=Math.max(this.length,S);I<this.length;I++)this.words[I]=0;for(var h=0,I=0;I<b.length;I++){var _=(this.words[I+w]|0)+h,l=(b.words[I]|0)*m;_-=l&67108863,h=(_>>26)-(l/67108864|0),this.words[I+w]=_&67108863}for(;I<this.length-w;I++){var _=(this.words[I+w]|0)+h;h=_>>26,this.words[I+w]=_&67108863}if(h===0)return this.strip();t(h===-1),h=0;for(var I=0;I<this.length;I++){var _=-(this.words[I]|0)+h;h=_>>26,this.words[I]=_&67108863}return this.negative=1,this.strip()},n.prototype._wordDiv=function(b,m){var w=this.length-b.length,S=this.clone(),I=b,q=I.words[I.length-1]|0,h=this._countBits(q);w=26-h,w!==0&&(I=I.ushln(w),S.iushln(w),q=I.words[I.length-1]|0);var _=S.length-I.length,l;if(m!=="mod"){l=new n(null),l.length=_+1,l.words=new Array(l.length);for(var A=0;A<l.length;A++)l.words[A]=0}var W=S.clone()._ishlnsubmul(I,1,_);W.negative===0&&(S=W,l&&(l.words[_]=1));for(var $=_-1;$>=0;$--){var Y=(S.words[I.length+$]|0)*67108864+(S.words[I.length+$-1]|0);for(Y=Math.min(Y/q|0,67108863),S._ishlnsubmul(I,Y,$);S.negative!==0;)Y--,S.negative=0,S._ishlnsubmul(I,1,$),S.cmpn(0)!==0&&(S.negative^=1);l&&(l.words[$]=Y)}return l&&l.strip(),S.strip(),m!=="div"&&w!==0&&S.iushrn(w),{div:l||null,mod:S}},n.prototype.divmod=function(b,m,w){if(t(b.cmpn(0)!==0),this.negative!==0&&b.negative===0){var S=this.neg().divmod(b,m),I,q;return m!=="mod"&&(I=S.div.neg()),m!=="div"&&(q=S.mod.neg(),w&&q.neg&&(q=q.add(b))),{div:I,mod:q}}else if(this.negative===0&&b.negative!==0){var S=this.divmod(b.neg(),m),I;return m!=="mod"&&(I=S.div.neg()),{div:I,mod:S.mod}}else if((this.negative&b.negative)!=0){var S=this.neg().divmod(b.neg(),m),q;return m!=="div"&&(q=S.mod.neg(),w&&q.neg&&(q=q.isub(b))),{div:S.div,mod:q}}return b.length>this.length||this.cmp(b)<0?{div:new n(0),mod:this}:b.length===1?m==="div"?{div:this.divn(b.words[0]),mod:null}:m==="mod"?{div:null,mod:new n(this.modn(b.words[0]))}:{div:this.divn(b.words[0]),mod:new n(this.modn(b.words[0]))}:this._wordDiv(b,m)},n.prototype.div=function(b){return this.divmod(b,"div",!1).div},n.prototype.mod=function(b){return this.divmod(b,"mod",!1).mod},n.prototype.umod=function(b){return this.divmod(b,"mod",!0).mod},n.prototype.divRound=function(b){var m=this.divmod(b);if(m.mod.cmpn(0)===0)return m.div;var w=m.div.negative!==0?m.mod.isub(b):m.mod,S=b.ushrn(1),I=b.andln(1),q=w.cmp(S);return q<0||I===1&&q===0?m.div:m.div.negative!==0?m.div.isubn(1):m.div.iaddn(1)},n.prototype.modn=function(b){t(b<=67108863);for(var m=(1<<26)%b,w=0,S=this.length-1;S>=0;S--)w=(m*w+(this.words[S]|0))%b;return w},n.prototype.idivn=function(b){t(b<=67108863);for(var m=0,w=this.length-1;w>=0;w--){var S=(this.words[w]|0)+m*67108864;this.words[w]=S/b|0,m=S%b}return this.strip()},n.prototype.divn=function(b){return this.clone().idivn(b)},n.prototype.egcd=function(b){t(b.negative===0),t(b.cmpn(0)!==0);var m=this,w=b.clone();m.negative!==0?m=m.umod(b):m=m.clone();for(var S=new n(1),I=new n(0),q=new n(0),h=new n(1),_=0;m.isEven()&&w.isEven();)m.iushrn(1),w.iushrn(1),++_;for(var l=w.clone(),A=m.clone();m.cmpn(0)!==0;){for(;m.isEven();)m.iushrn(1),S.isEven()&&I.isEven()?(S.iushrn(1),I.iushrn(1)):(S.iadd(l).iushrn(1),I.isub(A).iushrn(1));for(;w.isEven();)w.iushrn(1),q.isEven()&&h.isEven()?(q.iushrn(1),h.iushrn(1)):(q.iadd(l).iushrn(1),h.isub(A).iushrn(1));m.cmp(w)>=0?(m.isub(w),S.isub(q),I.isub(h)):(w.isub(m),q.isub(S),h.isub(I))}return{a:q,b:h,gcd:w.iushln(_)}},n.prototype._invmp=function(b){t(b.negative===0),t(b.cmpn(0)!==0);var m=this,w=b.clone();m.negative!==0?m=m.umod(b):m=m.clone();for(var S=new n(1),I=new n(0),q=w.clone();m.cmpn(1)>0&&w.cmpn(1)>0;){for(;m.isEven();)m.iushrn(1),S.isEven()?S.iushrn(1):S.iadd(q).iushrn(1);for(;w.isEven();)w.iushrn(1),I.isEven()?I.iushrn(1):I.iadd(q).iushrn(1);m.cmp(w)>=0?(m.isub(w),S.isub(I)):(w.isub(m),I.isub(S))}var h;return m.cmpn(1)===0?h=S:h=I,h.cmpn(0)<0&&h.iadd(b),h},n.prototype.gcd=function(b){if(this.cmpn(0)===0)return b.clone();if(b.cmpn(0)===0)return this.clone();var m=this.clone(),w=b.clone();m.negative=0,w.negative=0;for(var S=0;m.isEven()&&w.isEven();S++)m.iushrn(1),w.iushrn(1);do{for(;m.isEven();)m.iushrn(1);for(;w.isEven();)w.iushrn(1);var I=m.cmp(w);if(I<0){var q=m;m=w,w=q}else if(I===0||w.cmpn(1)===0)break;m.isub(w)}while(!0);return w.iushln(S)},n.prototype.invm=function(b){return this.egcd(b).a.umod(b)},n.prototype.isEven=function(){return(this.words[0]&1)==0},n.prototype.isOdd=function(){return(this.words[0]&1)==1},n.prototype.andln=function(b){return this.words[0]&b},n.prototype.bincn=function(b){t(typeof b=="number");var m=b%26,w=(b-m)/26,S=1<<m;if(this.length<=w){for(var I=this.length;I<w+1;I++)this.words[I]=0;return this.words[w]|=S,this.length=w+1,this}for(var q=S,I=w;q!==0&&I<this.length;I++){var h=this.words[I]|0;h+=q,q=h>>>26,h&=67108863,this.words[I]=h}return q!==0&&(this.words[I]=q,this.length++),this},n.prototype.cmpn=function(b){var m=b<0;if(m&&(b=-b),this.negative!==0&&!m)return-1;if(this.negative===0&&m)return 1;b&=67108863,this.strip();var w;if(this.length>1)w=1;else{var S=this.words[0]|0;w=S===b?0:S<b?-1:1}return this.negative!==0&&(w=-w),w},n.prototype.cmp=function(b){if(this.negative!==0&&b.negative===0)return-1;if(this.negative===0&&b.negative!==0)return 1;var m=this.ucmp(b);return this.negative!==0?-m:m},n.prototype.ucmp=function(b){if(this.length>b.length)return 1;if(this.length<b.length)return-1;for(var m=0,w=this.length-1;w>=0;w--){var S=this.words[w]|0,I=b.words[w]|0;if(S!==I){S<I?m=-1:S>I&&(m=1);break}}return m},n.red=function(b){return new F(b)},n.prototype.toRed=function(b){return t(!this.red,"Already a number in reduction context"),t(this.negative===0,"red works only with positives"),b.convertTo(this)._forceRed(b)},n.prototype.fromRed=function(){return t(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(b){return this.red=b,this},n.prototype.forceRed=function(b){return t(!this.red,"Already a number in reduction context"),this._forceRed(b)},n.prototype.redAdd=function(b){return t(this.red,"redAdd works only with red numbers"),this.red.add(this,b)},n.prototype.redIAdd=function(b){return t(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,b)},n.prototype.redSub=function(b){return t(this.red,"redSub works only with red numbers"),this.red.sub(this,b)},n.prototype.redISub=function(b){return t(this.red,"redISub works only with red numbers"),this.red.isub(this,b)},n.prototype.redShl=function(b){return t(this.red,"redShl works only with red numbers"),this.red.ushl(this,b)},n.prototype.redMul=function(b){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,b),this.red.mul(this,b)},n.prototype.redIMul=function(b){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,b),this.red.imul(this,b)},n.prototype.redSqr=function(){return t(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return t(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return t(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return t(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return t(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(b){return t(this.red&&!b.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,b)};var M={k256:null,p224:null,p192:null,p25519:null};function k(B,b){this.name=B,this.p=new n(b,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}k.prototype._tmp=function(){var b=new n(null);return b.words=new Array(Math.ceil(this.n/13)),b},k.prototype.ireduce=function(b){var m=b,w;do this.split(m,this.tmp),m=this.imulK(m),m=m.iadd(this.tmp),w=m.bitLength();while(w>this.n);var S=w<this.n?-1:m.ucmp(this.p);return S===0?(m.words[0]=0,m.length=1):S>0?m.isub(this.p):m.strip(),m},k.prototype.split=function(b,m){b.iushrn(this.n,0,m)},k.prototype.imulK=function(b){return b.imul(this.k)};function R(){k.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}i(R,k),R.prototype.split=function(b,m){for(var w=4194303,S=Math.min(b.length,9),I=0;I<S;I++)m.words[I]=b.words[I];if(m.length=S,b.length<=9){b.words[0]=0,b.length=1;return}var q=b.words[9];m.words[m.length++]=q&w;for(var I=10;I<b.length;I++){var h=b.words[I]|0;b.words[I-10]=(h&w)<<4|q>>>22,q=h}b.words[I-10]=q>>>22,b.length-=9},R.prototype.imulK=function(b){b.words[b.length]=0,b.words[b.length+1]=0,b.length+=2;for(var m,w=0,S=0;S<b.length;S++){var I=b.words[S]|0;m=I*64,w+=I*977,m+=w/67108864|0,w&=67108863,b.words[S]=w,w=m}return b.words[b.length-1]===0&&(b.length--,b.words[b.length-1]===0&&b.length--),b};function K(){k.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}i(K,k);function L(){k.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}i(L,k);function O(){k.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}i(O,k),O.prototype.imulK=function(b){for(var m=0,w=0;w<b.length;w++){var S=(b.words[w]|0)*19+m,I=S&67108863;S>>>=26,b.words[w]=I,m=S}return m!==0&&(b.words[b.length++]=m),b},n._prime=function(b){if(M[b])return M[b];var m;if(b==="k256")m=new R;else if(b==="p224")m=new K;else if(b==="p192")m=new L;else if(b==="p25519")m=new O;else throw new Error("Unknown prime "+b);return M[b]=m,m};function F(B){if(typeof B=="string"){var b=n._prime(B);this.m=b.p,this.prime=b}else this.m=B,this.prime=null}F.prototype._verify1=function(b){t(b.negative===0,"red works only with positives"),t(b.red,"red works only with red numbers")},F.prototype._verify2=function(b,m){t((b.negative|m.negative)==0,"red works only with positives"),t(b.red&&b.red===m.red,"red works only with red numbers")},F.prototype.imod=function(b){return this.prime?this.prime.ireduce(b)._forceRed(this):b.umod(this.m)._forceRed(this)},F.prototype.neg=function(b){var m=b.clone();return m.negative^=1,m.iadd(this.m)._forceRed(this)},F.prototype.add=function(b,m){this._verify2(b,m);var w=b.add(m);return w.cmp(this.m)>=0&&w.isub(this.m),w._forceRed(this)},F.prototype.iadd=function(b,m){this._verify2(b,m);var w=b.iadd(m);return w.cmp(this.m)>=0&&w.isub(this.m),w},F.prototype.sub=function(b,m){this._verify2(b,m);var w=b.sub(m);return w.cmpn(0)<0&&w.iadd(this.m),w._forceRed(this)},F.prototype.isub=function(b,m){this._verify2(b,m);var w=b.isub(m);return w.cmpn(0)<0&&w.iadd(this.m),w},F.prototype.shl=function(b,m){return this._verify1(b),this.imod(b.ushln(m))},F.prototype.imul=function(b,m){return this._verify2(b,m),this.imod(b.imul(m))},F.prototype.mul=function(b,m){return this._verify2(b,m),this.imod(b.mul(m))},F.prototype.isqr=function(b){return this.imul(b,b)},F.prototype.sqr=function(b){return this.mul(b,b)},F.prototype.sqrt=function(b){if(b.cmpn(0)===0)return b.clone();var m=this.m.andln(3);if(t(m%2==1),m===3){var w=this.m.add(new n(1)).iushrn(2),W=this.pow(b,w);return W}for(var S=this.m.subn(1),I=0;S.cmpn(0)!==0&&S.andln(1)===0;)I++,S.iushrn(1);t(S.cmpn(0)!==0);var q=new n(1).toRed(this),h=q.redNeg(),_=this.m.subn(1).iushrn(1),l=this.m.bitLength();for(l=new n(2*l*l).toRed(this);this.pow(l,_).cmp(h)!==0;)l.redIAdd(h);for(var A=this.pow(l,S),W=this.pow(b,S.addn(1).iushrn(1)),$=this.pow(b,S),Y=I;$.cmp(q)!==0;){for(var j=$,de=0;j.cmp(q)!==0;de++)j=j.redSqr();t(de<Y);var te=this.pow(A,new n(1).iushln(Y-de-1));W=W.redMul(te),A=te.redSqr(),$=$.redMul(A),Y=de}return W},F.prototype.invm=function(b){var m=b._invmp(this.m);return m.negative!==0?(m.negative=0,this.imod(m).redNeg()):this.imod(m)},F.prototype.pow=function(b,m){if(m.cmpn(0)===0)return new n(1);if(m.cmpn(1)===0)return b.clone();var w=4,S=new Array(1<<w);S[0]=new n(1).toRed(this),S[1]=b;for(var I=2;I<S.length;I++)S[I]=this.mul(S[I-1],b);var q=S[0],h=0,_=0,l=m.bitLength()%26;l===0&&(l=26);for(var I=m.length-1;I>=0;I--){for(var A=m.words[I],W=l-1;W>=0;W--){var $=A>>W&1;if(q!==S[0]&&(q=this.sqr(q)),$===0&&h===0){_=0;continue}h<<=1,h|=$,_++,!(_!==w&&(I!==0||W!==0))&&(q=this.mul(q,S[h]),_=0,h=0)}l=26}return q},F.prototype.convertTo=function(b){var m=b.umod(this.m);return m===b?m.clone():m},F.prototype.convertFrom=function(b){var m=b.clone();return m.red=null,m},n.mont=function(b){return new G(b)};function G(B){F.call(this,B),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}i(G,F),G.prototype.convertTo=function(b){return this.imod(b.ushln(this.shift))},G.prototype.convertFrom=function(b){var m=this.imod(b.mul(this.rinv));return m.red=null,m},G.prototype.imul=function(b,m){if(b.cmpn(0)===0||m.cmpn(0)===0)return b.words[0]=0,b.length=1,b;var w=b.imul(m),S=w.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),I=w.isub(S).iushrn(this.shift),q=I;return I.cmp(this.m)>=0?q=I.isub(this.m):I.cmpn(0)<0&&(q=I.iadd(this.m)),q._forceRed(this)},G.prototype.mul=function(b,m){if(b.cmpn(0)===0||m.cmpn(0)===0)return new n(0)._forceRed(this);var w=b.mul(m),S=w.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),I=w.isub(S).iushrn(this.shift),q=I;return I.cmp(this.m)>=0?q=I.isub(this.m):I.cmpn(0)<0&&(q=I.iadd(this.m)),q._forceRed(this)},G.prototype.invm=function(b){var m=this.imod(b._invmp(this.m).mul(this.r2));return m._forceRed(this)}})(typeof $c=="undefined"||$c,l4)});var hn=C((jB,b4)=>{b4.exports=p4;function p4(r,e){if(!r)throw new Error(e||"Assertion failed")}p4.equal=function(e,t,i){if(e!=t)throw new Error(i||"Assertion failed: "+e+" != "+t)}});var Qc=C(y4=>{"use strict";var Ba=y4;function WS(r,e){if(Array.isArray(r))return r.slice();if(!r)return[];var t=[];if(typeof r!="string"){for(var i=0;i<r.length;i++)t[i]=r[i]|0;return t}if(e==="hex"){r=r.replace(/[^a-z0-9]+/ig,""),r.length%2!=0&&(r="0"+r);for(var i=0;i<r.length;i+=2)t.push(parseInt(r[i]+r[i+1],16))}else for(var i=0;i<r.length;i++){var n=r.charCodeAt(i),s=n>>8,f=n&255;s?t.push(s,f):t.push(f)}return t}Ba.toArray=WS;function m4(r){return r.length===1?"0"+r:r}Ba.zero2=m4;function x4(r){for(var e="",t=0;t<r.length;t++)e+=m4(r[t].toString(16));return e}Ba.toHex=x4;Ba.encode=function(e,t){return t==="hex"?x4(e):e}});var Tr=C(v4=>{"use strict";var Qr=v4,jS=gi(),$S=hn(),ka=Qc();Qr.assert=$S;Qr.toArray=ka.toArray;Qr.zero2=ka.zero2;Qr.toHex=ka.toHex;Qr.encode=ka.encode;function QS(r,e,t){var i=new Array(Math.max(r.bitLength(),t)+1);i.fill(0);for(var n=1<<e+1,s=r.clone(),f=0;f<i.length;f++){var a,o=s.andln(n-1);s.isOdd()?(o>(n>>1)-1?a=(n>>1)-o:a=o,s.isubn(a)):a=0,i[f]=a,s.iushrn(1)}return i}Qr.getNAF=QS;function eE(r,e){var t=[[],[]];r=r.clone(),e=e.clone();for(var i=0,n=0,s;r.cmpn(-i)>0||e.cmpn(-n)>0;){var f=r.andln(3)+i&3,a=e.andln(3)+n&3;f===3&&(f=-1),a===3&&(a=-1);var o;(f&1)==0?o=0:(s=r.andln(7)+i&7,(s===3||s===5)&&a===2?o=-f:o=f),t[0].push(o);var c;(a&1)==0?c=0:(s=e.andln(7)+n&7,(s===3||s===5)&&f===2?c=-a:c=a),t[1].push(c),2*i===o+1&&(i=1-i),2*n===c+1&&(n=1-n),r.iushrn(1),e.iushrn(1)}return t}Qr.getJSF=eE;function tE(r,e,t){var i="_"+e;r.prototype[e]=function(){return this[i]!==void 0?this[i]:this[i]=t.call(this)}}Qr.cachedProperty=tE;function rE(r){return typeof r=="string"?Qr.toArray(r,"hex"):r}Qr.parseBytes=rE;function iE(r){return new jS(r,"hex","le")}Qr.intFromLE=iE});var id=C((ek,ed)=>{var td;ed.exports=function(e){return td||(td=new un(null)),td.generate(e)};function un(r){this.rand=r}ed.exports.Rand=un;un.prototype.generate=function(e){return this._rand(e)};un.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var t=new Uint8Array(e),i=0;i<t.length;i++)t[i]=this.rand.getByte();return t};if(typeof self=="object")self.crypto&&self.crypto.getRandomValues?un.prototype._rand=function(e){var t=new Uint8Array(e);return self.crypto.getRandomValues(t),t}:self.msCrypto&&self.msCrypto.getRandomValues?un.prototype._rand=function(e){var t=new Uint8Array(e);return self.msCrypto.getRandomValues(t),t}:typeof window=="object"&&(un.prototype._rand=function(){throw new Error("Not implemented yet")});else try{if(rd=Os(),typeof rd.randomBytes!="function")throw new Error("Not supported");un.prototype._rand=function(e){return rd.randomBytes(e)}}catch(r){}var rd});var tf=C((tk,g4)=>{"use strict";var Yn=gi(),ef=Tr(),qa=ef.getNAF,nE=ef.getJSF,Ca=ef.assert;function ln(r,e){this.type=r,this.p=new Yn(e.p,16),this.red=e.prime?Yn.red(e.prime):Yn.mont(this.p),this.zero=new Yn(0).toRed(this.red),this.one=new Yn(1).toRed(this.red),this.two=new Yn(2).toRed(this.red),this.n=e.n&&new Yn(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var t=this.n&&this.p.div(this.n);!t||t.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}g4.exports=ln;ln.prototype.point=function(){throw new Error("Not implemented")};ln.prototype.validate=function(){throw new Error("Not implemented")};ln.prototype._fixedNafMul=function(e,t){Ca(e.precomputed);var i=e._getDoubles(),n=qa(t,1,this._bitLength),s=(1<<i.step+1)-(i.step%2==0?2:1);s/=3;var f=[],a,o;for(a=0;a<n.length;a+=i.step){o=0;for(var c=a+i.step-1;c>=a;c--)o=(o<<1)+n[c];f.push(o)}for(var d=this.jpoint(null,null,null),u=this.jpoint(null,null,null),p=s;p>0;p--){for(a=0;a<f.length;a++)o=f[a],o===p?u=u.mixedAdd(i.points[a]):o===-p&&(u=u.mixedAdd(i.points[a].neg()));d=d.add(u)}return d.toP()};ln.prototype._wnafMul=function(e,t){var i=4,n=e._getNAFPoints(i);i=n.wnd;for(var s=n.points,f=qa(t,i,this._bitLength),a=this.jpoint(null,null,null),o=f.length-1;o>=0;o--){for(var c=0;o>=0&&f[o]===0;o--)c++;if(o>=0&&c++,a=a.dblp(c),o<0)break;var d=f[o];Ca(d!==0),e.type==="affine"?d>0?a=a.mixedAdd(s[d-1>>1]):a=a.mixedAdd(s[-d-1>>1].neg()):d>0?a=a.add(s[d-1>>1]):a=a.add(s[-d-1>>1].neg())}return e.type==="affine"?a.toP():a};ln.prototype._wnafMulAdd=function(e,t,i,n,s){var f=this._wnafT1,a=this._wnafT2,o=this._wnafT3,c=0,d,u,p;for(d=0;d<n;d++){p=t[d];var x=p._getNAFPoints(e);f[d]=x.wnd,a[d]=x.points}for(d=n-1;d>=1;d-=2){var y=d-1,g=d;if(f[y]!==1||f[g]!==1){o[y]=qa(i[y],f[y],this._bitLength),o[g]=qa(i[g],f[g],this._bitLength),c=Math.max(o[y].length,c),c=Math.max(o[g].length,c);continue}var M=[t[y],null,null,t[g]];t[y].y.cmp(t[g].y)===0?(M[1]=t[y].add(t[g]),M[2]=t[y].toJ().mixedAdd(t[g].neg())):t[y].y.cmp(t[g].y.redNeg())===0?(M[1]=t[y].toJ().mixedAdd(t[g]),M[2]=t[y].add(t[g].neg())):(M[1]=t[y].toJ().mixedAdd(t[g]),M[2]=t[y].toJ().mixedAdd(t[g].neg()));var k=[-3,-1,-5,-7,0,7,5,1,3],R=nE(i[y],i[g]);for(c=Math.max(R[0].length,c),o[y]=new Array(c),o[g]=new Array(c),u=0;u<c;u++){var K=R[0][u]|0,L=R[1][u]|0;o[y][u]=k[(K+1)*3+(L+1)],o[g][u]=0,a[y]=M}}var O=this.jpoint(null,null,null),F=this._wnafT4;for(d=c;d>=0;d--){for(var G=0;d>=0;){var B=!0;for(u=0;u<n;u++)F[u]=o[u][d]|0,F[u]!==0&&(B=!1);if(!B)break;G++,d--}if(d>=0&&G++,O=O.dblp(G),d<0)break;for(u=0;u<n;u++){var b=F[u];b!==0&&(b>0?p=a[u][b-1>>1]:b<0&&(p=a[u][-b-1>>1].neg()),p.type==="affine"?O=O.mixedAdd(p):O=O.add(p))}}for(d=0;d<n;d++)a[d]=null;return s?O:O.toP()};function zr(r,e){this.curve=r,this.type=e,this.precomputed=null}ln.BasePoint=zr;zr.prototype.eq=function(){throw new Error("Not implemented")};zr.prototype.validate=function(){return this.curve.validate(this)};ln.prototype.decodePoint=function(e,t){e=ef.toArray(e,t);var i=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1==2*i){e[0]===6?Ca(e[e.length-1]%2==0):e[0]===7&&Ca(e[e.length-1]%2==1);var n=this.point(e.slice(1,1+i),e.slice(1+i,1+2*i));return n}else if((e[0]===2||e[0]===3)&&e.length-1===i)return this.pointFromX(e.slice(1,1+i),e[0]===3);throw new Error("Unknown point format")};zr.prototype.encodeCompressed=function(e){return this.encode(e,!0)};zr.prototype._encode=function(e){var t=this.curve.p.byteLength(),i=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",t))};zr.prototype.encode=function(e,t){return ef.encode(this._encode(t),e)};zr.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this};zr.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return t?t.points.length>=Math.ceil((e.bitLength()+1)/t.step):!1};zr.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var i=[this],n=this,s=0;s<t;s+=e){for(var f=0;f<e;f++)n=n.dbl();i.push(n)}return{step:e,points:i}};zr.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],i=(1<<e)-1,n=i===1?null:this.dbl(),s=1;s<i;s++)t[s]=t[s-1].add(n);return{wnd:e,points:t}};zr.prototype._getBeta=function(){return null};zr.prototype.dblp=function(e){for(var t=this,i=0;i<e;i++)t=t.dbl();return t}});var rf=C((rk,nd)=>{typeof Object.create=="function"?nd.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:nd.exports=function(e,t){if(t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}}});var S4=C((ik,w4)=>{"use strict";var sE=Tr(),Lt=gi(),sd=rf(),X0=tf(),fE=sE.assert;function Or(r){X0.call(this,"short",r),this.a=new Lt(r.a,16).toRed(this.red),this.b=new Lt(r.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(r),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}sd(Or,X0);w4.exports=Or;Or.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var t,i;if(e.beta)t=new Lt(e.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);t=n[0].cmp(n[1])<0?n[0]:n[1],t=t.toRed(this.red)}if(e.lambda)i=new Lt(e.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(t))===0?i=s[0]:(i=s[1],fE(this.g.mul(i).x.cmp(this.g.x.redMul(t))===0))}var f;return e.basis?f=e.basis.map(function(a){return{a:new Lt(a.a,16),b:new Lt(a.b,16)}}):f=this._getEndoBasis(i),{beta:t,lambda:i,basis:f}}};Or.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:Lt.mont(e),i=new Lt(2).toRed(t).redInvm(),n=i.redNeg(),s=new Lt(3).toRed(t).redNeg().redSqrt().redMul(i),f=n.redAdd(s).fromRed(),a=n.redSub(s).fromRed();return[f,a]};Or.prototype._getEndoBasis=function(e){for(var t=this.n.ushrn(Math.floor(this.n.bitLength()/2)),i=e,n=this.n.clone(),s=new Lt(1),f=new Lt(0),a=new Lt(0),o=new Lt(1),c,d,u,p,x,y,g,M=0,k,R;i.cmpn(0)!==0;){var K=n.div(i);k=n.sub(K.mul(i)),R=a.sub(K.mul(s));var L=o.sub(K.mul(f));if(!u&&k.cmp(t)<0)c=g.neg(),d=s,u=k.neg(),p=R;else if(u&&++M==2)break;g=k,n=i,i=k,a=s,s=R,o=f,f=L}x=k.neg(),y=R;var O=u.sqr().add(p.sqr()),F=x.sqr().add(y.sqr());return F.cmp(O)>=0&&(x=c,y=d),u.negative&&(u=u.neg(),p=p.neg()),x.negative&&(x=x.neg(),y=y.neg()),[{a:u,b:p},{a:x,b:y}]};Or.prototype._endoSplit=function(e){var t=this.endo.basis,i=t[0],n=t[1],s=n.b.mul(e).divRound(this.n),f=i.b.neg().mul(e).divRound(this.n),a=s.mul(i.a),o=f.mul(n.a),c=s.mul(i.b),d=f.mul(n.b),u=e.sub(a).sub(o),p=c.add(d).neg();return{k1:u,k2:p}};Or.prototype.pointFromX=function(e,t){e=new Lt(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),n=i.redSqrt();if(n.redSqr().redSub(i).cmp(this.zero)!==0)throw new Error("invalid point");var s=n.fromRed().isOdd();return(t&&!s||!t&&s)&&(n=n.redNeg()),this.point(e,n)};Or.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,i=e.y,n=this.a.redMul(t),s=t.redSqr().redMul(t).redIAdd(n).redIAdd(this.b);return i.redSqr().redISub(s).cmpn(0)===0};Or.prototype._endoWnafMulAdd=function(e,t,i){for(var n=this._endoWnafT1,s=this._endoWnafT2,f=0;f<e.length;f++){var a=this._endoSplit(t[f]),o=e[f],c=o._getBeta();a.k1.negative&&(a.k1.ineg(),o=o.neg(!0)),a.k2.negative&&(a.k2.ineg(),c=c.neg(!0)),n[f*2]=o,n[f*2+1]=c,s[f*2]=a.k1,s[f*2+1]=a.k2}for(var d=this._wnafMulAdd(1,n,s,f*2,i),u=0;u<f*2;u++)n[u]=null,s[u]=null;return d};function er(r,e,t,i){X0.BasePoint.call(this,r,"affine"),e===null&&t===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new Lt(e,16),this.y=new Lt(t,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}sd(er,X0.BasePoint);Or.prototype.point=function(e,t,i){return new er(this,e,t,i)};Or.prototype.pointFromJSON=function(e,t){return er.fromJSON(this,e,t)};er.prototype._getBeta=function(){if(!!this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var i=this.curve,n=function(s){return i.point(s.x.redMul(i.endo.beta),s.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(n)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(n)}}}return t}};er.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};er.fromJSON=function(e,t,i){typeof t=="string"&&(t=JSON.parse(t));var n=e.point(t[0],t[1],i);if(!t[2])return n;function s(a){return e.point(a[0],a[1],i)}var f=t[2];return n.precomputed={beta:null,doubles:f.doubles&&{step:f.doubles.step,points:[n].concat(f.doubles.points.map(s))},naf:f.naf&&{wnd:f.naf.wnd,points:[n].concat(f.naf.points.map(s))}},n};er.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};er.prototype.isInfinity=function(){return this.inf};er.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var t=this.y.redSub(e.y);t.cmpn(0)!==0&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var i=t.redSqr().redISub(this.x).redISub(e.x),n=t.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,n)};er.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var t=this.curve.a,i=this.x.redSqr(),n=e.redInvm(),s=i.redAdd(i).redIAdd(i).redIAdd(t).redMul(n),f=s.redSqr().redISub(this.x.redAdd(this.x)),a=s.redMul(this.x.redSub(f)).redISub(this.y);return this.curve.point(f,a)};er.prototype.getX=function(){return this.x.fromRed()};er.prototype.getY=function(){return this.y.fromRed()};er.prototype.mul=function(e){return e=new Lt(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)};er.prototype.mulAdd=function(e,t,i){var n=[this,t],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s):this.curve._wnafMulAdd(1,n,s,2)};er.prototype.jmulAdd=function(e,t,i){var n=[this,t],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s,!0):this.curve._wnafMulAdd(1,n,s,2,!0)};er.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)};er.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var i=this.precomputed,n=function(s){return s.neg()};t.precomputed={naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(n)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(n)}}}return t};er.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function ar(r,e,t,i){X0.BasePoint.call(this,r,"jacobian"),e===null&&t===null&&i===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new Lt(0)):(this.x=new Lt(e,16),this.y=new Lt(t,16),this.z=new Lt(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}sd(ar,X0.BasePoint);Or.prototype.jpoint=function(e,t,i){return new ar(this,e,t,i)};ar.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),i=this.x.redMul(t),n=this.y.redMul(t).redMul(e);return this.curve.point(i,n)};ar.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};ar.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),i=this.z.redSqr(),n=this.x.redMul(t),s=e.x.redMul(i),f=this.y.redMul(t.redMul(e.z)),a=e.y.redMul(i.redMul(this.z)),o=n.redSub(s),c=f.redSub(a);if(o.cmpn(0)===0)return c.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var d=o.redSqr(),u=d.redMul(o),p=n.redMul(d),x=c.redSqr().redIAdd(u).redISub(p).redISub(p),y=c.redMul(p.redISub(x)).redISub(f.redMul(u)),g=this.z.redMul(e.z).redMul(o);return this.curve.jpoint(x,y,g)};ar.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),i=this.x,n=e.x.redMul(t),s=this.y,f=e.y.redMul(t).redMul(this.z),a=i.redSub(n),o=s.redSub(f);if(a.cmpn(0)===0)return o.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var c=a.redSqr(),d=c.redMul(a),u=i.redMul(c),p=o.redSqr().redIAdd(d).redISub(u).redISub(u),x=o.redMul(u.redISub(p)).redISub(s.redMul(d)),y=this.z.redMul(a);return this.curve.jpoint(p,x,y)};ar.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var i=this;for(t=0;t<e;t++)i=i.dbl();return i}var n=this.curve.a,s=this.curve.tinv,f=this.x,a=this.y,o=this.z,c=o.redSqr().redSqr(),d=a.redAdd(a);for(t=0;t<e;t++){var u=f.redSqr(),p=d.redSqr(),x=p.redSqr(),y=u.redAdd(u).redIAdd(u).redIAdd(n.redMul(c)),g=f.redMul(p),M=y.redSqr().redISub(g.redAdd(g)),k=g.redISub(M),R=y.redMul(k);R=R.redIAdd(R).redISub(x);var K=d.redMul(o);t+1<e&&(c=c.redMul(x)),f=M,o=K,d=R}return this.curve.jpoint(f,d.redMul(s),o)};ar.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};ar.prototype._zeroDbl=function(){var e,t,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),f=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(n).redISub(f);a=a.redIAdd(a);var o=n.redAdd(n).redIAdd(n),c=o.redSqr().redISub(a).redISub(a),d=f.redIAdd(f);d=d.redIAdd(d),d=d.redIAdd(d),e=c,t=o.redMul(a.redISub(c)).redISub(d),i=this.y.redAdd(this.y)}else{var u=this.x.redSqr(),p=this.y.redSqr(),x=p.redSqr(),y=this.x.redAdd(p).redSqr().redISub(u).redISub(x);y=y.redIAdd(y);var g=u.redAdd(u).redIAdd(u),M=g.redSqr(),k=x.redIAdd(x);k=k.redIAdd(k),k=k.redIAdd(k),e=M.redISub(y).redISub(y),t=g.redMul(y.redISub(e)).redISub(k),i=this.y.redMul(this.z),i=i.redIAdd(i)}return this.curve.jpoint(e,t,i)};ar.prototype._threeDbl=function(){var e,t,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),f=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(n).redISub(f);a=a.redIAdd(a);var o=n.redAdd(n).redIAdd(n).redIAdd(this.curve.a),c=o.redSqr().redISub(a).redISub(a);e=c;var d=f.redIAdd(f);d=d.redIAdd(d),d=d.redIAdd(d),t=o.redMul(a.redISub(c)).redISub(d),i=this.y.redAdd(this.y)}else{var u=this.z.redSqr(),p=this.y.redSqr(),x=this.x.redMul(p),y=this.x.redSub(u).redMul(this.x.redAdd(u));y=y.redAdd(y).redIAdd(y);var g=x.redIAdd(x);g=g.redIAdd(g);var M=g.redAdd(g);e=y.redSqr().redISub(M),i=this.y.redAdd(this.z).redSqr().redISub(p).redISub(u);var k=p.redSqr();k=k.redIAdd(k),k=k.redIAdd(k),k=k.redIAdd(k),t=y.redMul(g.redISub(e)).redISub(k)}return this.curve.jpoint(e,t,i)};ar.prototype._dbl=function(){var e=this.curve.a,t=this.x,i=this.y,n=this.z,s=n.redSqr().redSqr(),f=t.redSqr(),a=i.redSqr(),o=f.redAdd(f).redIAdd(f).redIAdd(e.redMul(s)),c=t.redAdd(t);c=c.redIAdd(c);var d=c.redMul(a),u=o.redSqr().redISub(d.redAdd(d)),p=d.redISub(u),x=a.redSqr();x=x.redIAdd(x),x=x.redIAdd(x),x=x.redIAdd(x);var y=o.redMul(p).redISub(x),g=i.redAdd(i).redMul(n);return this.curve.jpoint(u,y,g)};ar.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),i=this.z.redSqr(),n=t.redSqr(),s=e.redAdd(e).redIAdd(e),f=s.redSqr(),a=this.x.redAdd(t).redSqr().redISub(e).redISub(n);a=a.redIAdd(a),a=a.redAdd(a).redIAdd(a),a=a.redISub(f);var o=a.redSqr(),c=n.redIAdd(n);c=c.redIAdd(c),c=c.redIAdd(c),c=c.redIAdd(c);var d=s.redIAdd(a).redSqr().redISub(f).redISub(o).redISub(c),u=t.redMul(d);u=u.redIAdd(u),u=u.redIAdd(u);var p=this.x.redMul(o).redISub(u);p=p.redIAdd(p),p=p.redIAdd(p);var x=this.y.redMul(d.redMul(c.redISub(d)).redISub(a.redMul(o)));x=x.redIAdd(x),x=x.redIAdd(x),x=x.redIAdd(x);var y=this.z.redAdd(a).redSqr().redISub(i).redISub(o);return this.curve.jpoint(p,x,y)};ar.prototype.mul=function(e,t){return e=new Lt(e,t),this.curve._wnafMul(this,e)};ar.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),i=e.z.redSqr();if(this.x.redMul(i).redISub(e.x.redMul(t)).cmpn(0)!==0)return!1;var n=t.redMul(this.z),s=i.redMul(e.z);return this.y.redMul(s).redISub(e.y.redMul(n)).cmpn(0)===0};ar.prototype.eqXToP=function(e){var t=this.z.redSqr(),i=e.toRed(this.curve.red).redMul(t);if(this.x.cmp(i)===0)return!0;for(var n=e.clone(),s=this.curve.redN.redMul(t);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(s),this.x.cmp(i)===0)return!0}};ar.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};ar.prototype.isInfinity=function(){return this.z.cmpn(0)===0}});var _4=C((nk,E4)=>{"use strict";var Y0=gi(),M4=rf(),Ta=tf(),aE=Tr();function Z0(r){Ta.call(this,"mont",r),this.a=new Y0(r.a,16).toRed(this.red),this.b=new Y0(r.b,16).toRed(this.red),this.i4=new Y0(4).toRed(this.red).redInvm(),this.two=new Y0(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}M4(Z0,Ta);E4.exports=Z0;Z0.prototype.validate=function(e){var t=e.normalize().x,i=t.redSqr(),n=i.redMul(t).redAdd(i.redMul(this.a)).redAdd(t),s=n.redSqrt();return s.redSqr().cmp(n)===0};function tr(r,e,t){Ta.BasePoint.call(this,r,"projective"),e===null&&t===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new Y0(e,16),this.z=new Y0(t,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}M4(tr,Ta.BasePoint);Z0.prototype.decodePoint=function(e,t){return this.point(aE.toArray(e,t),1)};Z0.prototype.point=function(e,t){return new tr(this,e,t)};Z0.prototype.pointFromJSON=function(e){return tr.fromJSON(this,e)};tr.prototype.precompute=function(){};tr.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};tr.fromJSON=function(e,t){return new tr(e,t[0],t[1]||e.one)};tr.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};tr.prototype.isInfinity=function(){return this.z.cmpn(0)===0};tr.prototype.dbl=function(){var e=this.x.redAdd(this.z),t=e.redSqr(),i=this.x.redSub(this.z),n=i.redSqr(),s=t.redSub(n),f=t.redMul(n),a=s.redMul(n.redAdd(this.curve.a24.redMul(s)));return this.curve.point(f,a)};tr.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};tr.prototype.diffAdd=function(e,t){var i=this.x.redAdd(this.z),n=this.x.redSub(this.z),s=e.x.redAdd(e.z),f=e.x.redSub(e.z),a=f.redMul(i),o=s.redMul(n),c=t.z.redMul(a.redAdd(o).redSqr()),d=t.x.redMul(a.redISub(o).redSqr());return this.curve.point(c,d)};tr.prototype.mul=function(e){for(var t=e.clone(),i=this,n=this.curve.point(null,null),s=this,f=[];t.cmpn(0)!==0;t.iushrn(1))f.push(t.andln(1));for(var a=f.length-1;a>=0;a--)f[a]===0?(i=i.diffAdd(n,s),n=n.dbl()):(n=i.diffAdd(n,s),i=i.dbl());return n};tr.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};tr.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};tr.prototype.eq=function(e){return this.getX().cmp(e.getX())===0};tr.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};tr.prototype.getX=function(){return this.normalize(),this.x.fromRed()}});var B4=C((sk,I4)=>{"use strict";var oE=Tr(),Ji=gi(),A4=rf(),Na=tf(),cE=oE.assert;function wi(r){this.twisted=(r.a|0)!=1,this.mOneA=this.twisted&&(r.a|0)==-1,this.extended=this.mOneA,Na.call(this,"edwards",r),this.a=new Ji(r.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new Ji(r.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new Ji(r.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),cE(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(r.c|0)==1}A4(wi,Na);I4.exports=wi;wi.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)};wi.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)};wi.prototype.jpoint=function(e,t,i,n){return this.point(e,t,i,n)};wi.prototype.pointFromX=function(e,t){e=new Ji(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),n=this.c2.redSub(this.a.redMul(i)),s=this.one.redSub(this.c2.redMul(this.d).redMul(i)),f=n.redMul(s.redInvm()),a=f.redSqrt();if(a.redSqr().redSub(f).cmp(this.zero)!==0)throw new Error("invalid point");var o=a.fromRed().isOdd();return(t&&!o||!t&&o)&&(a=a.redNeg()),this.point(e,a)};wi.prototype.pointFromY=function(e,t){e=new Ji(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),n=i.redSub(this.c2),s=i.redMul(this.d).redMul(this.c2).redSub(this.a),f=n.redMul(s.redInvm());if(f.cmp(this.zero)===0){if(t)throw new Error("invalid point");return this.point(this.zero,e)}var a=f.redSqrt();if(a.redSqr().redSub(f).cmp(this.zero)!==0)throw new Error("invalid point");return a.fromRed().isOdd()!==t&&(a=a.redNeg()),this.point(a,e)};wi.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),i=e.y.redSqr(),n=t.redMul(this.a).redAdd(i),s=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(i)));return n.cmp(s)===0};function it(r,e,t,i,n){Na.BasePoint.call(this,r,"projective"),e===null&&t===null&&i===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new Ji(e,16),this.y=new Ji(t,16),this.z=i?new Ji(i,16):this.curve.one,this.t=n&&new Ji(n,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}A4(it,Na.BasePoint);wi.prototype.pointFromJSON=function(e){return it.fromJSON(this,e)};wi.prototype.point=function(e,t,i,n){return new it(this,e,t,i,n)};it.fromJSON=function(e,t){return new it(e,t[0],t[1],t[2])};it.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};it.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};it.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),i=this.z.redSqr();i=i.redIAdd(i);var n=this.curve._mulA(e),s=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),f=n.redAdd(t),a=f.redSub(i),o=n.redSub(t),c=s.redMul(a),d=f.redMul(o),u=s.redMul(o),p=a.redMul(f);return this.curve.point(c,d,p,u)};it.prototype._projDbl=function(){var e=this.x.redAdd(this.y).redSqr(),t=this.x.redSqr(),i=this.y.redSqr(),n,s,f,a,o,c;if(this.curve.twisted){a=this.curve._mulA(t);var d=a.redAdd(i);this.zOne?(n=e.redSub(t).redSub(i).redMul(d.redSub(this.curve.two)),s=d.redMul(a.redSub(i)),f=d.redSqr().redSub(d).redSub(d)):(o=this.z.redSqr(),c=d.redSub(o).redISub(o),n=e.redSub(t).redISub(i).redMul(c),s=d.redMul(a.redSub(i)),f=d.redMul(c))}else a=t.redAdd(i),o=this.curve._mulC(this.z).redSqr(),c=a.redSub(o).redSub(o),n=this.curve._mulC(e.redISub(a)).redMul(c),s=this.curve._mulC(a).redMul(t.redISub(i)),f=a.redMul(c);return this.curve.point(n,s,f)};it.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};it.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),i=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),n=this.t.redMul(this.curve.dd).redMul(e.t),s=this.z.redMul(e.z.redAdd(e.z)),f=i.redSub(t),a=s.redSub(n),o=s.redAdd(n),c=i.redAdd(t),d=f.redMul(a),u=o.redMul(c),p=f.redMul(c),x=a.redMul(o);return this.curve.point(d,u,x,p)};it.prototype._projAdd=function(e){var t=this.z.redMul(e.z),i=t.redSqr(),n=this.x.redMul(e.x),s=this.y.redMul(e.y),f=this.curve.d.redMul(n).redMul(s),a=i.redSub(f),o=i.redAdd(f),c=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(n).redISub(s),d=t.redMul(a).redMul(c),u,p;return this.curve.twisted?(u=t.redMul(o).redMul(s.redSub(this.curve._mulA(n))),p=a.redMul(o)):(u=t.redMul(o).redMul(s.redSub(n)),p=this.curve._mulC(a).redMul(o)),this.curve.point(d,u,p)};it.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)};it.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)};it.prototype.mulAdd=function(e,t,i){return this.curve._wnafMulAdd(1,[this,t],[e,i],2,!1)};it.prototype.jmulAdd=function(e,t,i){return this.curve._wnafMulAdd(1,[this,t],[e,i],2,!0)};it.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this};it.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};it.prototype.getX=function(){return this.normalize(),this.x.fromRed()};it.prototype.getY=function(){return this.normalize(),this.y.fromRed()};it.prototype.eq=function(e){return this===e||this.getX().cmp(e.getX())===0&&this.getY().cmp(e.getY())===0};it.prototype.eqXToP=function(e){var t=e.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(t)===0)return!0;for(var i=e.clone(),n=this.curve.redN.redMul(this.z);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(n),this.x.cmp(t)===0)return!0}};it.prototype.toP=it.prototype.normalize;it.prototype.mixedAdd=it.prototype.add});var fd=C(k4=>{"use strict";var Pa=k4;Pa.base=tf();Pa.short=S4();Pa.mont=_4();Pa.edwards=B4()});var ei=C(Qe=>{"use strict";var dE=hn(),hE=rf();Qe.inherits=hE;function uE(r,e){return(r.charCodeAt(e)&64512)!=55296||e<0||e+1>=r.length?!1:(r.charCodeAt(e+1)&64512)==56320}function lE(r,e){if(Array.isArray(r))return r.slice();if(!r)return[];var t=[];if(typeof r=="string")if(e){if(e==="hex")for(r=r.replace(/[^a-z0-9]+/ig,""),r.length%2!=0&&(r="0"+r),n=0;n<r.length;n+=2)t.push(parseInt(r[n]+r[n+1],16))}else for(var i=0,n=0;n<r.length;n++){var s=r.charCodeAt(n);s<128?t[i++]=s:s<2048?(t[i++]=s>>6|192,t[i++]=s&63|128):uE(r,n)?(s=65536+((s&1023)<<10)+(r.charCodeAt(++n)&1023),t[i++]=s>>18|240,t[i++]=s>>12&63|128,t[i++]=s>>6&63|128,t[i++]=s&63|128):(t[i++]=s>>12|224,t[i++]=s>>6&63|128,t[i++]=s&63|128)}else for(n=0;n<r.length;n++)t[n]=r[n]|0;return t}Qe.toArray=lE;function bE(r){for(var e="",t=0;t<r.length;t++)e+=q4(r[t].toString(16));return e}Qe.toHex=bE;function C4(r){var e=r>>>24|r>>>8&65280|r<<8&16711680|(r&255)<<24;return e>>>0}Qe.htonl=C4;function pE(r,e){for(var t="",i=0;i<r.length;i++){var n=r[i];e==="little"&&(n=C4(n)),t+=T4(n.toString(16))}return t}Qe.toHex32=pE;function q4(r){return r.length===1?"0"+r:r}Qe.zero2=q4;function T4(r){return r.length===7?"0"+r:r.length===6?"00"+r:r.length===5?"000"+r:r.length===4?"0000"+r:r.length===3?"00000"+r:r.length===2?"000000"+r:r.length===1?"0000000"+r:r}Qe.zero8=T4;function yE(r,e,t,i){var n=t-e;dE(n%4==0);for(var s=new Array(n/4),f=0,a=e;f<s.length;f++,a+=4){var o;i==="big"?o=r[a]<<24|r[a+1]<<16|r[a+2]<<8|r[a+3]:o=r[a+3]<<24|r[a+2]<<16|r[a+1]<<8|r[a],s[f]=o>>>0}return s}Qe.join32=yE;function mE(r,e){for(var t=new Array(r.length*4),i=0,n=0;i<r.length;i++,n+=4){var s=r[i];e==="big"?(t[n]=s>>>24,t[n+1]=s>>>16&255,t[n+2]=s>>>8&255,t[n+3]=s&255):(t[n+3]=s>>>24,t[n+2]=s>>>16&255,t[n+1]=s>>>8&255,t[n]=s&255)}return t}Qe.split32=mE;function xE(r,e){return r>>>e|r<<32-e}Qe.rotr32=xE;function vE(r,e){return r<<e|r>>>32-e}Qe.rotl32=vE;function gE(r,e){return r+e>>>0}Qe.sum32=gE;function wE(r,e,t){return r+e+t>>>0}Qe.sum32_3=wE;function SE(r,e,t,i){return r+e+t+i>>>0}Qe.sum32_4=SE;function EE(r,e,t,i,n){return r+e+t+i+n>>>0}Qe.sum32_5=EE;function ME(r,e,t,i){var n=r[e],s=r[e+1],f=i+s>>>0,a=(f<i?1:0)+t+n;r[e]=a>>>0,r[e+1]=f}Qe.sum64=ME;function _E(r,e,t,i){var n=e+i>>>0,s=(n<e?1:0)+r+t;return s>>>0}Qe.sum64_hi=_E;function IE(r,e,t,i){var n=e+i;return n>>>0}Qe.sum64_lo=IE;function AE(r,e,t,i,n,s,f,a){var o=0,c=e;c=c+i>>>0,o+=c<e?1:0,c=c+s>>>0,o+=c<s?1:0,c=c+a>>>0,o+=c<a?1:0;var d=r+t+n+f+o;return d>>>0}Qe.sum64_4_hi=AE;function BE(r,e,t,i,n,s,f,a){var o=e+i+s+a;return o>>>0}Qe.sum64_4_lo=BE;function kE(r,e,t,i,n,s,f,a,o,c){var d=0,u=e;u=u+i>>>0,d+=u<e?1:0,u=u+s>>>0,d+=u<s?1:0,u=u+a>>>0,d+=u<a?1:0,u=u+c>>>0,d+=u<c?1:0;var p=r+t+n+f+o+d;return p>>>0}Qe.sum64_5_hi=kE;function qE(r,e,t,i,n,s,f,a,o,c){var d=e+i+s+a+c;return d>>>0}Qe.sum64_5_lo=qE;function CE(r,e,t){var i=e<<32-t|r>>>t;return i>>>0}Qe.rotr64_hi=CE;function TE(r,e,t){var i=r<<32-t|e>>>t;return i>>>0}Qe.rotr64_lo=TE;function NE(r,e,t){return r>>>t}Qe.shr64_hi=NE;function PE(r,e,t){var i=r<<32-t|e>>>t;return i>>>0}Qe.shr64_lo=PE});var W0=C(N4=>{"use strict";var P4=ei(),RE=hn();function Ra(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}N4.BlockHash=Ra;Ra.prototype.update=function(e,t){if(e=P4.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){e=this.pending;var i=e.length%this._delta8;this.pending=e.slice(e.length-i,e.length),this.pending.length===0&&(this.pending=null),e=P4.join32(e,0,e.length-i,this.endian);for(var n=0;n<e.length;n+=this._delta32)this._update(e,n,n+this._delta32)}return this};Ra.prototype.digest=function(e){return this.update(this._pad()),RE(this.pending===null),this._digest(e)};Ra.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,i=t-(e+this.padLength)%t,n=new Array(i+this.padLength);n[0]=128;for(var s=1;s<i;s++)n[s]=0;if(e<<=3,this.endian==="big"){for(var f=8;f<this.padLength;f++)n[s++]=0;n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=e>>>24&255,n[s++]=e>>>16&255,n[s++]=e>>>8&255,n[s++]=e&255}else for(n[s++]=e&255,n[s++]=e>>>8&255,n[s++]=e>>>16&255,n[s++]=e>>>24&255,n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=0,f=8;f<this.padLength;f++)n[s++]=0;return n}});var ad=C(Gi=>{"use strict";var KE=ei(),Si=KE.rotr32;function LE(r,e,t,i){if(r===0)return R4(e,t,i);if(r===1||r===3)return L4(e,t,i);if(r===2)return K4(e,t,i)}Gi.ft_1=LE;function R4(r,e,t){return r&e^~r&t}Gi.ch32=R4;function K4(r,e,t){return r&e^r&t^e&t}Gi.maj32=K4;function L4(r,e,t){return r^e^t}Gi.p32=L4;function FE(r){return Si(r,2)^Si(r,13)^Si(r,22)}Gi.s0_256=FE;function DE(r){return Si(r,6)^Si(r,11)^Si(r,25)}Gi.s1_256=DE;function zE(r){return Si(r,7)^Si(r,18)^r>>>3}Gi.g0_256=zE;function OE(r){return Si(r,17)^Si(r,19)^r>>>10}Gi.g1_256=OE});var z4=C((dk,F4)=>{"use strict";var j0=ei(),UE=W0(),HE=ad(),od=j0.rotl32,nf=j0.sum32,VE=j0.sum32_5,JE=HE.ft_1,D4=UE.BlockHash,GE=[1518500249,1859775393,2400959708,3395469782];function Ei(){if(!(this instanceof Ei))return new Ei;D4.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}j0.inherits(Ei,D4);F4.exports=Ei;Ei.blockSize=512;Ei.outSize=160;Ei.hmacStrength=80;Ei.padLength=64;Ei.prototype._update=function(e,t){for(var i=this.W,n=0;n<16;n++)i[n]=e[t+n];for(;n<i.length;n++)i[n]=od(i[n-3]^i[n-8]^i[n-14]^i[n-16],1);var s=this.h[0],f=this.h[1],a=this.h[2],o=this.h[3],c=this.h[4];for(n=0;n<i.length;n++){var d=~~(n/20),u=VE(od(s,5),JE(d,f,a,o),c,i[n],GE[d]);c=o,o=a,a=od(f,30),f=s,s=u}this.h[0]=nf(this.h[0],s),this.h[1]=nf(this.h[1],f),this.h[2]=nf(this.h[2],a),this.h[3]=nf(this.h[3],o),this.h[4]=nf(this.h[4],c)};Ei.prototype._digest=function(e){return e==="hex"?j0.toHex32(this.h,"big"):j0.split32(this.h,"big")}});var cd=C((hk,O4)=>{"use strict";var $0=ei(),XE=W0(),Q0=ad(),YE=hn(),ti=$0.sum32,ZE=$0.sum32_4,WE=$0.sum32_5,jE=Q0.ch32,$E=Q0.maj32,QE=Q0.s0_256,eM=Q0.s1_256,tM=Q0.g0_256,rM=Q0.g1_256,U4=XE.BlockHash,iM=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Mi(){if(!(this instanceof Mi))return new Mi;U4.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=iM,this.W=new Array(64)}$0.inherits(Mi,U4);O4.exports=Mi;Mi.blockSize=512;Mi.outSize=256;Mi.hmacStrength=192;Mi.padLength=64;Mi.prototype._update=function(e,t){for(var i=this.W,n=0;n<16;n++)i[n]=e[t+n];for(;n<i.length;n++)i[n]=ZE(rM(i[n-2]),i[n-7],tM(i[n-15]),i[n-16]);var s=this.h[0],f=this.h[1],a=this.h[2],o=this.h[3],c=this.h[4],d=this.h[5],u=this.h[6],p=this.h[7];for(YE(this.k.length===i.length),n=0;n<i.length;n++){var x=WE(p,eM(c),jE(c,d,u),this.k[n],i[n]),y=ti(QE(s),$E(s,f,a));p=u,u=d,d=c,c=ti(o,x),o=a,a=f,f=s,s=ti(x,y)}this.h[0]=ti(this.h[0],s),this.h[1]=ti(this.h[1],f),this.h[2]=ti(this.h[2],a),this.h[3]=ti(this.h[3],o),this.h[4]=ti(this.h[4],c),this.h[5]=ti(this.h[5],d),this.h[6]=ti(this.h[6],u),this.h[7]=ti(this.h[7],p)};Mi.prototype._digest=function(e){return e==="hex"?$0.toHex32(this.h,"big"):$0.split32(this.h,"big")}});var J4=C((uk,H4)=>{"use strict";var dd=ei(),V4=cd();function Xi(){if(!(this instanceof Xi))return new Xi;V4.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}dd.inherits(Xi,V4);H4.exports=Xi;Xi.blockSize=512;Xi.outSize=224;Xi.hmacStrength=192;Xi.padLength=64;Xi.prototype._digest=function(e){return e==="hex"?dd.toHex32(this.h.slice(0,7),"big"):dd.split32(this.h.slice(0,7),"big")}});var ld=C((lk,G4)=>{"use strict";var _r=ei(),nM=W0(),sM=hn(),_i=_r.rotr64_hi,Ii=_r.rotr64_lo,X4=_r.shr64_hi,Y4=_r.shr64_lo,bn=_r.sum64,hd=_r.sum64_hi,ud=_r.sum64_lo,fM=_r.sum64_4_hi,aM=_r.sum64_4_lo,oM=_r.sum64_5_hi,cM=_r.sum64_5_lo,Z4=nM.BlockHash,dM=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function ri(){if(!(this instanceof ri))return new ri;Z4.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=dM,this.W=new Array(160)}_r.inherits(ri,Z4);G4.exports=ri;ri.blockSize=1024;ri.outSize=512;ri.hmacStrength=192;ri.padLength=128;ri.prototype._prepareBlock=function(e,t){for(var i=this.W,n=0;n<32;n++)i[n]=e[t+n];for(;n<i.length;n+=2){var s=lM(i[n-4],i[n-3]),f=bM(i[n-4],i[n-3]),a=i[n-14],o=i[n-13],c=hM(i[n-30],i[n-29]),d=uM(i[n-30],i[n-29]),u=i[n-32],p=i[n-31];i[n]=fM(s,f,a,o,c,d,u,p),i[n+1]=aM(s,f,a,o,c,d,u,p)}};ri.prototype._update=function(e,t){this._prepareBlock(e,t);var i=this.W,n=this.h[0],s=this.h[1],f=this.h[2],a=this.h[3],o=this.h[4],c=this.h[5],d=this.h[6],u=this.h[7],p=this.h[8],x=this.h[9],y=this.h[10],g=this.h[11],M=this.h[12],k=this.h[13],R=this.h[14],K=this.h[15];sM(this.k.length===i.length);for(var L=0;L<i.length;L+=2){var O=R,F=K,G=wM(p,x),B=SM(p,x),b=pM(p,x,y,g,M,k),m=yM(p,x,y,g,M,k),w=this.k[L],S=this.k[L+1],I=i[L],q=i[L+1],h=oM(O,F,G,B,b,m,w,S,I,q),_=cM(O,F,G,B,b,m,w,S,I,q);O=vM(n,s),F=gM(n,s),G=mM(n,s,f,a,o,c),B=xM(n,s,f,a,o,c);var l=hd(O,F,G,B),A=ud(O,F,G,B);R=M,K=k,M=y,k=g,y=p,g=x,p=hd(d,u,h,_),x=ud(u,u,h,_),d=o,u=c,o=f,c=a,f=n,a=s,n=hd(h,_,l,A),s=ud(h,_,l,A)}bn(this.h,0,n,s),bn(this.h,2,f,a),bn(this.h,4,o,c),bn(this.h,6,d,u),bn(this.h,8,p,x),bn(this.h,10,y,g),bn(this.h,12,M,k),bn(this.h,14,R,K)};ri.prototype._digest=function(e){return e==="hex"?_r.toHex32(this.h,"big"):_r.split32(this.h,"big")};function pM(r,e,t,i,n){var s=r&t^~r&n;return s<0&&(s+=4294967296),s}function yM(r,e,t,i,n,s){var f=e&i^~e&s;return f<0&&(f+=4294967296),f}function mM(r,e,t,i,n){var s=r&t^r&n^t&n;return s<0&&(s+=4294967296),s}function xM(r,e,t,i,n,s){var f=e&i^e&s^i&s;return f<0&&(f+=4294967296),f}function vM(r,e){var t=_i(r,e,28),i=_i(e,r,2),n=_i(e,r,7),s=t^i^n;return s<0&&(s+=4294967296),s}function gM(r,e){var t=Ii(r,e,28),i=Ii(e,r,2),n=Ii(e,r,7),s=t^i^n;return s<0&&(s+=4294967296),s}function wM(r,e){var t=_i(r,e,14),i=_i(r,e,18),n=_i(e,r,9),s=t^i^n;return s<0&&(s+=4294967296),s}function SM(r,e){var t=Ii(r,e,14),i=Ii(r,e,18),n=Ii(e,r,9),s=t^i^n;return s<0&&(s+=4294967296),s}function hM(r,e){var t=_i(r,e,1),i=_i(r,e,8),n=X4(r,e,7),s=t^i^n;return s<0&&(s+=4294967296),s}function uM(r,e){var t=Ii(r,e,1),i=Ii(r,e,8),n=Y4(r,e,7),s=t^i^n;return s<0&&(s+=4294967296),s}function lM(r,e){var t=_i(r,e,19),i=_i(e,r,29),n=X4(r,e,6),s=t^i^n;return s<0&&(s+=4294967296),s}function bM(r,e){var t=Ii(r,e,19),i=Ii(e,r,29),n=Y4(r,e,6),s=t^i^n;return s<0&&(s+=4294967296),s}});var $4=C((bk,W4)=>{"use strict";var bd=ei(),j4=ld();function Yi(){if(!(this instanceof Yi))return new Yi;j4.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}bd.inherits(Yi,j4);W4.exports=Yi;Yi.blockSize=1024;Yi.outSize=384;Yi.hmacStrength=192;Yi.padLength=128;Yi.prototype._digest=function(e){return e==="hex"?bd.toHex32(this.h.slice(0,12),"big"):bd.split32(this.h.slice(0,12),"big")}});var Q4=C(es=>{"use strict";es.sha1=z4();es.sha224=J4();es.sha256=cd();es.sha384=$4();es.sha512=ld()});var s6=C(e6=>{"use strict";var Zn=ei(),EM=W0(),Ka=Zn.rotl32,t6=Zn.sum32,sf=Zn.sum32_3,r6=Zn.sum32_4,i6=EM.BlockHash;function Ai(){if(!(this instanceof Ai))return new Ai;i6.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}Zn.inherits(Ai,i6);e6.ripemd160=Ai;Ai.blockSize=512;Ai.outSize=160;Ai.hmacStrength=192;Ai.padLength=64;Ai.prototype._update=function(e,t){for(var i=this.h[0],n=this.h[1],s=this.h[2],f=this.h[3],a=this.h[4],o=i,c=n,d=s,u=f,p=a,x=0;x<80;x++){var y=t6(Ka(r6(i,n6(x,n,s,f),e[IM[x]+t],MM(x)),BM[x]),a);i=a,a=f,f=Ka(s,10),s=n,n=y,y=t6(Ka(r6(o,n6(79-x,c,d,u),e[AM[x]+t],_M(x)),kM[x]),p),o=p,p=u,u=Ka(d,10),d=c,c=y}y=sf(this.h[1],s,u),this.h[1]=sf(this.h[2],f,p),this.h[2]=sf(this.h[3],a,o),this.h[3]=sf(this.h[4],i,c),this.h[4]=sf(this.h[0],n,d),this.h[0]=y};Ai.prototype._digest=function(e){return e==="hex"?Zn.toHex32(this.h,"little"):Zn.split32(this.h,"little")};function n6(r,e,t,i){return r<=15?e^t^i:r<=31?e&t|~e&i:r<=47?(e|~t)^i:r<=63?e&i|t&~i:e^(t|~i)}function MM(r){return r<=15?0:r<=31?1518500249:r<=47?1859775393:r<=63?2400959708:2840853838}function _M(r){return r<=15?1352829926:r<=31?1548603684:r<=47?1836072691:r<=63?2053994217:0}var IM=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],AM=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],BM=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],kM=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]});var a6=C((mk,f6)=>{"use strict";var qM=ei(),CM=hn();function ts(r,e,t){if(!(this instanceof ts))return new ts(r,e,t);this.Hash=r,this.blockSize=r.blockSize/8,this.outSize=r.outSize/8,this.inner=null,this.outer=null,this._init(qM.toArray(e,t))}f6.exports=ts;ts.prototype._init=function(e){e.length>this.blockSize&&(e=new this.Hash().update(e).digest()),CM(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(this.inner=new this.Hash().update(e),t=0;t<e.length;t++)e[t]^=106;this.outer=new this.Hash().update(e)};ts.prototype.update=function(e,t){return this.inner.update(e,t),this};ts.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}});var La=C(o6=>{var or=o6;or.utils=ei();or.common=W0();or.sha=Q4();or.ripemd=s6();or.hmac=a6();or.sha1=or.sha.sha1;or.sha256=or.sha.sha256;or.sha224=or.sha.sha224;or.sha384=or.sha.sha384;or.sha512=or.sha.sha512;or.ripemd160=or.ripemd.ripemd160});var d6=C((vk,c6)=>{c6.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}});var Fa=C(h6=>{"use strict";var pd=h6,pn=La(),yd=fd(),TM=Tr(),u6=TM.assert;function l6(r){r.type==="short"?this.curve=new yd.short(r):r.type==="edwards"?this.curve=new yd.edwards(r):this.curve=new yd.mont(r),this.g=this.curve.g,this.n=this.curve.n,this.hash=r.hash,u6(this.g.validate(),"Invalid curve"),u6(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}pd.PresetCurve=l6;function yn(r,e){Object.defineProperty(pd,r,{configurable:!0,enumerable:!0,get:function(){var t=new l6(e);return Object.defineProperty(pd,r,{configurable:!0,enumerable:!0,value:t}),t}})}yn("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:pn.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]});yn("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:pn.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]});yn("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:pn.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]});yn("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:pn.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]});yn("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:pn.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]});yn("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:pn.sha256,gRed:!1,g:["9"]});yn("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:pn.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var md;try{md=d6()}catch(r){md=void 0}yn("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:pn.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",md]})});var y6=C((wk,b6)=>{"use strict";var NM=La(),Wn=Qc(),p6=hn();function mn(r){if(!(this instanceof mn))return new mn(r);this.hash=r.hash,this.predResist=!!r.predResist,this.outLen=this.hash.outSize,this.minEntropy=r.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=Wn.toArray(r.entropy,r.entropyEnc||"hex"),t=Wn.toArray(r.nonce,r.nonceEnc||"hex"),i=Wn.toArray(r.pers,r.persEnc||"hex");p6(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,t,i)}b6.exports=mn;mn.prototype._init=function(e,t,i){var n=e.concat(t).concat(i);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var s=0;s<this.V.length;s++)this.K[s]=0,this.V[s]=1;this._update(n),this._reseed=1,this.reseedInterval=281474976710656};mn.prototype._hmac=function(){return new NM.hmac(this.hash,this.K)};mn.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),!!e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())};mn.prototype.reseed=function(e,t,i,n){typeof t!="string"&&(n=i,i=t,t=null),e=Wn.toArray(e,t),i=Wn.toArray(i,n),p6(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(i||[])),this._reseed=1};mn.prototype.generate=function(e,t,i,n){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof t!="string"&&(n=i,i=t,t=null),i&&(i=Wn.toArray(i,n||"hex"),this._update(i));for(var s=[];s.length<e;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var f=s.slice(0,e);return this._update(i),this._reseed++,Wn.encode(f,t)}});var x6=C((Sk,m6)=>{"use strict";var PM=gi(),RM=Tr(),xd=RM.assert;function lr(r,e){this.ec=r,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}m6.exports=lr;lr.fromPublic=function(e,t,i){return t instanceof lr?t:new lr(e,{pub:t,pubEnc:i})};lr.fromPrivate=function(e,t,i){return t instanceof lr?t:new lr(e,{priv:t,privEnc:i})};lr.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};lr.prototype.getPublic=function(e,t){return typeof e=="string"&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub};lr.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv};lr.prototype._importPrivate=function(e,t){this.priv=new PM(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)};lr.prototype._importPublic=function(e,t){if(e.x||e.y){this.ec.curve.type==="mont"?xd(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&xd(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,t)};lr.prototype.derive=function(e){return e.validate()||xd(e.validate(),"public point not validated"),e.mul(this.priv).getX()};lr.prototype.sign=function(e,t,i){return this.ec.sign(e,this,t,i)};lr.prototype.verify=function(e,t){return this.ec.verify(e,t,this)};lr.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}});var w6=C((Ek,v6)=>{"use strict";var Da=gi(),vd=Tr(),KM=vd.assert;function za(r,e){if(r instanceof za)return r;this._importDER(r,e)||(KM(r.r&&r.s,"Signature without r or s"),this.r=new Da(r.r,16),this.s=new Da(r.s,16),r.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=r.recoveryParam)}v6.exports=za;function LM(){this.place=0}function gd(r,e){var t=r[e.place++];if(!(t&128))return t;var i=t&15;if(i===0||i>4)return!1;for(var n=0,s=0,f=e.place;s<i;s++,f++)n<<=8,n|=r[f],n>>>=0;return n<=127?!1:(e.place=f,n)}function g6(r){for(var e=0,t=r.length-1;!r[e]&&!(r[e+1]&128)&&e<t;)e++;return e===0?r:r.slice(e)}za.prototype._importDER=function(e,t){e=vd.toArray(e,t);var i=new LM;if(e[i.place++]!==48)return!1;var n=gd(e,i);if(n===!1||n+i.place!==e.length||e[i.place++]!==2)return!1;var s=gd(e,i);if(s===!1)return!1;var f=e.slice(i.place,s+i.place);if(i.place+=s,e[i.place++]!==2)return!1;var a=gd(e,i);if(a===!1||e.length!==a+i.place)return!1;var o=e.slice(i.place,a+i.place);if(f[0]===0)if(f[1]&128)f=f.slice(1);else return!1;if(o[0]===0)if(o[1]&128)o=o.slice(1);else return!1;return this.r=new Da(f),this.s=new Da(o),this.recoveryParam=null,!0};function wd(r,e){if(e<128){r.push(e);return}var t=1+(Math.log(e)/Math.LN2>>>3);for(r.push(t|128);--t;)r.push(e>>>(t<<3)&255);r.push(e)}za.prototype.toDER=function(e){var t=this.r.toArray(),i=this.s.toArray();for(t[0]&128&&(t=[0].concat(t)),i[0]&128&&(i=[0].concat(i)),t=g6(t),i=g6(i);!i[0]&&!(i[1]&128);)i=i.slice(1);var n=[2];wd(n,t.length),n=n.concat(t),n.push(2),wd(n,i.length);var s=n.concat(i),f=[48];return wd(f,s.length),f=f.concat(s),vd.encode(f,e)}});var _6=C((Mk,S6)=>{"use strict";var jn=gi(),E6=y6(),FM=Tr(),Sd=Fa(),DM=id(),M6=FM.assert,Ed=x6(),Oa=w6();function Ur(r){if(!(this instanceof Ur))return new Ur(r);typeof r=="string"&&(M6(Object.prototype.hasOwnProperty.call(Sd,r),"Unknown curve "+r),r=Sd[r]),r instanceof Sd.PresetCurve&&(r={curve:r}),this.curve=r.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=r.curve.g,this.g.precompute(r.curve.n.bitLength()+1),this.hash=r.hash||r.curve.hash}S6.exports=Ur;Ur.prototype.keyPair=function(e){return new Ed(this,e)};Ur.prototype.keyFromPrivate=function(e,t){return Ed.fromPrivate(this,e,t)};Ur.prototype.keyFromPublic=function(e,t){return Ed.fromPublic(this,e,t)};Ur.prototype.genKeyPair=function(e){e||(e={});for(var t=new E6({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||DM(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),n=this.n.sub(new jn(2));;){var s=new jn(t.generate(i));if(!(s.cmp(n)>0))return s.iaddn(1),this.keyFromPrivate(s)}};Ur.prototype._truncateToN=function(e,t){var i=e.byteLength()*8-this.n.bitLength();return i>0&&(e=e.ushrn(i)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e};Ur.prototype.sign=function(e,t,i,n){typeof i=="object"&&(n=i,i=null),n||(n={}),t=this.keyFromPrivate(t,i),e=this._truncateToN(new jn(e,16));for(var s=this.n.byteLength(),f=t.getPrivate().toArray("be",s),a=e.toArray("be",s),o=new E6({hash:this.hash,entropy:f,nonce:a,pers:n.pers,persEnc:n.persEnc||"utf8"}),c=this.n.sub(new jn(1)),d=0;;d++){var u=n.k?n.k(d):new jn(o.generate(this.n.byteLength()));if(u=this._truncateToN(u,!0),!(u.cmpn(1)<=0||u.cmp(c)>=0)){var p=this.g.mul(u);if(!p.isInfinity()){var x=p.getX(),y=x.umod(this.n);if(y.cmpn(0)!==0){var g=u.invm(this.n).mul(y.mul(t.getPrivate()).iadd(e));if(g=g.umod(this.n),g.cmpn(0)!==0){var M=(p.getY().isOdd()?1:0)|(x.cmp(y)!==0?2:0);return n.canonical&&g.cmp(this.nh)>0&&(g=this.n.sub(g),M^=1),new Oa({r:y,s:g,recoveryParam:M})}}}}}};Ur.prototype.verify=function(e,t,i,n){e=this._truncateToN(new jn(e,16)),i=this.keyFromPublic(i,n),t=new Oa(t,"hex");var s=t.r,f=t.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0||f.cmpn(1)<0||f.cmp(this.n)>=0)return!1;var a=f.invm(this.n),o=a.mul(e).umod(this.n),c=a.mul(s).umod(this.n),d;return this.curve._maxwellTrick?(d=this.g.jmulAdd(o,i.getPublic(),c),d.isInfinity()?!1:d.eqXToP(s)):(d=this.g.mulAdd(o,i.getPublic(),c),d.isInfinity()?!1:d.getX().umod(this.n).cmp(s)===0)};Ur.prototype.recoverPubKey=function(r,e,t,i){M6((3&t)===t,"The recovery param is more than two bits"),e=new Oa(e,i);var n=this.n,s=new jn(r),f=e.r,a=e.s,o=t&1,c=t>>1;if(f.cmp(this.curve.p.umod(this.curve.n))>=0&&c)throw new Error("Unable to find sencond key candinate");c?f=this.curve.pointFromX(f.add(this.curve.n),o):f=this.curve.pointFromX(f,o);var d=e.r.invm(n),u=n.sub(s).mul(d).umod(n),p=a.mul(d).umod(n);return this.g.mulAdd(u,f,p)};Ur.prototype.getKeyRecoveryParam=function(r,e,t,i){if(e=new Oa(e,i),e.recoveryParam!==null)return e.recoveryParam;for(var n=0;n<4;n++){var s;try{s=this.recoverPubKey(r,e,n)}catch(f){continue}if(s.eq(t))return n}throw new Error("Unable to find valid recovery factor")}});var k6=C((_k,I6)=>{"use strict";var ff=Tr(),A6=ff.assert,B6=ff.parseBytes,rs=ff.cachedProperty;function rr(r,e){this.eddsa=r,this._secret=B6(e.secret),r.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=B6(e.pub)}rr.fromPublic=function(e,t){return t instanceof rr?t:new rr(e,{pub:t})};rr.fromSecret=function(e,t){return t instanceof rr?t:new rr(e,{secret:t})};rr.prototype.secret=function(){return this._secret};rs(rr,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});rs(rr,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});rs(rr,"privBytes",function(){var e=this.eddsa,t=this.hash(),i=e.encodingLength-1,n=t.slice(0,e.encodingLength);return n[0]&=248,n[i]&=127,n[i]|=64,n});rs(rr,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});rs(rr,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});rs(rr,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});rr.prototype.sign=function(e){return A6(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)};rr.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)};rr.prototype.getSecret=function(e){return A6(this._secret,"KeyPair is public only"),ff.encode(this.secret(),e)};rr.prototype.getPublic=function(e){return ff.encode(this.pubBytes(),e)};I6.exports=rr});var C6=C((Ik,q6)=>{"use strict";var zM=gi(),Ua=Tr(),OM=Ua.assert,Ha=Ua.cachedProperty,UM=Ua.parseBytes;function $n(r,e){this.eddsa=r,typeof e!="object"&&(e=UM(e)),Array.isArray(e)&&(e={R:e.slice(0,r.encodingLength),S:e.slice(r.encodingLength)}),OM(e.R&&e.S,"Signature without R or S"),r.isPoint(e.R)&&(this._R=e.R),e.S instanceof zM&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}Ha($n,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});Ha($n,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});Ha($n,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});Ha($n,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});$n.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};$n.prototype.toHex=function(){return Ua.encode(this.toBytes(),"hex").toUpperCase()};q6.exports=$n});var K6=C((Ak,T6)=>{"use strict";var HM=La(),VM=Fa(),is=Tr(),JM=is.assert,N6=is.parseBytes,P6=k6(),R6=C6();function Ir(r){if(JM(r==="ed25519","only tested with ed25519 so far"),!(this instanceof Ir))return new Ir(r);r=VM[r].curve,this.curve=r,this.g=r.g,this.g.precompute(r.n.bitLength()+1),this.pointClass=r.point().constructor,this.encodingLength=Math.ceil(r.n.bitLength()/8),this.hash=HM.sha512}T6.exports=Ir;Ir.prototype.sign=function(e,t){e=N6(e);var i=this.keyFromSecret(t),n=this.hashInt(i.messagePrefix(),e),s=this.g.mul(n),f=this.encodePoint(s),a=this.hashInt(f,i.pubBytes(),e).mul(i.priv()),o=n.add(a).umod(this.curve.n);return this.makeSignature({R:s,S:o,Rencoded:f})};Ir.prototype.verify=function(e,t,i){e=N6(e),t=this.makeSignature(t);var n=this.keyFromPublic(i),s=this.hashInt(t.Rencoded(),n.pubBytes(),e),f=this.g.mul(t.S()),a=t.R().add(n.pub().mul(s));return a.eq(f)};Ir.prototype.hashInt=function(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return is.intFromLE(e.digest()).umod(this.curve.n)};Ir.prototype.keyFromPublic=function(e){return P6.fromPublic(this,e)};Ir.prototype.keyFromSecret=function(e){return P6.fromSecret(this,e)};Ir.prototype.makeSignature=function(e){return e instanceof R6?e:new R6(this,e)};Ir.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t};Ir.prototype.decodePoint=function(e){e=is.parseBytes(e);var t=e.length-1,i=e.slice(0,t).concat(e[t]&~128),n=(e[t]&128)!=0,s=is.intFromLE(i);return this.curve.pointFromY(s,n)};Ir.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)};Ir.prototype.decodeInt=function(e){return is.intFromLE(e)};Ir.prototype.isPoint=function(e){return e instanceof this.pointClass}});var F6=C(L6=>{"use strict";var Qn=L6;Qn.version=u4().version;Qn.utils=Tr();Qn.rand=id();Qn.curve=fd();Qn.curves=Fa();Qn.ec=_6();Qn.eddsa=K6()});var z6=C((kk,D6)=>{var GM=F6().ec,Bi=new GM("secp256k1"),Fe=Bi.curve,et=Fe.n.constructor;function XM(r,e){let t=new et(e);if(t.cmp(Fe.p)>=0)return null;t=t.toRed(Fe.red);let i=t.redSqr().redIMul(t).redIAdd(Fe.b).redSqrt();return r===3!==i.isOdd()&&(i=i.redNeg()),Bi.keyPair({pub:{x:t,y:i}})}function YM(r,e,t){let i=new et(e),n=new et(t);if(i.cmp(Fe.p)>=0||n.cmp(Fe.p)>=0||(i=i.toRed(Fe.red),n=n.toRed(Fe.red),(r===6||r===7)&&n.isOdd()!==(r===7)))return null;let s=i.redSqr().redIMul(i);return n.redSqr().redISub(s.redIAdd(Fe.b)).isZero()?Bi.keyPair({pub:{x:i,y:n}}):null}function xn(r){let e=r[0];switch(e){case 2:case 3:return r.length!==33?null:XM(e,r.subarray(1,33));case 4:case 6:case 7:return r.length!==65?null:YM(e,r.subarray(1,33),r.subarray(33,65));default:return null}}function e0(r,e){let t=e.encode(null,r.length===33);for(let i=0;i<r.length;++i)r[i]=t[i]}D6.exports={contextRandomize(){return 0},privateKeyVerify(r){let e=new et(r);return e.cmp(Fe.n)<0&&!e.isZero()?0:1},privateKeyNegate(r){let e=new et(r),t=Fe.n.sub(e).umod(Fe.n).toArrayLike(Uint8Array,"be",32);return r.set(t),0},privateKeyTweakAdd(r,e){let t=new et(e);if(t.cmp(Fe.n)>=0||(t.iadd(new et(r)),t.cmp(Fe.n)>=0&&t.isub(Fe.n),t.isZero()))return 1;let i=t.toArrayLike(Uint8Array,"be",32);return r.set(i),0},privateKeyTweakMul(r,e){let t=new et(e);if(t.cmp(Fe.n)>=0||t.isZero())return 1;t.imul(new et(r)),t.cmp(Fe.n)>=0&&(t=t.umod(Fe.n));let i=t.toArrayLike(Uint8Array,"be",32);return r.set(i),0},publicKeyVerify(r){return xn(r)===null?1:0},publicKeyCreate(r,e){let t=new et(e);if(t.cmp(Fe.n)>=0||t.isZero())return 1;let i=Bi.keyFromPrivate(e).getPublic();return e0(r,i),0},publicKeyConvert(r,e){let t=xn(e);if(t===null)return 1;let i=t.getPublic();return e0(r,i),0},publicKeyNegate(r,e){let t=xn(e);if(t===null)return 1;let i=t.getPublic();return i.y=i.y.redNeg(),e0(r,i),0},publicKeyCombine(r,e){let t=new Array(e.length);for(let n=0;n<e.length;++n)if(t[n]=xn(e[n]),t[n]===null)return 1;let i=t[0].getPublic();for(let n=1;n<t.length;++n)i=i.add(t[n].pub);return i.isInfinity()?2:(e0(r,i),0)},publicKeyTweakAdd(r,e,t){let i=xn(e);if(i===null)return 1;if(t=new et(t),t.cmp(Fe.n)>=0)return 2;let n=i.getPublic().add(Fe.g.mul(t));return n.isInfinity()?2:(e0(r,n),0)},publicKeyTweakMul(r,e,t){let i=xn(e);if(i===null)return 1;if(t=new et(t),t.cmp(Fe.n)>=0||t.isZero())return 2;let n=i.getPublic().mul(t);return e0(r,n),0},signatureNormalize(r){let e=new et(r.subarray(0,32)),t=new et(r.subarray(32,64));return e.cmp(Fe.n)>=0||t.cmp(Fe.n)>=0?1:(t.cmp(Bi.nh)===1&&r.set(Fe.n.sub(t).toArrayLike(Uint8Array,"be",32),32),0)},signatureExport(r,e){let t=e.subarray(0,32),i=e.subarray(32,64);if(new et(t).cmp(Fe.n)>=0||new et(i).cmp(Fe.n)>=0)return 1;let{output:n}=r,s=n.subarray(4,4+33);s[0]=0,s.set(t,1);let f=33,a=0;for(;f>1&&s[a]===0&&!(s[a+1]&128);--f,++a);if(s=s.subarray(a),s[0]&128||f>1&&s[0]===0&&!(s[1]&128))return 1;let o=n.subarray(6+33,6+33+33);o[0]=0,o.set(i,1);let c=33,d=0;for(;c>1&&o[d]===0&&!(o[d+1]&128);--c,++d);return o=o.subarray(d),o[0]&128||c>1&&o[0]===0&&!(o[1]&128)?1:(r.outputlen=6+f+c,n[0]=48,n[1]=r.outputlen-2,n[2]=2,n[3]=s.length,n.set(s,4),n[4+f]=2,n[5+f]=o.length,n.set(o,6+f),0)},signatureImport(r,e){if(e.length<8||e.length>72||e[0]!==48||e[1]!==e.length-2||e[2]!==2)return 1;let t=e[3];if(t===0||5+t>=e.length||e[4+t]!==2)return 1;let i=e[5+t];if(i===0||6+t+i!==e.length||e[4]&128||t>1&&e[4]===0&&!(e[5]&128)||e[t+6]&128||i>1&&e[t+6]===0&&!(e[t+7]&128))return 1;let n=e.subarray(4,4+t);if(n.length===33&&n[0]===0&&(n=n.subarray(1)),n.length>32)return 1;let s=e.subarray(6+t);if(s.length===33&&s[0]===0&&(s=s.slice(1)),s.length>32)throw new Error("S length is too long");let f=new et(n);f.cmp(Fe.n)>=0&&(f=new et(0));let a=new et(e.subarray(6+t));return a.cmp(Fe.n)>=0&&(a=new et(0)),r.set(f.toArrayLike(Uint8Array,"be",32),0),r.set(a.toArrayLike(Uint8Array,"be",32),32),0},ecdsaSign(r,e,t,i,n){if(n){let a=n;n=o=>{let c=a(e,t,null,i,o);if(!(c instanceof Uint8Array&&c.length===32))throw new Error("This is the way");return new et(c)}}let s=new et(t);if(s.cmp(Fe.n)>=0||s.isZero())return 1;let f;try{f=Bi.sign(e,t,{canonical:!0,k:n,pers:i})}catch(a){return 1}return r.signature.set(f.r.toArrayLike(Uint8Array,"be",32),0),r.signature.set(f.s.toArrayLike(Uint8Array,"be",32),32),r.recid=f.recoveryParam,0},ecdsaVerify(r,e,t){let i={r:r.subarray(0,32),s:r.subarray(32,64)},n=new et(i.r),s=new et(i.s);if(n.cmp(Fe.n)>=0||s.cmp(Fe.n)>=0)return 1;if(s.cmp(Bi.nh)===1||n.isZero()||s.isZero())return 3;let f=xn(t);if(f===null)return 2;let a=f.getPublic();return Bi.verify(e,i,a)?0:3},ecdsaRecover(r,e,t,i){let n={r:e.slice(0,32),s:e.slice(32,64)},s=new et(n.r),f=new et(n.s);if(s.cmp(Fe.n)>=0||f.cmp(Fe.n)>=0)return 1;if(s.isZero()||f.isZero())return 2;let a;try{a=Bi.recoverPubKey(i,n,t)}catch(o){return 2}return e0(r,a),0},ecdh(r,e,t,i,n,s,f){let a=xn(e);if(a===null)return 1;let o=new et(t);if(o.cmp(Fe.n)>=0||o.isZero())return 2;let c=a.getPublic().mul(o);if(n===void 0){let d=c.encode(null,!0),u=Bi.hash().update(d).digest();for(let p=0;p<32;++p)r[p]=u[p]}else{s||(s=new Uint8Array(32));let d=c.getX().toArray("be",32);for(let y=0;y<32;++y)s[y]=d[y];f||(f=new Uint8Array(32));let u=c.getY().toArray("be",32);for(let y=0;y<32;++y)f[y]=u[y];let p=n(s,f,i);if(!(p instanceof Uint8Array&&p.length===r.length))return 2;r.set(p)}return 0}}});var U6=C((qk,O6)=>{O6.exports=d4()(z6())});var G6=C((Ck,H6)=>{"use strict";var ii=U6(),V6=Gs(),J6="sha2-256";H6.exports=r=>{let e=32;function t(){let d;do d=r(32);while(!ii.privateKeyVerify(d));return d}async function i(d,u){let p=await V6.digest(u,J6),x=ii.ecdsaSign(p,d);return ii.signatureExport(x.signature)}async function n(d,u,p){let x=await V6.digest(p,J6);return u=ii.signatureImport(u),ii.ecdsaVerify(u,x,d)}function s(d){if(!ii.publicKeyVerify(d))throw new Error("Invalid public key");return ii.publicKeyConvert(d,!0)}function f(d){return ii.publicKeyConvert(d,!1)}function a(d){if(!ii.privateKeyVerify(d))throw new Error("Invalid private key")}function o(d){if(!ii.publicKeyVerify(d))throw new Error("Invalid public key")}function c(d){return a(d),ii.publicKeyCreate(d)}return{generateKey:t,privateKeyLength:e,hashAndSign:i,hashAndVerify:n,compressPublicKey:s,decompressPublicKey:f,validatePrivateKey:a,validatePublicKey:o,computePublicKey:c}}});var W6=C((Tk,X6)=>{"use strict";var Y6=Gs(),ZM=jr(),Z6=Xs(),WM=on(),jM=Sa();X6.exports=(r,e,t)=>{t=t||G6()(e);class i{constructor(c){t.validatePublicKey(c),this._key=c}verify(c,d){return t.hashAndVerify(this._key,d,c)}marshal(){return t.compressPublicKey(this._key)}get bytes(){return r.PublicKey.encode({Type:r.KeyType.Secp256k1,Data:this.marshal()})}equals(c){return Z6(this.bytes,c.bytes)}hash(){return Y6.multihashing(this.bytes,"sha2-256")}}class n{constructor(c,d){this._key=c,this._publicKey=d||t.computePublicKey(c),t.validatePrivateKey(this._key),t.validatePublicKey(this._publicKey)}sign(c){return t.hashAndSign(this._key,c)}get public(){return new i(this._publicKey)}marshal(){return this._key}get bytes(){return r.PrivateKey.encode({Type:r.KeyType.Secp256k1,Data:this.marshal()})}equals(c){return Z6(this.bytes,c.bytes)}hash(){return Y6.multihashing(this.bytes,"sha2-256")}async id(){let c=await this.public.hash();return WM(c,"base58btc")}async export(c,d="libp2p-key"){if(d==="libp2p-key")return jM.export(this.bytes,c);throw ZM(new Error(`export format '${d}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function s(o){return new n(o)}function f(o){return new i(o)}async function a(){let o=await t.generateKey();return new n(o)}return{Secp256k1PublicKey:i,Secp256k1PrivateKey:n,unmarshalSecp256k1PrivateKey:s,unmarshalSecp256k1PublicKey:f,generateKeyPair:a}}});var $6=C((Nk,j6)=>{"use strict";j6.exports={SHA1:20,SHA256:32,SHA512:64}});var Md=C(Q6=>{"use strict";var e5=Js(),$M=$6(),QM={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},e_=async(r,e)=>{let t=await e5.get().subtle.sign({name:"HMAC"},r,e);return new Uint8Array(t,t.byteOffset,t.byteLength)};Q6.create=async function(r,e){let t=QM[r],i=await e5.get().subtle.importKey("raw",e,{name:"HMAC",hash:{name:t}},!1,["sign"]);return{async digest(n){return e_(i,n)},length:$M[r]}}});var s5=C((Rk,t5)=>{"use strict";var r5=jr(),i5=Vs(),t_=an(),r_=Md(),n5={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,cipherKeySize:32}};t5.exports=async(r,e,t)=>{let i=n5[r];if(!i){let R=Object.keys(n5).join(" / ");throw r5(new Error(`unknown cipher type '${r}'. Must be ${R}`),"ERR_INVALID_CIPHER_TYPE")}if(!e)throw r5(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");let n=i.keySize,s=i.ivSize,f=20,a=t_("key expansion"),o=2*(s+n+f),c=await r_.create(e,t),d=await c.digest(a),u=[],p=0;for(;p<o;){let R=await c.digest(i5([d,a])),K=R.length;p+K>o&&(K=o-p),u.push(R),p+=K,d=await c.digest(d)}let x=o/2,y=i5(u),g=y.slice(0,x),M=y.slice(x,o),k=R=>({iv:R.slice(0,s),cipherKey:R.slice(s,s+n),macKey:R.slice(s+n)});return{k1:k(g),k2:k(M)}}});var a5=C((Kk,f5)=>{"use strict";var i_=jr();f5.exports=function(r,e){if(!r.includes(e)){let t=r.join(" / ");throw i_(new Error(`Unknown curve: ${e}. Must be ${t}`),"ERR_INVALID_CURVE")}}});var l5=C(o5=>{"use strict";var n_=jr(),af=Js(),{base64urlToBuffer:c5}=wa(),s_=a5(),_d=on(),f_=Vs(),a_=Xs(),d5={"P-256":256,"P-384":384,"P-521":521};o5.generateEphmeralKeyPair=async function(r){s_(Object.keys(d5),r);let e=await af.get().subtle.generateKey({name:"ECDH",namedCurve:r},!0,["deriveBits"]),t=async(n,s)=>{let f;s?f=await af.get().subtle.importKey("jwk",c_(r,s),{name:"ECDH",namedCurve:r},!1,["deriveBits"]):f=e.privateKey;let a=[await af.get().subtle.importKey("jwk",h5(r,n),{name:"ECDH",namedCurve:r},!1,[]),f],o=await af.get().subtle.deriveBits({name:"ECDH",namedCurve:r,public:a[0]},a[1],d5[r]);return new Uint8Array(o,o.byteOffset,o.byteLength)},i=await af.get().subtle.exportKey("jwk",e.publicKey);return{key:o_(i),genSharedKey:t}};var u5={"P-256":32,"P-384":48,"P-521":66};function o_(r){let e=u5[r.crv];return f_([Uint8Array.from([4]),c5(r.x,e),c5(r.y,e)],1+e*2)}function h5(r,e){let t=u5[r];if(a_(!e.slice(0,1),Uint8Array.from([4])))throw n_(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:r,x:_d(e.slice(1,t+1),"base64url"),y:_d(e.slice(1+t),"base64url"),ext:!0}}var c_=(r,e)=>({...h5(r,e.public),d:_d(e.private,"base64url")})});var p5=C((Fk,b5)=>{"use strict";var d_=l5();b5.exports=async r=>d_.generateEphmeralKeyPair(r)});var Ad=C((Ar,y5)=>{"use strict";var h_=Ls(),ki=h_($f());P0();ap();var Id=He(),of=jr(),u_=an(),l_=yp();Ar=y5.exports;var Hr={rsa:r4(),ed25519:o4(),secp256k1:W6()(ki,ga())};Ar.supportedKeys=Hr;Ar.keysPBM=ki;var Va={message:"secp256k1 support requires libp2p-crypto-secp256k1 package",code:"ERR_MISSING_PACKAGE"};function ns(r){let e=Hr[r.toLowerCase()];if(!e){let t=Object.keys(Hr).join(" / ");throw of(new Error(`invalid or unsupported key type ${r}. Must be ${t}`),"ERR_UNSUPPORTED_KEY_TYPE")}return e}Ar.keyStretcher=s5();Ar.generateEphemeralKeyPair=p5();Ar.generateKeyPair=async(r,e)=>ns(r).generateKeyPair(e);Ar.generateKeyPairFromSeed=async(r,e,t)=>{let i=ns(r);if(r.toLowerCase()!=="ed25519")throw of(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return i.generateKeyPairFromSeed(e,t)};Ar.unmarshalPublicKey=r=>{let e=ki.PublicKey.decode(r),t=e.Data;switch(e.Type){case ki.KeyType.RSA:return Hr.rsa.unmarshalRsaPublicKey(t);case ki.KeyType.Ed25519:return Hr.ed25519.unmarshalEd25519PublicKey(t);case ki.KeyType.Secp256k1:if(Hr.secp256k1)return Hr.secp256k1.unmarshalSecp256k1PublicKey(t);throw of(new Error(Va.message),Va.code);default:ns(e.Type)}};Ar.marshalPublicKey=(r,e)=>(e=(e||"rsa").toLowerCase(),ns(e),r.bytes);Ar.unmarshalPrivateKey=async r=>{let e=ki.PrivateKey.decode(r),t=e.Data;switch(e.Type){case ki.KeyType.RSA:return Hr.rsa.unmarshalRsaPrivateKey(t);case ki.KeyType.Ed25519:return Hr.ed25519.unmarshalEd25519PrivateKey(t);case ki.KeyType.Secp256k1:if(Hr.secp256k1)return Hr.secp256k1.unmarshalSecp256k1PrivateKey(t);throw of(new Error(Va.message),Va.code);default:ns(e.Type)}};Ar.marshalPrivateKey=(r,e)=>(e=(e||"rsa").toLowerCase(),ns(e),r.bytes);Ar.import=async(r,e)=>{try{let n=await l_.import(r,e);return Ar.unmarshalPrivateKey(n)}catch(n){}let t=Id.pki.decryptRsaPrivateKey(r,e);if(t===null)throw of(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let i=Id.asn1.toDer(Id.pki.privateKeyToAsn1(t));return i=u_(i.getBytes(),"ascii"),Hr.rsa.unmarshalRsaPrivateKey(i)}});var m5=C((Dk,Bd)=>{"use strict";function b_(r,{className:e,symbolName:t}){let i=Symbol.for(t),n={[e]:class extends r{constructor(...s){super(...s);Object.defineProperty(this,i,{value:!0})}get[Symbol.toStringTag](){return e}}}[e];return n[`is${e}`]=s=>!!(s&&s[i]),n}function p_(r,{className:e,symbolName:t,withoutNew:i}){let n=Symbol.for(t),s={[e]:function(...f){if(i&&!(this instanceof s))return new s(...f);let a=r.call(this,...f)||this;return a&&!a[n]&&Object.defineProperty(a,n,{value:!0}),a}}[e];return s.prototype=Object.create(r.prototype),s.prototype.constructor=s,Object.defineProperty(s.prototype,Symbol.toStringTag,{get(){return e}}),s[`is${e}`]=f=>!!(f&&f[n]),s}Bd.exports=b_;Bd.exports.proto=p_});var v5=C((zk,x5)=>{"use strict";var y_=Ls();x5.exports=y_(`

message PeerIdProto {
  required bytes id = 1;
  bytes pubKey = 2;
  bytes privKey = 3;
}

`)});var M5=C((Nr,g5)=>{"use strict";var t0=Is(),kd=p2(),qi=Ad(),m_=m5(),{PeerIdProto:w5}=v5(),r0=Jf(),cf=jo(),x_=Uf(),S5=class{constructor(e,t,i){if(!(e instanceof Uint8Array))throw new Error("invalid id provided");if(t&&i&&!r0(t.public.bytes,i.bytes))throw new Error("inconsistent arguments");this._id=e,this._idB58String=t0.toB58String(this.id),this._privKey=t,this._pubKey=i}get id(){return this._id}set id(e){throw new Error("Id is immutable")}get privKey(){return this._privKey}set privKey(e){this._privKey=e}get pubKey(){if(this._pubKey)return this._pubKey;if(this._privKey)return this._privKey.public;try{let e=t0.decode(this.id);e.name==="identity"&&(this._pubKey=qi.unmarshalPublicKey(e.digest))}catch(e){}return this._pubKey}set pubKey(e){this._pubKey=e}marshalPubKey(){if(this.pubKey)return qi.marshalPublicKey(this.pubKey)}marshalPrivKey(){if(this.privKey)return qi.marshalPrivateKey(this.privKey)}marshal(e){return w5.encode({id:this.toBytes(),pubKey:this.marshalPubKey(),privKey:e?null:this.marshalPrivKey()})}toPrint(){let e=this.toB58String();e.startsWith("Qm")&&(e=e.slice(2));let t=6;return e.length<t&&(t=e.length),"<peer.ID "+e.substr(0,t)+">"}toJSON(){return{id:this.toB58String(),privKey:E5(this.marshalPrivKey()),pubKey:E5(this.marshalPubKey())}}toHexString(){return t0.toHexString(this.id)}toBytes(){return this.id}toB58String(){return this._idB58String}toString(){if(!this._idCIDString){let e=new kd(1,"libp2p-key",this.id,"base32");this._idCIDString=e.toBaseEncodedString("base32")}return this._idCIDString}equals(e){if(e instanceof Uint8Array)return r0(this.id,e);if(e.id)return r0(this.id,e.id);throw new Error("not valid Id")}isEqual(e){return this.equals(e)}isValid(){return Boolean(this.privKey&&this.privKey.public&&this.privKey.public.bytes&&this.pubKey.bytes instanceof Uint8Array&&r0(this.privKey.public.bytes,this.pubKey.bytes))}hasInlinePublicKey(){try{if(t0.decode(this.id).name==="identity")return!0}catch(e){}return!1}},Ci=m_(S5,{className:"PeerId",symbolName:"@libp2p/js-peer-id/PeerId"});Nr=g5.exports=Ci;var df=r=>r.bytes.length<=42?t0.encode(r.bytes,"identity"):r.hash(),qd=async(r,e)=>{let t=await df(e);return new Ci(t,r,e)};Nr.create=async r=>{r=r||{},r.bits=r.bits||2048,r.keyType=r.keyType||"RSA";let e=await qi.generateKeyPair(r.keyType,r.bits);return qd(e,e.public)};Nr.createFromHexString=r=>new Ci(t0.fromHexString(r));Nr.createFromBytes=r=>new Ci(r);Nr.createFromB58String=r=>Nr.createFromCID(r);var v_=r=>r.codec==="libp2p-key"||r.codec==="dag-pb";Nr.createFromCID=r=>{if(r=kd.isCID(r)?r:new kd(r),!v_(r))throw new Error("Supplied PeerID CID has invalid multicodec: "+r.codec);return new Ci(r.multihash)};Nr.createFromPubKey=async r=>{let e=r;if(typeof e=="string"&&(e=cf(r,"base64pad")),!(e instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let t=await qi.unmarshalPublicKey(e);return qd(null,t)};Nr.createFromPrivKey=async r=>{if(typeof r=="string"&&(r=cf(r,"base64pad")),!(r instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let e=await qi.unmarshalPrivateKey(r);return qd(e,e.public)};Nr.createFromJSON=async r=>{let e=t0.fromB58String(r.id),t=r.privKey&&cf(r.privKey,"base64pad"),i=r.pubKey&&cf(r.pubKey,"base64pad"),n=i&&await qi.unmarshalPublicKey(i);if(!t)return new Ci(e,null,n);let s=await qi.unmarshalPrivateKey(t),f=await df(s.public),a;if(n&&(a=await df(n)),n&&!r0(f,a))throw new Error("Public and private key do not match");if(e&&!r0(f,e))throw new Error("Id and private key do not match");return new Ci(e,s,n)};Nr.createFromProtobuf=async r=>{typeof r=="string"&&(r=cf(r,"base16"));let{id:e,privKey:t,pubKey:i}=w5.decode(r);t=t?await qi.unmarshalPrivateKey(t):!1,i=i?await qi.unmarshalPublicKey(i):!1;let n,s;if(t&&(s=await df(t.public)),i&&(n=await df(i)),t){if(i&&!r0(s,n))throw new Error("Public and private key do not match");return new Ci(s,t,t.public)}if(i)return new Ci(n,null,i);if(e)return new Ci(e);throw new Error("Protobuf did not contain any usable key material")};Nr.isPeerId=r=>Boolean(typeof r=="object"&&r._id&&r._idB58String);function E5(r){if(r)return x_(r,"base64pad")}});var A5=C((Ok,_5)=>{"use strict";fa();var Ja=He(),ss=on(),I5=an();_5.exports={createCipheriv:(r,e,t)=>{let i=Ja.cipher.createCipher("AES-CTR",ss(e,"ascii"));return i.start({iv:ss(t,"ascii")}),{update:n=>(i.update(Ja.util.createBuffer(ss(n,"ascii"))),I5(i.output.getBytes(),"ascii"))}},createDecipheriv:(r,e,t)=>{let i=Ja.cipher.createDecipher("AES-CTR",ss(e,"ascii"));return i.start({iv:ss(t,"ascii")}),{update:n=>(i.update(Ja.util.createBuffer(ss(n,"ascii"))),I5(i.output.getBytes(),"ascii"))}}}});var q5=C((Uk,B5)=>{"use strict";var g_=jr(),k5={16:"aes-128-ctr",32:"aes-256-ctr"};B5.exports=function(r){let e=k5[r.length];if(!e){let t=Object.entries(k5).map(([i,n])=>`${i} (${n})`).join(" / ");throw g_(new Error(`Invalid key length ${r.length} bytes. Must be ${t}`),"ERR_INVALID_KEY_LENGTH")}return e}});var N5=C(C5=>{"use strict";var T5=A5(),w_=q5();C5.create=async function(r,e){let t=w_(r),i=T5.createCipheriv(t,r,e),n=T5.createDecipheriv(t,r,e);return{async encrypt(f){return i.update(f)},async decrypt(f){return n.update(f)}}}});var K5=C((Vk,P5)=>{"use strict";var S_=Ic(),E_=Kt(),M_=jr(),R5={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function __(r,e,t,i,n){let s=R5[n];if(!s){let a=Object.keys(R5).join(" / ");throw M_(new Error(`Hash '${n}' is unknown or not supported. Must be ${a}`),"ERR_UNSUPPORTED_HASH_TYPE")}let f=S_(r,e,t,i,s);return E_.encode64(f)}P5.exports=__});var L5=C(fs=>{"use strict";var I_=Md(),A_=N5(),B_=Ad();fs.aes=A_;fs.hmac=I_;fs.keys=B_;fs.randomBytes=ga();fs.pbkdf2=K5()});var D5=C((Gk,F5)=>{"use strict";F5.exports=k_;function k_(r,e){for(var t=new Array(arguments.length-1),i=0,n=2,s=!0;n<arguments.length;)t[i++]=arguments[n++];return new Promise(function(a,o){t[i]=function(d){if(s)if(s=!1,d)o(d);else{for(var u=new Array(arguments.length-1),p=0;p<u.length;)u[p++]=arguments[p];a.apply(null,u)}};try{r.apply(e||null,t)}catch(c){s&&(s=!1,o(c))}})}});var H5=C(z5=>{"use strict";var Ga=z5;Ga.length=function(e){var t=e.length;if(!t)return 0;for(var i=0;--t%4>1&&e.charAt(t)==="=";)++i;return Math.ceil(e.length*3)/4-i};var as=new Array(64),O5=new Array(123);for(var Ti=0;Ti<64;)O5[as[Ti]=Ti<26?Ti+65:Ti<52?Ti+71:Ti<62?Ti-4:Ti-59|43]=Ti++;Ga.encode=function(e,t,i){for(var n=null,s=[],f=0,a=0,o;t<i;){var c=e[t++];switch(a){case 0:s[f++]=as[c>>2],o=(c&3)<<4,a=1;break;case 1:s[f++]=as[o|c>>4],o=(c&15)<<2,a=2;break;case 2:s[f++]=as[o|c>>6],s[f++]=as[c&63],a=0;break}f>8191&&((n||(n=[])).push(String.fromCharCode.apply(String,s)),f=0)}return a&&(s[f++]=as[o],s[f++]=61,a===1&&(s[f++]=61)),n?(f&&n.push(String.fromCharCode.apply(String,s.slice(0,f))),n.join("")):String.fromCharCode.apply(String,s.slice(0,f))};var U5="invalid encoding";Ga.decode=function(e,t,i){for(var n=i,s=0,f,a=0;a<e.length;){var o=e.charCodeAt(a++);if(o===61&&s>1)break;if((o=O5[o])===void 0)throw Error(U5);switch(s){case 0:f=o,s=1;break;case 1:t[i++]=f<<2|(o&48)>>4,f=o,s=2;break;case 2:t[i++]=(f&15)<<4|(o&60)>>2,f=o,s=3;break;case 3:t[i++]=(f&3)<<6|o,s=0;break}}if(s===1)throw Error(U5);return i-n};Ga.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var J5=C((Yk,V5)=>{"use strict";V5.exports=Xa;function Xa(){this._listeners={}}Xa.prototype.on=function(e,t,i){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:i||this}),this};Xa.prototype.off=function(e,t){if(e===void 0)this._listeners={};else if(t===void 0)this._listeners[e]=[];else for(var i=this._listeners[e],n=0;n<i.length;)i[n].fn===t?i.splice(n,1):++n;return this};Xa.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var i=[],n=1;n<arguments.length;)i.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,i)}return this}});var $5=C((Zk,G5)=>{"use strict";G5.exports=X5(X5);function X5(r){return typeof Float32Array!="undefined"?function(){var e=new Float32Array([-0]),t=new Uint8Array(e.buffer),i=t[3]===128;function n(o,c,d){e[0]=o,c[d]=t[0],c[d+1]=t[1],c[d+2]=t[2],c[d+3]=t[3]}function s(o,c,d){e[0]=o,c[d]=t[3],c[d+1]=t[2],c[d+2]=t[1],c[d+3]=t[0]}r.writeFloatLE=i?n:s,r.writeFloatBE=i?s:n;function f(o,c){return t[0]=o[c],t[1]=o[c+1],t[2]=o[c+2],t[3]=o[c+3],e[0]}function a(o,c){return t[3]=o[c],t[2]=o[c+1],t[1]=o[c+2],t[0]=o[c+3],e[0]}r.readFloatLE=i?f:a,r.readFloatBE=i?a:f}():function(){function e(i,n,s,f){var a=n<0?1:0;if(a&&(n=-n),n===0)i(1/n>0?0:2147483648,s,f);else if(isNaN(n))i(2143289344,s,f);else if(n>34028234663852886e22)i((a<<31|2139095040)>>>0,s,f);else if(n<11754943508222875e-54)i((a<<31|Math.round(n/1401298464324817e-60))>>>0,s,f);else{var o=Math.floor(Math.log(n)/Math.LN2),c=Math.round(n*Math.pow(2,-o)*8388608)&8388607;i((a<<31|o+127<<23|c)>>>0,s,f)}}r.writeFloatLE=e.bind(null,Y5),r.writeFloatBE=e.bind(null,Z5);function t(i,n,s){var f=i(n,s),a=(f>>31)*2+1,o=f>>>23&255,c=f&8388607;return o===255?c?NaN:a*Infinity:o===0?a*1401298464324817e-60*c:a*Math.pow(2,o-150)*(c+8388608)}r.readFloatLE=t.bind(null,W5),r.readFloatBE=t.bind(null,j5)}(),typeof Float64Array!="undefined"?function(){var e=new Float64Array([-0]),t=new Uint8Array(e.buffer),i=t[7]===128;function n(o,c,d){e[0]=o,c[d]=t[0],c[d+1]=t[1],c[d+2]=t[2],c[d+3]=t[3],c[d+4]=t[4],c[d+5]=t[5],c[d+6]=t[6],c[d+7]=t[7]}function s(o,c,d){e[0]=o,c[d]=t[7],c[d+1]=t[6],c[d+2]=t[5],c[d+3]=t[4],c[d+4]=t[3],c[d+5]=t[2],c[d+6]=t[1],c[d+7]=t[0]}r.writeDoubleLE=i?n:s,r.writeDoubleBE=i?s:n;function f(o,c){return t[0]=o[c],t[1]=o[c+1],t[2]=o[c+2],t[3]=o[c+3],t[4]=o[c+4],t[5]=o[c+5],t[6]=o[c+6],t[7]=o[c+7],e[0]}function a(o,c){return t[7]=o[c],t[6]=o[c+1],t[5]=o[c+2],t[4]=o[c+3],t[3]=o[c+4],t[2]=o[c+5],t[1]=o[c+6],t[0]=o[c+7],e[0]}r.readDoubleLE=i?f:a,r.readDoubleBE=i?a:f}():function(){function e(i,n,s,f,a,o){var c=f<0?1:0;if(c&&(f=-f),f===0)i(0,a,o+n),i(1/f>0?0:2147483648,a,o+s);else if(isNaN(f))i(0,a,o+n),i(2146959360,a,o+s);else if(f>17976931348623157e292)i(0,a,o+n),i((c<<31|2146435072)>>>0,a,o+s);else{var d;if(f<22250738585072014e-324)d=f/5e-324,i(d>>>0,a,o+n),i((c<<31|d/4294967296)>>>0,a,o+s);else{var u=Math.floor(Math.log(f)/Math.LN2);u===1024&&(u=1023),d=f*Math.pow(2,-u),i(d*4503599627370496>>>0,a,o+n),i((c<<31|u+1023<<20|d*1048576&1048575)>>>0,a,o+s)}}}r.writeDoubleLE=e.bind(null,Y5,0,4),r.writeDoubleBE=e.bind(null,Z5,4,0);function t(i,n,s,f,a){var o=i(f,a+n),c=i(f,a+s),d=(c>>31)*2+1,u=c>>>20&2047,p=4294967296*(c&1048575)+o;return u===2047?p?NaN:d*Infinity:u===0?d*5e-324*p:d*Math.pow(2,u-1075)*(p+4503599627370496)}r.readDoubleLE=t.bind(null,W5,0,4),r.readDoubleBE=t.bind(null,j5,4,0)}(),r}function Y5(r,e,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24}function Z5(r,e,t){e[t]=r>>>24,e[t+1]=r>>>16&255,e[t+2]=r>>>8&255,e[t+3]=r&255}function W5(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24)>>>0}function j5(r,e){return(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}});var Q5=C((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(r){}return null}});var t8=C(e8=>{"use strict";var Cd=e8;Cd.length=function(e){for(var t=0,i=0,n=0;n<e.length;++n)i=e.charCodeAt(n),i<128?t+=1:i<2048?t+=2:(i&64512)==55296&&(e.charCodeAt(n+1)&64512)==56320?(++n,t+=4):t+=3;return t};Cd.read=function(e,t,i){var n=i-t;if(n<1)return"";for(var s=null,f=[],a=0,o;t<i;)o=e[t++],o<128?f[a++]=o:o>191&&o<224?f[a++]=(o&31)<<6|e[t++]&63:o>239&&o<365?(o=((o&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,f[a++]=55296+(o>>10),f[a++]=56320+(o&1023)):f[a++]=(o&15)<<12|(e[t++]&63)<<6|e[t++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,f)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,f.slice(0,a))),s.join("")):String.fromCharCode.apply(String,f.slice(0,a))};Cd.write=function(e,t,i){for(var n=i,s,f,a=0;a<e.length;++a)s=e.charCodeAt(a),s<128?t[i++]=s:s<2048?(t[i++]=s>>6|192,t[i++]=s&63|128):(s&64512)==55296&&((f=e.charCodeAt(a+1))&64512)==56320?(s=65536+((s&1023)<<10)+(f&1023),++a,t[i++]=s>>18|240,t[i++]=s>>12&63|128,t[i++]=s>>6&63|128,t[i++]=s&63|128):(t[i++]=s>>12|224,t[i++]=s>>6&63|128,t[i++]=s&63|128);return i-n}});var i8=C((jk,r8)=>{"use strict";r8.exports=q_;function q_(r,e,t){var i=t||8192,n=i>>>1,s=null,f=i;return function(o){if(o<1||o>n)return r(o);f+o>i&&(s=r(i),f=0);var c=e.call(s,f,f+=o);return f&7&&(f=(f|7)+1),c}}});var s8=C(($k,n8)=>{"use strict";n8.exports=ir;var hf=vn();function ir(r,e){this.lo=r>>>0,this.hi=e>>>0}var i0=ir.zero=new ir(0,0);i0.toNumber=function(){return 0};i0.zzEncode=i0.zzDecode=function(){return this};i0.length=function(){return 1};var C_=ir.zeroHash="\0\0\0\0\0\0\0\0";ir.fromNumber=function(e){if(e===0)return i0;var t=e<0;t&&(e=-e);var i=e>>>0,n=(e-i)/4294967296>>>0;return t&&(n=~n>>>0,i=~i>>>0,++i>4294967295&&(i=0,++n>4294967295&&(n=0))),new ir(i,n)};ir.from=function(e){if(typeof e=="number")return ir.fromNumber(e);if(hf.isString(e))if(hf.Long)e=hf.Long.fromString(e);else return ir.fromNumber(parseInt(e,10));return e.low||e.high?new ir(e.low>>>0,e.high>>>0):i0};ir.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,i=~this.hi>>>0;return t||(i=i+1>>>0),-(t+i*4294967296)}return this.lo+this.hi*4294967296};ir.prototype.toLong=function(e){return hf.Long?new hf.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var gn=String.prototype.charCodeAt;ir.fromHash=function(e){return e===C_?i0:new ir((gn.call(e,0)|gn.call(e,1)<<8|gn.call(e,2)<<16|gn.call(e,3)<<24)>>>0,(gn.call(e,4)|gn.call(e,5)<<8|gn.call(e,6)<<16|gn.call(e,7)<<24)>>>0)};ir.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};ir.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};ir.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};ir.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return i===0?t===0?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:i<128?9:10}});var vn=C(Td=>{"use strict";var ae=Td;ae.asPromise=D5();ae.base64=H5();ae.EventEmitter=J5();ae.float=$5();ae.inquire=Q5();ae.utf8=t8();ae.pool=i8();ae.LongBits=s8();ae.isNode=Boolean(typeof globalThis!="undefined"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);ae.global=ae.isNode&&globalThis||typeof window!="undefined"&&window||typeof self!="undefined"&&self||Td;ae.emptyArray=Object.freeze?Object.freeze([]):[];ae.emptyObject=Object.freeze?Object.freeze({}):{};ae.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};ae.isString=function(e){return typeof e=="string"||e instanceof String};ae.isObject=function(e){return e&&typeof e=="object"};ae.isset=ae.isSet=function(e,t){var i=e[t];return i!=null&&e.hasOwnProperty(t)?typeof i!="object"||(Array.isArray(i)?i.length:Object.keys(i).length)>0:!1};ae.Buffer=function(){try{var r=ae.inquire("buffer").Buffer;return r.prototype.utf8Write?r:null}catch(e){return null}}();ae._Buffer_from=null;ae._Buffer_allocUnsafe=null;ae.newBuffer=function(e){return typeof e=="number"?ae.Buffer?ae._Buffer_allocUnsafe(e):new ae.Array(e):ae.Buffer?ae._Buffer_from(e):typeof Uint8Array=="undefined"?e:new Uint8Array(e)};ae.Array=typeof Uint8Array!="undefined"?Uint8Array:Array;ae.Long=ae.global.dcodeIO&&ae.global.dcodeIO.Long||ae.global.Long||ae.inquire("long");ae.key2Re=/^true|false|0|1$/;ae.key32Re=/^-?(?:0|[1-9][0-9]*)$/;ae.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;ae.longToHash=function(e){return e?ae.LongBits.from(e).toHash():ae.LongBits.zeroHash};ae.longFromHash=function(e,t){var i=ae.LongBits.fromHash(e);return ae.Long?ae.Long.fromBits(i.lo,i.hi,t):i.toNumber(Boolean(t))};function f8(r,e,t){for(var i=Object.keys(e),n=0;n<i.length;++n)(r[i[n]]===void 0||!t)&&(r[i[n]]=e[i[n]]);return r}ae.merge=f8;ae.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function a8(r){function e(t,i){if(!(this instanceof e))return new e(t,i);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),i&&f8(this,i)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return r}}),e.prototype.toString=function(){return this.name+": "+this.message},e}ae.newError=a8;ae.ProtocolError=a8("ProtocolError");ae.oneOfGetter=function(e){for(var t={},i=0;i<e.length;++i)t[e[i]]=1;return function(){for(var n=Object.keys(this),s=n.length-1;s>-1;--s)if(t[n[s]]===1&&this[n[s]]!==void 0&&this[n[s]]!==null)return n[s]}};ae.oneOfSetter=function(e){return function(t){for(var i=0;i<e.length;++i)e[i]!==t&&delete this[e[i]]}};ae.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};ae._configure=function(){var r=ae.Buffer;if(!r){ae._Buffer_from=ae._Buffer_allocUnsafe=null;return}ae._Buffer_from=r.from!==Uint8Array.from&&r.from||function(t,i){return new r(t,i)},ae._Buffer_allocUnsafe=r.allocUnsafe||function(t){return new r(t)}}});var Dd=C((eq,o8)=>{"use strict";o8.exports=Ue;var Vr=vn(),Nd,Ya=Vr.LongBits,c8=Vr.base64,d8=Vr.utf8;function uf(r,e,t){this.fn=r,this.len=e,this.next=void 0,this.val=t}function Pd(){}function T_(r){this.head=r.head,this.tail=r.tail,this.len=r.len,this.next=r.states}function Ue(){this.len=0,this.head=new uf(Pd,0,0),this.tail=this.head,this.states=null}var h8=function(){return Vr.Buffer?function(){return(Ue.create=function(){return new Nd})()}:function(){return new Ue}};Ue.create=h8();Ue.alloc=function(e){return new Vr.Array(e)};Vr.Array!==Array&&(Ue.alloc=Vr.pool(Ue.alloc,Vr.Array.prototype.subarray));Ue.prototype._push=function(e,t,i){return this.tail=this.tail.next=new uf(e,t,i),this.len+=t,this};function Rd(r,e,t){e[t]=r&255}function N_(r,e,t){for(;r>127;)e[t++]=r&127|128,r>>>=7;e[t]=r}function Kd(r,e){this.len=r,this.next=void 0,this.val=e}Kd.prototype=Object.create(uf.prototype);Kd.prototype.fn=N_;Ue.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new Kd((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};Ue.prototype.int32=function(e){return e<0?this._push(Ld,10,Ya.fromNumber(e)):this.uint32(e)};Ue.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Ld(r,e,t){for(;r.hi;)e[t++]=r.lo&127|128,r.lo=(r.lo>>>7|r.hi<<25)>>>0,r.hi>>>=7;for(;r.lo>127;)e[t++]=r.lo&127|128,r.lo=r.lo>>>7;e[t++]=r.lo}Ue.prototype.uint64=function(e){var t=Ya.from(e);return this._push(Ld,t.length(),t)};Ue.prototype.int64=Ue.prototype.uint64;Ue.prototype.sint64=function(e){var t=Ya.from(e).zzEncode();return this._push(Ld,t.length(),t)};Ue.prototype.bool=function(e){return this._push(Rd,1,e?1:0)};function Fd(r,e,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24}Ue.prototype.fixed32=function(e){return this._push(Fd,4,e>>>0)};Ue.prototype.sfixed32=Ue.prototype.fixed32;Ue.prototype.fixed64=function(e){var t=Ya.from(e);return this._push(Fd,4,t.lo)._push(Fd,4,t.hi)};Ue.prototype.sfixed64=Ue.prototype.fixed64;Ue.prototype.float=function(e){return this._push(Vr.float.writeFloatLE,4,e)};Ue.prototype.double=function(e){return this._push(Vr.float.writeDoubleLE,8,e)};var P_=Vr.Array.prototype.set?function(e,t,i){t.set(e,i)}:function(e,t,i){for(var n=0;n<e.length;++n)t[i+n]=e[n]};Ue.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(Rd,1,0);if(Vr.isString(e)){var i=Ue.alloc(t=c8.length(e));c8.decode(e,i,0),e=i}return this.uint32(t)._push(P_,t,e)};Ue.prototype.string=function(e){var t=d8.length(e);return t?this.uint32(t)._push(d8.write,t,e):this._push(Rd,1,0)};Ue.prototype.fork=function(){return this.states=new T_(this),this.head=this.tail=new uf(Pd,0,0),this.len=0,this};Ue.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new uf(Pd,0,0),this.len=0),this};Ue.prototype.ldelim=function(){var e=this.head,t=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=e.next,this.tail=t,this.len+=i),this};Ue.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),i=0;e;)e.fn(e.val,t,i),i+=e.len,e=e.next;return t};Ue._configure=function(r){Nd=r,Ue.create=h8(),Nd._configure()}});var b8=C((tq,u8)=>{"use strict";u8.exports=Ni;var l8=Dd();(Ni.prototype=Object.create(l8.prototype)).constructor=Ni;var wn=vn();function Ni(){l8.call(this)}Ni._configure=function(){Ni.alloc=wn._Buffer_allocUnsafe,Ni.writeBytesBuffer=wn.Buffer&&wn.Buffer.prototype instanceof Uint8Array&&wn.Buffer.prototype.set.name==="set"?function(e,t,i){t.set(e,i)}:function(e,t,i){if(e.copy)e.copy(t,i,0,e.length);else for(var n=0;n<e.length;)t[i++]=e[n++]}};Ni.prototype.bytes=function(e){wn.isString(e)&&(e=wn._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(Ni.writeBytesBuffer,t,e),this};function R_(r,e,t){r.length<40?wn.utf8.write(r,e,t):e.utf8Write?e.utf8Write(r,t):e.write(r,t)}Ni.prototype.string=function(e){var t=wn.Buffer.byteLength(e);return this.uint32(t),t&&this._push(R_,t,e),this};Ni._configure()});var Ud=C((rq,p8)=>{"use strict";p8.exports=Ft;var Pi=vn(),zd,y8=Pi.LongBits,K_=Pi.utf8;function ni(r,e){return RangeError("index out of range: "+r.pos+" + "+(e||1)+" > "+r.len)}function Ft(r){this.buf=r,this.pos=0,this.len=r.length}var m8=typeof Uint8Array!="undefined"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Ft(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Ft(e);throw Error("illegal buffer")},x8=function(){return Pi.Buffer?function(t){return(Ft.create=function(n){return Pi.Buffer.isBuffer(n)?new zd(n):m8(n)})(t)}:m8};Ft.create=x8();Ft.prototype._slice=Pi.Array.prototype.subarray||Pi.Array.prototype.slice;Ft.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,ni(this,10);return e}}();Ft.prototype.int32=function(){return this.uint32()|0};Ft.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function Od(){var r=new y8(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(r.lo=(r.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return r;if(r.lo=(r.lo|(this.buf[this.pos]&127)<<28)>>>0,r.hi=(r.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return r;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw ni(this);if(r.lo=(r.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return r}return r.lo=(r.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,r}if(this.len-this.pos>4){for(;e<5;++e)if(r.hi=(r.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return r}else for(;e<5;++e){if(this.pos>=this.len)throw ni(this);if(r.hi=(r.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return r}throw Error("invalid varint encoding")}Ft.prototype.bool=function(){return this.uint32()!==0};function Za(r,e){return(r[e-4]|r[e-3]<<8|r[e-2]<<16|r[e-1]<<24)>>>0}Ft.prototype.fixed32=function(){if(this.pos+4>this.len)throw ni(this,4);return Za(this.buf,this.pos+=4)};Ft.prototype.sfixed32=function(){if(this.pos+4>this.len)throw ni(this,4);return Za(this.buf,this.pos+=4)|0};function v8(){if(this.pos+8>this.len)throw ni(this,8);return new y8(Za(this.buf,this.pos+=4),Za(this.buf,this.pos+=4))}Ft.prototype.float=function(){if(this.pos+4>this.len)throw ni(this,4);var e=Pi.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};Ft.prototype.double=function(){if(this.pos+8>this.len)throw ni(this,4);var e=Pi.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};Ft.prototype.bytes=function(){var e=this.uint32(),t=this.pos,i=this.pos+e;if(i>this.len)throw ni(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,i):t===i?new this.buf.constructor(0):this._slice.call(this.buf,t,i)};Ft.prototype.string=function(){var e=this.bytes();return K_.read(e,0,e.length)};Ft.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw ni(this,e);this.pos+=e}else do if(this.pos>=this.len)throw ni(this);while(this.buf[this.pos++]&128);return this};Ft.prototype.skipType=function(r){switch(r){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(r=this.uint32()&7)!=4;)this.skipType(r);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+r+" at offset "+this.pos)}return this};Ft._configure=function(r){zd=r,Ft.create=x8(),zd._configure();var e=Pi.Long?"toLong":"toNumber";Pi.merge(Ft.prototype,{int64:function(){return Od.call(this)[e](!1)},uint64:function(){return Od.call(this)[e](!0)},sint64:function(){return Od.call(this).zzDecode()[e](!1)},fixed64:function(){return v8.call(this)[e](!0)},sfixed64:function(){return v8.call(this)[e](!1)}})}});var E8=C((iq,g8)=>{"use strict";g8.exports=n0;var w8=Ud();(n0.prototype=Object.create(w8.prototype)).constructor=n0;var S8=vn();function n0(r){w8.call(this,r)}n0._configure=function(){S8.Buffer&&(n0.prototype._slice=S8.Buffer.prototype.slice)};n0.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};n0._configure()});var _8=C((nq,M8)=>{"use strict";M8.exports=lf;var Hd=vn();(lf.prototype=Object.create(Hd.EventEmitter.prototype)).constructor=lf;function lf(r,e,t){if(typeof r!="function")throw TypeError("rpcImpl must be a function");Hd.EventEmitter.call(this),this.rpcImpl=r,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(t)}lf.prototype.rpcCall=function r(e,t,i,n,s){if(!n)throw TypeError("request must be specified");var f=this;if(!s)return Hd.asPromise(r,f,e,t,i,n);if(!f.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return f.rpcImpl(e,t[f.requestDelimited?"encodeDelimited":"encode"](n).finish(),function(o,c){if(o)return f.emit("error",o,e),s(o);if(c===null){f.end(!0);return}if(!(c instanceof i))try{c=i[f.responseDelimited?"decodeDelimited":"decode"](c)}catch(d){return f.emit("error",d,e),s(d)}return f.emit("data",c,e),s(null,c)})}catch(a){f.emit("error",a,e),setTimeout(function(){s(a)},0);return}};lf.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var A8=C(I8=>{"use strict";var L_=I8;L_.Service=_8()});var k8=C((fq,B8)=>{"use strict";B8.exports={}});var T8=C(q8=>{"use strict";var Br=q8;Br.build="minimal";Br.Writer=Dd();Br.BufferWriter=b8();Br.Reader=Ud();Br.BufferReader=E8();Br.util=vn();Br.rpc=A8();Br.roots=k8();Br.configure=C8;function C8(){Br.util._configure(),Br.Writer._configure(Br.BufferWriter),Br.Reader._configure(Br.BufferReader)}C8()});var P8=C((oq,N8)=>{"use strict";N8.exports=T8()});var K8=C((R8,bf)=>{(function(r,e){typeof define=="function"&&define.amd?define(["protobufjs/minimal"],e):typeof bf=="object"&&bf&&bf.exports&&(bf.exports=e(P8()))})(R8,function(r){var e=r.Reader,t=r.Writer,i=r.util,n=r.roots.default||(r.roots.default={});return n.pb=function(){var s={};return s.NoiseHandshakePayload=function(){function f(a){if(a)for(var o=Object.keys(a),c=0;c<o.length;++c)a[o[c]]!=null&&(this[o[c]]=a[o[c]])}return f.prototype.identityKey=i.newBuffer([]),f.prototype.identitySig=i.newBuffer([]),f.prototype.data=i.newBuffer([]),f.create=function(o){return new f(o)},f.encode=function(o,c){return c||(c=t.create()),o.identityKey!=null&&o.hasOwnProperty("identityKey")&&c.uint32(10).bytes(o.identityKey),o.identitySig!=null&&o.hasOwnProperty("identitySig")&&c.uint32(18).bytes(o.identitySig),o.data!=null&&o.hasOwnProperty("data")&&c.uint32(26).bytes(o.data),c},f.encodeDelimited=function(o,c){return this.encode(o,c).ldelim()},f.decode=function(o,c){o instanceof e||(o=e.create(o));for(var d=c===void 0?o.len:o.pos+c,u=new n.pb.NoiseHandshakePayload;o.pos<d;){var p=o.uint32();switch(p>>>3){case 1:u.identityKey=o.bytes();break;case 2:u.identitySig=o.bytes();break;case 3:u.data=o.bytes();break;default:o.skipType(p&7);break}}return u},f.decodeDelimited=function(o){return o instanceof e||(o=new e(o)),this.decode(o,o.uint32())},f.verify=function(o){return typeof o!="object"||o===null?"object expected":o.identityKey!=null&&o.hasOwnProperty("identityKey")&&!(o.identityKey&&typeof o.identityKey.length=="number"||i.isString(o.identityKey))?"identityKey: buffer expected":o.identitySig!=null&&o.hasOwnProperty("identitySig")&&!(o.identitySig&&typeof o.identitySig.length=="number"||i.isString(o.identitySig))?"identitySig: buffer expected":o.data!=null&&o.hasOwnProperty("data")&&!(o.data&&typeof o.data.length=="number"||i.isString(o.data))?"data: buffer expected":null},f.fromObject=function(o){if(o instanceof n.pb.NoiseHandshakePayload)return o;var c=new n.pb.NoiseHandshakePayload;return o.identityKey!=null&&(typeof o.identityKey=="string"?i.base64.decode(o.identityKey,c.identityKey=i.newBuffer(i.base64.length(o.identityKey)),0):o.identityKey.length&&(c.identityKey=o.identityKey)),o.identitySig!=null&&(typeof o.identitySig=="string"?i.base64.decode(o.identitySig,c.identitySig=i.newBuffer(i.base64.length(o.identitySig)),0):o.identitySig.length&&(c.identitySig=o.identitySig)),o.data!=null&&(typeof o.data=="string"?i.base64.decode(o.data,c.data=i.newBuffer(i.base64.length(o.data)),0):o.data.length&&(c.data=o.data)),c},f.toObject=function(o,c){c||(c={});var d={};return c.defaults&&(c.bytes===String?d.identityKey="":(d.identityKey=[],c.bytes!==Array&&(d.identityKey=i.newBuffer(d.identityKey))),c.bytes===String?d.identitySig="":(d.identitySig=[],c.bytes!==Array&&(d.identitySig=i.newBuffer(d.identitySig))),c.bytes===String?d.data="":(d.data=[],c.bytes!==Array&&(d.data=i.newBuffer(d.data)))),o.identityKey!=null&&o.hasOwnProperty("identityKey")&&(d.identityKey=c.bytes===String?i.base64.encode(o.identityKey,0,o.identityKey.length):c.bytes===Array?Array.prototype.slice.call(o.identityKey):o.identityKey),o.identitySig!=null&&o.hasOwnProperty("identitySig")&&(d.identitySig=c.bytes===String?i.base64.encode(o.identitySig,0,o.identitySig.length):c.bytes===Array?Array.prototype.slice.call(o.identitySig):o.identitySig),o.data!=null&&o.hasOwnProperty("data")&&(d.data=c.bytes===String?i.base64.encode(o.data,0,o.data.length):c.bytes===Array?Array.prototype.slice.call(o.data):o.data),d},f.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},f}(),s}(),n})});var H8=C((dq,U8)=>{"use strict";var os=Ki(),Xd=new Int8Array(new Int16Array([1]).buffer)[0]===0,pf=class{constructor(){this.state=new Uint32Array(16),this.stream=new Uint32Array(16),this.bytes=new Uint8Array(this.stream.buffer),this.pos=-1,Xd&&(this.bytes=Buffer.alloc(64))}init(e,t,i){if(i==null&&(i=0),os(Buffer.isBuffer(e)),os(Buffer.isBuffer(t)),os(Number.isSafeInteger(i)),e.length!==16&&e.length!==32)throw new RangeError("Invalid key size.");if(t.length>=24&&(e=pf.derive(e,t.slice(0,16)),t=t.slice(16)),this.state[0]=1634760805,this.state[1]=e.length<32?824206446:857760878,this.state[2]=e.length<32?2036477238:2036477234,this.state[3]=1797285236,this.state[4]=Ye(e,0),this.state[5]=Ye(e,4),this.state[6]=Ye(e,8),this.state[7]=Ye(e,12),this.state[8]=Ye(e,16%e.length),this.state[9]=Ye(e,20%e.length),this.state[10]=Ye(e,24%e.length),this.state[11]=Ye(e,28%e.length),this.state[12]=i>>>0,t.length===8)this.state[13]=i/4294967296>>>0,this.state[14]=Ye(t,0),this.state[15]=Ye(t,4);else if(t.length===12)this.state[13]=Ye(t,0),this.state[14]=Ye(t,4),this.state[15]=Ye(t,8);else if(t.length===16)this.state[12]=Ye(t,0),this.state[13]=Ye(t,4),this.state[14]=Ye(t,8),this.state[15]=Ye(t,12);else throw new RangeError("Invalid nonce size.");return this.pos=0,this}encrypt(e){if(os(Buffer.isBuffer(e)),this.pos===-1)throw new Error("Context is not initialized.");for(let t=0;t<e.length;t++)(this.pos&63)==0&&(this._block(),this.pos=0),e[t]^=this.bytes[this.pos++];return e}_block(){for(let e=0;e<16;e++)this.stream[e]=this.state[e];for(let e=0;e<10;e++)br(this.stream,0,4,8,12),br(this.stream,1,5,9,13),br(this.stream,2,6,10,14),br(this.stream,3,7,11,15),br(this.stream,0,5,10,15),br(this.stream,1,6,11,12),br(this.stream,2,7,8,13),br(this.stream,3,4,9,14);for(let e=0;e<16;e++)this.stream[e]+=this.state[e];if(Xd)for(let e=0;e<16;e++)Wi(this.bytes,this.stream[e],e*4);this.state[12]+=1,this.state[12]===0&&(this.state[13]+=1)}destroy(){for(let e=0;e<16;e++)this.state[e]=0,this.stream[e]=0;if(Xd)for(let e=0;e<64;e++)this.bytes[e]=0;return this.pos=-1,this}static derive(e,t){if(os(Buffer.isBuffer(e)),os(Buffer.isBuffer(t)),e.length!==16&&e.length!==32)throw new RangeError("Invalid key size.");if(t.length!==16)throw new RangeError("Invalid nonce size.");let i=new Uint32Array(16);i[0]=1634760805,i[1]=e.length<32?824206446:857760878,i[2]=e.length<32?2036477238:2036477234,i[3]=1797285236,i[4]=Ye(e,0),i[5]=Ye(e,4),i[6]=Ye(e,8),i[7]=Ye(e,12),i[8]=Ye(e,16%e.length),i[9]=Ye(e,20%e.length),i[10]=Ye(e,24%e.length),i[11]=Ye(e,28%e.length),i[12]=Ye(t,0),i[13]=Ye(t,4),i[14]=Ye(t,8),i[15]=Ye(t,12);for(let s=0;s<10;s++)br(i,0,4,8,12),br(i,1,5,9,13),br(i,2,6,10,14),br(i,3,7,11,15),br(i,0,5,10,15),br(i,1,6,11,12),br(i,2,7,8,13),br(i,3,4,9,14);let n=Buffer.alloc(32);return Wi(n,i[0],0),Wi(n,i[1],4),Wi(n,i[2],8),Wi(n,i[3],12),Wi(n,i[12],16),Wi(n,i[13],20),Wi(n,i[14],24),Wi(n,i[15],28),n}};pf.native=0;function br(r,e,t,i,n){r[e]+=r[t],r[n]=Qa(r[n]^r[e],16),r[i]+=r[n],r[t]=Qa(r[t]^r[i],12),r[e]+=r[t],r[n]=Qa(r[n]^r[e],8),r[i]+=r[n],r[t]=Qa(r[t]^r[i],7)}function Qa(r,e){return r<<e|r>>>32-e}function Ye(r,e){return r[e++]+r[e++]*256+r[e++]*65536+r[e]*16777216}function Wi(r,e,t){return r[t++]=e,e>>>=8,r[t++]=e,e>>>=8,r[t++]=e,e>>>=8,r[t++]=e,t}U8.exports=pf});var J8=C((hq,V8)=>{"use strict";var eo=Ki(),Yd=class{constructor(){this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.buffer=Buffer.alloc(16),this.fin=-1,this.leftover=0}init(e){eo(Buffer.isBuffer(e)&&e.length>=32);let t=cr(e,0),i=cr(e,2),n=cr(e,4),s=cr(e,6),f=cr(e,8),a=cr(e,10),o=cr(e,12),c=cr(e,14);this.r[0]=t&8191,this.r[1]=(t>>>13|i<<3)&8191,this.r[2]=(i>>>10|n<<6)&7939,this.r[3]=(n>>>7|s<<9)&8191,this.r[4]=(s>>>4|f<<12)&255,this.r[5]=f>>>1&8190,this.r[6]=(f>>>14|a<<2)&8191,this.r[7]=(a>>>11|o<<5)&8065,this.r[8]=(o>>>8|c<<8)&8191,this.r[9]=c>>>5&127;for(let d=0;d<10;d++)this.h[d]=0;for(let d=0;d<8;d++)this.pad[d]=cr(e,16+2*d);return this.fin=0,this.leftover=0,this}_blocks(e,t,i){let n=this.fin?0:1<<11,s=new Uint32Array(10);for(;t>=16;){let f=cr(e,i+0),a=cr(e,i+2),o=cr(e,i+4),c=cr(e,i+6),d=cr(e,i+8),u=cr(e,i+10),p=cr(e,i+12),x=cr(e,i+14);this.h[0]+=f&8191,this.h[1]+=(f>>>13|a<<3)&8191,this.h[2]+=(a>>>10|o<<6)&8191,this.h[3]+=(o>>>7|c<<9)&8191,this.h[4]+=(c>>>4|d<<12)&8191,this.h[5]+=d>>>1&8191,this.h[6]+=(d>>>14|u<<2)&8191,this.h[7]+=(u>>>11|p<<5)&8191,this.h[8]+=(p>>>8|x<<8)&8191,this.h[9]+=x>>>5|n;let y=0;for(let g=0;g<10;g++){s[g]=y;for(let M=0;M<10;M++){let k=this.h[M];M<=g?k*=this.r[g-M]:k*=5*this.r[g+10-M],s[g]+=k,M===4&&(y=s[g]>>>13,s[g]&=8191)}y+=s[g]>>>13,s[g]&=8191}y=(y<<2)+y,y+=s[0],s[0]=y&8191,y=y>>>13,s[1]+=y;for(let g=0;g<10;g++)this.h[g]=s[g];i+=16,t-=16}}update(e){if(eo(Buffer.isBuffer(e)),this.fin===-1)throw new Error("Context is not initialized.");let t=e.length,i=0;if(this.leftover){let n=16-this.leftover;n>t&&(n=t);for(let s=0;s<n;s++)this.buffer[this.leftover+s]=e[i+s];if(t-=n,i+=n,this.leftover+=n,this.leftover<16)return this;this._blocks(this.buffer,16,0),this.leftover=0}if(t>=16){let n=t&~(16-1);this._blocks(e,n,i),i+=n,t-=n}if(t){for(let n=0;n<t;n++)this.buffer[this.leftover+n]=e[i+n];this.leftover+=t}return this}final(){if(this.fin===-1)throw new Error("Context is not initialized.");let e=Buffer.alloc(16),t=new Uint16Array(10);if(this.leftover){let f=this.leftover;for(this.buffer[f++]=1;f<16;f++)this.buffer[f]=0;this.fin=1,this._blocks(this.buffer,16,0)}let i=this.h[1]>>>13;this.h[1]&=8191;for(let f=2;f<10;f++)this.h[f]+=i,i=this.h[f]>>>13,this.h[f]&=8191;this.h[0]+=i*5,i=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=i,i=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=i,t[0]=this.h[0]+5,i=t[0]>>>13,t[0]&=8191;for(let f=1;f<10;f++)t[f]=this.h[f]+i,i=t[f]>>>13,t[f]&=8191;let n=(i^1)-1;for(let f=0;f<10;f++)t[f]&=n;n=~n;for(let f=0;f<10;f++)this.h[f]=this.h[f]&n|t[f];this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535;let s=this.h[0]+this.pad[0];this.h[0]=s;for(let f=1;f<8;f++)s=this.h[f]+this.pad[f]+(s>>>16),this.h[f]=s;for(let f=0;f<8;f++)O_(e,this.h[f],f*2);return this.destroy(),e}destroy(){for(let e=0;e<10;e++)this.r[e]=0,this.h[e]=0;for(let e=0;e<8;e++)this.pad[e]=0;for(let e=0;e<16;e++)this.buffer[e]=0;this.fin=-1,this.leftover=0}verify(e){eo(Buffer.isBuffer(e)),eo(e.length===16);let t=this.final(),i=0;for(let n=0;n<16;n++)i|=t[n]^e[n];return i-1>>>31!=0}};Yd.native=0;function cr(r,e){return r[e++]+r[e]*256}function O_(r,e,t){return r[t++]=e,r[t++]=e>>>8,t}V8.exports=Yd});var W8=C((uq,G8)=>{"use strict";var cs=Ki(),X8=H8(),U_=J8(),H_=Buffer.alloc(16,0),s0=class{constructor(){this.chacha=new X8,this.poly=new U_,this.key=Buffer.alloc(64),this.mode=-1,this.aadLen=0,this.cipherLen=0}init(e,t){return cs(Buffer.isBuffer(e)),cs(Buffer.isBuffer(t)),this.key.fill(0),this.chacha.init(e,t,0),this.chacha.encrypt(this.key),this.poly.init(this.key),this.mode=0,this.aadLen=0,this.cipherLen=0,this}aad(e){if(this.mode===-1)throw new Error("Context is not initialized.");if(this.mode!==0)throw new Error("Invalid state for aad.");return this.poly.update(e),this.aadLen+=e.length,this}encrypt(e){if(this.mode===-1)throw new Error("Context is not initialized.");if(this.mode!==0&&this.mode!==1)throw new Error("Invalid state for encrypt.");return this.mode===0&&(this._pad16(this.aadLen),this.mode=1),this.chacha.encrypt(e),this.poly.update(e),this.cipherLen+=e.length,e}decrypt(e){if(cs(Buffer.isBuffer(e)),this.mode===-1)throw new Error("Context is not initialized.");if(this.mode!==0&&this.mode!==2)throw new Error("Invalid state for decrypt.");return this.mode===0&&(this._pad16(this.aadLen),this.mode=2),this.cipherLen+=e.length,this.poly.update(e),this.chacha.encrypt(e),e}auth(e){if(cs(Buffer.isBuffer(e)),this.mode===-1)throw new Error("Context is not initialized.");if(this.mode!==0&&this.mode!==3)throw new Error("Invalid state for auth.");return this.mode===0&&(this._pad16(this.aadLen),this.mode=3),this.cipherLen+=e.length,this.poly.update(e),e}final(){if(this.mode===-1)throw new Error("Context is not initialized.");let e=Buffer.alloc(16);Y8(e,this.aadLen,0),Y8(e,this.cipherLen,8),this.mode===0&&this._pad16(this.aadLen),this._pad16(this.cipherLen),this.poly.update(e);let t=this.poly.final();return this.destroy(),t}destroy(){this.chacha.destroy(),this.poly.destroy();for(let e=0;e<64;e++)this.key[e]=0;return this.mode=-1,this.aadLen=0,this.cipherLen=0,this}verify(e){cs(Buffer.isBuffer(e)),cs(e.length===16);let t=this.final(),i=0;for(let n=0;n<16;n++)i|=t[n]^e[n];return i-1>>>31!=0}_pad16(e){let t=e&15;t>0&&this.poly.update(H_.slice(0,16-t))}static encrypt(e,t,i,n){let s=new s0;return s.init(e,t),n&&s.aad(n),s.encrypt(i),s.final()}static decrypt(e,t,i,n,s){let f=new s0;return f.init(e,t),s&&f.aad(s),f.decrypt(i),f.verify(n)}static auth(e,t,i,n,s){let f=new s0;return f.init(e,t),s&&f.aad(s),f.auth(i),f.verify(n)}};s0.native=X8.native;function Z8(r,e,t){return r[t++]=e,e>>>=8,r[t++]=e,e>>>=8,r[t++]=e,e>>>=8,r[t++]=e,t}function Y8(r,e,t){let i=e*(1/4294967296)>>>0,n=e>>>0;return Z8(r,n,t+0),Z8(r,i,t+4),t+8}G8.exports=s0});var $8=C((lq,j8)=>{var ds=1e3,hs=ds*60,us=hs*60,f0=us*24,V_=f0*7,J_=f0*365.25;j8.exports=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return G_(r);if(t==="number"&&isFinite(r))return e.long?Y_(r):X_(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function G_(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(!!e){var t=parseFloat(e[1]),i=(e[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return t*J_;case"weeks":case"week":case"w":return t*V_;case"days":case"day":case"d":return t*f0;case"hours":case"hour":case"hrs":case"hr":case"h":return t*us;case"minutes":case"minute":case"mins":case"min":case"m":return t*hs;case"seconds":case"second":case"secs":case"sec":case"s":return t*ds;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function X_(r){var e=Math.abs(r);return e>=f0?Math.round(r/f0)+"d":e>=us?Math.round(r/us)+"h":e>=hs?Math.round(r/hs)+"m":e>=ds?Math.round(r/ds)+"s":r+"ms"}function Y_(r){var e=Math.abs(r);return e>=f0?to(r,e,f0,"day"):e>=us?to(r,e,us,"hour"):e>=hs?to(r,e,hs,"minute"):e>=ds?to(r,e,ds,"second"):r+" ms"}function to(r,e,t,i){var n=e>=t*1.5;return Math.round(r/t)+" "+i+(n?"s":"")}});var ey=C((bq,Q8)=>{function Z_(r){t.debug=t,t.default=t,t.coerce=o,t.disable=s,t.enable=n,t.enabled=f,t.humanize=$8(),t.destroy=c,Object.keys(r).forEach(d=>{t[d]=r[d]}),t.names=[],t.skips=[],t.formatters={};function e(d){let u=0;for(let p=0;p<d.length;p++)u=(u<<5)-u+d.charCodeAt(p),u|=0;return t.colors[Math.abs(u)%t.colors.length]}t.selectColor=e;function t(d){let u,p=null;function x(...y){if(!x.enabled)return;let g=x,M=Number(new Date),k=M-(u||M);g.diff=k,g.prev=u,g.curr=M,u=M,y[0]=t.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");let R=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,(L,O)=>{if(L==="%%")return"%";R++;let F=t.formatters[O];if(typeof F=="function"){let G=y[R];L=F.call(g,G),y.splice(R,1),R--}return L}),t.formatArgs.call(g,y),(g.log||t.log).apply(g,y)}return x.namespace=d,x.useColors=t.useColors(),x.color=t.selectColor(d),x.extend=i,x.destroy=t.destroy,Object.defineProperty(x,"enabled",{enumerable:!0,configurable:!1,get:()=>p===null?t.enabled(d):p,set:y=>{p=y}}),typeof t.init=="function"&&t.init(x),x}function i(d,u){let p=t(this.namespace+(typeof u=="undefined"?":":u)+d);return p.log=this.log,p}function n(d){t.save(d),t.names=[],t.skips=[];let u,p=(typeof d=="string"?d:"").split(/[\s,]+/),x=p.length;for(u=0;u<x;u++)!p[u]||(d=p[u].replace(/\*/g,".*?"),d[0]==="-"?t.skips.push(new RegExp("^"+d.substr(1)+"$")):t.names.push(new RegExp("^"+d+"$")))}function s(){let d=[...t.names.map(a),...t.skips.map(a).map(u=>"-"+u)].join(",");return t.enable(""),d}function f(d){if(d[d.length-1]==="*")return!0;let u,p;for(u=0,p=t.skips.length;u<p;u++)if(t.skips[u].test(d))return!1;for(u=0,p=t.names.length;u<p;u++)if(t.names[u].test(d))return!0;return!1}function a(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function o(d){return d instanceof Error?d.stack||d.message:d}function c(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}Q8.exports=Z_});var ty=C((Pr,ro)=>{Pr.formatArgs=W_;Pr.save=j_;Pr.load=$_;Pr.useColors=Q_;Pr.storage=eI();Pr.destroy=(()=>{let r=!1;return()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();Pr.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Q_(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function W_(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+ro.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;r.splice(1,0,e,"color: inherit");let t=0,i=0;r[0].replace(/%[a-zA-Z%]/g,n=>{n!=="%%"&&(t++,n==="%c"&&(i=t))}),r.splice(i,0,e)}Pr.log=console.debug||console.log||(()=>{});function j_(r){try{r?Pr.storage.setItem("debug",r):Pr.storage.removeItem("debug")}catch(e){}}function $_(){let r;try{r=Pr.storage.getItem("debug")}catch(e){}return!r&&typeof process!="undefined"&&"env"in process&&(r=process.env.DEBUG),r}function eI(){try{return localStorage}catch(r){}}ro.exports=ey()(Pr);var{formatters:tI}=ro.exports;tI.j=function(r){try{return JSON.stringify(r)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var iI={};wy(iI,{NOISE:()=>by,Noise:()=>wf});var{Buffer}=Ht();var hy=We(Nf()),ho=We(Ht()),rh=We(Il()),uy=We(Nl()),ih=We(Pl()),ly=We(Ll()),uo=We(Ho());var ys=We(Ht());var An=We(Ht());var Vd=We(Ul()),Wa=We(Nf()),Jd=We(Xo()),Jr=We(Ht()),ja=We(M5()),L8=We(L5()),F8=We(K8()),D8=We(Jf()),$a=F8.pb.NoiseHandshakePayload;function Sn(){let r=Wa.default.privateKeyGenerate();return{publicKey:Wa.default.publicKeyCreate(r),privateKey:r}}async function O8(r,e,t){let i=await D_(r,z8(e)),n=t??Jr.Buffer.alloc(0);return F_(r.marshalPubKey(),i,n)}function F_(r,e,t){let i=$a.create({identityKey:Jr.Buffer.from(r),identitySig:e,data:t??null});return Jr.Buffer.from($a.encode(i).finish())}async function D_(r,e){return Jr.Buffer.from(await r.privKey.sign(e))}async function En(r){return await ja.default.createFromPubKey(Jr.Buffer.from(r.identityKey))}function Mn(r){return $a.toObject($a.decode(Jr.Buffer.from(r)))}function z8(r){return Jr.Buffer.concat([Jr.Buffer.from("noise-libp2p-static-key:"),r])}async function z_(r,e){let t=await ja.default.createFromPubKey(e);return D8.default(t.id,r)}async function _n(r,e,t){let i=Jr.Buffer.from(e.identityKey);if(!await z_(t.id,i))throw new Error("Peer ID doesn't match libp2p public key.");let n=z8(r),s=L8.keys.unmarshalPublicKey(i);if(!e.identitySig||!s.verify(n,Jr.Buffer.from(e.identitySig)))throw new Error("Static key doesn't match to peer that signed payload!");return await ja.default.createFromPubKey(i)}function Gd(r,e){let t=Jr.Buffer.alloc(0),i=Vd.default.extract(Jd.default,e,r),n=Vd.default.expand(Jd.default,i,t,96),s=n.slice(0,32),f=n.slice(32,64),a=n.slice(64,96);return[s,f,a]}function Zi(r){return Wa.default.publicKeyVerify(r.slice(0,32))}var pr=We(Ht()),Wd=We(W8()),ny=We(Nf()),sy=We(Xo());var iy=We(ty());var a0=65535,Zd=a0-16,ry=process.env.DUMP_SESSION_KEYS;var we=iy.default("libp2p:noise"),Gr;ry?Gr=we:Gr=()=>{};function io(r){Gr(`LOCAL_STATIC_PUBLIC_KEY ${r.publicKey.toString("hex")}`),Gr(`LOCAL_STATIC_PRIVATE_KEY ${r.privateKey.toString("hex")}`)}function In(r){r?(Gr(`LOCAL_PUBLIC_EPHEMERAL_KEY ${r.publicKey.toString("hex")}`),Gr(`LOCAL_PRIVATE_EPHEMERAL_KEY ${r.privateKey.toString("hex")}`)):Gr("Missing local ephemeral keys.")}function ls(r){Gr(`REMOTE_STATIC_PUBLIC_KEY ${r.toString("hex")}`)}function ji(r){Gr(`REMOTE_EPHEMERAL_PUBLIC_KEY ${r.toString("hex")}`)}function no(r){r.cs1&&r.cs2?(Gr(`CIPHER_STATE_1 ${r.cs1.n} ${r.cs1.k.toString("hex")}`),Gr(`CIPHER_STATE_2 ${r.cs2.n} ${r.cs2.k.toString("hex")}`)):Gr("Missing cipher state.")}var rI=0,yf=class{encryptWithAd(e,t,i){let n=this.encrypt(e.k,e.n,t,i);return this.setNonce(e,this.incrementNonce(e.n)),n}decryptWithAd(e,t,i){let{plaintext:n,valid:s}=this.decrypt(e.k,e.n,t,i);return this.setNonce(e,this.incrementNonce(e.n)),{plaintext:n,valid:s}}hasKey(e){return!this.isEmptyKey(e.k)}setNonce(e,t){e.n=t}createEmptyKey(){return pr.Buffer.alloc(32)}isEmptyKey(e){return this.createEmptyKey().equals(e)}incrementNonce(e){return e+1}nonceToBytes(e){let t=pr.Buffer.alloc(12);return t.writeUInt32LE(e,4),t}encrypt(e,t,i,n){let s=this.nonceToBytes(t),f=new Wd.default;return n=pr.Buffer.from(n),f.init(e,s),f.aad(i),f.encrypt(n),pr.Buffer.concat([n,f.final()])}encryptAndHash(e,t){let i;return this.hasKey(e.cs)?i=this.encryptWithAd(e.cs,e.h,t):i=t,this.mixHash(e,i),i}decrypt(e,t,i,n){let s=this.nonceToBytes(t),f=new Wd.default;n=pr.Buffer.from(n);let a=n.slice(n.length-16);return n=n.slice(0,n.length-16),f.init(e,s),f.aad(i),f.decrypt(n),{plaintext:n,valid:f.verify(a)}}decryptAndHash(e,t){let i,n=!0;return this.hasKey(e.cs)?{plaintext:i,valid:n}=this.decryptWithAd(e.cs,e.h,t):i=t,this.mixHash(e,t),{plaintext:i,valid:n}}dh(e,t){try{let i=ny.default.derive(t,e),n=pr.Buffer.alloc(32);return i.copy(n),n}catch(i){return we(i.message),pr.Buffer.alloc(32)}}mixHash(e,t){e.h=this.getHash(e.h,t)}getHash(e,t){return sy.default.digest(pr.Buffer.from([...e,...t]))}mixKey(e,t){let[i,n]=Gd(e.ck,t);e.cs=this.initializeKey(n),e.ck=i}initializeKey(e){return{k:e,n:rI}}initializeSymmetric(e){let t=pr.Buffer.from(e,"utf-8"),i=this.hashProtocolName(t),n=i,s=this.createEmptyKey();return{cs:this.initializeKey(s),ck:n,h:i}}hashProtocolName(e){if(e.length<=32){let t=pr.Buffer.alloc(32);return e.copy(t),t}else return this.getHash(e,pr.Buffer.alloc(0))}split(e){let[t,i]=Gd(e.ck,pr.Buffer.alloc(0)),n=this.initializeKey(t),s=this.initializeKey(i);return{cs1:n,cs2:s}}writeMessageRegular(e,t){let i=this.encryptWithAd(e,pr.Buffer.alloc(0),t),n=this.createEmptyKey(),s=pr.Buffer.alloc(0);return{ne:n,ns:s,ciphertext:i}}readMessageRegular(e,t){return this.decryptWithAd(e,pr.Buffer.alloc(0),t.ciphertext)}};var jd=class extends yf{initializeInitiator(e,t,i,n){let s="Noise_XX_25519_ChaChaPoly_SHA256",f=this.initializeSymmetric(s);this.mixHash(f,e);let a=An.Buffer.alloc(32);return{ss:f,s:t,rs:i,psk:n,re:a}}initializeResponder(e,t,i,n){let s="Noise_XX_25519_ChaChaPoly_SHA256",f=this.initializeSymmetric(s);this.mixHash(f,e);let a=An.Buffer.alloc(32);return{ss:f,s:t,rs:i,psk:n,re:a}}writeMessageA(e,t,i){let n=An.Buffer.alloc(0);i!==void 0?e.e=i:e.e=Sn();let s=e.e.publicKey;this.mixHash(e.ss,s);let f=this.encryptAndHash(e.ss,t);return{ne:s,ns:n,ciphertext:f}}writeMessageB(e,t){e.e=Sn();let i=e.e.publicKey;this.mixHash(e.ss,i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let n=An.Buffer.from(e.s.publicKey),s=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let f=this.encryptAndHash(e.ss,t);return{ne:i,ns:s,ciphertext:f}}writeMessageC(e,t){let i=An.Buffer.from(e.s.publicKey),n=this.encryptAndHash(e.ss,i);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let s=this.encryptAndHash(e.ss,t),a={ne:this.createEmptyKey(),ns:n,ciphertext:s},{cs1:o,cs2:c}=this.split(e.ss);return{h:e.ss.h,messageBuffer:a,cs1:o,cs2:c}}readMessageA(e,t){return Zi(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),this.decryptAndHash(e.ss,t.ciphertext)}readMessageB(e,t){if(Zi(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,t.ns);n&&i.length===32&&Zi(i)&&(e.rs=i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:s,valid:f}=this.decryptAndHash(e.ss,t.ciphertext);return{plaintext:s,valid:n&&f}}readMessageC(e,t){let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,t.ns);if(n&&i.length===32&&Zi(i)&&(e.rs=i),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:s,valid:f}=this.decryptAndHash(e.ss,t.ciphertext),{cs1:a,cs2:o}=this.split(e.ss);return{h:e.ss.h,plaintext:s,valid:n&&f,cs1:a,cs2:o}}initSession(e,t,i){let n=this.createEmptyKey(),s=An.Buffer.alloc(32),f;return e?f=this.initializeInitiator(t,i,s,n):f=this.initializeResponder(t,i,s,n),{hs:f,i:e,mc:0}}sendMessage(e,t,i){let n;if(e.mc===0)n=this.writeMessageA(e.hs,t,i);else if(e.mc===1)n=this.writeMessageB(e.hs,t);else if(e.mc===2){let{h:s,messageBuffer:f,cs1:a,cs2:o}=this.writeMessageC(e.hs,t);n=f,e.h=s,e.cs1=a,e.cs2=o}else if(e.mc>2)if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");n=this.writeMessageRegular(e.cs1,t)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");n=this.writeMessageRegular(e.cs2,t)}else throw new Error("Session invalid.");return e.mc++,n}recvMessage(e,t){let i=An.Buffer.alloc(0),n=!1;if(e.mc===0)({plaintext:i,valid:n}=this.readMessageA(e.hs,t));else if(e.mc===1)({plaintext:i,valid:n}=this.readMessageB(e.hs,t));else if(e.mc===2){let{h:s,plaintext:f,valid:a,cs1:o,cs2:c}=this.readMessageC(e.hs,t);i=f,n=a,e.h=s,e.cs1=o,e.cs2=c}return e.mc++,{plaintext:i,valid:n}}};var o0=We(Ht()),mf=(r,e,t)=>(e=e||o0.Buffer.allocUnsafe(2),e.writeUInt16BE(r,t),e);mf.bytes=2;var xf=r=>{if(r.length<2)throw RangeError("Could not decode int16BE");return r.readUInt16BE(0)};xf.bytes=2;function so(r){return o0.Buffer.concat([r.ne,r.ciphertext])}function fo(r){return o0.Buffer.concat([r.ne,r.ns,r.ciphertext])}function fy(r){return o0.Buffer.concat([r.ns,r.ciphertext])}function bs(r){if(r.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:r.slice(0,32),ciphertext:r.slice(32,r.length),ns:o0.Buffer.alloc(0)}}function ps(r){if(r.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:r.slice(0,32),ns:r.slice(32,80),ciphertext:r.slice(80,r.length)}}function ay(r){if(r.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:o0.Buffer.alloc(0),ns:r.slice(0,48),ciphertext:r.slice(48,r.length)}}var vf=class{constructor(e,t,i,n,s,f,a){this.isInitiator=e,this.payload=t,this.prologue=i,this.staticKeypair=n,this.connection=s,f&&(this.remotePeer=f),this.xx=a??new jd,this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair),this.remoteEarlyData=ys.Buffer.alloc(0)}async propose(){if(io(this.session.hs.s),this.isInitiator){we("Stage 0 - Initiator starting to send first message.");let e=this.xx.sendMessage(this.session,ys.Buffer.alloc(0));this.connection.writeLP(so(e)),we("Stage 0 - Initiator finished sending first message."),In(this.session.hs.e)}else{we("Stage 0 - Responder waiting to receive first message...");let e=bs((await this.connection.readLP()).slice()),{valid:t}=this.xx.recvMessage(this.session,e);if(!t)throw new Error("xx handshake stage 0 validation fail");we("Stage 0 - Responder received first message."),ji(this.session.hs.re)}}async exchange(){if(this.isInitiator){we("Stage 1 - Initiator waiting to receive first message from responder...");let e=ps((await this.connection.readLP()).slice()),{plaintext:t,valid:i}=this.xx.recvMessage(this.session,e);if(!i)throw new Error("xx handshake stage 1 validation fail");we("Stage 1 - Initiator received the message."),ji(this.session.hs.re),ls(this.session.hs.rs),we("Initiator going to check remote's signature...");try{let n=await Mn(t);this.remotePeer=this.remotePeer||await En(n),this.remotePeer=await _n(e.ns,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let s=n;throw new Error(`Error occurred while verifying signed payload: ${s.message}`)}we("All good with the signature!")}else{we("Stage 1 - Responder sending out first message with signed payload and static key.");let e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(fo(e)),we("Stage 1 - Responder sent the second handshake message with signed payload."),In(this.session.hs.e)}}async finish(){if(this.isInitiator){we("Stage 2 - Initiator sending third handshake message.");let e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(fy(e)),we("Stage 2 - Initiator sent message with signed payload.")}else{we("Stage 2 - Responder waiting for third handshake message...");let e=ay((await this.connection.readLP()).slice()),{plaintext:t,valid:i}=this.xx.recvMessage(this.session,e);if(!i)throw new Error("xx handshake stage 2 validation fail");we("Stage 2 - Responder received the message, finished handshake.");try{let n=await Mn(t);this.remotePeer=this.remotePeer||await En(n),await _n(this.session.hs.rs,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let s=n;throw new Error(`Error occurred while verifying signed payload: ${s.message}`)}}no(this.session)}encrypt(e,t){let i=this.getCS(t);return this.xx.encryptWithAd(i,ys.Buffer.alloc(0),e)}decrypt(e,t){let i=this.getCS(t,!1);return this.xx.decryptWithAd(i,ys.Buffer.alloc(0),e)}getRemoteStaticKey(){return this.session.hs.rs}getCS(e,t=!0){if(!e.cs1||!e.cs2)throw new Error("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?t?e.cs1:e.cs2:t?e.cs2:e.cs1}setRemoteEarlyData(e){e&&(this.remoteEarlyData=ys.Buffer.from(e.buffer,e.byteOffset,e.length))}};var gf=We(Ht());var $d=class extends yf{initSession(e,t,i,n){let s=this.createEmptyKey(),f;return e?f=this.initializeInitiator(t,i,n,s):f=this.initializeResponder(t,i,n,s),{hs:f,i:e,mc:0}}sendMessage(e,t){let i;if(e.mc===0)i=this.writeMessageA(e.hs,t);else if(e.mc===1){let{messageBuffer:n,h:s,cs1:f,cs2:a}=this.writeMessageB(e.hs,t);i=n,e.h=s,e.cs1=f,e.cs2=a}else if(e.mc>1)if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");i=this.writeMessageRegular(e.cs1,t)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");i=this.writeMessageRegular(e.cs2,t)}else throw new Error("Session invalid.");return e.mc++,i}recvMessage(e,t){let i=gf.Buffer.alloc(0),n=!1;if(e.mc===0&&({plaintext:i,valid:n}=this.readMessageA(e.hs,t)),e.mc===1){let{plaintext:s,valid:f,h:a,cs1:o,cs2:c}=this.readMessageB(e.hs,t);i=s,n=f,e.h=a,e.cs1=o,e.cs2=c}return e.mc++,{plaintext:i,valid:n}}writeMessageA(e,t){e.e=Sn();let i=e.e.publicKey;this.mixHash(e.ss,i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let n=gf.Buffer.from(e.s.publicKey),s=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.rs));let f=this.encryptAndHash(e.ss,t);return{ne:i,ns:s,ciphertext:f}}writeMessageB(e,t){e.e=Sn();let i=e.e.publicKey;this.mixHash(e.ss,i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re)),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let n=this.encryptAndHash(e.ss,t),s=this.createEmptyKey(),f={ne:i,ns:s,ciphertext:n},{cs1:a,cs2:o}=this.split(e.ss);return{messageBuffer:f,cs1:a,cs2:o,h:e.ss.h}}readMessageA(e,t){Zi(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,t.ns);n&&i.length===32&&Zi(i)&&(e.rs=i),this.mixKey(e.ss,this.dh(e.s.privateKey,e.rs));let{plaintext:s,valid:f}=this.decryptAndHash(e.ss,t.ciphertext);return{plaintext:s,valid:n&&f}}readMessageB(e,t){if(Zi(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state should contain ephemeral key by now.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re)),this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,t.ciphertext),{cs1:s,cs2:f}=this.split(e.ss);return{h:e.ss.h,valid:n,plaintext:i,cs1:s,cs2:f}}initializeInitiator(e,t,i,n){let s="Noise_IK_25519_ChaChaPoly_SHA256",f=this.initializeSymmetric(s);this.mixHash(f,e),this.mixHash(f,i);let a=gf.Buffer.alloc(32);return{ss:f,s:t,rs:i,re:a,psk:n}}initializeResponder(e,t,i,n){let s="Noise_IK_25519_ChaChaPoly_SHA256",f=this.initializeSymmetric(s);this.mixHash(f,e),this.mixHash(f,t.publicKey);let a=gf.Buffer.alloc(32);return{ss:f,s:t,rs:i,re:a,psk:n}}};var c0=We(Ht());var ao=class extends Error{constructor(e,t){super(t);this.initialMsg=e,this.name="FailedIKhandshake"}};var Qd=class{constructor(e,t,i,n,s,f,a,o){this.isInitiator=e,this.payload=c0.Buffer.from(t),this.prologue=i,this.staticKeypair=n,this.connection=s,a&&(this.remotePeer=a),this.ik=o??new $d,this.session=this.ik.initSession(this.isInitiator,this.prologue,this.staticKeypair,f),this.remoteEarlyData=c0.Buffer.alloc(0)}async stage0(){if(io(this.session.hs.s),ls(this.session.hs.rs),this.isInitiator){we("IK Stage 0 - Initiator sending message...");let e=this.ik.sendMessage(this.session,this.payload);this.connection.writeLP(fo(e)),we("IK Stage 0 - Initiator sent message."),In(this.session.hs.e)}else{we("IK Stage 0 - Responder receiving message...");let e=await this.connection.readLP();try{let t=ps(e.slice()),{plaintext:i,valid:n}=this.ik.recvMessage(this.session,t);if(!n)throw new Error("ik handshake stage 0 decryption validation fail");we("IK Stage 0 - Responder got message, going to verify payload.");let s=await Mn(i);this.remotePeer=this.remotePeer||await En(s),await _n(this.session.hs.rs,s,this.remotePeer),this.setRemoteEarlyData(s.data),we("IK Stage 0 - Responder successfully verified payload!"),ji(this.session.hs.re)}catch(t){let i=t;throw we("Responder breaking up with IK handshake in stage 0."),new ao(e,`Error occurred while verifying initiator's signed payload: ${i.message}`)}}}async stage1(){if(this.isInitiator){we("IK Stage 1 - Initiator receiving message...");let e=(await this.connection.readLP()).slice(),t=bs(c0.Buffer.from(e)),{plaintext:i,valid:n}=this.ik.recvMessage(this.session,t);we("IK Stage 1 - Initiator got message, going to verify payload.");try{if(!n)throw new Error("ik stage 1 decryption validation fail");let s=await Mn(i);this.remotePeer=this.remotePeer||await En(s),await _n(t.ns.slice(0,32),s,this.remotePeer),this.setRemoteEarlyData(s.data),we("IK Stage 1 - Initiator successfully verified payload!"),ji(this.session.hs.re)}catch(s){let f=s;throw we("Initiator breaking up with IK handshake in stage 1."),new ao(e,`Error occurred while verifying responder's signed payload: ${f.message}`)}}else{we("IK Stage 1 - Responder sending message...");let e=this.ik.sendMessage(this.session,this.payload);this.connection.writeLP(so(e)),we("IK Stage 1 - Responder sent message..."),In(this.session.hs.e)}no(this.session)}decrypt(e,t){let i=this.getCS(t,!1);return this.ik.decryptWithAd(i,c0.Buffer.alloc(0),e)}encrypt(e,t){let i=this.getCS(t);return this.ik.encryptWithAd(i,c0.Buffer.alloc(0),e)}getLocalEphemeralKeys(){if(!this.session.hs.e)throw new Error("Ephemeral keys do not exist.");return this.session.hs.e}getCS(e,t=!0){if(!e.cs1||!e.cs2)throw new Error("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?t?e.cs1:e.cs2:t?e.cs2:e.cs1}setRemoteEarlyData(e){e&&(this.remoteEarlyData=c0.Buffer.from(e.buffer,e.byteOffset,e.length))}};var oo=We(Ht());var eh=class extends vf{constructor(e,t,i,n,s,f,a,o,c){super(e,t,i,n,s,a,c);o&&(this.ephemeralKeys=o),this.initialMsg=f}async propose(){if(this.isInitiator)this.xx.sendMessage(this.session,oo.Buffer.alloc(0),this.ephemeralKeys),we("XX Fallback Stage 0 - Initialized state as the first message was sent by initiator."),In(this.session.hs.e);else{we("XX Fallback Stage 0 - Responder decoding initial msg from IK.");let e=bs(this.initialMsg),{valid:t}=this.xx.recvMessage(this.session,{ne:e.ne,ns:oo.Buffer.alloc(0),ciphertext:oo.Buffer.alloc(0)});if(!t)throw new Error("xx fallback stage 0 decryption validation fail");we("XX Fallback Stage 0 - Responder used received message from IK."),ji(this.session.hs.re)}}async exchange(){if(this.isInitiator){let e=ps(this.initialMsg),{plaintext:t,valid:i}=this.xx.recvMessage(this.session,e);if(!i)throw new Error("xx fallback stage 1 decryption validation fail");we("XX Fallback Stage 1 - Initiator used received message from IK."),ji(this.session.hs.re),ls(this.session.hs.rs),we("Initiator going to check remote's signature...");try{let n=await Mn(t);this.remotePeer=this.remotePeer||await En(n),await _n(this.session.hs.rs,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let s=n;throw new Error(`Error occurred while verifying signed payload from responder: ${s.message}`)}we("All good with the signature!")}else we("XX Fallback Stage 1 - Responder start"),await super.exchange(),we("XX Fallback Stage 1 - Responder end")}};var th=We(Ht());function oy(r){return async function*(e){for await(let t of e){let i=th.Buffer.from(t.buffer,t.byteOffset,t.length);for(let n=0;n<i.length;n+=Zd){let s=n+Zd;s>i.length&&(s=i.length),yield r.encrypt(i.slice(n,s),r.session)}}}}function cy(r){return async function*(e){for await(let t of e){let i=th.Buffer.from(t.buffer,t.byteOffset,t.length);for(let n=0;n<i.length;n+=a0){let s=n+a0;s>i.length&&(s=i.length);let f=i.slice(n,s),{plaintext:a,valid:o}=await r.decrypt(f,r.session);if(!o)throw new Error("Failed to validate decrypted chunk");yield a}}}}var dy=class{constructor(){this.storage=new Map}store(e,t){this.storage.set(e.id,t)}load(e){return e?this.storage.get(e.id)??null:null}resetStorage(){this.storage.clear()}},co=new dy;var wf=class{constructor(e,t){this.protocol="/noise";this.prologue=ho.Buffer.alloc(0);if(this.earlyData=t??ho.Buffer.alloc(0),this.useNoisePipes=!1,e){let i=hy.default.publicKeyCreate(e);this.staticKeys={privateKey:e,publicKey:i}}else this.staticKeys=Sn()}async secureOutbound(e,t,i){let n=rh.default(t,{lengthEncoder:mf,lengthDecoder:xf,maxDataLength:a0}),s=await this.performHandshake({connection:n,isInitiator:!0,localPeer:e,remotePeer:i});return{conn:await this.createSecureConnection(n,s),remoteEarlyData:s.remoteEarlyData,remotePeer:s.remotePeer}}async secureInbound(e,t,i){let n=rh.default(t,{lengthEncoder:mf,lengthDecoder:xf,maxDataLength:a0}),s=await this.performHandshake({connection:n,isInitiator:!1,localPeer:e,remotePeer:i});return{conn:await this.createSecureConnection(n,s),remoteEarlyData:s.remoteEarlyData,remotePeer:s.remotePeer}}async performHandshake(e){let t=await O8(e.localPeer,this.staticKeys.publicKey,this.earlyData),i=this.useNoisePipes;if(e.isInitiator&&co.load(e.remotePeer)===null&&(i=!1),i){let{remotePeer:n,connection:s,isInitiator:f}=e,a=new Qd(f,t,this.prologue,this.staticKeys,s,co.load(e.remotePeer)??ho.Buffer.alloc(32),n);try{return await this.performIKHandshake(a)}catch(o){let c;return e.isInitiator&&(c=a.getLocalEphemeralKeys()),await this.performXXFallbackHandshake(e,t,o.initialMsg,c)}}else return await this.performXXHandshake(e,t)}async performXXFallbackHandshake(e,t,i,n){let{isInitiator:s,remotePeer:f,connection:a}=e,o=new eh(s,t,this.prologue,this.staticKeys,a,i,f,n);try{await o.propose(),await o.exchange(),await o.finish()}catch(c){we(c);let d=c;throw new Error(`Error occurred during XX Fallback handshake: ${d.message}`)}return o}async performXXHandshake(e,t){let{isInitiator:i,remotePeer:n,connection:s}=e,f=new vf(i,t,this.prologue,this.staticKeys,s,n);try{await f.propose(),await f.exchange(),await f.finish(),this.useNoisePipes&&f.remotePeer&&co.store(f.remotePeer,f.getRemoteStaticKey())}catch(a){let o=a;throw new Error(`Error occurred during XX handshake: ${o.message}`)}return f}async performIKHandshake(e){return await e.stage0(),await e.stage1(),e}async createSecureConnection(e,t){let[i,n]=uy.default(),s=e.unwrap();return await ly.default(i,ih.default,oy(t),uo.encode({lengthEncoder:mf}),s,uo.decode({lengthDecoder:xf}),ih.default,cy(t),i),n}};var by=new wf;return iI;})();
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
 * aead.js - aead for bcrypto
 * Copyright (c) 2016-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://tools.ietf.org/html/rfc7539#section-2.8
 *   https://github.com/openssh/openssh-portable
 */
/*!
 * assert.js - assert for bcrypto
 * Copyright (c) 2020, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
/*!
 * bn.js - big numbers for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
/*!
 * bn.js - big numbers for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on indutny/bn.js:
 *   Copyright (c) 2015, Fedor Indutny (MIT License).
 *   https://github.com/indutny/bn.js
 *
 * Parts of this software are based on golang/go:
 *   Copyright (c) 2009, The Go Authors. All rights reserved.
 *   https://github.com/golang/go
 *
 * Parts of this software are based on openssl/openssl:
 *   Copyright (c) 1998-2018, The OpenSSL Project (Apache License v2.0).
 *   Copyright (c) 1995-1998, Eric A. Young, Tim J. Hudson. All rights reserved.
 *   https://github.com/openssl/openssl
 *
 * Parts of this software are based on libgmp:
 *   Copyright (c) 1991-1997, 1999-2014, Free Software Foundation, Inc.
 *   https://gmplib.org/
 *
 * Parts of this software are based on v8/v8:
 *   Copyright (c) 2017, The V8 Project Authors (BSD-Style License).
 *   https://github.com/v8/v8
 *
 * Resources:
 *   https://github.com/indutny/bn.js/blob/master/lib/bn.js
 *   https://github.com/indutny/miller-rabin/blob/master/lib/mr.js
 *   https://github.com/golang/go/blob/master/src/math/big/int.go
 *   https://github.com/golang/go/blob/master/src/math/big/nat.go
 *   https://github.com/golang/go/blob/master/src/math/big/prime.go
 *   https://github.com/openssl/openssl/tree/master/crypto/bn
 *   https://github.com/openssl/openssl/blob/master/crypto/bn/bn_kron.c
 *   https://github.com/gnutls/nettle/blob/master/mini-gmp.c
 *   https://github.com/v8/v8/blob/master/src/objects/bigint.cc
 */
/*!
 * chacha20.js - chacha20 for bcrypto
 * Copyright (c) 2016-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources
 *   https://en.wikipedia.org/wiki/Chacha20
 *   https://tools.ietf.org/html/rfc7539#section-2
 *   https://cr.yp.to/chacha.html
 */
/*!
 * custom.js - custom inspect symbol for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
/*!
 * ecdh.js - ECDH for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://cr.yp.to/ecdh.html
 *   https://cr.yp.to/ecdh/curve25519-20060209.pdf
 *   https://tools.ietf.org/html/rfc7748
 */
/*!
 * elliptic.js - elliptic curves for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on indutny/elliptic:
 *   Copyright (c) 2014, Fedor Indutny (MIT License).
 *   https://github.com/indutny/elliptic
 *
 * Formulas from DJB and Tanja Lange [EFD].
 *
 * References:
 *
 *   [GECC] Guide to Elliptic Curve Cryptography
 *     D. Hankerson, A. Menezes, and S. Vanstone
 *     https://tinyurl.com/guide-to-ecc
 *
 *   [GLV] Faster Point Multiplication on Elliptic Curves
 *     R. Gallant, R. Lambert, and S. Vanstone
 *     https://link.springer.com/content/pdf/10.1007/3-540-44647-8_11.pdf
 *
 *   [MONT1] Montgomery curves and the Montgomery ladder
 *     Daniel J. Bernstein, Tanja Lange
 *     https://eprint.iacr.org/2017/293.pdf
 *
 *   [SQUARED] Elligator Squared
 *     Mehdi Tibouchi
 *     https://eprint.iacr.org/2014/043.pdf
 *
 *   [SEC1] SEC 1 - Standards for Efficient Cryptography Group
 *     Certicom Research
 *     https://www.secg.org/sec1-v2.pdf
 *
 *   [SEC2] SEC 2: Recommended Elliptic Curve Domain Parameters
 *     Certicom Research
 *     https://www.secg.org/sec2-v2.pdf
 *
 *   [SIDE1] Elliptic Curves and Side-Channel Attacks
 *     Marc Joye
 *     https://pdfs.semanticscholar.org/8d69/9645033e25d74fcfd4cbf07a770d2e943e14.pdf
 *
 *   [BLIND] Side-Channel Analysis on Blinding Regular Scalar Multiplications
 *     B. Feix, M. Roussellet, A. Venelli
 *     https://eprint.iacr.org/2014/191.pdf
 *
 *   [ALT] Alternative Elliptic Curve Representations
 *     R. Struik
 *     https://tools.ietf.org/id/draft-ietf-lwig-curve-representations-02.html
 *
 *   [ARITH1] Arithmetic of Elliptic Curves
 *     Christophe Doche, Tanja Lange
 *     Handbook of Elliptic and Hyperelliptic Curve Cryptography
 *     Page 267, Section 13 (978-1-58488-518-4)
 *     https://hyperelliptic.org/HEHCC/index.html
 *
 *   [ARITH2] The Arithmetic of Elliptic Curves, 2nd Edition
 *     Joseph H. Silverman
 *     http://www.pdmi.ras.ru/~lowdimma/BSD/Silverman-Arithmetic_of_EC.pdf
 *
 *   [EFD] Explicit-Formulas Database
 *     Daniel J. Bernstein, Tanja Lange
 *     https://hyperelliptic.org/EFD/index.html
 *
 *   [SAFE] SafeCurves: choosing safe curves for elliptic-curve cryptography
 *     Daniel J. Bernstein
 *     https://safecurves.cr.yp.to/
 *
 *   [4GLV] Refinement of the Four-Dimensional GLV Method on Elliptic Curves
 *     Hairong Yi, Yuqing Zhu, and Dongdai Lin
 *     http://www.site.uottawa.ca/~cadams/papers/prepro/paper_19_slides.pdf
 *
 *   [SSWU1] Efficient Indifferentiable Hashing into Ordinary Elliptic Curves
 *     E. Brier, J. Coron, T. Icart, D. Madore, H. Randriam, M. Tibouchi
 *     https://eprint.iacr.org/2009/340.pdf
 *
 *   [SSWU2] Rational points on certain hyperelliptic curves over finite fields
 *     Maciej Ulas
 *     https://arxiv.org/abs/0706.1448
 *
 *   [H2EC] Hashing to Elliptic Curves
 *     A. Faz-Hernandez, S. Scott, N. Sullivan, R. S. Wahby, C. A. Wood
 *     https://git.io/JeWz6
 *     https://github.com/cfrg/draft-irtf-cfrg-hash-to-curve
 *
 *   [SVDW1] Construction of Rational Points on Elliptic Curves
 *     A. Shallue, C. E. van de Woestijne
 *     https://works.bepress.com/andrew_shallue/1/download/
 *
 *   [SVDW2] Indifferentiable Hashing to Barreto-Naehrig Curves
 *     Pierre-Alain Fouque, Mehdi Tibouchi
 *     https://www.di.ens.fr/~fouque/pub/latincrypt12.pdf
 *
 *   [SVDW3] Covert ECDH over secp256k1
 *     Pieter Wuille
 *     https://gist.github.com/sipa/29118d3fcfac69f9930d57433316c039
 *
 *   [MONT2] Montgomery Curve (wikipedia)
 *     https://en.wikipedia.org/wiki/Montgomery_curve
 *
 *   [MONT3] Montgomery Curves and their arithmetic
 *     C. Costello, B. Smith
 *     https://eprint.iacr.org/2017/212.pdf
 *
 *   [ELL2] Elliptic-curve points indistinguishable from uniform random strings
 *     D. Bernstein, M. Hamburg, A. Krasnova, T. Lange
 *     https://elligator.cr.yp.to/elligator-20130828.pdf
 *
 *   [RFC7748] Elliptic Curves for Security
 *     A. Langley, M. Hamburg, S. Turner
 *     https://tools.ietf.org/html/rfc7748
 *
 *   [TWISTED] Twisted Edwards Curves
 *     D. Bernstein, P. Birkner, M. Joye, T. Lange, C. Peters
 *     https://eprint.iacr.org/2008/013.pdf
 *
 *   [ELL1] Injective Encodings to Elliptic Curves
 *     P. Fouque, A. Joux, M. Tibouchi
 *     https://eprint.iacr.org/2013/373.pdf
 *
 *   [ISOGENY] Twisting Edwards curves with isogenies
 *     Mike Hamburg
 *     https://www.shiftleft.org/papers/isogeny/isogeny.pdf
 *
 *   [RFC8032] Edwards-Curve Digital Signature Algorithm (EdDSA)
 *     S. Josefsson, SJD AB, I. Liusvaara
 *     https://tools.ietf.org/html/rfc8032
 *
 *   [SCHNORR] Schnorr Signatures for secp256k1
 *     Pieter Wuille
 *     https://github.com/sipa/bips/blob/d194620/bip-schnorr.mediawiki
 *
 *   [BIP340] Schnorr Signatures for secp256k1
 *     Pieter Wuille, Jonas Nick, Tim Ruffing
 *     https://github.com/bitcoin/bips/blob/master/bip-0340.mediawiki
 *
 *   [JCEN12] Efficient Software Implementation of Public-Key Cryptography
 *            on Sensor Networks Using the MSP430X Microcontroller
 *     C. P. L. Gouvea, L. B. Oliveira, J. Lopez
 *     http://conradoplg.cryptoland.net/files/2010/12/jcen12.pdf
 *
 *   [FIPS186] Federal Information Processing Standards Publication
 *     National Institute of Standards and Technology
 *     https://tinyurl.com/fips-186-3
 *
 *   [RFC5639] Elliptic Curve Cryptography (ECC) Brainpool
 *             Standard Curves and Curve Generation
 *     M. Lochter, BSI, J. Merkle
 *     https://tools.ietf.org/html/rfc5639
 *
 *   [TWISTEQ] Twisted Edwards & Short Weierstrass Equivalence
 *     Christopher Jeffrey
 *     https://gist.github.com/chjj/16ba7fa08d64e8dda269a9fe5b2a8bbc
 *
 *   [ECPM] Elliptic Curve Point Multiplication (wikipedia)
 *     https://en.wikipedia.org/wiki/Elliptic_curve_point_multiplication
 */
/*!
 * hkdf.js - hkdf for bcrypto
 * Copyright (c) 2014-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/HKDF
 *   https://tools.ietf.org/html/rfc5869
 */
/*!
 * hkdf.js - hkdf for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
/*!
 * hmac.js - hmac for bcrypto
 * Copyright (c) 2016-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on indutny/hash.js:
 *   Copyright (c) 2014, Fedor Indutny (MIT License).
 *   https://github.com/indutny/hash.js
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/HMAC
 *   https://tools.ietf.org/html/rfc2104
 *   https://github.com/indutny/hash.js/blob/master/lib/hash/hmac.js
 */
/*!
 * poly1305.js - poly1305 for bcrypto
 * Copyright (c) 2016-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on floodyberry/poly1305-donna:
 *   Placed into the public domain by Andrew Moon.
 *   https://github.com/floodyberry/poly1305-donna
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/Poly1305
 *   https://cr.yp.to/mac.html
 *   https://tools.ietf.org/html/rfc7539#section-2.5
 *   https://github.com/floodyberry/poly1305-donna/blob/master/poly1305-donna-16.h
 */
/*!
 * random.js - random for bcrypto
 * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 */
/*!
 * random.js - random number generator for bcrypto
 * Copyright (c) 2014-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://wiki.openssl.org/index.php/Random_Numbers
 *   https://csrc.nist.gov/projects/random-bit-generation/
 *   http://www.pcg-random.org/posts/bounded-rands.html
 *   https://developer.mozilla.org/en-US/docs/Web/API/Crypto/getRandomValues
 */
/*!
 * sha256.js - SHA256 implementation for bcrypto
 * Copyright (c) 2016-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Parts of this software are based on indutny/hash.js:
 *   Copyright (c) 2014, Fedor Indutny (MIT License).
 *   https://github.com/indutny/hash.js
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/SHA-2
 *   https://tools.ietf.org/html/rfc4634
 *   https://github.com/indutny/hash.js/blob/master/lib/hash/sha/256.js
 */
/*!
 * x25519.js - x25519 for bcrypto
 * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcrypto
 *
 * Resources:
 *   https://en.wikipedia.org/wiki/Curve25519
 *   https://cr.yp.to/ecdh/curve25519-20060209.pdf
 *   https://tools.ietf.org/html/rfc7748#section-5
 */
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */

return Libp2pNoise;
}));

